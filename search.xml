<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>å¦‚ä½•åœ¨2DUIä¸Šç”Ÿæˆ3Dæ¨¡å‹çš„åŒ…å›´ç›’</title>
    <url>/p/8d386e7b10e2/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="å‰è¨€">å‰è¨€</h1>
<p>åœ¨å®é™…å¼€å‘ä¸­é‡åˆ°äº†è¿™ä¸ªé—®é¢˜ï¼Œéœ€è¦åˆ¤æ–­ä¸€ä¸ª3Dæ¨¡å‹åœ¨ä¸“ç”¨ç›¸æœºä¸‹çš„æ˜¾ç¤ºèŒƒå›´ï¼Œå°†å…¶å±•ç¤ºåœ¨UIä¸Šã€‚åœ¨è¿™é‡Œè®°å½•ä¸€ä¸‹å®ç°æ­¥éª¤å’Œä»£ç ã€‚</p>
<h1 id="å®ç°æ–¹æ³•">å®ç°æ–¹æ³•</h1>
<ol type="1">
<li>ä»éœ€è¦æ¸²æŸ“çš„å¯¹è±¡ä¸Šè·å–Rendererç»„ä»¶ï¼ˆå¯¹äºå¤æ‚çš„3Dæ¨¡å‹ï¼Œä¸€èˆ¬å¾—åˆ°çš„æ˜¯<code>MeshRenderer</code>ï¼‰</li>
<li>æ ¹æ®Rendererç»„ä»¶çš„bounds.centerï¼Œbounds.extentsè®¡ç®—å‡ºä¸–ç•Œåæ ‡çš„å…«ä¸ªç‚¹</li>
<li>ä½¿ç”¨æ‹æ‘„æ¸²æŸ“å¯¹è±¡çš„Cameraè°ƒç”¨æ¥å£<code>UnityEngine.Camera.WorldToScreenPoint</code>ï¼Œè·å–å…«ä¸ªç‚¹çš„å±å¹•åæ ‡</li>
<li>éå†å…«ä¸ªç‚¹ï¼Œå–å‡ºxæ–¹å‘ä¸yæ–¹å‘çš„æœ€å¤§æœ€å°å€¼ï¼Œè¿”å›ä¸€ä¸ª<code>Vector4(minX,
minY, maxX,
maxY)</code>ï¼Œè¿™ä¸ªåæ ‡å³æ˜¯3Dæ¨¡å‹åœ¨2DUIä¸Šçš„æ˜¾ç¤ºåŒ…å›´ç›’ï¼ˆboundsï¼‰</li>
<li>æœ€ååœ¨UIå±‚è°ƒæ•´åŒ…å›´çŸ©å½¢çš„ä½ç½®å’Œå¤§å°å³å¯</li>
</ol>
<span id="more"></span>
<h1 id="ä»£ç ç¤ºä¾‹">ä»£ç ç¤ºä¾‹</h1>
<pre class="line-numbers language-c#" data-language="c#"><code class="language-c#">     &#x2F;&#x2F; Static Toolkit Code
     &#x2F;&#x2F;&#x2F; &lt;summary&gt;
     &#x2F;&#x2F;&#x2F; calculate all worldCorners with bounds, and translate into screen point(minX, minY, maxX, maxY)
     &#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;
     &#x2F;&#x2F;&#x2F; &lt;param name&#x3D;&quot;target&quot;&gt;&lt;&#x2F;param&gt;
     &#x2F;&#x2F;&#x2F; &lt;param name&#x3D;&quot;camera&quot;&gt;&lt;&#x2F;param&gt;
     &#x2F;&#x2F;&#x2F; &lt;param name&#x3D;&quot;zTest&quot;&gt;if ture, x and y will be set to 0 if z less or equal than 0 if screen point&lt;&#x2F;param&gt;
     &#x2F;&#x2F;&#x2F; &lt;returns&gt;&lt;&#x2F;returns&gt;
     public static Vector4 GetScreenCorners(GameObject target, UnityEngine.Camera camera, bool zTest)
     &#123;
         var renderer &#x3D; target.GetComponentInChildren&lt;Renderer&gt;();
         if (renderer &#x3D;&#x3D; null)
         &#123;
             return Vector4.zero;
         &#125;

         var bounds &#x3D; renderer.bounds;
         var center &#x3D; bounds.center;
         var extents &#x3D; bounds.extents;

         var worldCorners &#x3D; new[]
         &#123;
             new Vector3(center.x - extents.x, center.y - extents.y, center.z - extents.z),
             new Vector3(center.x - extents.x, center.y - extents.y, center.z + extents.z),
             new Vector3(center.x - extents.x, center.y + extents.y, center.z - extents.z),
             new Vector3(center.x - extents.x, center.y + extents.y, center.z + extents.z),
             new Vector3(center.x + extents.x, center.y - extents.y, center.z - extents.z),
             new Vector3(center.x + extents.x, center.y - extents.y, center.z + extents.z),
             new Vector3(center.x + extents.x, center.y + extents.y, center.z - extents.z),
             new Vector3(center.x + extents.x, center.y + extents.y, center.z + extents.z),
         &#125;;

         var screenCornerArray &#x3D; new Vector3[8];
         for (int i &#x3D; 0; i &lt; 8; i++)
         &#123;
             screenCornerArray[i] &#x3D; camera.WorldToScreenPoint(worldCorners[i]);
             if (zTest &amp;&amp; screenCornerArray[i].z &lt;&#x3D; 0)
             &#123;
                 screenCornerArray[i].x &#x3D; 0;
                 screenCornerArray[i].y &#x3D; 0;
             &#125;
         &#125;
         
         var minX &#x3D; float.MaxValue;
         var minY &#x3D; float.MaxValue;
         var maxX &#x3D; float.MinValue;
         var maxY &#x3D; float.MinValue;
         for (int i &#x3D; 0; i &lt; screenCornerArray.Length; i++)
         &#123;
             var corner &#x3D; screenCornerArray[i];
             if (corner.x &lt; minX)
             &#123;
                 minX &#x3D; corner.x;
             &#125;

             if (corner.x &gt; maxX)
             &#123;
                 maxX &#x3D; corner.x;
             &#125;

             if (corner.y &lt; minY)
             &#123;
                 minY &#x3D; corner.y;
             &#125;

             if (corner.y &gt; maxY)
             &#123;
                 maxY &#x3D; corner.y;
             &#125;
         &#125;
         
         return new Vector4(minX, minY, maxX, maxY);
     &#125;

     &#x2F;&#x2F; UI Controller Code: Size adjustment
     private void OnTargetObjectScreenBoundsUpdate(object[] param)
     &#123;
         if (param.Length !&#x3D; 2)
         &#123;
             return;
         &#125;

         var targetName &#x3D; (string) param[0];
         var vec4 &#x3D; (Vector4) param[1];
         &#x2F;&#x2F; Debug.LogFormat(&quot;[ScreenCornerController.OnTargetObjectScreenBoundsUpdate] &#123;0&#125;&quot;, vec4);
         var centerX &#x3D; (vec4[2] + vec4[0]) &#x2F; 2;
         var centerY &#x3D; (vec4[3] + vec4[1]) &#x2F; 2;
         var width &#x3D; vec4[2] - vec4[0];
         var height &#x3D; vec4[3] - vec4[1];
         
         &#x2F;&#x2F; selectorImage&lt;UnityEngine.UI.Image&gt;
         selectorImage.rectTransform.anchoredPosition &#x3D; new Vector2(centerX, centerY);
         selectorImage.rectTransform.SetSizeWithCurrentAnchors(RectTransform.Axis.Vertical, height);
         selectorImage.rectTransform.SetSizeWithCurrentAnchors(RectTransform.Axis.Horizontal, width);
&#x2F;&#x2F; selectorText&lt;TMPro.TextMeshProUGUI&gt;
         selectorText.text &#x3D; $&quot;&#123;targetName&#125;\nminX:&#123;vec4[0]&#125; minY:&#123;vec4[1]&#125;\nmaxX:&#123;vec4[2]&#125; maxY:&#123;vec4[3]&#125;&quot;;
         selectorImage.gameObject.SetActive(width &gt; 0.001f &amp;&amp; height &gt; 0.001f);
     &#125;</code></pre>
<h1 id="æ•ˆæœç¤ºä¾‹">æ•ˆæœç¤ºä¾‹</h1>
<a href="/p/8d386e7b10e2/3bounds2.gif" class="gallery-item"><img src="/p/8d386e7b10e2/3bounds2.gif" class="" title="UIåŒ…å›´ç›’çš„å¤§å°éšç€å…”å­æ¨¡å‹ç»•zè½´æ—‹è½¬è€Œå˜åŒ–"></a>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>æ¸¸æˆå¼€å‘</category>
        <category>è§£å†³æ–¹æ¡ˆ</category>
      </categories>
      <tags>
        <tag>æ¸¸æˆå¼€å‘</tag>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ŠCLR via C#ã€‹Chapter4 ç±»å‹åŸºç¡€</title>
    <url>/p/77589f7bf80e/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="ç¬¬å››ç« -ç±»å‹åŸºç¡€">ç¬¬å››ç«  ç±»å‹åŸºç¡€</h1>
<h2 id="æ‰€æœ‰ç±»å‹éƒ½ä»system.objectæ´¾ç”Ÿ">4.1
æ‰€æœ‰ç±»å‹éƒ½ä»System.Objectæ´¾ç”Ÿ</h2>
<h3 id="gethashcode-ä¸-equals">GetHashCode() ä¸ Equals()</h3>
<p>å¦‚æœå¯¹è±¡è¦åœ¨å“ˆå¸Œè¡¨é›†åˆä¸­ç”¨ä½œé”®ä½¿ç”¨ï¼Œé‚£ä¹ˆåº”è¯¥é‡å†™GetHashCodeæ–¹æ³•ï¼›å¦‚æœä¸¤ä¸ªå¯¹è±¡å…·æœ‰ç›¸åŒçš„å€¼ï¼Œé‚£ä¹ˆEqualsåº”è¯¥è¿”å›trueã€‚</p>
<p>Objectç±»çš„Equalså’ŒGetHashCodeå…·ä½“å®ç°éƒ½æ˜¯internalcallï¼Œç”±CLRå®ç°ï¼ŒEqualsæºç å®ç°å¯å‚è€ƒä»¥ä¸‹ï¼š</p>
<span id="more"></span>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">&#x2F;&#x2F; https:&#x2F;&#x2F;stackoverflow.com&#x2F;questions&#x2F;384294&#x2F;where-is-the-implementation-of-internalequalsobject-obja-object-objb
&#x2F;&#x2F; sscli20&#x2F;clr&#x2F;src&#x2F;vm&#x2F;comobject.cpp
&#x2F;&#x2F; ä¸è¿‡è¿™ä»½å®ç°å¾ˆè€äº†ï¼Œç®€å•å‚è€ƒå³å¯

FCIMPL2(FC_BOOL_RET, ObjectNative::Equals, Object *pThisRef, Object *pCompareRef)
&#123;
    CONTRACTL
    &#123;
        THROWS;
        DISABLED(GC_NOTRIGGER);
        INJECT_FAULT(FCThrow(kOutOfMemoryException););
        MODE_COOPERATIVE;
        SO_TOLERANT;          
    &#125;
    CONTRACTL_END;

    if (pThisRef &#x3D;&#x3D; pCompareRef) &#x2F;&#x2F; åŒä¸€ä¸ªå¼•ç”¨ç±»å‹å¯¹è±¡å®ä¾‹
        FC_RETURN_BOOL(TRUE);

    &#x2F;&#x2F; Since we are in FCALL, we must handle NULL specially.
    if (pThisRef &#x3D;&#x3D; NULL || pCompareRef &#x3D;&#x3D; NULL)
         FC_RETURN_BOOL(FALSE);

    MethodTable *pThisMT &#x3D; pThisRef-&gt;GetMethodTable();

    &#x2F;&#x2F; If it&#39;s not a value class, don&#39;t compare by value, &lt;- åªæœ‰å€¼ç±»å‹çš„å¯¹è±¡æ‰è¿›è¡Œå€¼æ¯”è¾ƒ
    if (!pThisMT-&gt;IsValueClass()) &#x2F;&#x2F; ä¸åŒçš„å¼•ç”¨ç±»å‹å¯¹è±¡ï¼Œåœ¨è¿™é‡Œç»“æŸï¼Œè¿”å›False
         FC_RETURN_BOOL(FALSE);

    &#x2F;&#x2F; Make sure they are the same type.
    if (pThisMT !&#x3D; pCompareRef-&gt;GetMethodTable())
        FC_RETURN_BOOL(FALSE);

    &#x2F;&#x2F; Compare the contents (size - vtable - sink block index).
    BOOL ret &#x3D; memcmp(
        (void *) (pThisRef+1), 
        (void *) (pCompareRef+1), 
        pThisRef-&gt;GetMethodTable()-&gt;GetBaseSize() - sizeof(Object) - sizeof(int)) &#x3D;&#x3D; 0;

    FC_GC_POLL_RET();

    FC_RETURN_BOOL(ret);
&#125;
FCIMPLEND</code></pre>
<h3 id="newæ“ä½œç¬¦ä¼šåšä»€ä¹ˆ">newæ“ä½œç¬¦ä¼šåšä»€ä¹ˆ</h3>
<p>æ‰€æœ‰å¯¹è±¡éƒ½ç”¨newæ“ä½œç¬¦åˆ›å»ºï¼Œnewæ“ä½œä¼šåšçš„äº‹æƒ…æœ‰ï¼š</p>
<ol type="1">
<li>è®¡ç®—ç±»å‹åŠå…¶æ‰€æœ‰åŸºç±»å‹å®šä¹‰çš„æ‰€æœ‰å®ä¾‹å­—æ®µï¼ˆå³éé™æ€å­—æ®µï¼‰éœ€è¦çš„å­—èŠ‚æ•°ã€‚å †ä¸Šçš„æ¯ä¸ªå¯¹è±¡éœ€è¦ä¸€äº›é¢å¤–çš„æˆå‘˜ï¼ŒåŒ…æ‹¬<strong>ç±»å‹å¯¹è±¡æŒ‡é’ˆï¼ˆtype
object pointerï¼‰</strong>å’Œ<strong>åŒæ­¥å—ç´¢å¼•ï¼ˆsync block
indexï¼‰</strong>ï¼ŒCLRåˆ©ç”¨è¿™äº›æˆå‘˜ç®¡ç†å¯¹è±¡ï¼Œé¢å¤–æˆå‘˜çš„å­—èŠ‚æ•°ä¹Ÿè®¡å…¥å…‘ç°å¤§å°</li>
<li>ä»æ‰˜ç®¡å †ä¸­åˆ†é…éœ€æ±‚çš„å­—èŠ‚æ•°ï¼Œåˆ†é…çš„æ‰€æœ‰å­—èŠ‚è®¾ä¸º0</li>
<li>åˆå§‹åŒ–å¯¹è±¡çš„<strong>ç±»å‹å¯¹è±¡æŒ‡é’ˆ</strong>å’Œ<strong>åŒæ­¥å—ç´¢å¼•</strong>æˆå‘˜</li>
<li>è°ƒç”¨ç±»å‹çš„å®ä¾‹æ„é€ å™¨ï¼Œè°ƒç”¨<strong>System.Object</strong>çš„æ„é€ å™¨ï¼ˆæ­¤æ„é€ å™¨ä»€ä¹ˆéƒ½ä¸åšï¼Œç®€å•è¿”å›ï¼‰</li>
</ol>
<h2 id="ç±»å‹è½¬æ¢">4.2 ç±»å‹è½¬æ¢</h2>
<p>ç±»å‹å®‰å…¨æ˜¯CLRæœ€é‡è¦çš„ç‰¹æ€§ä¹‹ä¸€ï¼Œè¿è¡Œæ—¶CLRæ€»æ˜¯çŸ¥é“å¯¹è±¡çš„ç±»å‹æ˜¯ä»€ä¹ˆ</p>
<div class="note warning"><p>ç±»å‹ä¼ªè£…æ˜¯è®¸å¤šå®‰å…¨æ¼æ´çš„æ ¹æºï¼Œå®ƒè¿˜ä¼šç ´ååº”ç”¨ç¨‹åºçš„ç¨³å®šæ€§å’Œå¥å£®æ€§ã€‚å› æ­¤ï¼Œç±»å‹å®‰å…¨æ˜¯CLRæå…¶é‡è¦çš„ä¸€ä¸ªç‰¹ç‚¹ã€‚</p>
</div>
<p>C#ä¸è¦æ±‚ç‰¹æ®Šè¯­æ³•
å³å¯å°†å¯¹è±¡è½¬æ¢ä¸ºå®ƒçš„åŸºç±»å‹ï¼Œå› ä¸ºå‘åŸºç±»å‹çš„è½¬æ¢è¢«è®¤ä¸ºæ˜¯å®‰å…¨éšå¼è½¬æ¢ã€‚ç„¶è€Œè½¬æ¢ä¸ºå®ƒçš„æ´¾ç”Ÿç±»å‹æ—¶ï¼ŒC#è¦æ±‚å¼€å‘äººå‘˜åªèƒ½è¿›è¡Œæ˜¾ç¤ºè½¬æ¢ï¼Œå› ä¸ºè½¬æ¢å¯èƒ½åœ¨è¿è¡Œæ—¶å¤±è´¥ã€‚</p>
<div class="note info"><p>æ³¨æ„ï¼Œå‘½åç©ºé—´å’Œç¨‹åºé›†ä¸ä¸€å®šç›¸å…³ã€‚åŒä¸€ä¸ªå‘½åç©ºé—´ä¸­çš„ç±»å‹å¯èƒ½åœ¨ä¸åŒç¨‹åºé›†ä¸­å®ç°ï¼ŒåŒä¸€ä¸ªç¨‹åºé›†ä¹Ÿå¯èƒ½åŒ…å«ä¸åŒå‘½åç©ºé—´ä¸­çš„ç±»å‹ã€‚</p>
</div>
<h2 id="è¿è¡Œæ—¶çš„ç›¸äº’å…³ç³»">4.4 è¿è¡Œæ—¶çš„ç›¸äº’å…³ç³»</h2>
<div class="note info"><p>[å¤ä¹ ][è®¡ç®—æœºç»„æˆåŸç†]
å½“æ¯ä¸ªçº¿ç¨‹åˆ›å»ºå®Œæˆåéƒ½è¢«åˆ†é…ä¸€å®šå¤§å°çš„æ ˆç©ºé—´ï¼Œç”¨äºå­˜æ”¾å±€éƒ¨å˜é‡ï¼Œæ–¹æ³•é—´ä¼ é€’å‚æ•°ï¼Œæ ˆç©ºé—´ä»é«˜åœ°å€å‘ä½åœ°å€å¢é•¿ã€‚æ–¹æ³•è°ƒç”¨æ—¶ï¼Œ<strong>å‚æ•°</strong>ï¼Œä»¥åŠ<strong>è¢«è°ƒç”¨æ–¹æ³•ç»“æŸæ—¶çš„è¿”å›åœ°å€</strong>ä¼šè¢«å‹å…¥æ ˆä¸­</p>
</div>
<h3 id="ç±»å‹å¯¹è±¡">ç±»å‹å¯¹è±¡</h3>
<p>å‰é¢æåˆ°æ¯ä¸ªå †ä¸Šçš„å¯¹è±¡éƒ½åŒ…æ‹¬äº†<strong>ç±»å‹å¯¹è±¡æŒ‡é’ˆï¼ˆType object
ptrï¼‰</strong>å’Œ<strong>åŒæ­¥å—ç´¢å¼•ï¼ˆsync block
indexï¼‰</strong>ï¼Œç±»å‹å¯¹è±¡ï¼ˆtype
objectï¼Œå³æ¯ä¸ªç±»å‹å”¯ä¸€çš„å¯¹è±¡/å®ä¾‹ï¼‰ä¹Ÿæ˜¯ä¸€æ ·çš„</p>
<p>å®šä¹‰ç±»å‹çš„<strong>é™æ€æˆå‘˜</strong>æ—¶ï¼Œç”¨äºå­˜æ”¾è¿™äº›é™æ€å†…å®¹çš„æ‰€æœ‰å­—èŠ‚å°±å­˜æ”¾åœ¨ç±»å‹å¯¹è±¡ä¸­</p>
<p>æ¯ä¸ªç±»å‹å¯¹è±¡ä¸­è¿˜å­˜æ”¾äº†æ–¹æ³•è¡¨ï¼Œæ–¹æ³•è¡¨é‡Œè®°å½•äº†ç±»å‹æ¯ä¸€ä¸ªæ–¹æ³•çš„å…¥å£ï¼Œéœ€è¦è¡¥å……çš„æ˜¯è¿™é‡Œå¹¶ä¸åŒºåˆ†é™æ€æ–¹æ³•å’Œéé™æ€æ–¹æ³•ã€‚å¯ä»¥çœ‹åˆ°å¯¹äºå­ç±»ï¼Œæ–¹æ³•è¡¨ä¸­ä»…æœ‰é‡å†™ï¼ˆoverrideï¼‰äº†çš„æ–¹æ³•ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/01/25/3tmkIhuFzGON7bn.png" title="Employeeä¸Managerç±»çš„å£°æ˜" class="gallery-item"><img src="https://s2.loli.net/2023/01/25/3tmkIhuFzGON7bn.png"
alt="Employeeä¸Managerç±»çš„å£°æ˜" /></a>
<figcaption aria-hidden="true">Employeeä¸Managerç±»çš„å£°æ˜</figcaption>
</figure>
<figure>
<a href="https://s2.loli.net/2023/01/25/cLj8t4deqmRYQW6.png" title="ç±»å‹å¯¹è±¡åˆ›å»ºåçš„å†…å­˜åˆ†é…æƒ…å†µ" class="gallery-item"><img src="https://s2.loli.net/2023/01/25/cLj8t4deqmRYQW6.png"
alt="ç±»å‹å¯¹è±¡åˆ›å»ºåçš„å†…å­˜åˆ†é…æƒ…å†µ" /></a>
<figcaption aria-hidden="true">ç±»å‹å¯¹è±¡åˆ›å»ºåçš„å†…å­˜åˆ†é…æƒ…å†µ</figcaption>
</figure>
<p>CLRä¼šåœ¨æ–¹æ³•æ‰§è¡Œå‰ä¿è¯è¯¥æ–¹æ³•ä¾èµ–çš„æ‰€æœ‰ç±»å¯¹è±¡å‡å·²åˆ›å»ºå®Œæ¯•ï¼ˆä½†æ˜¯å¯¹äºéJITæ˜¯å¦ä¹Ÿæ˜¯æ–¹æ³•æ‰§è¡Œå‰åˆ›å»ºï¼Œè¿™ä¸ªéœ€è¦ç¡®è®¤ä¸‹ï¼‰</p>
<h3 id="ç±»å‹å®ä¾‹çš„åˆ›å»ºä¸æ–¹æ³•è°ƒç”¨">ç±»å‹å®ä¾‹çš„åˆ›å»ºä¸æ–¹æ³•è°ƒç”¨</h3>
<p>[è§£æƒ‘]
CLRä¼šè‡ªåŠ¨å°†å±€éƒ¨å˜é‡èµ‹å€¼ä¸ºnullæˆ–0ï¼Œä½†ç¼–è¯‘å™¨ä¼šå°†â€œå¯¹æœªèµ‹å€¼å±€éƒ¨å˜é‡çš„ä½¿ç”¨â€è¿›è¡ŒæŠ¥é”™å¤„ç†</p>
<p>ä¸¾ä¾‹ç¤ºä¾‹ä¸­çš„Managerå¯¹è±¡ï¼Œåˆ†é…åœ¨å †ä¸Šï¼ŒåŒæ ·æ‹¥æœ‰<strong>ç±»å‹å¯¹è±¡æŒ‡é’ˆï¼ˆType
object ptrï¼‰</strong>å’Œ<strong>åŒæ­¥å—ç´¢å¼•ï¼ˆsync block
indexï¼‰</strong>ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜æœ‰ç”¨äºå­˜æ”¾æ‰€æœ‰éé™æ€å­—æ®µ/å®ä¾‹å­—æ®µï¼ˆinstance
data fieldsï¼‰çš„è®¸å¤šå­—èŠ‚ï¼Œè¿™äº›å­—æ®µå½“ç„¶åŒ…å«äº†åŸºç±»å®šä¹‰çš„å­—æ®µ</p>
<p>æœ€ånewæ“ä½œç¬¦ä¼šè¿”å›Managerå¯¹è±¡åœ¨å †ä¸Šçš„å†…å­˜åœ°å€ï¼Œå­˜æ”¾åœ¨å±€éƒ¨å˜é‡eä¸­ï¼ˆeåˆ†é…åœ¨æ ˆä¸Šï¼‰</p>
<h4 id="é™æ€æ–¹æ³•çš„è°ƒç”¨">é™æ€æ–¹æ³•çš„è°ƒç”¨</h4>
<p>å½“è°ƒç”¨ä¸€ä¸ªç±»å‹çš„é™æ€æ–¹æ³•æ—¶ï¼ŒCLRå…ˆæ ¹æ®ç±»å‹æ‰¾åˆ°ç±»å‹å¯¹è±¡ï¼Œå†ä»ç±»å‹å¯¹è±¡çš„æ–¹æ³•è¡¨ä¸­æ‰¾åˆ°å¯¹åº”çš„æ–¹æ³•è¿›è¡Œè°ƒç”¨ã€‚</p>
<h4 id="éé™æ€æ–¹æ³•çš„è°ƒç”¨">éé™æ€æ–¹æ³•çš„è°ƒç”¨</h4>
<p>å½“è°ƒç”¨ä¸€ä¸ªéè™šæ–¹æ³•ï¼ˆnonvirtualï¼‰æ—¶ï¼ŒCLRï¼ˆåŸæ–‡ä¸ºJIT
Compilerï¼‰å°†ä¼šç›´æ¥æ ¹æ®å˜é‡çš„ç±»å‹å®šä½åˆ°å¯¹åº”ç±»å‹çš„<strong>ç±»å‹å¯¹è±¡</strong>ï¼›å¦‚æœåœ¨æ–¹æ³•è¡¨ä¸­æ²¡æœ‰æ‰¾åˆ°è¿™ä¸ªæ–¹æ³•ï¼ŒCLRå°†ä¼šæŸ¥çœ‹ç±»å‹ç»§æ‰¿ç»“æ„ç›´åˆ°Objectæ¥å¯»æ‰¾è¿™ä¸ªæ–¹æ³•ã€‚æ¯ä¸ªç±»å‹å¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå­—æ®µæŒ‡å‘å®ƒçš„åŸºç±»ï¼Œæ­¤å†…å®¹å¹¶æ²¡æœ‰ç»˜åˆ¶åˆ°å›¾ä¸­ã€‚</p>
<p>å½“è°ƒç”¨ä¸€ä¸ªè™šæ–¹æ³•æ—¶ï¼ˆvirtualï¼‰ï¼Œä¼šå¤šæ‰§è¡Œä¸€äº›ä»£ç ï¼šæ ¹æ®å˜é‡çš„ç±»å‹å¯¹è±¡æŒ‡é’ˆæ‰¾åˆ°å¯¹è±¡çš„å‡†ç¡®ç±»å‹ï¼Œå¹¶åœ¨æ­¤ç±»å‹å¯¹è±¡çš„æ–¹æ³•è¡¨ä¸­æŸ¥æ‰¾æ–¹æ³•å…¥å£ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/01/25/GgP6z4J1MQ5ZEnX.png" title="è°ƒç”¨éè™šæ–¹æ³•GetYearsEmployed" class="gallery-item"><img src="https://s2.loli.net/2023/01/25/GgP6z4J1MQ5ZEnX.png"
alt="è°ƒç”¨éè™šæ–¹æ³•GetYearsEmployed" /></a>
<figcaption aria-hidden="true">è°ƒç”¨éè™šæ–¹æ³•GetYearsEmployed</figcaption>
</figure>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼Œå¯¹äºä¸Šè¿°<code>Manager</code>å’Œ<code>Employee</code>ä¸¤ä¸ªç±»å‹å¯¹è±¡ï¼Œå®ƒä»¬çš„ç±»å‹å¯¹è±¡æŒ‡é’ˆä¹Ÿæ˜¯åœ¨åˆå§‹åŒ–æ—¶èµ‹å€¼çš„ï¼Œå®ƒä»¬çš„ç±»å‹æ˜¯<code>System.Type</code>ï¼Œæ‰€ä»¥å®ƒä»¬çš„ç±»å‹å¯¹è±¡æŒ‡é’ˆæŒ‡å‘çš„å°±æ˜¯<code>System.Type</code>è¿™ä¸ªç±»å‹çš„ç±»å‹å¯¹è±¡ã€‚</p>
<p>è€Œ<code>System.Type</code>ç±»å‹å¯¹è±¡çš„ç±»å‹å¯¹è±¡æŒ‡é’ˆæŒ‡å‘å®ƒè‡ªå·±ï¼Œæ¯•ç«Ÿè¿™ä¸ªå¯¹è±¡ä¹Ÿæ˜¯ä¸€ä¸ª<code>System.Type</code>ç±»å‹çš„å®ä¾‹ï¼Œç»“æ„å¦‚ä¸‹å›¾ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/01/25/nh5dGIwtLCyrSkE.png" title="System.Typeç±»å‹çš„ç±»å‹å¯¹è±¡" class="gallery-item"><img src="https://s2.loli.net/2023/01/25/nh5dGIwtLCyrSkE.png"
alt="System.Typeç±»å‹çš„ç±»å‹å¯¹è±¡" /></a>
<figcaption aria-hidden="true">System.Typeç±»å‹çš„ç±»å‹å¯¹è±¡</figcaption>
</figure>
<p>æœ€åå›é¡¾å¹¶å¤ä¹ ä¸€ä¸‹ï¼Œä½¿ç”¨<code>System.Object</code>çš„<code>GetType()</code>æ–¹æ³•å¯ä»¥è¿”å›å­˜å‚¨åœ¨ç±»å‹å¯¹è±¡æŒ‡é’ˆæˆå‘˜ä¸­çš„å†…å®¹ï¼Œä»è€Œç¡®å®šä»»æ„å¯¹è±¡çš„ç¡®åˆ‡ç±»å‹ã€‚</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ç¼–ç¨‹è¯­è¨€</category>
        <category>C#</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹è¯­è¨€</tag>
        <tag>C#</tag>
        <tag>.NET</tag>
        <tag>CLR</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨hexoå¿«é€Ÿè¿›è¡Œåšå®¢æ­å»º</title>
    <url>/p/c9e58284d744/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="ä½¿ç”¨hexoå¿«é€Ÿè¿›è¡Œåšå®¢æ­å»º">ä½¿ç”¨hexoå¿«é€Ÿè¿›è¡Œåšå®¢æ­å»º</h1>
<p>ä¹‹å‰ç”¨wordpressæ­å»ºçš„åšå®¢éœ€è¦æŠ˜è…¾çš„ä¸œè¥¿å¤ªå¤šï¼Œç¼–è¾‘å™¨æ”¯æŒä¹Ÿä¸å¤ªå¥½ï¼Œæ²¡æœ‰Notioné‡Œè®°ç¬”è®°æ¥çš„æ–¹ä¾¿ï¼ˆè¯¥è¯´å†™ä¸ªç¬”è®°ä¸¤å¤´ä¼ æœ¬æ¥å°±éº»çƒ¦ï¼‰ï¼Œæ‰€ä»¥è¿™æ¬¡ç”¨hexoæ¥æ­å»ºçœ‹çœ‹ã€‚</p>
<p>éƒ¨ç½²é€‰æ‹©äº†ä¸€é”®åŒæ­¥ç”Ÿæˆçš„ç½‘ç«™å†…å®¹åˆ°github
repoä¸Šï¼Œä½¿ç”¨pagesæ¥è¿›è¡Œç½‘ç«™éƒ¨ç½²ï¼Œmarkdownæºæ–‡ä»¶å†è‡ªå·±ä½¿ç”¨githubæ¥åŒæ­¥ã€‚</p>
<p>è¿™ç¯‡æ–‡ç« ä¸»è¦è®°å½•ä¸€ä¸‹æ­å»ºç½‘ç«™çš„è¿‡ç¨‹ï¼Œè¿˜æœ‰ç»™æ­å»ºçš„æ—¶å€™çœ‹çš„å‡ ä¸ªæ–‡æ¡£é“¾æ¥ç•™ä¸ªæ¡£ã€‚</p>
<h2 id="hexoå®˜æ–¹æ–‡æ¡£">hexoå®˜æ–¹æ–‡æ¡£</h2>
<ol type="1">
<li>https://hexo.io/docs/</li>
<li>https://hexo.io/zh-cn/docs/ ä¸­æ–‡</li>
</ol>
<h2 id="hexo-å¸¸ç”¨å‘½ä»¤">hexo å¸¸ç”¨å‘½ä»¤</h2>
<p><strong>hexo new [layout] &lt;title&gt;</strong></p>
<p>åˆ›å»ºæ–°æ–‡ç« ï¼Œä½¿ç”¨é»˜è®¤çš„layoutï¼špost</p>
<p><strong>hexo generate</strong></p>
<p>ä¸€èˆ¬ä¼šä½¿ç”¨ç¼©å†™<code>hexo
g</code>ï¼Œå¹¶ä¸”åŠ ä¸Š<code>-d</code>å‚æ•°æ¥ä¸€é”®éƒ¨ç½²åˆ°è¿œç«¯ï¼ˆæˆ‘ç›®å‰æ˜¯éƒ¨ç½²åˆ°äº†githubä¸Šï¼‰ï¼Œä¹Ÿå¯ä»¥åŠ ä¸Š<code>-w</code>æ¥è§‚å¯Ÿæ–‡ä»¶å˜åŒ–ï¼Œæˆ–æ˜¯åŠ ä¸Š<code>-f</code>æ¥é‡æ–°ç”Ÿæˆ</p>
<p><strong>hexo server</strong></p>
<p>è™½ç„¶æ˜¯éƒ¨ç½²åˆ°è¿œç«¯ä¸Šï¼Œä½†æ˜¯ä¹Ÿå¯ä»¥åœ¨çœŸæ­£æäº¤å‰å…ˆåœ¨æœ¬åœ°ç®€å•åœ°ç”Ÿæˆéƒ¨ç½²ä¸€ä¸‹ï¼Œçœ‹ä¸‹æ–‡ç« æ˜¾ç¤ºæ˜¯å¦æœ‰é—®é¢˜ï¼Œæˆ–è€…ç”¨è¿™ä¸ªå‘½ä»¤æ¥ååŠ©debugï¼ˆå¸¦ä¸Š<code>--log</code>ï¼Œä»¥åŠ<code>--debug</code>å‚æ•°ï¼‰</p>
<p>åŠ ä¸Š<code>-p</code>æ¥æŒ‡å®šéƒ¨ç½²çš„ç«¯å£ï¼Œä»¥é˜²åœ¨ç‰¹å®šç¯å¢ƒä¸‹æ”¶åˆ°å®‰å…¨ç»„å½±å“</p>
<p><strong>hexo deploy</strong></p>
<p>éƒ¨ç½²åˆ°è¿œç«¯ï¼Œè¿™ä¸ªå‘½ä»¤ä¹Ÿå¯ä»¥åŠ ä¸Š<code>-g</code>ä»è€Œåœ¨éƒ¨ç½²ä¹‹å‰ç”Ÿæˆ</p>
<p><strong>hexo clean</strong></p>
<p>æ¸…é™¤æœ¬åœ°ç”Ÿæˆæ–‡ä»¶ï¼Œé‡åˆ°å¥‡æ€ªæ˜¾ç¤ºé—®é¢˜å¯ä»¥è€ƒè™‘å…ˆæ‰§è¡Œä¸€ä¸‹ï¼Œå†é‡æ–°generate</p>
<h2 id="éƒ¨ç½²ç›¸å…³github-pages">éƒ¨ç½²ç›¸å…³ï¼ˆgithub-pagesï¼‰</h2>
<ol type="1">
<li>https://segmentfault.com/a/1190000017986794 ä¸€é”®éƒ¨ç½²</li>
<li>https://zhuanlan.zhihu.com/p/26625249
è‡ªå®šä¹‰åŸŸåæ­¥éª¤å‚è€ƒï¼Œå…å»ä¹‹å‰ä½¿ç”¨wordpressè‡ªå·±éƒ¨ç½²ç½‘ç«™æ—¶è§£æçš„éº»çƒ¦</li>
<li>https://docs.github.com/en/pages/configuring-a-custom-domain-for-your-github-pages-site/about-custom-domains-and-github-pages</li>
</ol>
<p>è‡ªå®šä¹‰åŸŸååœ¨å‚è€ƒäº†ä¸Šè¿°é“¾æ¥ååšäº†ä¸€ç‚¹å°è¯•ï¼š</p>
<ol type="1">
<li><p>é¦–å…ˆåŸŸåè¿˜æ˜¯ä½¿ç”¨çš„ä¹‹å‰æ­å»ºwordpressç”¨çš„threegates.net</p></li>
<li><p>è¿™é‡Œå¼€å§‹éœ€è¦åšçš„æ˜¯å°†åŸŸåé‡å®šå‘åˆ°github-pagesï¼Œæ‰€ä»¥å®é™…ä¸Š<strong>éœ€è¦å‚è€ƒçš„æ¯”è¾ƒæƒå¨çš„æ–‡æ¡£æ˜¯ä¸Šé¢çš„é“¾æ¥3</strong></p>
<span id="more"></span></li>
<li><p>github
pageså»ºè®®çš„æ˜¯ä½¿ç”¨wwwåŸŸï¼Œè¯´æ˜äº†ä½¿ç”¨wwwåŸŸä½¿pagesä¹Ÿä¼šä¸ºä½ è¿›è¡Œapex
domainï¼ˆå³ä¸å¸¦wwwçš„threegates.netï¼‰çš„é‡å®šå‘ã€‚</p>
<blockquote>
<p>We recommend always using a <code>www</code> subdomain, even if you
also use an apex domain. When you create a new site with an apex domain,
we automatically attempt to secure the <code>www</code> subdomain for
use when serving your site's content. If you configure a
<code>www</code> subdomain, we automatically attempt to secure the
associated apex domain.</p>
</blockquote></li>
<li><p>å‚è€ƒâ€œManaging a custom domain for your GitHub Pages
siteâ€ï¼Œé¦–å…ˆåœ¨gtihub repoçš„settings-&gt;pagesç›®å½•ä¸‹é…ç½®Custom
Domainï¼Œè¿™é‡Œä½¿ç”¨<code>www.threegates.net</code></p></li>
<li><p>åœ¨é˜¿é‡Œäº‘çš„DNSè§£æä¸­é…ç½®ï¼Œè¿™é‡Œåº”è¯¥å°†<code>www.threegates.net</code>ä½¿ç”¨CNAMEå½¢å¼è§£æåˆ°æˆ‘çš„<code>kalulas.github.io</code>ï¼Œä¸”é€šè¿‡digå·¥å…·å’Œåç»­æ–‡æ¡£å¯ä»¥å¾—çŸ¥ï¼Œå¦‚æœé…ç½®äº†<code>threegates.net</code>åˆ°github
pagesæä¾›çš„å››ä¸ªDNSï¼ˆè§ä¸‹æ–‡ï¼‰ï¼Œgithub
pagesä¼šå¸®ä½ é‡å®šå‘åˆ°ç½‘é¡µå†…å®¹ï¼Œè€Œ<code>www.threegates.net</code>é…ç½®åˆ°<code>kalulas.github.io</code>ä¹‹åï¼Œåé¢å…¶å®ä¹Ÿæ˜¯è§£æåˆ°github.pagesçš„DNS</p></li>
<li><p>é…ç½®å¦‚å›¾ï¼š<a href="/p/c9e58284d744/aliyun-dns-config.png" class="gallery-item"><img src="/p/c9e58284d744/aliyun-dns-config.png" class="" title="aliyun dns configuration"></a></p></li>
<li><p>digå‘½ä»¤è§£æç»“æœå¦‚ä¸‹ï¼ˆthreegates.netçš„è§£ææƒ…å†µä¹Ÿä¸€æ ·ï¼‰ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ dig kalulas.github.io +nostats +nocomments +nocmd
; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.8 &lt;&lt;&gt;&gt; kalulas.github.io +nostats +nocomments +nocmd
;; global options: +cmd
;kalulas.github.io.             IN      A
kalulas.github.io.      3600    IN      A       185.199.109.153
kalulas.github.io.      3600    IN      A       185.199.111.153
kalulas.github.io.      3600    IN      A       185.199.110.153
kalulas.github.io.      3600    IN      A       185.199.108.153</code></pre>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ dig www.threegates.net +nostats +nocomment
; &lt;&lt;&gt;&gt; DiG 9.11.4-P2-RedHat-9.11.4-26.P2.el7_9.8 &lt;&lt;&gt;&gt; www.threegates.net +nostats +nocomment
;; global options: +cmd
;www.threegates.net.            IN      A
www.threegates.net.     600     IN      CNAME   kalulas.github.io.
kalulas.github.io.      3600    IN      A       185.199.109.153
kalulas.github.io.      3600    IN      A       185.199.111.153
kalulas.github.io.      3600    IN      A       185.199.110.153
kalulas.github.io.      3600    IN      A       185.199.108.153</code></pre></li>
<li><p>æœ€åï¼Œåœ¨ç¬¬4æ­¥ä¸­ä¿®æ”¹Custom
Domainä¼šæ·»åŠ ä¸€ä¸ªæ–‡ä»¶CNAMEåˆ°repoçš„æ ¹ç›®å½•ä¸‹ï¼Œä½†æ˜¯ç”±äºä½¿ç”¨äº†ä¸€é”®éƒ¨ç½²ï¼Œå®é™…ä¸ŠåŒæ­¥çš„ç›®å½•æ˜¯~/.../your_site/.deploy_gitï¼Œå¯ä»¥åœ¨è¿™ä¸ªç›®å½•ä¸‹åŒæ­¥ï¼Œä½†æ˜¯è¿™ä¸ªç›®å½•æ˜¯ç”±~/.../your_site/sourceç”Ÿæˆè€Œæ¥çš„ï¼Œæ‰€ä»¥å¾—åœ¨sourceä¸‹ä¹Ÿåˆ›å»ºä¸€ä¸ªCNAMEæ–‡ä»¶ï¼Œå†…å®¹å°±ç”¨githubä¸ºä½ ç”Ÿæˆçš„<code>www.threegates.net</code>å³å¯</p></li>
<li><p>æœ€åï¼Œæ–‡æ¡£æç¤ºäº†å¯ä»¥enforce
HTTPSï¼Œè¿™ä¸ªåœ¨åç»­ä¹ŸåŠ ä¸Šäº†ï¼Œå·¥ä½œæ­£å¸¸</p></li>
</ol>
<h2 id="ç½‘ç«™ä¸»é¢˜">ç½‘ç«™ä¸»é¢˜</h2>
<p>å½“å‰ç»´æŠ¤ä¸­çš„nextä¸»é¢˜ä¼ é€é—¨ï¼š</p>
<ol type="1">
<li>å®˜æ–¹æ–‡æ¡£ï¼šhttps://theme-next.js.org/docs/</li>
<li>githubï¼šhttps://github.com/next-theme/hexo-theme-next</li>
</ol>
<p>å½“å‰threegatesçš„hexoæ˜¯ä½¿ç”¨npmçš„æ–¹å¼å®‰è£…ä¸»é¢˜å¹¶æ›´æ–°çš„ï¼Œå‚è€ƒ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ cd hexo-site
$ npm install hexo-theme-next</code></pre>
<p>ä¸€æ¬¡åœ¨ç»™åšå®¢çš„æœ¬åœ°æœç´¢åŠŸèƒ½debugçš„æ—¶å€™å‘ç°äº†ç°åœ¨nextå…¶å®åŒæ—¶å­˜åœ¨ç€å¤šä¸ªgithubé¡¹ç›®ï¼Œå’Œè¿™äº›é¡¹ç›®ä¸­æŒ‡å‘çš„å¤šä¸ªæ–‡æ¡£ï¼Œå¯¼è‡´å®¹æ˜“é˜…è¯»åˆ°ä¸€äº›ä¸å½“å‰ç‰ˆæœ¬çš„ä¸åŒ¹é…å†…å®¹...è¿™è¾¹è¿˜æ˜¯ç•™æ„ä¸‹ï¼Œä»¥ä¸Šæ–‡ä¸­æä¾›çš„ä¸¤ä¸ªé“¾æ¥ä¸ºå‚è€ƒï¼ˆå½“å‰nextç‰ˆæœ¬v8.14.1ï¼‰ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/01/22/b8hiH1C3gnxD2Yo.png" title="è®°å½•äºNexT v8.14.1" class="gallery-item"><img src="https://s2.loli.net/2023/01/22/b8hiH1C3gnxD2Yo.png"
alt="è®°å½•äºNexT v8.14.1" /></a>
<figcaption aria-hidden="true">è®°å½•äºNexT v8.14.1</figcaption>
</figure>
<p>é¡ºå¸¦ä¸€æï¼Œæˆ‘å‘ç°çš„åœæ­¢ç»´æŠ¤é¡¹ç›®æœ‰ï¼š</p>
<ol type="1">
<li><a href="https://github.com/theme-next/hexo-theme-next" title="" target="">theme-next&#x2F;hexo-theme-next</a>
æ³¨æ„è¿™é‡Œç”¨æˆ·åæ˜¯<code>theme-next</code>è€Œä¸æ˜¯ä¸Šæ–‡çš„<code>next-theme</code>...è¿™ä¸ªä»“åº“releaseåœç•™åœ¨äº†v7.8.0</li>
<li><a href="https://github.com/iissnan/hexo-theme-next" title="" target="">iissnan&#x2F;hexo-theme-next</a>
è¿™ä¸ªä»“åº“ä¸­æ–‡å†…å®¹å¾ˆå¤šï¼Œä½†æ˜¯ä¹Ÿå·²ç»åœæ­¢ç»´æŠ¤ï¼Œreleaseåœç•™åœ¨v5.1.4</li>
</ol>
<h3 id="æ ·å¼layoutè‡ªå®šä¹‰">æ ·å¼ï¼ˆlayoutï¼‰è‡ªå®šä¹‰</h3>
<p>é˜…è¯»äº†hexoå’ŒNEXTçš„æ¨¡æ¿ç›¸å…³æ–‡ç« ï¼Œç®€å•çœ‹äº†ä¸‹å…³è”çš„njxï¼Œejsæ–‡ä»¶ï¼Œæƒ³é€šè¿‡is_post()æˆ–è€…is_home()çš„helperæ–¹æ³•å®ç°ä¸€ä¸‹ä»…åœ¨æ–‡ç« é¡µæ˜¾ç¤ºé˜…è¯»è¿›åº¦æ¡çš„æ•ˆæœï¼Œä½†æ˜¯ä¼¼ä¹è¿”å›ç»“æœä¸æ­£ç¡®ï¼Œç°åœ¨åœ¨nextçš„githubé¡µæäº†issueè¿˜åœ¨ç­‰å›å¤ã€‚</p>
<p>njxä¸­çš„è¯­æ³•ä¸ejsä¸å®Œå…¨ç›¸åŒï¼Œç®€å•å‚è€ƒäº†éå®˜æ–¹æ–‡æ¡£ï¼š</p>
<ol type="1">
<li>https://carrion.cc/20210201/85bc1840d3ea.html
æ ¸å¯¹äº†ä¸€ä¸‹njkä¸­çš„helperè¯­æ³•</li>
</ol>
<h3 id="å›¾ç‰‡å¢™">å›¾ç‰‡å¢™</h3>
<p>é€‰ç”¨äº†hexo-light-galleryæ’ä»¶ï¼Œä¼ é€é—¨
https://github.com/lzane/hexo-light-gallery
æŒ‰ç…§æ•™ç¨‹å®‰è£…äº†hexo-light-galleryï¼Œå¯¹<code>node_modules/hexo-light-gallery/src/renderer.js</code>
åšäº†ä¸€ç‚¹ä¿®æ”¹</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; node_modules&#x2F;hexo-light-gallery&#x2F;src&#x2F;renderer.js 
function addTag(data)&#123;
    var config &#x3D; this.config.lightgallery;
    if(!config)&#123;
        return;
    &#125;

    &#x2F;&#x2F; add js
    &#x2F;&#x2F; è¿™é‡Œæœ¬æ¥ &#39;&gt;&#39; åœ¨ &#39;&quot;&#39; å‰é¢ï¼Œä¼šé€ æˆç»“æ„ç ´å
    data.content &#x3D; &#39;&lt;div class&#x3D;&quot;.article-gallery&quot;&gt;&#39;+data.content+&#39;&lt;&#x2F;div&gt;&#39;;
    data.content+&#x3D;&#39;&lt;script src&#x3D;&quot;&#39;+config.js+&#39;&quot;&gt;&lt;&#x2F;script&gt;&#39;;

    &#x2F;&#x2F; add css
    var css &#x3D; &#39;&lt;link rel&#x3D;&quot;stylesheet&quot; type&#x3D;&quot;text&#x2F;css&quot; href&#x3D;&quot;&#39;+config.css+&#39;&quot; &#x2F;&gt;&#39;;
    data.content &#x3D; css + data.content;

    &#x2F;&#x2F; add plugins
    var plugins &#x3D; Object.keys(config.plugins);
    for (var plugin of plugins)&#123;
        var jsTag &#x3D; &#39;&lt;script src&#x3D;&quot;&#39;+config.plugins[plugin]+&#39;&quot;&gt;&lt;&#x2F;script&gt;&#39;;
        data.content +&#x3D; jsTag;
    &#125;
&#125;

&#x2F;&#x2F; ...
function render(data)&#123;
    if (ignore(data))&#123;
        return;
    &#125;
    &#x2F;&#x2F; å¦‚æœæ‰¾ä¸åˆ°å›¾ç‰‡æ ‡ç­¾ï¼Œå°±ä¸æ‰§è¡Œä¸‹é¢çš„ä»£ç ï¼Œå°±ä¸ä¼šåœ¨ä¸éœ€è¦çš„åœ°æ–¹å¢åŠ å¤šä½™å†…å®¹
    if (!imgRgr.exec(data.content))&#123;
        return;
    &#125;

    wrapImage.call(this,data);
    addTag.call(this,data);
    addRunnableTag.call(this,data);
&#125;;

</code></pre>
<p>åœ¨lightgalleryæä¾›çš„æ’ä»¶ï¼ˆæ’ä»¶çš„æ’ä»¶...ï¼‰ä¸­è¡¥å……äº†ä¸‰ä¸ªæ’ä»¶ï¼š</p>
<ol type="1">
<li>lg-thumbnail: æä¾›å›¾ç‰‡çš„ç¼©ç•¥å›¾</li>
<li>lg-zoom: æä¾›å›¾ç‰‡ç¼©æ”¾åŠŸèƒ½</li>
<li>lg-fullscreen: æä¾›å›¾ç‰‡å…¨å±é¢„è§ˆåŠŸèƒ½</li>
</ol>
<p>ä¸‰ä¸ªæ’ä»¶éƒ½é€šè¿‡npmä¸‹è½½äº†.min.jsæ–‡ä»¶ï¼Œæ”¾ç½®äº/source/js/ä¸‹ï¼Œç°åœ¨çš„<strong>_config.yml</strong>å¦‚ä¸‹</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># Plugin: lightgallery https:&#x2F;&#x2F;github.com&#x2F;lzane&#x2F;hexo-light-gallery
lightgallery:
# if you don&#39;t specify the css or js source, the default cdn will be used.
# css: # css source url
# js: #js source url
# sorry that I can not find any cdn hosting following plugins,
# please self-host the plugin js and add url here
  plugins:
    lg-thumbnail: &#x2F;js&#x2F;lg-thumbnail.min.js
    lg-zoom: &#x2F;js&#x2F;lg-zoom.min.js
#   lg-autoplay:
    lg-fullscreen: &#x2F;js&#x2F;lg-fullscreen.min.js
#   lg-pager:
</code></pre>
<h3 id="åŸºäºæ¨¡æ¿è¿›è¡Œhtmlç”Ÿæˆ">åŸºäºæ¨¡æ¿è¿›è¡Œhtmlç”Ÿæˆ</h3>
<p>å¾ˆåœ¨æ„htmlä¸­çš„ä¸€äº›jsä»£ç èµ„æºæ ‡ç­¾&lt;script&gt;æ˜¯æ€ä¹ˆåœ¨ç”Ÿæˆæ—¶åŠ ä¸Šçš„ï¼Œå¦‚å›¾ä¸Šçš„è¿™ç§</p>
<a href="/p/c9e58284d744/image-20211224175532445.png" class="gallery-item"><img src="/p/c9e58284d744/image-20211224175532445.png" class="" title="htmlä¸­çš„ä»£ç æ ‡ç­¾ç¤ºä¾‹"></a>
<p>è¦çŸ¥é“å®ƒçš„ç”Ÿæˆæœºåˆ¶æ‰æ–¹ä¾¿åšä¸€äº›jsä»£ç ä¸Šä¼ ï¼Œè¿˜æœ‰cdnä¸Šçš„èµ„æºæ”¾åˆ°æœ¬åœ°è¿™æ ·çš„æ“ä½œï¼Œè¿›è¡Œäº†ä¸€äº›æ’æŸ¥å¤§è‡´å®šä½ä¸‹ä¸‹é¢è¿™äº›ä¿¡æ¯ï¼š</p>
<ol type="1">
<li><strong>index.njk</strong>æ–‡ä»¶é‡Œåˆ©ç”¨äº†<code>next_js()</code>è¿™ä¸ªæ–¹æ³•æ¥åŠ è½½nextæä¾›çš„é™æ€jsæ–‡ä»¶ï¼Œå¦‚
comments.jsï¼Œutils.js ç­‰ç­‰</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; hexo-site-home&#x2F;node_modules&#x2F;hexo-theme-next&#x2F;layout&#x2F;_scripts&#x2F;index.njk

&#123;%- include &#39;vendors.njk&#39; -%&#125;

&#123;&#123;- next_js(&#39;comments.js&#39;) &#125;&#125;

&#123;&#123;- next_js(&#39;utils.js&#39;) &#125;&#125;
&#123;%- if theme.motion.enable %&#125;
  &#123;&#123;- next_js(&#39;motion.js&#39;) &#125;&#125;
&#123;%- endif %&#125;

&#123;%- if theme.scheme &#x3D;&#x3D;&#x3D; &#39;Muse&#39; or theme.scheme &#x3D;&#x3D;&#x3D; &#39;Mist&#39; %&#125;
  &#123;&#123;- next_js(&#39;schemes&#x2F;muse.js&#39;) &#125;&#125;
&#123;%- endif %&#125;

&#123;&#123;- next_js(&#39;next-boot.js&#39;) &#125;&#125;
&#123;%- if theme.bookmark.enable %&#125;
  &#123;&#123;- next_js(&#39;bookmark.js&#39;) &#125;&#125;
&#123;%- endif %&#125;
&#123;%- if theme.pjax %&#125;
  &#123;&#123;- next_js(&#39;pjax.js&#39;) &#125;&#125;
&#123;%- endif %&#125;
</code></pre>
<p>è€Œåœ¨ä¸Šé¢ä»£ç å—çš„ç¬¬ä¸€è¡Œçœ‹åˆ°äº†<code>&#123;%- include 'vendors.njk' -%&#125;</code>ï¼Œæ‰¾åˆ°å¯¹åº”çš„æ–‡ä»¶<strong>vendors.njk</strong>ä¸‹å¯ä»¥çœ‹åˆ°</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; hexo-site-home&#x2F;node_modules&#x2F;hexo-theme-next&#x2F;layout&#x2F;_scripts&#x2F;vendors.njk

&#123;%- if theme.canvas_ribbon.enable %&#125;
  &lt;script size&#x3D;&quot;&#123;&#123; theme.canvas_ribbon.size &#125;&#125;&quot; alpha&#x3D;&quot;&#123;&#123; theme.canvas_ribbon.alpha &#125;&#125;&quot; zIndex&#x3D;&quot;&#123;&#123; theme.canvas_ribbon.zIndex &#125;&#125;&quot; src&#x3D;&quot;&#123;&#123; theme.vendors.canvas_ribbon.url     &#125;&#125;&quot;&gt;&lt;&#x2F;script&gt;
&#123;%- endif %&#125;

&#123;%- for name in js_vendors() %&#125;
  &#123;&#123; next_vendors(name) &#125;&#125;
&#123;%- endfor %&#125;
</code></pre>
<p><code>&#123;%- for name in js_vendors() %&#125;</code>éå†çš„å°±æ˜¯<code>js_vendors()</code>æ–¹æ³•è¿”å›çš„æ‰€æœ‰jsèµ„æºæ ‡è¯†ç¬¦</p>
<ol start="2" type="1">
<li><code>js_vendors()</code>è¿™ä¸ªæ–¹æ³•æ˜¯åœ¨<strong>next-vendors.js</strong>ä¸­æ³¨å†Œçš„ï¼Œåƒprism-coreçš„è¿™äº›cdnä¸Šè·å–çš„jsèµ„æºï¼Œå…ˆé€šè¿‡é…ç½®æ¥å†³å®šæ˜¯å¦pushåˆ°è¿”å›çš„vendorsåˆ—è¡¨ä¸­ï¼Œé€»è¾‘å¦‚ä¸‹</li>
</ol>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; hexo-site-home&#x2F;node_modules&#x2F;hexo-theme-next&#x2F;scripts&#x2F;helpers&#x2F;next-vendors.js

hexo.extend.helper.register(&#39;js_vendors&#39;, function() &#123;
  const &#123; config, theme &#125; &#x3D; this;
  const vendors &#x3D; [&#39;anime&#39;];
  if (config.prismjs.enable &amp;&amp; !config.prismjs.preprocess) &#123;
    vendors.push(&#39;prism&#39;, &#39;prism_autoloader&#39;);
   if (config.prismjs.line_number) &#123;
     vendors.push(&#39;prism_line_numbers&#39;);
    &#125;
  &#125;
  if (theme.pjax) &#123;
    vendors.push(&#39;pjax&#39;);
  &#125;
  if (theme.fancybox) &#123;
    vendors.push(&#39;jquery&#39;, &#39;fancybox_js&#39;);
  &#125;
  if (theme.mediumzoom) &#123;
    vendors.push(&#39;mediumzoom&#39;);
  &#125;
  if (theme.lazyload) &#123;
    vendors.push(&#39;lazyload&#39;);
  &#125;
  if (theme.pangu) &#123;
    vendors.push(&#39;pangu&#39;);
  &#125;
  return vendors;
&#125;);
</code></pre>
<p>ä»ä¸Šæ–‡å¯ä»¥çœ‹åˆ°<code>vendors.njk</code>ä¼šéå†js_vendorsåˆ—è¡¨ï¼Œå¹¶ä¸”ç”¨æ‹¿åˆ°çš„æ¯ä¸€ä¸ªvendor_nameå»è°ƒç”¨æ–¹æ³•<code>next_vendors</code>ï¼Œè€Œè¿™ä¸ªæ–¹æ³•å°±æ˜¯åœ¨<strong>engine.js</strong>ä¸­æ³¨å†Œçš„ã€‚</p>
<p><code>next_vendors</code>çš„é€»è¾‘å°±æ˜¯æŸ¥æ‰¾vendorçš„ç›¸åº”é…ç½®ï¼Œvendorså­—æ®µä¸­çš„å†…å®¹æ˜¯ä»ä¸»é¢˜ç›®å½•ä¸‹çš„<strong>_vendors.yml</strong>è¿™ä¸ªyamlé…ç½®æ–‡ä»¶ä¸­è§£æå‡ºæ¥çš„ã€‚</p>
<pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">&#x2F;&#x2F; hexo-site-home&#x2F;node_modules&#x2F;hexo-theme-next&#x2F;scripts&#x2F;helpers&#x2F;engine.js
&#x2F;&#x2F; ...
hexo.extend.helper.register(&#39;next_vendors&#39;, function(name) &#123;
  const &#123; url, integrity &#125; &#x3D; this.theme.vendors[name];
  const type &#x3D; url.endsWith(&#39;css&#39;) ? &#39;css&#39; : &#39;js&#39;;
  if (type &#x3D;&#x3D;&#x3D; &#39;css&#39;) &#123;
    if (integrity) return &#96;&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;$&#123;url&#125;&quot; integrity&#x3D;&quot;$&#123;integrity&#125;&quot; crossorigin&#x3D;&quot;anonymous&quot;&gt;&#96;;
    return &#96;&lt;link rel&#x3D;&quot;stylesheet&quot; href&#x3D;&quot;$&#123;url&#125;&quot;&gt;&#96;;
  &#125;
  if (integrity) return &#96;&lt;script src&#x3D;&quot;$&#123;url&#125;&quot; integrity&#x3D;&quot;$&#123;integrity&#125;&quot; crossorigin&#x3D;&quot;anonymous&quot;&gt;&lt;&#x2F;script&gt;&#96;;
  return &#96;&lt;script src&#x3D;&quot;$&#123;url&#125;&quot;&gt;&lt;&#x2F;script&gt;&#96;;
&#125;);
</code></pre>
<ol start="3" type="1">
<li>æ‰€ä»¥å¦‚æœæƒ³åŠ ä¸€ä¸ªjsæ–‡ä»¶èµ„æºå¼•ç”¨ï¼Œå¯ä»¥è€ƒè™‘ä½œä¸ºä¸€ä¸ªé™æ€èµ„æºåŠ å…¥é¡¹ç›®ï¼Œå¹¶åœ¨<strong>index.njk</strong>å°±åˆ©ç”¨<code>next_js()</code>åŠ è½½ï¼›ä¹Ÿå¯ä»¥è€ƒè™‘åœ¨<strong>next-vendors.js</strong>ä»£ç ä¸­å°†è¿™ä¸ªjsæ–‡ä»¶çš„æ ‡è¯†ç¬¦pushåˆ°<code>vendors</code>é‡Œé¢ï¼Œç„¶åå†åˆ°themeï¼ˆä¹Ÿå°±æ˜¯æˆ‘è¿™é‡Œä½¿ç”¨çš„NexTï¼‰çš„<strong>_vendors.yml</strong>æ–‡ä»¶é‡Œé¢å»æ³¨å†Œè¿™ä¸ªæ ‡è¯†ç¬¦å¯¹åº”çš„æ–‡ä»¶è·¯å¾„ï¼Œç‰ˆæœ¬ç­‰ï¼Œè¿™æ ·æƒ³è¦é€šè¿‡cdnåŠ è½½jsæ–‡ä»¶ä¹Ÿæ–¹ä¾¿ã€‚</li>
<li>å®é™…ä¸Šé’ˆå¯¹ä¸Šè¿°æ–¹æ³•äºŒï¼Œè¿™ä¸ª<strong>_vendors.yml</strong>æ˜¯å¯ä»¥ä½¿ç”¨è¿™ä¸ªé¡¹ç›®
<a href="https://github.com/next-theme/plugins" title="" target="">next-theme-plugins</a>
ç”Ÿæˆçš„ï¼Œæˆ‘è‡ªå·±è¯•è¿‡ä¹ŸæˆåŠŸäº†ã€‚ä¸è¿‡å¯¹äºä¸€äº›å°æ”¹åŠ¨ï¼ˆæ¯”å¦‚ä¸ºprismæ·»åŠ ä¸€ä¸ªprism-download-button.jsï¼‰ï¼Œè‡ªå·±åšä¸‹<strong>_vendors.yml</strong>çš„ä¿®æ”¹ï¼ŒåŠ å…¥ä¸€ä¸ªæ¡ç›®ä¹Ÿæ˜¯å¾ˆç®€å•çš„ï¼Œä¸éœ€è¦å®‰è£…é‚£ä¹ˆå¤šä¾èµ–é¡¹ã€‚</li>
</ol>
<h2 id="èµ„æºæ–‡ä»¶å¤¹">èµ„æºæ–‡ä»¶å¤¹</h2>
<p>ç½‘ç«™éœ€è¦æ˜¾ç¤ºä¸€äº›åƒç½‘ç«™å›¾æ ‡å’Œç”¨æˆ·ç”»åƒï¼Œè¿˜æœ‰æ–‡ç« ä¸­çš„æˆªå›¾è¿™æ ·çš„èµ„æºï¼Œå‚è€ƒhexoæ–‡æ¡£ï¼Œæœ€åé‡‡ç”¨çš„æ–¹å¼æ˜¯å°†é…ç½®é¡¹<code>post_asset_folder</code>è®¾ç½®ä¸ºtrueï¼Œè¿™ä¼šè®©hexoåœ¨æ–°å»ºpostæ—¶ä¸ºè¿™ä¸ªpostæ–°å»ºä¸€ä¸ªåŒåèµ„æºæ–‡ä»¶å¤¹ã€‚ç„¶åä½¿ç”¨<a
href="https://github.com/hexojs/hexo-renderer-marked">hexo-renderer-marked</a>
3.1.0
çš„ç‰¹æ€§ï¼Œåœ¨æ–‡ç« ä¸­ç›´æ¥ä½¿ç”¨markdownå›¾ç‰‡æ ¼å¼ï¼Œå›¾ç‰‡é“¾æ¥ç›´æ¥å¡«å†™å›¾ç‰‡æ–‡ä»¶åï¼Œhexoä¼šå°†èµ„æºè¯·æ±‚é‡å®šå‘åˆ°postçš„åŒåèµ„æºæ–‡ä»¶å¤¹ä¸­ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ä¹Ÿå¯ä»¥åœ¨å…¶ä»–postä¸­ä½¿ç”¨ç›¸å¯¹è·¯å¾„æ¥ç´¢å¼•åˆ°è¿™äº›èµ„æºï¼Œä¸ºpostä¹‹é—´å…±äº«èµ„æºæä¾›äº†æ€è·¯ã€‚</p>
<p><strong>_config.yml</strong>é…ç½®å½¢å¼å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml">post_asset_folder: true
marked:
  prependRoot: true
  postAsset: true</code></pre>
<h2 id="hexoä»¥åŠnextçš„æ›´æ–°">hexoä»¥åŠnextçš„æ›´æ–°</h2>
<p>ä»å„è‡ªçš„å®˜æ–¹æ–‡æ¡£æˆ–è€…npméƒ½èƒ½æŸ¥çœ‹åˆ°å½“å‰çš„æœ€æ–°ç‰ˆæœ¬ï¼Œæ®è¯´NexTæ˜¯æ¯ä¸ªæœˆéƒ½ä¼šå‘å¸ƒæ–°ç‰ˆæœ¬çš„ï¼Œé‡åˆ°é—®é¢˜éƒ½å¯ä»¥ç•™æ„ä¸€ä¸‹æ˜¯ä¸æ˜¯æœ€æ–°ç‰ˆæœ¬ï¼ˆå½“ç„¶ä¹Ÿè¦åšå¥½å›é€€çš„å‡†å¤‡ï¼Œæ›´æ–°hexoå’Œnextæ—¶éƒ½è®°å¾—å¤‡ä»½<strong>_config.yml</strong>ï¼‰ã€‚</p>
<p>è´´ä¸€ä¸‹npmå¯¹åº”packageçš„é“¾æ¥:</p>
<ol type="1">
<li><a href="https://www.npmjs.com/package/hexo" title="" target="">hexo</a>
<p>npm package</p></li>
<li><a href="https://www.npmjs.com/package/hexo-theme-next" title="" target="">hexo-theme-next</a>
<p>npm package</p></li>
</ol>
<p>æ‰§è¡Œnpmå‘½ä»¤æ¥æ£€æŸ¥packagesæ˜¯å¦æœ‰æ–°ç‰ˆæœ¬ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ cd hexo-site
$ npm outdated</code></pre>
<p>ä½¿ç”¨npmè¿›è¡Œpackageæ›´æ–°ï¼ˆå½“ç„¶ï¼Œhexoæœ¬èº«ä¹Ÿæ˜¯ä¸€ä¸ªpackageï¼‰ï¼Œå¹¶ä½¿ç”¨å‚æ•°<code>--save</code>å°†æ”¹åŠ¨ä¿å­˜åˆ°package.jsonï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ cd hexo-site
$ npm update &lt;package-name&gt; --save</code></pre>
<p>æˆ–è€…ä½¿ç”¨npm-check-updatesï¼Œæ¥å°†package.jsonæ›´æ–°åˆ°æœ€æ–°ç‰ˆæœ¬ï¼Œå†ä¸€æ¬¡æ€§å…¨éƒ¨å®‰è£…æœ€æ–°ç‰ˆ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ npm i npm-check-updates -g # å¦‚æœä½ æ²¡æœ‰å®‰è£…è¿‡npm-check-updates
$ ncu # æ£€æŸ¥ç‰ˆæœ¬æ›´æ–°ï¼Œç±»ä¼¼npm outdatedï¼Œncuæ˜¯npm-check-updatesçš„åˆ«å
$ ncu -u # æ›´æ–°package.json
$ npm install # npmæŒ‰ç…§æ›´æ–°åçš„package.jsonè¿›è¡Œå®‰è£…</code></pre>
<p>è¾“å‡ºå¦‚ä¸‹ï¼š</p>
<figure>
<a href="https://s2.loli.net/2023/01/22/eLjDP1XYNJ6o73t.png" title="ä½¿ç”¨npm-check-updatesè¿›è¡Œnpm packageæ›´æ–°" class="gallery-item"><img src="https://s2.loli.net/2023/01/22/eLjDP1XYNJ6o73t.png"
alt="ä½¿ç”¨npm-check-updatesè¿›è¡Œnpm packageæ›´æ–°" /></a>
<figcaption aria-hidden="true">ä½¿ç”¨npm-check-updatesè¿›è¡Œnpm
packageæ›´æ–°</figcaption>
</figure>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>åšå®¢æ­å»º</category>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>è®°å½•</tag>
        <tag>åšå®¢æ­å»º</tag>
      </tags>
  </entry>
  <entry>
    <title>ä½¿ç”¨SSHè¿›è¡Œè¿œç«¯ä»“åº“èº«ä»½éªŒè¯</title>
    <url>/p/6f279d447649/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="ä½¿ç”¨sshè¿›è¡Œgithubèº«ä»½éªŒè¯">ä½¿ç”¨sshè¿›è¡ŒGitHubèº«ä»½éªŒè¯</h2>
<h3 id="ç”Ÿæˆssh-key">ç”Ÿæˆssh key</h3>
<p>ä½¿ç”¨ssh
keyè¿›è¡Œè¿æ¥/èº«ä»½æ ¡éªŒï¼Œéœ€è¦å…ˆç”Ÿæˆå…¬ç§å¯†é’¥ï¼Œå°†å…¬é’¥æ”¾åˆ°å¯¹åº”ä»£ç æ‰˜ç®¡å¹³å°ä¸Šï¼Œå¹¶åœ¨è¿æ¥æ—¶ä½¿ç”¨ç›¸åº”çš„ç§é’¥ã€‚githubç›®å‰æ¨èçš„keygenç­¾åç®—æ³•ï¼Œä»¥åŠ<a
href="https://docs.github.com/en/authentication/connecting-to-github-with-ssh/generating-a-new-ssh-key-and-adding-it-to-the-ssh-agent">å¯†é’¥å¯¹ç”Ÿæˆæ–¹å¼</a>ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ssh-keygen -t ed25519 -C &quot;your_email@example.com&quot;
&gt; ...</code></pre>
<p>ç”Ÿæˆå…¬ç§å¯†é’¥å¯¹åï¼Œå°†å…¬é’¥æ”¾åˆ°å¯¹åº”ä»£ç æ‰˜ç®¡å¹³å°ä¸Šçœ‹èµ·æ¥åƒæ˜¯ä¸‹é¢è¿™æ ·ã€‚åœ¨è¿›è¡Œsshè¿æ¥æ—¶ï¼Œé»˜è®¤ä¼šä½¿ç”¨å”¯ä¸€çš„ç§é’¥è¿›è¡Œæ ¡éªŒ</p>
<a href="/p/6f279d447649/github-ssh-example.png" class="gallery-item"><img src="/p/6f279d447649/github-ssh-example.png" class="" title="githubç”¨æˆ·ä¿¡æ¯é¡µçš„Authentication Keys"></a>
<p>åŒæ—¶ï¼Œå¯ä»¥å°†githubçš„public
keyå­˜æ”¾åˆ°è‡ªå·±è®¾å¤‡çš„<code>~/.ssh/known_hosts</code>ä¸‹ï¼Œå°±ä¸ä¼šåœ¨åˆæ¬¡ä½¿ç”¨sshè¿æ¥githubæ—¶éœ€è¦æ‰‹åŠ¨æ ¡éªŒ</p>
<p><a
href="https://docs.github.com/cn/authentication/keeping-your-account-and-data-secure/githubs-ssh-key-fingerprints">GitHub
çš„ SSH å¯†é’¥æŒ‡çº¹ - GitHub Docs</a></p>
<div class="note info"><p>ğŸ˜… æ‰‹åŠ¨æ ¡éªŒæ—¶ä¼šè¾“å‡ºä¸‹è¿°ç±»ä¼¼å†…å®¹ï¼Œä½ å¯èƒ½å·²ç»è§è¿‡äº†â€¦</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">&gt; The authenticity of host &#39;[ssh.github.com]:443 ([140.82.112.36]:443)&#39; can&#39;t be established.&gt; ED25519 key fingerprint is SHA256:+DiY3wvvV6TuJJhbpZisF&#x2F;zLDA0zPMSvHdkr4UvCOqU...</code></pre>
</div>
<span id="more"></span>
<h3 id="ssh-config-é…ç½®">ssh config é…ç½®</h3>
<p>åœ¨ä¸€å°è®¾å¤‡ä¸Šä½¿ç”¨ssh-keygenç”Ÿæˆå¤šä¸ªå…¬ç§å¯†é’¥ï¼Œå°†å…¬é’¥æ”¾åˆ°å¯¹åº”ä»£ç æ‰˜ç®¡å¹³å°ä¸Šï¼Œå†é€šè¿‡ç¼–è¾‘<code>~/.ssh/config</code>æ¥å†³å®šä»€ä¹ˆæƒ…å†µä¸‹ä½¿ç”¨å“ªä¸€ä¸ªç§é’¥è¿›è¡Œæ ¡éªŒã€‚</p>
<p>åœ¨ä¸€äº›æƒ…å†µä¸‹ï¼Œè¿˜éœ€è¦ç¼–è¾‘.gitç›®å½•ä¸‹çš„configæ–‡ä»¶ï¼Œæ¥æŒ‡å®šfetch /
pushæ—¶ä½¿ç”¨çš„urlã€‚</p>
<p>ç”Ÿæˆå¤šä¸ªå…¬ç§é’¥å¯¹ä¹‹åï¼Œä½¿ç”¨configå¦‚æ­¤é…ç½®</p>
<pre class="line-numbers language-text" data-language="text"><code class="language-text"># Default GitHub
Host github.com # ä½¿ç”¨&#96;ssh -T username@host&#96;ä¸­åŒ¹é…çš„&#96;host&#96;ä¼šè¢«è§£æä¸ºä¸‹é¢çš„HostName
 HostName github.com
 User git
 PreferredAuthentications publickey
 IdentityFile ~&#x2F;.ssh&#x2F;id_ed25519 # å¯¹åº”çš„ç§é’¥

# Work GitHub ç¬¬äºŒä¸ªè´¦å·
Host work.github.com # åŒç†ï¼Œè¿™é‡Œç”¨&#96;work.github.com&#96;åŒ¹é…æ­¤è§„åˆ™ï¼Œä¼šè¢«è§£æä¸ºgithub.com
 HostName github.com
 User git
 PreferredAuthentications publickey
 IdentityFile ~&#x2F;.ssh&#x2F;id_rsa_work # æŒ‡å®šå¯¹åº”çš„ç§é’¥</code></pre>
<p>æµ‹è¯•é…ç½®æ˜¯å¦æˆåŠŸ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ssh -T git@github.com
Hi stefano! You&#39;ve successfully authenticated, but GitHub does not provide shell access.

$ ssh -T git@work.github.com
Hi stefano! You&#39;ve successfully authenticated, but GitHub does not provide shell access.</code></pre>
<p>å‚è€ƒï¼š</p>
<p><a
href="https://stackoverflow.com/questions/3225862/multiple-github-accounts-ssh-config">https://stackoverflow.com/questions/3225862/multiple-github-accounts-ssh-config</a></p>
<h2 id="é—®é¢˜è§£å†³é€šè¿‡httpsçš„sshè¿æ¥">é—®é¢˜è§£å†³ï¼šé€šè¿‡HTTPSçš„SSHè¿æ¥</h2>
<p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ<code>ssh -T
git@github.com</code>æ—¶å¯èƒ½å¾—åˆ°ä¸‹è¿°çš„è¾“å‡ºç»“æœ</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ssh: connect to host github.com port 22: Connection timed out</code></pre>
<p>è¿™ä¸ªé—®é¢˜å¯èƒ½æ˜¯ç”±äºæ‰€åœ¨è®¾å¤‡é˜²ç«å¢™ç¦ç”¨äº†sshè¿æ¥ï¼ˆæˆ‘ä¹Ÿæ€€ç–‘å¯èƒ½æ˜¯å› ä¸ºå¢™å¯¼è‡´github.comè§£æå¤±è´¥ï¼Œå› ä¸ºåŒæ ·ä½¿ç”¨port22çš„æˆ‘è‡ªå·±çš„giteaæ˜¯å¯ä»¥ä½¿ç”¨sshè¿æ¥/éªŒè¯çš„ï¼Œè€Œæˆ‘ä½¿ç”¨çš„clashåªè®¾ç½®äº†http
/ httpsçš„ä»£ç†ï¼‰ã€‚</p>
<p>è¿™ä¸ªé—®é¢˜å¯ä»¥å‚è€ƒstackoverflowæˆ–è€…å®˜æ–¹çš„è§£å†³æ–¹æ¡ˆï¼š</p>
<p><a
href="https://stackoverflow.com/questions/15589682/ssh-connect-to-host-github-com-port-22-connection-timed-out">ssh:
connect to host github.com port 22: Connection timed out</a></p>
<p><a
href="https://docs.github.com/en/authentication/troubleshooting-ssh/using-ssh-over-the-https-port">Using
SSH over the HTTPS port - GitHub Docs</a></p>
<div class="note info"><p>ğŸ’¡ 443æ˜¯httpsä½¿ç”¨çš„ç«¯å£ï¼Œé¡ºå¸¦ä¸€æï¼Œhttpä½¿ç”¨çš„ç«¯å£æ˜¯80ã€‚</p>
<p>æ ¸å¿ƒæ€è·¯æ˜¯githubä¹Ÿéƒ¨ç½²äº†<code>ssh.github.com</code>è¿™ä¸ªåŸŸåï¼Œå¹¶å€Ÿç”¨443ç«¯å£æ¥å»ºç«‹sshè¿æ¥ï¼Œå› ä¸ºå¤§å¤šæ•°è®¾å¤‡ç¯å¢ƒæ˜¯ä¸ä¼šç¦ç”¨443ç«¯å£çš„ã€‚</p>
</div>
<p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤æ¥æµ‹è¯•æ˜¯å¦å¯ä»¥ä½¿ç”¨æ­¤è§£å†³æ–¹æ¡ˆï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ssh -T -p 443 git@ssh.github.com
&gt; Hi USERNAME! You&#39;ve successfully authenticated, but GitHub does not
&gt; provide shell access.</code></pre>
<p>å¦‚æœå¾—åˆ°äº†ä¸Šè¿°è¾“å‡ºï¼Œç°åœ¨ä½ å¯ä»¥é€šè¿‡ä»¥ä¸‹å‘½ä»¤æ¥cloneä½ çš„ä»“åº“äº†ï¼š</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ git clone ssh:&#x2F;&#x2F;git@ssh.github.com:443&#x2F;YOUR-USERNAME&#x2F;YOUR-REPOSITORY.git
&gt; ...</code></pre>
<h3 id="é€šè¿‡ssh-configå»ºç«‹åŸºäºhttpsçš„sshè¿æ¥">é€šè¿‡ssh
configå»ºç«‹åŸºäºhttpsçš„sshè¿æ¥</h3>
<p>æƒ³è¦æ›´ä¾¿åˆ©åœ°ä½¿ç”¨443ç«¯å£æ¥å»ºç«‹ä¸githubçš„sshè¿æ¥ï¼Œå¯ä»¥ä½¿ç”¨ç¼–è¾‘<code>~/.ssh/config</code>çš„æ–¹å¼ï¼Œåœ¨é…ç½®æ–‡ä»¶ä¸­åŠ å…¥/è°ƒæ•´ä¸‹è¿°å†…å®¹</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">Host github.com
 Hostname ssh.github.com # æ³¨æ„è¿™é‡Œæ˜¯å¦ä¸€ä¸ªgithubåŸŸå
 Port 443 # ä½¿ç”¨443ç«¯å£
 User git</code></pre>
<p>ç°åœ¨ï¼Œä½ å¯ä»¥åƒä¹‹å‰ä¸€æ ·ä½¿ç”¨sshè¿æ¥GitHub.comäº†</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ ssh -T git@github.com
&gt; Hi USERNAME! You&#39;ve successfully authenticated, but GitHub does not
&gt; provide shell access.</code></pre>
<p>P.S. gitlabä¹Ÿæœ‰ç±»ä¼¼çš„è§£å†³æ–¹æ¡ˆï¼Œå¯ä»¥å‚è€ƒï¼š<a
href="https://about.gitlab.com/blog/2016/02/18/gitlab-dot-com-now-supports-an-alternate-git-plus-ssh-port/">gitlabä½¿ç”¨httpså»ºç«‹sshè¿æ¥</a></p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>å·¥å…·ä½¿ç”¨æŒ‡å—</category>
        <category>git</category>
      </categories>
      <tags>
        <tag>git</tag>
        <tag>github</tag>
        <tag>ssh</tag>
      </tags>
  </entry>
  <entry>
    <title>é€šå…³åç®€å•åœ°è¯„ä»·ä¸€ä¸‹P5R</title>
    <url>/p/a31f36d806f9/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="å†™åœ¨å‰é¢">å†™åœ¨å‰é¢</h2>
<p>ä»æœ€æ—©17å¹´çœ‹<a
href="https://www.bilibili.com/video/BV1ux411k7Pk?spm_id_from=333.999.0.0">ç‹—å¤´äººç©å¥³ç¥å¼‚é—»å½•5</a>ï¼Œåˆ°17ä¸‹åŠå¹´è‡ªå·±æ”’é’±ä¹°äº†æ˜¾ç¤ºå™¨å’Œç¼©æ°´ç‰ˆçš„ps4slimåœ¨å¯å®¤é‡Œè‡ªå·±ç©ï¼Œå†åˆ°19å¹´çš‡å®¶ç‰ˆæ¸¸æˆå‘å”®æ‰¾ä»£è´­å…¥äº†æ”¶è—ç‰ˆï¼Œæˆ‘ç»ˆäºåœ¨22å¹´å¹´åˆæ¢äº†å·¥ä½œä¹‹åå¿™é‡Œå·é—²åœ°æŠŠå®ƒä½œä¸ºpsnå¹³å°ä¸Šçš„ç¬¬ä¸€ä¸ªç™½é‡‘æ¸¸æˆé€šå…³äº†ã€‚</p>
<a href="/p/a31f36d806f9/platinum-award.jpg" class="gallery-item"><img src="/p/a31f36d806f9/platinum-award.jpg" class="" title="å…¶å®ä¹Ÿå¾—è°¢è°¢çš‡å®¶ç‰ˆæ˜¯ä¸€æ¬¾ç›¸å¯¹å®¹æ˜“ç™½é‡‘çš„æ¸¸æˆ"></a>
<p>å‰å‰ååäº”å¹´é—´è·Ÿè¿™ä¸ªç³»åˆ—ä¹‹é—´çš„æ•…äº‹è‡ªç„¶ä¹Ÿä¸å°‘äº†ï¼Œè™½ç„¶è‡³ä»Šä¸ºæ­¢ä¹Ÿä¸èƒ½è¯´è‡ªå·±æ˜¯ä¸€ä¸ªå¾ˆåˆæ ¼çš„ç³»åˆ—ç²‰ä¸â€”â€”å¹¶ä¸æ˜¯é‚£ç§çœŸçš„å’Œç³»åˆ—ä¸€èµ·é•¿å¤§çš„ç©å®¶ï¼Œé™¤äº†é€šå…³äº†ç¬¬äº”ä»£æ¸¸æˆå’Œåœ¨ç³»åˆ—ä¸ŠèŠ±äº†ä¸å°‘é’±å…¶å®ä¹Ÿæ²¡æœ‰ä»€ä¹ˆæ‹¿çš„å‡ºæ‰‹çš„ç²‰ä¸è¯æ˜ï¼Œä½†æ˜¯è¿˜æ˜¯æƒ³åœ¨è¿™é‡Œç®€å•åœ°è®°å½•ä¸€ä¸‹çš‡å®¶ç‰ˆä¸æˆ‘ä¹‹é—´çš„æ•…äº‹ï¼Œå¹¶ä»¥ä¸æˆç†Ÿçš„æµ‹è¯„äººèº«ä»½è¯´è¯´æˆ‘å¯¹çš‡å®¶ç‰ˆçš„çœ‹æ³•ã€‚</p>
<p><strong>æ³¨æ„ï¼šæœ¬æ–‡å¯èƒ½å«æœ‰å¤§é‡å‰§é€ï¼Œè¯·å°šæœªä»¥ä»»ä½•å½¢å¼é€šå…³ã€Šå¥³ç¥å¼‚é—»å½•ã€‹ã€Šå¥³ç¥å¼‚é—»å½•5çš‡å®¶ç‰ˆã€‹çš„è¯»è€…è‡ªè¡Œé€‰æ‹©æ˜¯å¦ç»§ç»­é˜…è¯»ã€‚</strong></p>
<span id="more"></span>
<h2 id="ä¸å¾—äº†çš„æ¼”å”±ä¼šå’Œå¢å¼ºç‰ˆ">ä¸å¾—äº†çš„æ¼”å”±ä¼šå’Œå¢å¼ºç‰ˆ</h2>
<h3 id="åœ¨çº¿è§‚èµä½æ¸…æ¼”å”±ä¼šç°åœº">åœ¨çº¿è§‚èµä½æ¸…æ¼”å”±ä¼šç°åœº</h3>
<p>19å¹´4æœˆçš„æ—¶å€™ï¼Œp5rå’Œp5så®£å¸ƒåœ¨æ¼”å”±ä¼šçš„å‰åä¸¤å¤©å®£å¸ƒå‘å”®ï¼Œå¤§äºŒåœ¨è¯»çš„æˆ‘è‡ªç„¶ä¹Ÿæ²¡ä»€ä¹ˆåŠæ³•è·‘å»å²›å›½æ¼”å”±ä¼šç°åœºï¼Œå°±å……äº†niconicoæ”¶è´¹ä¼šå‘˜åœ¨çº¿ä¸ŠåŒæ­¥è§†å¬ï¼Œå½“æ—¶ç³Ÿç³•çš„æ¢¯å­+niconicoæ‚²å‰§çš„ç›´æ’­ä½“éªŒç»“åˆèµ·æ¥ï¼Œæ•´åœºæ¼”å”±ä¼šåŸºæœ¬å°±æ˜¯åªèƒ½æŒ‚åœ¨åå°å¬çš„æ°´å¹³ã€‚ä¸è¿‡day1ç¬¬ä¸€å¤©p5rå…¬å¸ƒçš„æ—¶å€™ï¼Œè¿˜æ˜¯èƒ½å¤§æ¦‚åªæœ‰256pçš„ç”»é¢é‡Œçœ‹å‡ºç°åœºè§‚ä¼—çš„å…´å¥‹ï¼ˆå½“ç„¶ï¼Œæˆ‘ä¹Ÿï¼‰ã€‚</p>
<p>ç›¸è¾ƒday1æ”¾å‡ºçš„åŠ å¼ºç‰ˆé¢„å‘Šï¼Œday2å…¬å¸ƒçš„æ˜¯ä¸€ä¸ªå…‰è£å¼€å‘çš„ç³»åˆ—è¡ç”Ÿå‰²è‰æ¸¸æˆp5sï¼Œè‡ªç„¶å°±æ²¡èƒ½æ¿€èµ·å¤šå¤§æ°´èŠ±ï¼Œè€Œä¸”ç°åœ¨å›æƒ³èµ·æ¥ï¼Œå½“æ—¶æ”¾å‡ºpvä¹Ÿæ˜¯å¾—èƒŒé”…çš„â€”â€”æ²¡æŠŠè¯¥ä½œå³æ—¶æˆ˜æ–—çš„ä¹è¶£ä½“ç°å‡ºæ¥ï¼ŒåŒæ—¶å¯¹æ–°è§’è‰²ä¹Ÿåªç»™äº†ä¸€ä¸ªå¾ˆè¯¡å¼‚çš„ç‰¹å†™ï¼ˆå…¶å®åé¢ç©è¿‡çš„å¤§å®¶éƒ½çŸ¥é“ç´¢è²äºšè¶…å¯çˆ±ï¼‰ã€‚</p>
<p>æ¥å•†åº—æ„Ÿå—ä¸€ä¸‹ç´¢è²äºšçš„å¯çˆ±å’Œp5ç³»åˆ—ä½œä¹‹ä¸­ä¹Ÿç®—å¾—ä¸Šå¸¦æ„Ÿçš„bgmï¼Œ<a
href="https://www.bilibili.com/video/BV14T4y1J7ws?from=search&amp;seid=10262646871642464225&amp;spm_id_from=333.337.0.0">ä¼ é€é—¨
-&gt;</a></p>
<p>å½“æ—¶å…´å¤´ä¸Šçš„æˆ‘è‡ªç„¶æ˜¯æ‰¾åˆ°èƒ½ä»£è´­åº—çš„ç¬¬ä¸€æ—¶é—´å°±ä¸‹å•äº†ã€‚è™½ç„¶å½“æ—¶å¿ƒé‡Œä¹Ÿæ¸…æ¥šåŠ å¼ºç‰ˆçš„å¤§å¤šå‰§æƒ…å’Œæ— å°ç‰ˆï¼ˆä¹Ÿå°±æ˜¯æœ€æ—©å‘å”®çš„éåŠ å¼ºç‰ˆï¼‰æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä½†ä¹Ÿæƒ³ç€èƒ½å¤Ÿä½“éªŒä¸€ä¸‹åˆè§çš„ä¹è¶£ï¼Œä¹Ÿè®¸èƒ½å¸¦æ¥æ›´å¤§çš„æ„Ÿè§¦ä¹Ÿè¯´ä¸å®šã€‚</p>
<a href="/p/a31f36d806f9/unbox.jpg" class="gallery-item"><img src="/p/a31f36d806f9/unbox.jpg" class="" title="ç°åœ¨æƒ³èµ·æ¥è¿™ä¸€ç®±é€çš„ä¸œè¥¿é™¤äº†cdè¿˜çœŸæ²¡å•¥æœ‰ç”¨çš„"></a>
<p>ç„¶è€Œè™½ç„¶æ—¥æ–‡ç‰ˆå¦‚çº¦åœ¨19å¹´çš„11æœˆé€è¾¾äº†å®¿èˆï¼Œå½“æ—¶æˆ‘å·²ç»åœ¨ä¸ºæ¯•ä¸šå»å‘è‹¦æ¼äº†ï¼Œè€Œä¸”æ—¥æ–‡ç‰ˆæ²¡ä»€ä¹ˆå·®å¼‚çš„å¼€å¤´å‰§æƒ…ä¹Ÿè®©æˆ‘æ²¡èƒ½ç‰¹åˆ«æŠ½å‡ºç©ºæ¥ç©ã€‚ç»“æœä¸€ç›´åˆ°20å¹´ä¸­æ–‡ç‰ˆå‘å”®ï¼Œè¿™æ—¶å€™æˆ‘ç”šè‡³å·²ç»ä¸‹å•äº†ä¸­æ–‡ç‰ˆï¼Œå´ä¾ç„¶æ²¡èƒ½æ­£å¼åœ°å¼€å§‹æ¸¸æˆï¼Œåªæ˜¯é›¶æ˜Ÿåœ°ç©äº†ä¸€ç‚¹ç‚¹ã€‚è€Œè¿™æ—¶å€™ï¼Œä¸€äº›å…³äºçš‡å®¶ç‰ˆçš„ä¸­æ–‡è¯„ä»·å°±å¼€å§‹æ‰©æ•£å¼€æ¥äº†...</p>
<p>è¿™é‡Œå°±ä¼šæ‰¯åˆ°æˆ‘è¿™å‡ å¹´å¯¹atluså‘è¿‡çš„ä¸€äº›ç‰¢éªšï¼Œå…¶ä¸­ç¬¬ä¸€ç‚¹å°±æ˜¯å¸Œæœ›ä»–ä»¬<strong>ä¸è¦å†æŠŠæ—¥æ–‡ç‰ˆå’Œéæ—¥æ–‡ç‰ˆåˆ†å¼€æ—¶æ®µå‘å”®äº†</strong>ï¼Œè¿™æ ·æƒ³è¦æ—¥è¯­è‹¦æ‰‹çš„ç©å®¶æƒ³åœ¨ä¸è¢«å‰§é€ï¼Œä¸è¢«ä»–äººçš„ä¸»è§‚è¯„ä»·å½±å“çš„æƒ…å†µä¸‹äº«å—åˆè§çš„ä¹è¶£ï¼Œå‡ ä¹æ˜¯ä¸€ä»¶ä¸å¯èƒ½çš„äº‹ã€‚</p>
<h3 id="é‚£å¹´è¯„è®ºç‰ˆçš„å›å¿†å½•">é‚£å¹´è¯„è®ºç‰ˆçš„å›å¿†å½•</h3>
<p>çš‡å®¶ç‰ˆå‘å”®ä¹‹åæ— è®ºæ˜¯å›½å†…å›½å¤–ï¼Œè¯„è®ºéƒ½ä¸èƒ½è¯´æ˜¯ç‰¹åˆ«ä¹è§‚ï¼Œå½“æ—¶æ„Ÿè§¦ç”±å…¶æ·±çš„æ˜¯åœ¨å›½å†…çš„ä¸€äº›ä¸»æµæ¸¸æˆåª’ä½“ä¸Šï¼Œè¯„è®ºå·²ç»æ¸…ä¸€è‰²æ˜¯â€œP5Rä¹Ÿå°±å›¾ä¸€ä¹â€çš„èµ°å‘äº†ï¼ˆæœ‰å…³æ³¨çš„äººå¯èƒ½çŸ¥é“éšåç´§è·Ÿçš„ä¾¿æ˜¯â€œçœŸç»­ä½œè¿˜å¾—çœ‹æˆ‘P5Sâ€ï¼‰ï¼Œæ™®éè®¤ä¸ºP5Ræœ‰å¼ºæ¨ä¸»äººå…¬ä¸æ˜æ™ºCPå«Œç–‘ï¼ˆ1ï¼‰ï¼Œå¥³ä¸»è¿‡äºè·¯äººåŒ–ï¼ˆ2ï¼‰ï¼Œæ–°å¢å‰§æƒ…å¤ªçŸ­ã€å‰éƒ¨åˆ†çš„å‰§æƒ…åˆä¸æ— å°ç‰ˆæ— äºŒï¼ˆ3ï¼‰ï¼Œæƒ³è¿›å…¥çš‡å®¶ç‰ˆå‰§æƒ…è·¯çº¿å¿…é¡»ä¸ç‰¹å®šè§’è‰²å»ºç«‹COOPä»¤äººä¸å¿«ï¼ˆ4ï¼‰ç­‰ç­‰ã€‚å…¶ä¸­ç¬¬ä¸€ç‚¹å’Œç¬¬ä¸‰ç‚¹åº”è¯¥æ˜¯æˆ‘æ‰€æµè§ˆè¿‡çš„ä¼—å¤šè¯„è®ºä¸­æœ€çªå‡ºçš„ä¸¤ç§å£°éŸ³ã€‚</p>
<p>äº‹æƒ…å‘å±•åˆ°è¿™ä¸ªé˜¶æ®µå·²ç»æ˜¯20å¹´çš„ä¸ŠåŠå¹´äº†ï¼Œè¿™æ—¶æˆ‘æ¯•ä¸šå‡ºè·¯ä¹Ÿç®—å¤§è‡´å®šäº†ä¸‹æ¥ï¼Œè™½ç„¶å¤šå°‘è¢«å‰§é€äº†ä¸€ç‚¹*ï¼Œä½†ä¹Ÿæ˜¯æœ‰è¶³å¤Ÿæ—¶é—´æ­£å¼åœ°å¼€å§‹åˆè§æ¸¸æˆæ”»ç•¥äº†ã€‚åœ¨ç½‘å‹ä»¬çš„å£°è®¨ä¹‹ä¸‹ï¼Œæˆ‘å…¶å®æ˜¯å¯¹æ˜¯å¦è¦è¿›è¡Œäº²è‡ªæ¸¸ç©æœ‰äº›çŠ¹è±«çš„ï¼šè™½ç„¶å¯¹å‡è®¾å­˜åœ¨çš„é€‚é‡å–è…å¹¶ä¸åæ„Ÿï¼Œè€Œä¸”å¯¹ATLUSåŠ å¼ºç‰ˆçš„å¥—è·¯å·²ç»æœ‰äº›äº†è§£ï¼Œä½†æ˜¯å¦‚æœçš‡å®¶ç‰ˆçš„æ¸¸æˆè¿‡ç¨‹åè€Œè®©æˆ‘å¯¹äº”ä»£ç•™ä¸‹çš„è®°å¿†å˜å¾—å¾®å¦™äº†ï¼Œé‚£è®©æˆ‘é€‰æ‹©ç®€å•åœ°äº‘ä¸€ä¸‹æ–°å‰§æƒ…ä¹Ÿæœªå°ä¸å¯ã€‚</p>
<a href="/p/a31f36d806f9/game-of-the-year.jpg" class="gallery-item"><img src="/p/a31f36d806f9/game-of-the-year.jpg" class="" title="æ˜å¹´ä¸€å®šç©å¾—æ‚ä¸€ç‚¹ï¼æ˜å¹´ï¼"></a>
<p>å¥½åœ¨ä¸€äº›å®˜æ–¹æ¸¸æˆåª’ä½“ç»™å‡ºäº†è¿˜æ¯”è¾ƒä¸­è‚¯çš„è¯„ä»·ï¼Œæœ€åçš‡å®¶ç‰ˆçš„é”€é‡ä¹Ÿæ˜¯ä¸€ä¸ªè¿˜ä¸é”™çš„æ°´å¹³ã€‚åŒæ—¶åœ¨åå¤å¾ªç¯äº†å®˜æ–¹æ”¾å‡ºçš„pvå’Œæˆ˜æ–—é…ä¹åï¼Œæœ€åè¿˜æ˜¯å†³å®šç©äº†ï¼ä¹Ÿè°¢è°¢è·³æ§½åçš„å…¬å¸æ¯”è¾ƒäººæ€§åŒ–çš„å¹´å‡æ–¹æ¡ˆå’Œå·¥ä½œèŠ‚å¥ï¼Œä»é‡‘åŸæ®¿å ‚å¼€å§‹åˆ°æœ€åçš„ä¸¸å–œæ®¿å ‚è¿™100å°æ—¶åº”è¯¥éƒ½æ˜¯åœ¨2021å¹´ä¸‹åŠå¹´å®Œæˆçš„ï¼</p>
<p>ä¸€ç‚¹ï¼šæŒ‡æ–°å­¦æœŸåªæœ‰ä¸€ä¸ªæ®¿å ‚ï¼Œæ®¿å ‚çš„BOSSæ˜¯ä¸¸å–œï¼Œè¿˜æœ‰åŠ å¼ºç‰ˆç»“å±€è¾¾æˆçš„å‡ ç§æ–¹å¼ã€‚</p>
<h2 id="hç©ä¸‹æ¥çš„æ„Ÿæƒ³">140hç©ä¸‹æ¥çš„æ„Ÿæƒ³</h2>
<p>ç»“æœçœŸçš„ä¸€å‘¨ç›®é€šå…³æ—¶ï¼Œå­˜æ¡£æ˜¾ç¤ºçš„æ¸¸æˆæ—¶é•¿æ˜¯140å°æ—¶ã€‚</p>
<p>æ€ä¹ˆä¼šæ˜¯90å°æ—¶å‘¢ï¼Ÿæˆ‘æ€ä¹ˆå°±ä¿¡äº†ä¸€äº›æµ‹è¯„è¯´çš„90å°æ—¶èƒ½å¤ŸåŸºæœ¬æµç¨‹é€šå…³å‘¢ï¼Ÿè¿˜è¯´è·³è¿‡åŠ¨ç”»åº”è¯¥èƒ½æ›´å¿«é€šå…³ï¼Œåˆ°åº•æ˜¯ä»¥ä»€ä¹ˆå½¢å¼é€šå…³çš„å‘¢ï¼Ÿ</p>
<a href="/p/a31f36d806f9/mona-shock.jpg" class="gallery-item"><img src="/p/a31f36d806f9/mona-shock.jpg" class="" title="ä½ æ€ä¹ˆä¼šä¸€å‘¨ç›®å°±ç©äº†140hå‘¢"></a>
<p>è™½ç„¶æœ‰ä¸€äº›æ€¨è¨€ï¼Œå…¶å®ç©åˆ°ä¸€åŠæ—¶æˆ‘å¤šå°‘ä¹Ÿæ„Ÿè§‰åˆ°å¯¹æ¸¸æˆçš„PersonaåŸ¹å…»ç³»ç»Ÿæ˜æ˜¾æ¯”åˆè§P5æ—¶è¦æ›´ä¸ºä¸Šå¿ƒäº†ï¼Œä¼šå»å°½å¯èƒ½å°†ç‰¹æ€§ã€å±æ€§å’ŒæŠ€èƒ½è¿›è¡Œé…åˆï¼Œè®©æ¯ä¸ªPï¼ˆäººæ ¼é¢å…·
/
Personaï¼‰çš„å®šä½æ›´æ˜ç¡®ï¼ŒåŒæ—¶ä¹Ÿä¼šæƒ³è¦å»åˆæˆè·å–æ¯ä¸ªå±æ€§çš„æœ€é«˜çº§Pï¼Œå»è¾¾æˆäººæ ¼é¢å…·çš„100%å®Œæˆç‡ï¼›è€Œä¸”æˆ‘åœ¨ä¸€å‘¨ç›®å°±å¯¹æ²¡å°†æ‰€æœ‰å¯COOPè§’è‰²æ»¡COOPï¼Œä»¥åŠé”™è¿‡äº†ä¸€äº›è·¯è¾¹NPCå¯¹è¯è€¿è€¿äºæ€€ï¼Œè¿™ä¸€å‘¨ç›®ä¹Ÿå°½å¯èƒ½å‚è€ƒç€æ”»ç•¥å›é¿äº†è¿™äº›æƒ¨å‰§ã€‚</p>
<p>çœŸçš„ç©ä¸‹æ¥ï¼Œè¿˜æ˜¯è§‰å¾—åº”éªŒäº†è‡ªå·±ä¸€ç›´ä»¥æ¥çš„åŸåˆ™ï¼Œå°±æ˜¯å¯¹æœ‰è¶³å¤Ÿé‡è¦æ„ä¹‰çš„äº‹æƒ…ï¼Œè¿˜æ˜¯å¾—è¦äº²è‡ªä½“éªŒæ‰è¡Œï¼Œåœ¨è¿™äº›äº‹æƒ…ä¸Šæˆ‘æ°¸è¿œä¸ä¼šæ··æ·†ä»–äººçš„è¯„ä»·ä¸è‡ªå·±çš„çœ‹æ³•ã€‚ç°åœ¨è¿˜èƒ½æƒ³èµ·æ¥çš„ï¼Œçš‡å®¶ç‰ˆæ¸¸ç©è¿‡ç¨‹ä¸­çš„æ„Ÿè§¦åº”è¯¥å°±æ˜¯ä¸‹é¢è¿™äº›å§ï¼š</p>
<h3 id="æˆ‘è®¤ä¸ºçš„åŠ åˆ†é¡¹">+ æˆ‘è®¤ä¸ºçš„åŠ åˆ†é¡¹</h3>
<a href="/p/a31f36d806f9/pic-in-chatroom.jpg" class="gallery-item"><img src="/p/a31f36d806f9/pic-in-chatroom.jpg" class="" title="åŒ…æ‹¬è¿™ä¸ªèŠå¤©æ é‡Œé¢çš„é…å›¾æˆ‘ä¹ŸæŒºä¸­æ„çš„"></a>
<ol type="1">
<li><p>æ–°å¢åŠ çš„ç³»ç»Ÿä»ä¸ªäººè§’åº¦ä¸Šç¡®å®æ‰¾ä¸åˆ°ç¼ºç‚¹ï¼Œéƒ½æ˜¯æ­£å‘æ”¹è‰¯ï¼šåŒ…æ‹¬ä¼™ä¼´æˆ˜æ–—æ—¶çš„SHOW-TIMEï¼Œæ–°å¢çš„TECHNICALæœºåˆ¶ï¼Œå¤©é¹…ç»’æˆ¿é—´çš„åˆä½“è­¦æŠ¥ï¼Œè¿˜æœ‰æ˜“ç”¨æ€§åŠŸèƒ½å¦‚å¯¹ä½ç­‰çº§é˜´å½±çš„ç§’æ€è·³è¿‡æˆ˜æ–—ï¼Œè¿™äº›æ— ç–‘éƒ½æ˜¯è®©æˆ‘èƒ½é‡æ–°æ‰“ä¸‹å®Œæ•´ä¸€å‘¨ç›®çš„åŠ©åŠ›ã€‚</p></li>
<li><p>æ„Ÿè§‰å¾—å‡ºæ¥çš‡å®¶ç‰ˆåœ¨å¾ˆå¤šåœ°æ–¹æé«˜äº†ç©å®¶åŸ¹å…»è§’è‰²çš„æ•ˆç‡ï¼Œä¹Ÿç»™äº†ç©å®¶æ›´å¤šçš„è¡ŒåŠ¨æœºä¼šï¼Œè™½ç„¶ä½“æ„Ÿä¸Šä¼šè§‰å¾—æ—¥å¸¸éƒ¨åˆ†ç©èµ·æ¥æ›´å¿™äº†ï¼Œä½†æ˜¯ç¡®å®èƒ½å‡å°‘å¾ˆå¤šæœªèƒ½è¾¾åˆ°äº”ç»´è¦æ±‚ã€è¾¾æˆæ»¡COOPçš„æŒ«è´¥æ„Ÿã€‚</p></li>
<li><p>è™½ç„¶æ–°å¢çš„å¤§åœºæ™¯åªæœ‰å‰ç¥¥å¯ºä¸€ä¸ªï¼Œä½†åŠŸèƒ½æ€§è®¾æ–½å¾ˆå¤šï¼Œå¸¸é©»çš„å‰§æƒ…npcä¹Ÿè¿˜æ¯”è¾ƒä¸°å¯Œï¼Œè¿™ä¸€ç‚¹ä¸Šå¯ä»¥çœ‹å‡ºåˆ¶ä½œç»„çš„ç”¨å¿ƒï¼Œè¿™é‡Œå§‘ä¸”æ˜¯å¯ä»¥è¡¨æ‰¬çš„ã€‚</p></li>
<li><p>çš‡å®¶ç‰ˆåæ–°å¢çš„ä¸¤ä¸ªæ€ªç›—å›¢æ”¹å¿ƒä»»åŠ¡éƒ½æœ‰æ¯”è¾ƒå¤æ‚çš„æ¥å–æœºåˆ¶å’Œæ”»ç•¥æœºåˆ¶ï¼ŒåŒä¼´å¯¹äºè¿™äº›ä»»åŠ¡ä¹Ÿæœ‰ä¸€äº›å¾ˆèƒ½ä½“ç°ä¸ªæ€§çš„ä¸ªäººçœ‹æ³•ï¼ŒåŒæ—¶åœ¨æ¸¸æˆåœºæ™¯ä¸­ä¹Ÿèƒ½å‘ç°è·Ÿè¿™äº›ä»»åŠ¡æœ‰å…³çš„NPCåœ¨æ”¹å¿ƒå‰åå‘ç”Ÿå¯¹åº”æ”¹å˜ï¼Œèƒ½ä½“ä¼šåˆ°å’Œå…ˆå‰çš„ä¸€äº›æµç¨‹åŒ–æ”¹å¿ƒä»»åŠ¡çš„ä¸åŒï¼ˆå½“ç„¶ä¹Ÿæœ‰å¯èƒ½æ˜¯æˆ‘æ‰å †ä¸‹å°è±¡ç©ºé—´å¯¼è‡´äº†æ”¹å¿ƒä»»åŠ¡æ²¡ä»€ä¹ˆå®æ„Ÿ...æ˜¯çš„è¯æˆ‘é“æ­‰ï¼‰</p>
<a href="/p/a31f36d806f9/shot.JPEG" class="gallery-item"><img src="/p/a31f36d806f9/shot.JPEG" class="" title="å°„çˆ†ï¼"></a></li>
<li><p>ä¸¸å–œçš„å‰§æƒ…æˆ‘ä¸ªäººè§‰å¾—è™½ç„¶æ²¡æœ‰å¤ªå¤šæƒŠå–œï¼Œåœ†è¿˜æ˜¯åœ†å¾—ä¸Šæ¥ï¼Œè¿˜æ˜¯ç®—åˆæ ¼çš„ï¼Œæœ€åç»“å±€çš„å‡ æ®µæ¼”å‡ºä¹Ÿèƒ½æ„Ÿå—å‡ºæ¥ç”¨äº†å¿ƒï¼Œè™½ç„¶å¯¹æ®´æ¡¥æ®µä¸ªäººè§‰å¾—åœŸäº†ç‚¹....ä½†æ˜¯ä¸€äº›ä¸¸å–œçš„ç°å®è¿˜æ˜¯æ˜ å°„å‡ºäº†ä¸€ä¸ªå¤§å®¶å¹¸ç¦çš„å‡è±¡ä¸–ç•Œï¼Œæå‡ºäº†ä¸€ä¸ªè¿˜ç®—æœ‰è¶£çš„æƒ³æ³•ï¼Œå°¤å…¶æ˜¯å¯¹æ˜æ™ºè§’è‰²åˆ»ç”»ä¹Ÿèµ·åˆ°äº†å¾ˆé‡è¦ä½œç”¨ï¼ˆå½“æ—¶æ˜¯è®©æˆ‘è§‰å¾—ï¼Œå“‡æ˜æ™ºé‚£ä½ å¾ˆå‹‡å•Šï¼‰</p>
<a href="/p/a31f36d806f9/sekai-tree.JPEG" class="gallery-item"><img src="/p/a31f36d806f9/sekai-tree.JPEG" class="" title="ä¸¸å–œæ®¿å ‚è¿™æ£µæ ‘æˆ‘çœ‹äº†å¥½ä¸€ä¼šå„¿"></a></li>
<li><p>è™½ç„¶æˆ‘æ²¡æœ‰åƒå­¦å¦¹è¿™ç§ä¸€ç›´è¦åˆ«äººçœ‹å¥¹çš„äººè®¾ä½†æ˜¯ä¸€äº›æœè£…æ­¦å™¨è®¾è®¡å’Œå°åŠ¨ä½œè¿˜æ˜¯æŒºæˆ³çš„ã€‚</p></li>
<li><p>MY PALACEè¿™ä¸ªæœ‰ç‚¹æ”¶é›†ç³»ç»Ÿ /
æˆå°±ç³»ç»Ÿå‘³é“çš„ç©æ³•ä¹Ÿè¿˜æŒºå¯¹æˆ‘èƒƒå£çš„ã€‚</p></li>
</ol>
<h3 id="æˆ‘è®¤ä¸ºçš„æ‰£åˆ†é¡¹">- æˆ‘è®¤ä¸ºçš„æ‰£åˆ†é¡¹</h3>
<ol type="1">
<li><p><strong>å¢å¼ºç‰ˆè¿™ä¸ªåšæ³•å¾ˆçƒ‚ã€‚ATLUSè¿˜æ˜¯å¾—ä½ å‡ºæ¥èƒŒé”…ã€‚</strong>æˆ‘ä¸ªäººè¿˜æ˜¯å®æ„¿ä½ å…¨éƒ¨åšå®Œå†æ™šå‡ å¹´å‡ºï¼Œæ­£å¥½21å¹´ä¹Ÿæ²¡ä»€ä¹ˆå¤§ä½œè·Ÿä½ æŠ¢å¹´åº¦æœ€ä½³æä¸å¥½å°±GOTYäº†å‘¢ï¼Ÿæˆ‘åœ¨è¿™ä¸€å‘¨ç›®é‡Œå¤šæ¬¡æ„Ÿè§‰éƒé—·éƒ½å’Œâ€œå¢å¼ºç‰ˆå¾ˆçƒ‚â€æœ‰å…³:</p>
<ol type="1">
<li><p>å‰é¢çš„å‰§æƒ…è¦é‡å¤æ‰“ä¸€éæ¯”è¾ƒåŠé€€ï¼Œæ˜¯å› ä¸ºä½ è¿™æ˜¯å¢å¼ºç‰ˆæ¸¸æˆ</p></li>
<li><p>å­¦å¦¹è™½ç„¶äººè®¾è¿˜å¯ä»¥ä½†æ˜¯å‰æœŸæ€ä¹ˆå®‰æ’éƒ½åƒè·¯äººï¼Œä¼™ä¼´ä»¬å¯¹å­¦å¦¹çš„å­˜åœ¨è®¤è¯†åœ¨æ—©å…ˆé˜¶æ®µä½åˆ°ä¸å¯æ€è®®ä¹Ÿæ˜¯å› ä¸ºä½ è¿™æ˜¯å¢å¼ºç‰ˆæ¸¸æˆï¼Œå‘¨å¯å’Œå­¦å¦¹çš„äº’åŠ¨å®Œå…¨åƒç½‘å‹å†™çš„åŒäººæ–‡ï¼Œä¸ä¸»çº¿åŒæ­¥å‘ç”Ÿåœ¨æ— äººçŸ¥æ™“çš„æ—¶ç©º</p>
<a href="/p/a31f36d806f9/on-the-phone.JPEG" class="gallery-item"><img src="/p/a31f36d806f9/on-the-phone.JPEG" class="" title="æˆ‘è¿˜æŒºå–œæ¬¢å­¦å¦¹è¿™ä¸ªé€ å‹çš„"></a></li>
<li><p>å‰§æƒ…å˜æˆæ€ªç›—å›¢æœ€åä»»åŠ¡æ¨å€’ä¼šé•¿è€å§ -&gt; æ€ªç›—å›¢æœ€åä»»åŠ¡å¹²æ‰ç‹®ç«¥
-&gt; æ€ªç›—å›¢æœ€åä»»åŠ¡å¹²ç¿»åœ£æ¯ -&gt; æ€ªç›—å›¢æœ€åäººç‰©å¹²çˆ†é‚ªç¥ -&gt;
æ€ªç›—å›¢æœ€åä»»åŠ¡å¤ºå›ç°å®ï¼Œè¿™ä¸€æ³¢æ¥ä¸€æ³¢çš„æœ€ç»ˆå›åˆ°æœ€åå‰§æƒ…æœ¬åº”ç»™æˆ‘çš„è§¦åŠ¨è‡³å°‘å°‘äº†ä¸€åŠï¼Œè¿™ä¹Ÿæ˜¯å› ä¸ºä½ è¿™æ˜¯å¢å¼ºç‰ˆæ¸¸æˆåˆåŠ äº†ä¸ªå°¾å·´ã€‚ç‰¹åˆ«æ˜¯ä½œä¸ºå‰§æƒ…æœ€åçš„å°¾å·´ï¼Œè™½ç„¶ä¸å¤Ÿæ·±åˆ»ä¹Ÿå¥½ï¼Œæ‰“å€’ä¸€è‡´è®¤å¯çš„é‚ªæ¶è¦æ¯”å’Œäº¦æ­£äº¦é‚ªçš„å­˜åœ¨æˆ˜æ–—è¦è®©äººçˆ½å¿«ä¸€äº›</p></li>
</ol></li>
<li><p>è§’è‰²COOPè®²å®Œè¯å›å®¶å†æ‰“ä¸€é€šç”µè¯è¿™ä¸ªè®¾å®šæ„Ÿè§‰æŒºå¥‡æ€ªçš„ï¼Œæœ‰äº›æ—¶å€™ç”µè¯å†…å®¹è¿˜å’Œå½“æ—¥å‘ç”Ÿçš„COOPå†…å®¹å¾®å¦™åœ°å¯¹ä¸å¤ªä¸Šï¼ŒæŒºå®¹æ˜“ç»™äººå‡ºæˆçš„æ„Ÿè§‰ã€‚</p></li>
<li><p>æˆ‘è¿˜æ˜¯ä¸å¤ªå–œæ¬¢å°è±¡ç©ºé—´è¿™ç§æœ‰ç‚¹roguelikeè¦ç´ çš„åˆ·çº§åœ°å›¾ï¼Œå¯èƒ½æ˜¯åœ¨è¿™ç§éšæœºç”Ÿæˆå†…å®¹ä¸­ï¼Œåˆ›ä½œè€…çš„è®¾è®¡æ„Ÿä½“ç°åœ°è¿˜æ˜¯ä¸å¤Ÿå¤šé€ æˆçš„å§ï¼Œè¿™ç‚¹å¯ä»¥å½“ä½œæ˜¯æˆ‘ä¸ªäººçš„é—®é¢˜äº†ã€‚</p></li>
</ol>
<h3 id="æ‰€ä»¥è¿™å‘¨ç›®é€‰æ‹©äº†å“ªä½å‘¢...">æ‰€ä»¥è¿™å‘¨ç›®é€‰æ‹©äº†å“ªä½å‘¢...</h3>
<p>æˆ‘ä¸€å‘¨ç›®é€‰æ‹©çš„æ˜¯é˜¿çœŸï¼ˆæ–°å²›çœŸï¼‰ã€‚å½“æ—¶å¯èƒ½å¤šå°‘ä¹Ÿå—äº†ä¸€äº›å…¶ä»–äººæ¸¸æˆå®å†µæˆ–è€…åŒäººä½œå“çš„å½±å“ï¼Œä½†æ˜¯å®é™…ä½“éªŒä¸‹æ¥è¿˜æ˜¯æ¯å¤ªèƒ½æ„Ÿå—åˆ°é˜¿çœŸçš„é­…åŠ›ï¼Œåè€Œæ˜¯é˜¿æ˜¥ï¼ˆå¥¥æ‘æ˜¥ï¼‰é‚£ç§èº«ä¸ºå¤§å°å§å…¶å®å¶å°”ä¹Ÿä¼šä½¿åï¼ŒèƒŒåœ°é‡Œæœ‰ä¸€äº›å°ç®—ç›˜å…¶å®è¿˜æœ‰ç‚¹æˆ³ã€‚</p>
<a href="/p/a31f36d806f9/no-turning-back.jpg" class="gallery-item"><img src="/p/a31f36d806f9/no-turning-back.jpg" class="" title="å·²ç»æ— æ³•å›å¤´äº†"></a>
<p>æ— å¥ˆé˜¿æ˜¥çš„å‡ºåœºè¿˜æ˜¯å®Œï¼Œè™½ç„¶çš‡å®¶ç‰ˆåŠ é•¿äº†æ¸¸æˆæµç¨‹ï¼Œè§’è‰²çš„åˆ»ç”»è¿˜æ˜¯æœ‰ç‚¹æŠ±æ­‰ï¼Œå¯¹äºæ€ªç›—å›¢ä¸­å”¯ä¸€ä¸€ä¸ªå› ä¸ºæ”¹å¿ƒäº‹ä»¶ä¸§å¤±äº²äººçš„æˆå‘˜è¿˜æ˜¯æ²¡æœ‰å¤ªå¤šç¯‡å¹…æ¥å±•å¼€ï¼Œè€Œä¸”ä¸€äº›å®˜æ–¹é…å›¾é‡Œçš„é˜¿æ˜¥çœŸçš„æœ‰ç‚¹ä¸€è¨€éš¾å°½ï¼</p>
<p>æœ€åè¿˜æ˜¯é€‰æ‹©äº†åŒå¶å•¦ã€‚è™½ç„¶æ˜¯ä¸ä¸‰æ¬¡å…ƒæ— ç¼˜çš„æ€§æ ¼ï¼Œè¿˜æ˜¯èƒ½è®©åƒç–®ç™¾å­”çš„ç¤¾ç•œå¾—åˆ°æ²»æ„ˆå‘¢ã€‚è€Œä¸”æ‚ æœ¨ç¢§é…çš„åŒå¶ç¡®å®æŒºåˆ°ä½çš„ï¼Œç°åœ¨å¹³æ—¥è¿½ç•ªçœ‹åˆ°æ‚ æœ¨ç¢§é…çš„è§’è‰²éƒ½ä¼šé¢å¤–ç•™æ„ä¸€ä¸‹ã€‚</p>
<a href="https://cdn.jsdelivr.net/gh/kalulas/image-hosting/images/persona5-royal-futaba-best-girl.jpg" class="gallery-item"><img src="https://cdn.jsdelivr.net/gh/kalulas/image-hosting/images/persona5-royal-futaba-best-girl.jpg" class="" title="åŒå¶å¤©ä¸‹ç¬¬ä¸€"></a>
<h2 id="é—æ†¾å’Œä¸€äº›å±•æœ›">é—æ†¾å’Œä¸€äº›å±•æœ›</h2>
<p>è¦è¯´è¿™ä¸€æ¬¡æ¸¸ç©çš„é—æ†¾é‚£ä¹Ÿè¿˜æ˜¯æœ‰çš„ï¼Œå°±æ˜¯ç›®å‰çš„å¯æ”¯é…æ—¶é—´åº”è¯¥ä¹Ÿæ²¡æœ‰å……è¶³åˆ°å¯ä»¥è®©æˆ‘äºŒå‘¨ç›®ä»¥è‡³äºå…¨Awardï¼ˆMY
PALACEä¸­çš„æ¸¸æˆå†…ç½®æˆå°±ç³»ç»Ÿï¼‰ï¼Œä»¥åŠè™½ç„¶å¾ˆè®¤çœŸåœ°åœ¨æ”¶é›†æ¸¸æˆä¸­çš„å½©è›‹ï¼Œä¸€äº›å°è±¡ç©ºè§ä»»åŠ¡çš„æ¸¸æˆåœºæ™¯ç›¸å…³å†…å®¹å’Œå„å¤§åœºæ™¯ä¸­çš„å¸¸é©»npcå°æ•…äº‹æˆ‘åº”è¯¥è¿˜æ˜¯æ²¡æœ‰å…¨è¦†ç›–ã€‚ä¸è¿‡æ„Ÿè§‰ç¬¬äº”ä»£çš„æ•…äº‹ä¹Ÿå·²ç»è®©æˆ‘ç¿»æ¥è¦†å»åœ°å·®ä¸å¤šäº†ï¼Œæˆ‘ä¹Ÿæœ€å¥½åœ¨è¿™é‡Œå®å®åœ¨åœ¨åœ°å’Œæ¸¸æˆä¸­çš„å¤§å®¶å‘Šåˆ«è¦å¥½ï¼Œä¸ºæ­¤è¿˜ç‰¹æ„ä¹°äº†é‡‡é›†å¡å½•äº†æ¸¸æˆå°¾å£°å‘¨å¯å›è€å®¶çš„ä¸€æ®µè§†é¢‘ï¼Œ<a
href="https://www.bilibili.com/video/BV1NP4y1J7JY?spm_id_from=333.999.0.0">ä¼ é€é—¨-&gt;</a>ã€‚</p>
<a href="https://s2.loli.net/2023/01/22/od73WjMJ9Ga1e5z.jpg" class="gallery-item"><img src="https://s2.loli.net/2023/01/22/od73WjMJ9Ga1e5z.jpg" class="" title="å‘œå‘œè™½ç„¶æˆ‘æ²¡èƒ½ä¸Šè½¦è°¢è°¢å¤§å®¶æ¥é€æˆ‘"></a>
<p>å‘è¿™ç¯‡æ–‡ç« çš„æ—¶å€™ATLUSä¹Ÿæ­£åƒæŒ¤ç‰™è†ä¸€æ ·åœ°å…¬å¸ƒç€25å‘¨å¹´ç›¸å…³çš„æƒ…æŠ¥ï¼Œå¦‚æœèƒ½æœ‰P3çš„é‡ç½®ä¹Ÿå¥½ï¼Œæ¯•ç«Ÿæ˜¯æˆ‘å®Œå…¨æ²¡æœ‰æ¥è§¦è¿‡çš„æ•…äº‹ï¼Œä½†æœç„¶è¿˜æ˜¯ä¼šæƒ³è¦P6å•Š...å¯¹ATLUSçš„å‡ ç‚¹æœŸå¾…å…¶å®ä¹Ÿéƒ½å†™åœ¨ä¸Šé¢äº†ï¼Œæ— éå°±æ˜¯ï¼ˆ1ï¼‰ä¸è¦æä¸åŒè¯­è¨€çš„åˆ†æ—¶æ®µå‘å”®ï¼Œè¯·å…¨è¯­è¨€åŒæ­¥å‘å”®ï¼ˆ2ï¼‰ä¸è¦æåŠ å¼ºç‰ˆï¼Œæˆ‘å¯ä»¥å¤šç­‰å‡ å¹´ã€‚ä¸è¿‡è¿™å¯æ˜¯é‚£ä¸ªATLUSå•Šï¼Œç­‰äº†é‚£ä¹ˆå¤šæ¬¡æƒ…æŠ¥å’Œç›¸å…³å‘å¸ƒä¼šï¼Œæˆ‘ä¹Ÿå¤§æ¦‚æ˜ç™½ATLUSçš„è¡Œäº‹é£æ ¼äº†ï¼Œå¦‚æœè¿˜æ˜¯æ²¿è¢­â€œä¼˜è‰¯ä¼ ç»Ÿâ€ï¼Œé‚£æˆ‘åº”è¯¥ä¹Ÿèƒ½çœ‹å¼€å§ã€‚</p>
<a href="/p/a31f36d806f9/taxi.jpg" class="gallery-item"><img src="/p/a31f36d806f9/taxi.jpg" class="" title="ä¸¸å–œè¿™ä¸€èº«è¿˜æŒºå¸…..."></a>
<p>ä¸Šä¸€æ¬¡è‡ªå‘åœ°å†™è¿™ä¹ˆé•¿çš„æŠ€æœ¯æ— å…³æ–‡ç« å¯èƒ½è¿˜æ˜¯å¤§äºŒï¼æˆ–è€…æ˜¯é«˜ä¸­æ ¡åˆŠæ—¶æœŸäº†ï¼åœ¨å¦é—¨è€å®¶ç”¨ä¸å¤ªé€‚åˆå·¥ä½œçš„å¹³ä»·é’è½´é”®ç›˜ï¼Œå¾ˆç—›è‹¦å‘¢ã€‚ä»¥ä¸Šæ˜¯ä¸€ç¯‡å®Œå…¨å‡ºè‡ªæˆ‘ç§å¿ƒï¼Œçºªå¿µç”¨çš„æ–‡ç« ï¼Œå†™çš„æ—¶å€™æ²¡æœ‰è€ƒè™‘é‚£ä¹ˆå¤šï¼Œå¯¼è‡´ä¸€äº›é£è¯é€ å¥å¯èƒ½ä¼šè®©è¯»è€…æ„Ÿåˆ°å›°æƒ‘ï¼Œå¦‚æœå¸¦æ¥äº†é˜…è¯»ä¸Šçš„å›°éš¾è¿˜è¯·å¤šå¤šè°…è§£ã€‚</p>
<a href="/p/a31f36d806f9/fin.jpg" class="gallery-item"><img src="/p/a31f36d806f9/fin.jpg" class="" title="ç»“æŸå•¦"></a>
<p>æ„Ÿè°¢é˜…è¯»åˆ°è¿™é‡Œçš„ä½ ï¼Œæˆ‘ä»¬ä¸‹ç¯‡æ–‡ç« å†è§ï¼</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>ç”µç©å’–</category>
        <category>å¥³ç¥å¼‚é—»å½•</category>
      </categories>
      <tags>
        <tag>é€šå…³çºªå¿µ</tag>
        <tag>æ¸¸æˆæµ‹è¯„</tag>
        <tag>å¥³ç¥å¼‚é—»å½•</tag>
      </tags>
  </entry>
  <entry>
    <title>å…³äºé…ç½®ä»£ç ç”Ÿæˆå™¨çš„æ„æƒ³</title>
    <url>/p/ab7a58fcc8d2/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h3 id="éœ€æ±‚">éœ€æ±‚</h3>
<p>ç›®å‰é¡¹ç›®ç»„çš„å¼€å‘å·¥ä½œæµä¸­ï¼Œè¯»å–è¡¨æ ¼é…ç½®éœ€è¦é‡å¤è¾ƒå¤šæœºæ¢°æ€§çš„å·¥ä½œï¼šé¦–å…ˆæ˜¯å­—æ®µçš„åç§°å’Œç±»å‹è§„å®šä¸Šæœ‰ä¸€å®šçš„å¿ƒæ™ºè´Ÿæ‹…ï¼Œåœ¨å¤šç§ä½¿ç”¨æ¸ é“ï¼ˆå¦‚clientï¼Œserverï¼‰ä¸‹å¯èƒ½è¦è®¤ä¸ºè¿›è¡Œå¤šæ¬¡åŒæ­¥ï¼Œå…¶æ¬¡æ˜¯å®Œæˆè¯»è¡¨ä»£ç ä¹Ÿæ¯”è¾ƒæ¨¡å¼åŒ–ï¼Œç†è®ºä¸Šè¿™äº›å·¥ä½œéƒ½å¯ä»¥ç”±å·¥å…·æä¾›è¾…åŠ©å¹¶æœ€ç»ˆç”±å·¥å…·ç”Ÿæˆä»£ç ã€‚</p>
<h3 id="åŠŸèƒ½æ¦‚è§ˆ">åŠŸèƒ½æ¦‚è§ˆ</h3>
<ol type="1">
<li>å°†è¡¨æ ¼çš„æ‰€æœ‰å­—æ®µåœ¨å·¥å…·ä¸­æ˜¾ç¤ºï¼Œç”±ç”¨æˆ·æ¥è‡ªå®šä¹‰è¡¨æ ¼å±æ€§ï¼šå­—æ®µçš„ç±»å‹ï¼Œç”¨é€”å’Œé»˜è®¤å€¼</li>
<li>å·¥å…·èƒ½å¤Ÿå°†è¡¨æ ¼å±æ€§ä»¥jsonå½¢å¼åºåˆ—åŒ–ï¼Œä»¥jsonæ–‡ä»¶å½¢å¼è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨</li>
<li>å·¥å…·èƒ½å¤Ÿä¾æ®è¡¨æ ¼å±æ€§ä»¥åŠç”¨æˆ·è‡ªå®šä¹‰çš„ä»£ç æ¨¡æ¿æ¥ç”Ÿæˆè¯»è¡¨ä»£ç </li>
</ol>
<h3 id="å®šä¹‰">å®šä¹‰</h3>
<p>è¡¨åï¼šå³é…ç½®æ–‡ä»¶çš„æ–‡ä»¶å</p>
<p>å­—æ®µï¼šå³é…ç½®è¡¨ä¸­æœ‰å®é™…ç”¨é€”çš„ä¸€åˆ—</p>
<p>è¯»è¡¨ä»£ç ï¼šå¹¶ä¸æä¾›ä»èµ„æºæ–‡ä»¶ä¸­è¯»å–é…ç½®æ•°æ®çš„åŠŸèƒ½ï¼Œä»…æä¾›ä»é…ç½®æ•°æ®è§£æå‡ºå¯¹åº”ç±»å‹å­—æ®µçš„åŠŸèƒ½</p>
<span id="more"></span>
<h3 id="å·¥å…·éœ€æ±‚æ–‡æ¡£">å·¥å…·éœ€æ±‚æ–‡æ¡£</h3>
<p>csvåªæ˜¯é…ç½®çš„ä¸€ç§å½¢å¼ï¼Œå¸Œæœ›èƒ½å…¼å®¹æ‰€æœ‰è¡¨æ ¼ç±»å‹çš„é…ç½®</p>
<ol type="1">
<li>ConfigCodeGenLibï¼šä»¥dllçš„å½¢å¼æä¾›åŸºç¡€åŠŸèƒ½ï¼ŒåŒ…æ‹¬
<ol type="1">
<li>æŒ‡å®šè¡¨æ ¼çš„å­—æ®µå¯ä»¥æœ‰æœ‰å“ªäº›ç”¨é€”ï¼ˆusageï¼‰å’Œç±»å‹ï¼ˆtypeï¼‰ï¼ŒåŒ…æ‹¬å€¼ç±»å‹ä¸å®¹å™¨ç±»å‹</li>
<li>æŒ‡å®šç”Ÿæˆä»£ç æ¨¡æ¿ç›®å½•å’Œç”Ÿæˆä»£ç ç›®å½•ï¼Œç”Ÿæˆè¯»è¡¨ä»£ç æ—¶ä»è¿™äº›ç›®å½•è¯»å–</li>
<li>ä¼ å…¥é…ç½®æ–‡ä»¶ï¼ˆcsvç­‰ï¼‰è·¯å¾„ï¼Œç”Ÿæˆè¡¨ååˆ°å­—æ®µçš„å±æ€§åˆ—è¡¨çš„æ˜ å°„</li>
<li>åœ¨ä¸æä¾›jsonæ–‡ä»¶æ—¶ï¼Œä»…æ‰€æœ‰å­—æ®µçš„å±æ€§éƒ½è®¾ç½®ä¸ºåˆå§‹å€¼</li>
<li>åœ¨æä¾›jsonæ–‡ä»¶æ—¶ï¼Œä»jsonæ–‡ä»¶ä¸­è¯»å‡ºå­—æ®µçš„å®¢åˆ¶åŒ–å±æ€§</li>
<li>æä¾›è¡¨åå¯ä»¥è·å–å­—æ®µå±æ€§åˆ—è¡¨ï¼Œå¯¹å­—æ®µå±æ€§è¿›è¡Œè¯»å†™ï¼ˆç¼–è¾‘å™¨æ”¯æŒï¼‰</li>
<li>å¯ä»¥å°†è¡¨æ ¼çš„é…ç½®å±æ€§ä»¥jsonå½¢å¼æŒä¹…åŒ–</li>
</ol></li>
<li>ConfigEditorï¼šä¾èµ–ConfigCodeGenLibçš„å›¾å½¢åŒ–å·¥å…·ï¼Œæä¾›åŠŸèƒ½åŒ…æ‹¬
<ol type="1">
<li>æä¾›é…ç½®ç›®å½•ï¼ˆjsonç´¢å¼•ï¼‰ï¼Œç”Ÿæˆæ‰€æœ‰è¡¨æ ¼é…ç½®çš„é€‰å–åˆ—è¡¨</li>
<li>é€‰å–è¡¨æ ¼åï¼Œæ˜¾ç¤ºå­—æ®µçš„ç¼–è¾‘ç•Œé¢</li>
<li>ä¿å­˜å­—æ®µå±æ€§çš„ç¼–è¾‘ç»“æœï¼Œç”Ÿæˆjsoné…ç½®æ–‡ä»¶</li>
<li>ç”Ÿæˆç‰¹å®šç”¨é€”ï¼ˆusageï¼‰ä¸‹çš„ç”Ÿæˆä»£ç ï¼ˆç”± Visual Studio
æä¾›çš„<strong>TextTransform</strong>ä»¥åŠT4 Text Templateæ”¯æŒï¼‰</li>
</ol></li>
</ol>
<h3 id="å¼€å‘è®°å½•">å¼€å‘è®°å½•</h3>
<p>githubä¼ é€é—¨ï¼šhttps://github.com/kalulas/ConfigCodeGen</p>
<p>libenv.jsonç”¨äºåˆå§‹åŒ–libraryï¼Œappsettings.jsonç”¨äºåˆå§‹åŒ–åº”ç”¨</p>
<h4 id="configcodegenlib">ConfigCodeGenLib</h4>
<p>.Net Standard 2.0 Library</p>
<ol type="1">
<li>Configurationï¼šé™æ€ç±»ï¼Œç”¨äºæ ¹æ®jsonæ–‡ä»¶é…ç½®å·¥å…·ç¯å¢ƒ</li>
<li>ConfigManagerï¼šå•ä¾‹æ¨¡å¼ï¼Œç”¨äºæ ¹æ®é…ç½®æ–‡ä»¶å’Œjsonæ–‡ä»¶ç”Ÿæˆè¿è¡Œæ—¶æ•°æ®</li>
</ol>
<h4 id="configcodegenconsole">ConfigCodeGenConsole</h4>
<p>.Net 6.0 è°ƒè¯•Libraryç”¨çš„Console</p>
<h4 id="configeditor">ConfigEditor</h4>
<p>.Net 6.0 åŸºäº<a
href="https://docs.avaloniaui.net/">Avalonia</a>çš„å›¾å½¢åŒ–ç¼–è¾‘å™¨</p>
<h4 id="é…ç½®å½¢å¼è¯´æ˜">é…ç½®å½¢å¼è¯´æ˜</h4>
<p>config.json</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;
    &quot;DataValueType&quot;: [&quot;int&quot;, &quot;float&quot;, &quot;boolean&quot;, &quot;string&quot;], &#x2F;&#x2F; æ”¯æŒçš„å€¼ç±»å‹
    &quot;DataCollectionType&quot;: [&quot;none&quot;, &quot;array&quot;, &quot;list&quot;], &#x2F;&#x2F; æ”¯æŒçš„å®¹å™¨ç±»å‹
    &quot;ConfigJsonPath&quot;: &quot;ConfigJson\\&quot;, &#x2F;&#x2F; ç›¸å¯¹è·¯å¾„ï¼Œåœ¨è¯¥ç›®å½•ä¸‹å­˜æ”¾æè¿°é…ç½®çš„json
    &quot;CodeTemplatePath&quot;: &quot;CodeTemplate\\&quot;, &#x2F;&#x2F; ç›¸å¯¹è·¯å¾„ï¼Œåœ¨è¯¥ç›®å½•ä¸‹ä»£ç ç”Ÿæˆæ¨¡æ¿
    &quot;ConfigUsageType&quot;:&#123; &#x2F;&#x2F; ç”¨æˆ·çš„è‡ªå®šä¹‰ç”Ÿæˆç±»å‹
        &quot;client&quot;:&#123; 
            &quot;CodeTemplateName&quot;: &quot;csharp.txt&quot;, &#x2F;&#x2F; ä»£ç æ¨¡æ¿å
            &quot;TargetPath&quot;: &quot;Generated-C#\\&quot;, &#x2F;&#x2F; ç”Ÿæˆä»£ç ç›®å½•
            &quot;TargetFileType&quot;: &quot;.cs&quot; &#x2F;&#x2F; ç”Ÿæˆåç¼€å
        &#125;,
        &quot;server&quot;:&#123;
            &quot;CodeTemplateName&quot;: &quot;go.txt&quot;,
            &quot;TargetPath&quot;: &quot;Generated-go\\&quot;,
            &quot;TargetFileType&quot;: &quot;.go&quot;
        &#125;
    &#125;
&#125;</code></pre>
<p>table.jsonï¼ˆé…ç½®æ–‡ä»¶å¯¹åº”jsonï¼‰</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json">&#123;
    &quot;ConfigName&quot; : &quot;AutoPickupConfig&quot;,
    &quot;Usage&quot;      : [
    ],
    &quot;Attributes&quot; : [
        &#123;
            &quot;AttributeName&quot; : &quot;Id&quot;,
            &quot;ValueType&quot;     : &quot;&quot;,
            &quot;CollectionType&quot; : &quot;&quot;,
            &quot;Usage&quot;          : [
            ]
        &#125;,
        &#123;
            &quot;AttributeName&quot; : &quot;Desc&quot;,
            &quot;ValueType&quot;     : &quot;&quot;,
            &quot;CollectionType&quot; : &quot;&quot;,
            &quot;Usage&quot;          : [
            ]
        &#125;,
        &#x2F;&#x2F; ...
    ]
&#125;</code></pre>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>å¼€å‘è®¾è®¡ç¨¿</category>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>è®°å½•</tag>
        <tag>æ¸¸æˆå¼€å‘å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>è®¡ç®—æœºå›¾å½¢å­¦ä¸­çš„å››å…ƒæ•°</title>
    <url>/p/d376051877fb/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="å››å…ƒæ•°ä¸æ¬§æ‹‰è§’">å››å…ƒæ•°ä¸æ¬§æ‹‰è§’</h1>
<p>ä»¥ä¸‹å†…å®¹ä¸»è¦æ˜¯å‚è€ƒäº†<a
href="https://github.com/Krasjet/quaternion">Krasjet</a>å…³äºå››å…ƒæ•°çš„ä»‹ç»ã€Šå››å…ƒæ•°ä¸ä¸‰ç»´æ—‹è½¬ã€‹ï¼š<a href="/p/d376051877fb/quaternion.pdf" title="â€œç‚¹è¿™é‡Œé˜…è¯»ã€Šå››å…ƒæ•°ä¸ä¸‰ç»´æ—‹è½¬ã€‹â€">â€œç‚¹è¿™é‡Œé˜…è¯»ã€Šå››å…ƒæ•°ä¸ä¸‰ç»´æ—‹è½¬ã€‹â€</a></p>
<p>ä¼šè®°å½•ä¸€äº›é˜…è¯»è¿‡ç¨‹ä¸­é‡åˆ°çš„ç»“è®ºæ€§å†…å®¹ï¼Œç³»ç»Ÿå­¦ä¹ ä¸»è¦è¿˜æ˜¯å‚è€ƒåŸæ–‡æ¡£ä¸ºä¸»</p>
<h2 id="å¤æ•°">å¤æ•°</h2>
<h3 id="å¤æ•°ç›¸ä¹˜ä¸2dæ—‹è½¬">1.3 å¤æ•°ç›¸ä¹˜ä¸2Dæ—‹è½¬</h3>
<p>ä¸å¤æ•° <span class="math inline">\(z=a+bi\)</span> ç›¸ä¹˜ä»£è¡¨ç€<span
class="math inline">\(\begin{bmatrix}a &amp; -b \\b &amp; a
\end{bmatrix}\)</span>
çŸ©é˜µæ‰€ä½œå‡ºçš„å˜æ¢ï¼Œå°†çŸ©é˜µä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½é™¤ä»¥æ¨¡é•¿ï¼Œå¯ä»¥å¾—åˆ°ä»¥ä¸‹å˜æ¢ï¼š</p>
<p><span class="math display">\[
\begin{bmatrix}a &amp; -b \\b &amp; a \end{bmatrix} =
\sqrt{a^2+b^2}*\begin{bmatrix}\frac{a}{\sqrt{a^2+b^2}}&amp;\frac{-b}{\sqrt{a^2+b^2}}\\\frac{b}{\sqrt{a^2+b^2}}&amp;\frac{a}{\sqrt{a^2+b^2}}\end{bmatrix}
\]</span></p>
<a href="/p/d376051877fb/complex-plane.png" class="gallery-item"><img src="/p/d376051877fb/complex-plane.png" class="" title="å¤å¹³é¢ä¸Šçš„å¤æ•°z"></a>
<p>ä»å¤å¹³é¢è§‚å¯Ÿå¯ä»¥å¾—åˆ°ï¼Œ<span
class="math inline">\(\|z\|=\sqrt{a^2+b^2}\)</span> ä¸”æœ‰ <span
class="math inline">\(\theta=\arctan(\frac{b}{a})\)</span>
ï¼ŒåŸæœ¬çš„çŸ©é˜µè½¬æ¢ä¸ºäº†ä¸¤ä¸ªå˜æ¢çŸ©é˜µçš„å¤åˆï¼Œå…¶ä¸­å·¦è¾¹çš„<span
class="math inline">\(\begin{bmatrix}\|z\|&amp;0\\0&amp;\|z\|\end{bmatrix}\)</span>æ˜¯ç¼©æ”¾çŸ©é˜µï¼Œè€Œå³è¾¹çš„<span
class="math inline">\(\begin{bmatrix}\cos(
\theta)&amp;-\sin(\theta)\\\sin(\theta)&amp;\cos(\theta)\end{bmatrix}\)</span>åˆ™æ˜¯2Dæ—‹è½¬çŸ©é˜µã€‚</p>
<span id="more"></span>
<h3 id="æ—‹è½¬çš„å¤åˆ">1.4 æ—‹è½¬çš„å¤åˆ</h3>
<p><span class="math display">\[
\begin{aligned}z_{net}&amp;=(\cos(\theta)+i\sin(\theta))(\cos(\phi)+i\sin(\phi))\\&amp;=\cos(\theta+\phi)+i\sin(\theta+\phi)\end{aligned}
\]</span></p>
<p>å¯¹ä¸¤ä¸ª2Dæ—‹è½¬è¿›è¡Œå¤åˆæ—¶ï¼Œæ‰€å¾—çš„å˜æ¢ <span
class="math inline">\(z_{net}\)</span>
ä»æ˜¯ä¸€ä¸ªæ—‹è½¬ï¼Œè€Œä¸”ä¸æ–½åŠ çš„æ¬¡åºæ— å…³ã€‚è¿™ä¸ªç­‰æ•ˆå˜æ¢çš„æ—‹è½¬è§’æ˜¯ä¸¤ä¸ªæ—‹è½¬è§’ä¹‹å’Œã€‚</p>
<h2 id="ä¸‰ç»´ç©ºé—´ä¸­çš„æ—‹è½¬">2 ä¸‰ç»´ç©ºé—´ä¸­çš„æ—‹è½¬</h2>
<p><strong>è½´è§’å¼(Axis-angle)</strong> æ—‹è½¬ï¼šç»™å®šæ—‹è½¬çš„è½¬è½´å‘é‡<span
class="math inline">\(\vec{u}=(x,y,z)^T\)</span>ä»¥åŠæ—‹è½¬çš„è§’åº¦<span
class="math inline">\(\theta\)</span>ï¼Œä½†å®é™…åœ¨ä¸‰ç»´ç©ºé—´ä¸­è¡¨ç¤ºæ–¹å‘åªéœ€è¦ä¸¤ä¸ªè‡ªç”±åº¦ï¼ˆæˆ–è€…è¯´ä¸¤ä¸ªå˜é‡ï¼‰ï¼Œå³ä¸ä¸¤ä¸ªåæ ‡è½´çš„å¤¹è§’ï¼Œè½¬è½´å‘é‡å¯ä»¥é™¤ä»¥æ¨¡é•¿è½¬æ¢ä¸ºç‰¹å®šæ–¹å‘ä¸Šçš„å•ä½å‘é‡ã€‚</p>
<h3 id="æ—‹è½¬çš„åˆ†è§£">2.1 æ—‹è½¬çš„åˆ†è§£</h3>
<p>é¦–å…ˆå°†è¦æ—‹è½¬çš„å‘é‡åœ¨å‚ç›´å’Œå¹³è¡Œäºè½¬è½´çš„æ–¹å‘ä¸Šè¿›è¡Œåˆ†è§£ï¼Œæœ‰<span
class="math inline">\(\vec{v}=\vec{v_\parallel}+\vec{v_\perp}\)</span>
ï¼Œåˆ†åˆ«è¿›è¡Œæ—‹è½¬åå†ç›¸åŠ å°±èƒ½å¾—åˆ°æ—‹è½¬åçš„ç»“æœã€‚</p>
<p>æ ¹æ®æ­£äº¤æŠ•å½±å…¬å¼ï¼Œå¯ä»¥å¾—å‡º</p>
<p><span class="math display">\[
\begin{aligned}\vec{v_\parallel}&amp;=proj_{\vec{u}}(\vec{v})\\&amp;=\frac{\vec{u}\cdot\vec{v}}{\vec{u}\cdot\vec{u}}\vec{u}\\&amp;=(\vec{u}\cdot\vec{v})\vec{u}\end{aligned}
\]</span></p>
<p>åˆç”±äº<span
class="math inline">\(\vec{v}=\vec{v_\|}+\vec{v_\perp}\)</span>ï¼Œå¯ä»¥å¾—åˆ°å‚ç›´äºè½¬è½´æ–¹å‘æœ‰</p>
<p><span class="math display">\[
\begin{aligned}\vec{v_{\perp}}&amp;=\vec{v}-\vec{v_{\parallel}}\\&amp;=\vec{v}-(\vec{u}\cdot\vec{v})\vec{u}\end{aligned}
\]</span></p>
<h3 id="å‚ç›´åˆ†é‡çš„æ—‹è½¬">2.3 å‚ç›´åˆ†é‡çš„æ—‹è½¬</h3>
<p>åœ¨ä¸<span
class="math inline">\(\vec{u}\)</span>å‚ç›´å¹³é¢ä¸Šçš„åˆ†é‡æ—‹è½¬è§’åº¦<span
class="math inline">\(\theta\)</span>ï¼Œå¯å¯¹ç»“æœè¿›è¡Œä¸‹è¿°è¡¨ç¤ºï¼Œå…ˆæ„é€ ä¸€ä¸ªæ­£äº¤äºè½¬è½´å‘é‡å’Œ<span
class="math inline">\(\vec{v_{\perp}}\)</span>çš„å‘é‡<span
class="math inline">\(\vec{w}\)</span>ï¼š</p>
<p><span class="math display">\[
\vec{w}=\vec{u}\times\vec{v_\perp}
\]</span></p>
<p>å¯ä»¥å¾—åˆ°æ­£äº¤äºæ—‹è½¬è½´<span
class="math inline">\(\vec{u}\)</span>çš„åˆ†é‡<span
class="math inline">\(\vec{v_\perp}\)</span>ï¼Œæ—‹è½¬è§’åº¦<span
class="math inline">\(\theta\)</span>åå¾—åˆ°çš„<span
class="math inline">\(\vec{v_\perp^\prime}\)</span>ï¼š</p>
<p><span class="math display">\[
\begin{aligned}\vec{v_\perp^\prime}&amp;=\cos{\theta}\vec{v_\perp}+\sin{\theta}\vec{w}\\&amp;=\cos{\theta}\vec{v_\perp}+\sin{\theta}(\vec{u}\times\vec{v_\perp})\end{aligned}
\]</span></p>
<h3 id="vecvçš„æ—‹è½¬">2.4 <span
class="math inline">\(\vec{v}\)</span>çš„æ—‹è½¬</h3>
<p>æ ¹æ®ä¸Šè¿°å…¬å¼å¯ä»¥å¾—åˆ°ä»¥ä¸‹æ¨å¯¼ï¼Œå¾—åˆ°3Dæ—‹è½¬å…¬å¼ï¼Œä¹Ÿç§°<strong><em>Rodriguesâ€™
Rotation Formula</em></strong>ï¼š</p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}\vec{v^\prime}&amp;=\vec{v^\prime_\parallel}+\vec{v_\perp^\prime}\\&amp;=\vec{v_\parallel}+\cos{\theta}\vec{v_\perp}+\sin{\theta}(\vec{u}\times\vec{v_\perp})\\&amp;=(\vec{u}\cdot\vec{v})\vec{u}+\cos{\theta}(\vec{v}-(\vec{u}\cdot\vec{v})\vec{u})+\sin{\theta}(\vec{u}\times\vec{v})\\&amp;=\cos{\theta}\vec{v}+(1-\cos{\theta})(\vec{u}\cdot\vec{v})\vec{u}+\sin{\theta}(\vec{u}\times\vec{v})\end{aligned}\end{equation}
\]</span></p>
<p>å…¶ä¸­ç¬¬äºŒæ­¥åŒ…å«ä»¥ä¸‹æ¨å¯¼ï¼ˆå‰ä¹˜éµå®ˆåˆ†é…å¾‹ï¼‰</p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}\vec{u}\times\vec{v_\perp}&amp;=\vec{u}\times(\vec{v}-\vec{v_\parallel})\\&amp;=\vec{u}\times\vec{v}-\vec{u}\times\vec{v_\parallel}ï¼ˆ\vec{u}å¹³è¡Œäº\vec{v_\parallel}ï¼Œç»“æœä¸º0ï¼‰\\&amp;=\vec{u}\times\vec{v}\end{aligned}\end{equation}
\]</span></p>
<h2 id="å››å…ƒæ•°">å››å…ƒæ•°</h2>
<p>æ‰€æœ‰å››å…ƒæ•°<span
class="math inline">\(q\in\mathbb{H}\)</span>éƒ½å¯ä»¥è¡¨ç°æˆä¸‹è¿°å½¢å¼ï¼Œæœ‰æ—¶å››å…ƒæ•°ä¹Ÿå†™ä½œwï¼Œxï¼Œyï¼Œzçš„å½¢å¼ï¼Œwæ˜¯å¸¸æ•°é¡¹ï¼Œxï¼Œyï¼Œzåˆ†åˆ«æ˜¯iï¼Œjï¼Œkç»´åº¦ä¸Šçš„ç³»æ•°ï¼ˆè®°ä½wæ˜¯å¸¸æ•°é¡¹å°±è¡Œï¼‰</p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}q=a+bi+cj+dk(a,b,c,d\in\mathbb{R})\end{aligned}\end{equation}
\]</span></p>
<p>å…¶ä¸­æœ‰</p>
<p><span class="math display">\[
\begin{equation}i^2=j^2=k^2=ijk=-1\end{equation}
\]</span></p>
<h3 id="æ ‡é‡ä¹˜æ³•-å››å…ƒæ•°ä¹˜æ³•">3.1 æ ‡é‡ä¹˜æ³• &amp; å››å…ƒæ•°ä¹˜æ³•</h3>
<p>å››å…ƒæ•°ä¸æ ‡é‡çš„ä¹˜æ³•éµå®ˆäº¤æ¢å¾‹ï¼Œä½†å››å…ƒæ•°ä¹‹é—´çš„ä¹˜æ³•æ¯”è¾ƒç‰¹æ®Šä¸éµå®ˆäº¤æ¢å¾‹ï¼Œæœ‰å·¦ä¹˜ä¸å³ä¹˜çš„åŒºåˆ«ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å·¦ä¹˜ç»“æœä¸ç­‰äºå³ä¹˜ç»“æœã€‚ä¸¾ä¾‹å¯¹<span
class="math inline">\(q_1=a+bi+cj+dk\)</span>ä¸<span
class="math inline">\(q_2=e+fi+gj+hk\)</span>ä¹‹é—´çš„ä¹˜æ³•æœ‰ï¼š</p>
<p><span class="math display">\[
\begin{equation}q_1q_2=\begin{bmatrix}a&amp;-b&amp;-c&amp;-d\\b&amp;a&amp;-d&amp;c\\c&amp;d&amp;a&amp;-b\\d&amp;-c&amp;b&amp;a\end{bmatrix}\begin{bmatrix}e\\f\\g\\h\end{bmatrix}\end{equation}
\]</span></p>
<p>è¿›è¡Œ<span class="math inline">\(q_1\)</span>å³ä¹˜<span
class="math inline">\(q_2\)</span>æœ‰ä»¥ä¸‹</p>
<p><span class="math display">\[
\begin{equation}q_2q_1=\begin{bmatrix}a&amp;-b&amp;-c&amp;-d\\b&amp;a&amp;d&amp;-c\\c&amp;-d&amp;a&amp;b\\d&amp;c&amp;-b&amp;a\end{bmatrix}\begin{bmatrix}e\\f\\g\\h\end{bmatrix}\end{equation}
\]</span></p>
<h3 id="graÃŸmannç§¯">3.1.6 GraÃŸmannç§¯</h3>
<p>å¯¹ä»¥ä¸Š<span class="math inline">\(q_1\)</span>ä»¥åŠ<span
class="math inline">\(q_2\)</span>æœ‰ä¸¤è€…çš„ä¹˜ç§¯</p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}q_1q_2=&amp;(ae-(bf+cg+dh))+\\&amp;(be+af+ch-dg)i+\\&amp;(ce+ag+df-bh)j+\\&amp;(de+ah+bg-cf)k\end{aligned}\end{equation}
\]</span></p>
<p>è‹¥ç»™å‡ºä»¥<span
class="math inline">\(\vec{i}ã€\vec{j}ã€\vec{k}\)</span>ä¸ºåŸºçš„å‘é‡<span
class="math inline">\(\vec{v}=\begin{bmatrix}b\\c\\d\end{bmatrix}\)</span>ä»¥åŠ<span
class="math inline">\(\vec{u}=\begin{bmatrix}f\\g\\h\end{bmatrix}\)</span>ï¼Œæœ‰ä»¥ä¸‹</p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}\vec{v}\cdot\vec{u}&amp;=bf+cg+dh\\\vec{v}\times\vec{u}&amp;=\left|\begin{matrix}\vec{i}&amp;\vec{j}&amp;\vec{k}\\b&amp;c&amp;d\\f&amp;g&amp;h\end{matrix}\right|\\&amp;=(ch-dg)\vec{i}-(bh-df)\vec{j}+(bg-cf)\vec{k}\end{aligned}\end{equation}
\]</span></p>
<p>æœ€åå¯ä»¥å¾—åˆ°GraÃŸmannç§¯ç»“æœï¼Œæœ‰å¯¹ä»»æ„å››å…ƒæ•°<span
class="math inline">\(q_1=\begin{bmatrix}s,\vec{v}\end{bmatrix},
q_2=\begin{bmatrix}t,\vec{u}\end{bmatrix}\)</span>å¯ä»¥å¾—åˆ°ç»“æœï¼š</p>
<p><span class="math display">\[
\begin{equation}q_1q_2=\begin{bmatrix}st-\vec{v}\cdot\vec{u},
s\vec{u}+t\vec{v}+\vec{v}\times\vec{u}\end{bmatrix}\end{equation}
\]</span></p>
<p>éœ€è¦ç•™æ„è¿™é‡Œçš„åˆ°çš„ç»“æœæ˜¯ä¸€ä¸ªå››å…ƒæ•°ï¼Œå‰è€…æ˜¯æ ‡é‡ï¼Œåè€…æ˜¯ä¸€ä¸ªä»¥<span
class="math inline">\(\vec{i}ã€\vec{j}ã€\vec{k}\)</span>ä¸ºåŸºçš„ä¸‰ç»´å‘é‡</p>
<h3 id="çº¯å››å…ƒæ•°">3.1.7 çº¯å››å…ƒæ•°</h3>
<p>çº¯å››å…ƒæ•°æ˜¯ä»…æœ‰è™šéƒ¨çš„å››å…ƒæ•°ï¼Œå› ä¸ºçº¯å››å…ƒæ•°ä»…ç”±è™šéƒ¨çš„3Då‘é‡å†³å®šï¼Œæ‰€ä»¥å¯ä»¥å°†ä»»æ„çš„3Då‘é‡è½¬æ¢ä¸ºçº¯å››å…ƒæ•°ã€‚å¯¹3Då‘é‡<span
class="math inline">\(\vec{v}\)</span>ï¼Œæœ‰å¯¹åº”çš„çº¯å››å…ƒæ•°ï¼š</p>
<p><span class="math display">\[
\begin{equation}v=\begin{bmatrix}0, \vec{v}\end{bmatrix}\end{equation}
\]</span></p>
<p>å¯ä»¥æ€è€ƒä¸€ä¸‹å¯¹äºçº¯å››å…ƒæ•°æ¥è¯´GraÃŸmannç§¯ï¼ˆ14ï¼‰ä¼šå¾—åˆ°ä»€ä¹ˆç»“æœ</p>
<h3 id="é€†ä¸å…±è½­">3.1.8 é€†ä¸å…±è½­</h3>
<p>å¯¹å››å…ƒæ•°<span class="math inline">\(q\)</span>ï¼Œå®ƒçš„é€†ä¸º<span
class="math inline">\(q^{-1}\)</span>ï¼Œç›¸ä¹˜ç§¯ä¸º1ï¼Œè¿™é‡Œæ³¨æ„å¤ä¹ ä¸‹å››å…ƒæ•°ä¸éµå®ˆäº¤æ¢å¾‹</p>
<p>åŒæ ·å¯¹å››å…ƒæ•°<span class="math inline">\(q = a+bi+cj+dk\)</span>
æœ‰å…±è½­ä¸º <span class="math inline">\(q^* =
a-bi-cj-dk\)</span>ï¼Œå››å…ƒæ•°<span
class="math inline">\(q\)</span>ä¸å…±è½­<span
class="math inline">\(q^*\)</span>ç›¸ä¹˜å¾—åˆ°ç»“æœä¸ºå››å…ƒæ•°æ¨¡é•¿çš„å¹³æ–¹<span
class="math inline">\({\|q\|}^2\)</span>ï¼ŒåŒæ—¶è¿™ä¸ªç‰¹æ®Šçš„è¿ç®—æ˜¯éµå®ˆäº¤æ¢å¾‹çš„</p>
<p>æœ€åï¼Œæ ¹æ®é€†çš„å®šä¹‰å¯ä»¥æ¨å¯¼å¾—åˆ°ä¸€ç§å¯»æ‰¾å››å…ƒæ•°çš„é€†çš„æ–¹å¼ï¼Œå³ï¼š</p>
<p><span class="math display">\[
\begin{equation}q^{-1}=\frac{q^*}{\|q\|^2}\end{equation}
\]</span></p>
<h2 id="å››å…ƒæ•°ä¸3dæ—‹è½¬">3.2 å››å…ƒæ•°ä¸3Dæ—‹è½¬</h2>
<p>æ¥ä¸‹æ¥çš„å†…å®¹å°±æ˜¯å°†å…ˆå‰æ¨å¯¼è¿‡çš„3Dæ—‹è½¬å…¬å¼ï¼ˆ14ï¼‰ï¼Œç”¨<strong>å››å…ƒæ•°çš„è®¡ç®—</strong>å’Œ<strong>çº¯å››å…ƒæ•°</strong>çš„æ–¹å¼è¿›è¡Œè¡¨è¾¾ï¼Œè¿™é‡Œå¼€å§‹æ¬è¿çš„å†…å®¹ä¼šå‡å°‘ï¼Œè¯·ä¸»è¦ä»¥é˜…è¯»åŸpdfä¸ºä¸»ã€‚</p>
<p>å¯¹æ—‹è½¬å‘é‡<span
class="math inline">\(\vec{v}\)</span>åœ¨å‚ç›´æ–¹å‘ä¸Šçš„åˆ†é‡æ—‹è½¬<span
class="math inline">\(\theta\)</span>åçš„ç»“æœ<span
class="math inline">\(\vec{v_\perp^\prime}\)</span>ï¼Œæ›¿æ¢ä¸º<strong>çº¯å››å…ƒæ•°</strong>çš„å½¢å¼æœ‰ï¼š</p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}v_\perp^\prime&amp;=\cos{\theta}v_\perp+\sin{\theta}(uv_\perp)\\&amp;=(\cos{\theta}+\sin{\theta}u)v_\perp\\&amp;=qv_\perp\\q&amp;=\begin{bmatrix}\cos{\theta},\sin{\theta}\vec{u}\end{bmatrix}\end{aligned}\end{equation}
\]</span></p>
<p>è¿™é‡Œçš„<span
class="math inline">\(q\)</span>æ˜¯ä¸€ä¸ªå•ä½å››å…ƒæ•°ï¼Œæ ¹æ®ï¼ˆ16ï¼‰å¯ä»¥å¾—åˆ°<span
class="math inline">\(q^{-1}=q^\star\)</span></p>
<p>å¯¹å¹³è¡Œäºæ—‹è½¬è½´çš„<span
class="math inline">\(\vec{v_\parallel}\)</span>ï¼Œæ—‹è½¬åçš„ä¿æŒä¸å˜ï¼Œå››å…ƒæ•°è¡¨è¾¾å½¢å¼ï¼š<span
class="math inline">\(v_\parallel^\prime=v_\parallel\)</span></p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}v^\prime&amp;=v_\parallel^\prime+v_\perp^\prime\\&amp;=v_\parallel+qv_\perp\\&amp;=1\cdot{v_\parallel}+qv_\perp\\&amp;=pp^{-1}v_\parallel+ppv_\perpï¼ˆä»¤p^2=q,p=[cos(\frac{1}{2}\theta),sin(\frac{1}{2}\theta)\vec{u})]ï¼‰\\&amp;=p{v_\parallel}p^*+p{v_\perp}p^*\\&amp;=p(v_\parallel+v_\perp)p^*\\&amp;=pvp^*\end{aligned}\end{equation}
\]</span></p>
<p>å…¶ä¸­ç¬¬å››æ­¥æ¶‰åŠåˆ°ä¸€ä¸ªå¼•ç†è¯æ˜ï¼Œç¬¬äº”æ¶‰åŠåˆ°ä¸¤ä¸ªå¼•ç†è¯æ˜ï¼Œè¿™é‡Œå°±ä¸è¿›è¡Œæ¬è¿äº†ã€‚</p>
<p>æœ€åæˆ‘ä»¬å¯ä»¥å¾—åˆ°å››å…ƒæ•°å‹ï¼Œä¸€èˆ¬æƒ…å†µçš„3Dæ—‹è½¬å…¬å¼ï¼Œå¯¹ä»»æ„å‘é‡<span
class="math inline">\(\vec{v}\)</span>æ²¿ä»¥å•ä½å‘é‡å®šä¹‰çš„æ—‹è½¬è½´<span
class="math inline">\(\vec{u}\)</span>æ—‹è½¬<span
class="math inline">\(\theta\)</span>åº¦åå¾—åˆ°çš„<span
class="math inline">\(\vec{v^\prime}\)</span>å¯ä»¥é€šè¿‡å››å…ƒæ•°ä¹˜æ³•å¾—åˆ°ï¼Œä»¤<span
class="math inline">\(v=\begin{bmatrix}0,\vec{v}\end{bmatrix},
q=\begin{bmatrix}\cos({\frac{1}{2}\theta}),\sin({\frac{1}{2}\theta})\vec{u}\end{bmatrix}\)</span>ï¼Œæœ‰</p>
<p><span class="math display">\[
\begin{equation}v^\prime=qvq^*=qvq^{-1}\end{equation}
\]</span></p>
<h2 id="dæ—‹è½¬çš„çŸ©é˜µå½¢å¼">3.3 3Dæ—‹è½¬çš„çŸ©é˜µå½¢å¼</h2>
<p>å¯¹å·¦ä¹˜ä¸€ä¸ªå››å…ƒæ•°<span
class="math inline">\(q=a+bi+cj+dk\)</span>ç­‰åŒäºä¸‹é¢è¿™ä¸ªçŸ©é˜µ</p>
<p><span class="math display">\[
\begin{equation}L(q)=\begin{bmatrix}a&amp;-b&amp;-c&amp;-d\\b&amp;a&amp;-d&amp;c\\c&amp;d&amp;a&amp;-b\\d&amp;-c&amp;b&amp;a\\\end{bmatrix}\end{equation}
\]</span></p>
<p>åŒæ ·çš„ï¼Œå³ä¹˜qç­‰åŒäºè¿™ä¸ªçŸ©é˜µ</p>
<p><span class="math display">\[
\begin{equation}R(q)=\begin{bmatrix}a&amp;-b&amp;-c&amp;-d\\b&amp;a&amp;d&amp;-c\\c&amp;-d&amp;a&amp;b\\d&amp;c&amp;-b&amp;a\\\end{bmatrix}\end{equation}
\]</span></p>
<p>å¯¹å…ˆå‰çš„<span
class="math inline">\(q=\begin{bmatrix}\cos({\frac{1}{2}\theta}),\sin({\frac{1}{2}\theta})\vec{u}\end{bmatrix}\)</span>ï¼Œå¯ä»¥è½¬æ¢æˆ<span
class="math inline">\(a=\cos(\frac{1}{2}\theta),
b=\sin(\frac{1}{2}\theta)u_x,c=\sin(\frac{1}{2}\theta)u_y,d=\sin(\frac{1}{2}\theta)u_z,
q=a+bi+cj+dk\)</span>ï¼Œæˆ‘ä»¬å°±èƒ½å¾—åˆ°</p>
<p><span class="math display">\[
\begin{equation}qvq^*=\begin{bmatrix}1&amp;0&amp;0&amp;0\\0&amp;1-c^2-2d^2&amp;2bc-2ad&amp;2ac+abd\\0&amp;2bx+2ad&amp;1-2b^2-2d^2&amp;2cd-2ab\\0&amp;2bd-2ac&amp;2ab+2cd&amp;1-2b^2-2c^2\end{bmatrix}v\end{equation}
\]</span></p>
<p>æ³¨æ„äº†ï¼Œè¿™é‡Œçš„<span
class="math inline">\(v\)</span>æ˜¯çº¯å››å…ƒæ•°ï¼Œç­‰å¼å·¦ä¾§ä¹Ÿæ˜¯å››å…ƒæ•°çš„å½¢å¼ä¸‹çš„3Dæ—‹è½¬</p>
<p>ç”±äºæˆ‘ä»¬çŸ¥é“<span
class="math inline">\(v=\begin{bmatrix}0,\vec{v}\end{bmatrix}\)</span>ï¼Œæ‰€ä»¥ä¸Šè¿°çŸ©é˜µçš„æœ€å¤–åœˆä¸ä¼šè¿›è¡Œä»»ä½•å˜æ¢ï¼Œå¯ä»¥å°†å®ƒå‹ç¼©æˆ3x3çš„çŸ©é˜µï¼Œ3Dæ—‹è½¬çš„çŸ©é˜µå½¢å¼ä¸å¦‚å››å…ƒæ•°å½¢å¼ç®€å•ï¼Œä¸”å ç”¨æ›´å¤šç©ºé—´ï¼Œä½†æ˜¯é¢„è®¡ç®—å¥½çš„çŸ©é˜µå¯¹äºå¤§æ‰¹é‡çš„å˜æ¢æ˜¯æ›´æœ‰æ•ˆç‡çš„ã€‚</p>
<p><span class="math display">\[
\begin{equation}\vec{v^\prime}=\begin{bmatrix}1-c^2-2d^2&amp;2bc-2ad&amp;2ac+abd\\2bx+2ad&amp;1-2b^2-2d^2&amp;2cd-2ab\\2bd-2ac&amp;2ab+2cd&amp;1-2b^2-2c^2\end{bmatrix}\vec{v}\end{equation}
\]</span></p>
<h2 id="todo-ä½ å¯èƒ½è¿˜ä¼šéœ€è¦">TODO ä½ å¯èƒ½è¿˜ä¼šéœ€è¦</h2>
<p>å››å…ƒæ•°æ¬§æ‹‰è§’ä¹‹é—´çš„å˜æ¢ï¼š<a
href="http://zhaoxuhui.top/blog/2018/03/13/RelationBetweenQ4&amp;R&amp;Euler.html#5%E6%AC%A7%E6%8B%89%E8%A7%92%E8%BD%AC%E5%9B%9B%E5%85%83%E7%B4%A0">http://zhaoxuhui.top/blog/2018/03/13/RelationBetweenQ4&amp;R&amp;Euler.html#5æ¬§æ‹‰è§’è½¬å››å…ƒç´ </a></p>
<p>è®©ä½ å¿«é€Ÿå˜æ¢çš„ç½‘ç«™å·¥å…·ï¼š</p>
<p><a
href="https://quaternions.online/">https://quaternions.online/</a></p>
<h2 id="ä¸‡å‘èŠ‚æ­»é”">ä¸‡å‘èŠ‚æ­»é”</h2>
<p>åŒ…å«äº†ä¸‡å‘èŠ‚æ­»é”çš„éƒ¨åˆ†é—®é¢˜ï¼Œä»¥Unityä¸ºä¾‹çš„å›ç­”</p>
<p><a
href="https://www.zhihu.com/question/321381903/answer/667753991">ä¸ºä»€ä¹ˆUnity3dæ—‹è½¬é»˜è®¤é‡‡ç”¨äº†æœ‰ä¸‡å‘èŠ‚æ­»é”çš„æ¬§æ‹‰è§’ï¼Œè€Œä¸ç”¨å››å…ƒæ•°ï¼Ÿ</a></p>
<p><a
href="https://krasjet.github.io/quaternion/bonus_gimbal_lock.pdf">bonus_gimbal_lock.pdf</a></p>
<p>ä¸ªäººå‘çš„æ¢³ç†æ€»ç»“ï¼š</p>
<p><strong>ä¸‡å‘èŠ‚æ­»é”ï¼ˆGimbal
Lockï¼‰</strong>ï¼Œæ˜¯æŒ‡åœ¨å°†ä¸€ä¸ªæ—‹è½¬æ‹†åˆ†æˆ<strong>ç‰©ä½“è‡ªèº«</strong>ä¸‰ä¸ªæ­£äº¤åæ ‡è½´ï¼Œå¹¶æŒ‰ç…§<strong>å›ºå®šæ¬¡åº</strong>æ—‹è½¬çš„æƒ…å†µä¸‹ï¼Œå­˜åœ¨ç‰¹æ®Šæƒ…å†µä½¿å¾—å…¶ä¸­çš„ä¸¤æ¬¡æ—‹è½¬å˜æ¢å®é™…ä¸Šå˜æ¢çš„æ˜¯åŒä¸€ä¸ªè½´ï¼ˆ<strong>å¤–éƒ¨è½´</strong>/<strong>ä¸–ç•Œåæ ‡è½´</strong>ï¼‰ã€‚</p>
<a href="/p/d376051877fb/GimbalLock.gif" class="gallery-item"><img src="/p/d376051877fb/GimbalLock.gif" class="" title="ç”¨Unityåšçš„æ¼”ç¤ºï¼Œå¯ä»¥çœ‹åˆ°yè½´æ—‹è½¬90Â°åzè½´æ­£æ–¹å‘å’ŒåŸå…ˆçš„xè½´æ­£æ–¹å‘ä¸€è‡´"></a>
<p>æ³¨æ„ï¼šç‰©ä½“è‡ªèº«çš„åæ ‡è½´æ­£æ–¹å‘ä¼šéšç€ç‰©ä½“çš„æ—‹è½¬è€Œæ”¹å˜ï¼Œè€Œå¤–éƒ¨è½´/ä¸–ç•Œåæ ‡è½´æ­£æ–¹å‘æ˜¯å§‹ç»ˆä¸å˜çš„ï¼Œä¸éšç€ç‰©ä½“æ—‹è½¬è€Œæ”¹å˜ã€‚åœ¨è¿ç»­çš„æ—‹è½¬å˜æ¢ä¸­ï¼Œä¸‹é¢ç»™å‡ºçš„æ—‹è½¬çŸ©é˜µé’ˆå¯¹çš„â€œè½´â€ï¼Œè¦ä»¥å¤–éƒ¨è½´/ä¸–ç•Œåæ ‡è½´çš„æ–¹å¼å»ç†è§£ã€‚</p>
<p>ä»æ•°å­¦ä¸Šç»™å‡ºç¤ºä¾‹è¿›è¡Œè§£é‡Šï¼Œé¦–å…ˆå¯¹äºxã€yã€zè½´ä¸Šçš„æ—‹è½¬ï¼Œæœ‰ä¸‹è¿°æ—‹è½¬çŸ©é˜µ</p>
<p><span class="math display">\[
\begin{equation}R_x(\theta)=\begin{bmatrix}1&amp;0&amp;0\\0&amp;\cos{\theta}&amp;-\sin{\theta}\\0&amp;sin{\theta}&amp;\cos{\theta}\end{bmatrix}\end{equation}
\]</span></p>
<p><span class="math display">\[
\begin{equation}R_y(\theta)=\begin{bmatrix}\cos{\theta}&amp;0&amp;\sin{\theta}\\0&amp;1&amp;0\\-\sin{\theta}&amp;0&amp;\cos{\theta}\end{bmatrix}\end{equation}
\]</span></p>
<p><span class="math display">\[
\begin{equation}R_z(\theta)=\begin{bmatrix}\cos{\theta}&amp;-sin{\theta}&amp;0\\\sin{\theta}&amp;\cos{\theta}&amp;0\\0&amp;0&amp;1\end{bmatrix}\end{equation}
\]</span></p>
<p>æˆ‘ä»¬å›ºå®šæŒ‰ç…§xã€yã€zè½´çš„é¡ºåºè¿›è¡Œæ—‹è½¬ï¼Œå¹¶å‡è®¾æ²¿xè½´æ—‹è½¬ä»»æ„åº¦ï¼Œæ²¿yè½´æ—‹è½¬90Â°ï¼Œå†æ²¿zè½´æ—‹è½¬ä»»æ„åº¦ï¼Œå¯ä»¥å¾—åˆ°å¦‚ä¸‹ç»“æœï¼šæ²¿ç‰©ä½“yè½´æ—‹è½¬åï¼Œç‰©ä½“zè½´å˜æ¢åˆ°äº†åŸæ¥ç‰©ä½“xè½´çš„æ–¹å‘ï¼ˆå³åŒä¸€ä¸ªä¸–ç•Œè½´æ–¹å‘ï¼‰ã€‚ä¹Ÿå°±æ˜¯è¯´<strong>ä¸‰æ¬¡æ—‹è½¬å˜æ¢ä»…ä»…è¦†ç›–äº†ä¸¤ä¸ªå¤–éƒ¨è½´/ä¸–ç•Œè½´çš„æ—‹è½¬</strong>ï¼Œä¸€ä¸ªè‡ªç”±åº¦å°±è¿™æ ·ä¸¢å¤±äº†ï¼Œè¿™ä¹Ÿå°±å¯¼è‡´äº†Gimbal
Lockçš„ç°è±¡ã€‚</p>
<p>å°†å˜æ¢ç”¨å…¬å¼è¿›è¡Œç†è§£ï¼š</p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}E(\alpha,\frac{\pi}{2},\beta)&amp;=R_z(\beta)R_y(\frac{\pi}{2})R_x(\alpha)\\&amp;=\begin{bmatrix}0&amp;\sin({\alpha-\beta})&amp;\cos({\alpha-\beta})\\0&amp;\cos({\alpha-\beta})&amp;-\sin({\alpha-\beta})\\-1&amp;0&amp;0\\\end{bmatrix}\\&amp;=R_y(\frac{\pi}{2})R_x(\alpha-\beta)\end{aligned}\end{equation}
\]</span></p>
<p>*è¡¥å……è§£é‡Šåœ¨ä¸€äº›æ—‹è½¬æè¿°ä¸­å¯èƒ½çœ‹åˆ°çš„æœ¯è¯­ï¼špitchæ˜¯ä¿¯ä»°è§’ï¼Œå›´ç»•xè½´è½¬åŠ¨ï¼›yawæ˜¯åèˆªè§’ï¼Œå›´ç»•yè½´è½¬åŠ¨ï¼›rollæ˜¯ç¿»æ»šè§’ï¼Œå›´ç»•zè½´è½¬åŠ¨ã€‚èµ·æºäºèˆªç©ºæœ¯è¯­ï¼Œæƒ³è±¡ä¸€æ¶é£æœºï¼Œå¤´éƒ¨æŒ‡å‘zè½´æ­£æ–¹å‘ï¼Œå·¦æœºç¿¼æŒ‡å‘xè½´æ­£æ–¹å‘ï¼Œå¯èƒ½ä¼šæ˜“äºç†è§£ã€‚</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºå›¾å½¢å­¦</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>å¤æ•°</tag>
        <tag>å››å…ƒæ•°</tag>
        <tag>ä¸‡å‘èŠ‚æ­»é”</tag>
      </tags>
  </entry>
  <entry>
    <title>å‘æœç´¢å¼•æ“æäº¤hexoç«™ç‚¹sitemap</title>
    <url>/p/e620710b2f05/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1
id="å‘æœç´¢å¼•æ“æäº¤hexoç«™ç‚¹sitemap">å‘æœç´¢å¼•æ“æäº¤hexoç«™ç‚¹sitemap</h1>
<h2 id="ç®€ä»‹">ç®€ä»‹</h2>
<p>ä¸ºè‡ªå·±çš„ç«™ç‚¹åˆ›å»ºsitemapï¼Œå¹¶é€šè¿‡æœç´¢å¼•æ“æä¾›çš„åå°å·¥å…·è¿›è¡Œæäº¤ï¼Œå¯ä»¥å¢å¼ºä¸ªäººç½‘ç«™çš„æ›å…‰ç‡ã€‚è¿™é‡Œç®€å•è®°å½•ä¸€ä¸‹hexoè¦å¦‚ä½•ç”Ÿæˆsitemapï¼Œå¹¶æäº¤åˆ°å„å¤§æœç´¢å¼•æ“ä¸Šã€‚</p>
<h2 id="ç”Ÿæˆsitemap">ç”Ÿæˆsitemap</h2>
<ol type="1">
<li><p>è¿›å…¥åˆ°ä¸ªäººhexoåšå®¢<code>_config.yml</code>åŒçº§ç›®å½•ä¸‹ï¼Œä½¿ç”¨npmå®‰è£…<code>hexo-generator-sitemap</code>ä»¥åŠ<code>hexo-generator-baidu-sitemap</code>ï¼Œå‘½ä»¤å¦‚ä¸‹</p>
<pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">npm install hexo-generator-sitemap --save
npm install hexo-generator-baidu-sitemap --save</code></pre></li>
<li><p>å®‰è£…å®Œæˆåï¼Œç¼–è¾‘åšå®¢çš„é…ç½®æ–‡ä»¶<code>_config.yml</code>ï¼ŒåŠ å…¥ä»¥ä¸‹å†…å®¹</p>
<pre class="line-numbers language-yaml" data-language="yaml"><code class="language-yaml"># For generating google &#x2F; bing &#x2F; baidu sitemapâ†“
Plugins:
- hexo-generator-sitemap
- hexo-generator-baidu-sitemap

baidusitemap:
  path: baidusitemap.xml # ç™¾åº¦ç”¨çš„sitemapç”Ÿæˆåœ¨publicæ ¹ç›®å½•çš„æ­¤æ–‡ä»¶å†…
sitemap:
  path: sitemap.xml # å…¶ä»–sitemapç”Ÿæˆåœ¨publicæ ¹ç›®å½•çš„æ­¤æ–‡ä»¶å†…</code></pre></li>
</ol>
<span id="more"></span>
<ol start="3" type="1">
<li><p>å›åˆ°ä¸ªäººåšå®¢æ ¹ç›®å½•ï¼Œæ‰§è¡Œ<code>hexo g -d</code>
ç”Ÿæˆå¹¶éƒ¨ç½²ï¼ˆthreegatesæ˜¯éƒ¨ç½²åœ¨github-pagesä¸Šçš„ï¼‰ï¼Œè§‚å¯Ÿåˆ°ä»¥ä¸‹è¾“å‡ºåˆ™ä¸ºç”ŸæˆæˆåŠŸ</p>
<a href="/p/e620710b2f05/image-20221211173054833.png" class="gallery-item"><img src="/p/e620710b2f05/image-20221211173054833.png" class="" title="å‘½ä»¤æ•°æ®ç»“æœ"></a></li>
<li><p>ç­‰å¾…githubéƒ¨ç½²å®Œæˆåï¼Œè®¿é—®ä¸ªäººåšå®¢ç«™ç‚¹<code>url/sitemap.xml</code>èƒ½è®¿é—®åˆ°å¯¹åº”xmlå†…å®¹å³ç”ŸæˆæˆåŠŸ</p></li>
</ol>
<h2 id="æäº¤sitemap">æäº¤sitemap</h2>
<p>å‡ å¤§å¸¸ç”¨æœç´¢å¼•æ“å¯¹åº”çš„ç«™ç‚¹ç®¡ç†å‘˜åå°ï¼Œæäº¤sitemapä½ç½®å¦‚ä¸‹ï¼š</p>
<ol type="1">
<li><p>Googleï¼š<a href="https://search.google.com/search-console">Google
Search Console</a> éœ€è¦å…ˆæ³¨å†Œè‡ªå·±çš„ç«™ç‚¹èµ„æºï¼Œæäº¤ä½ç½®å¦‚ä¸‹</p>
<a href="/p/e620710b2f05/image-20221211173607448.png" class="gallery-item"><img src="/p/e620710b2f05/image-20221211173607448.png" class="" title="image-20221211173607448"></a></li>
<li><p>Bingï¼š<a href="https://www.bing.com/webmasters/">Webmaster
Tools</a> åŒä¸Šï¼Œæäº¤ä½ç½®åœ¨</p>
<a href="/p/e620710b2f05/image-20221211173724782.png" class="gallery-item"><img src="/p/e620710b2f05/image-20221211173724782.png" class="" title="image-20221211173724782"></a></li>
<li><p>ç™¾åº¦ï¼š<a
href="https://ziyuan.baidu.com/linksubmit/index">æœç´¢èµ„æºå¹³å°</a>
ä½¿ç”¨çš„æ˜¯<strong>æ™®é€šæ”¶å½•</strong>ä¸‹çš„sitemapæ–¹æ³•ï¼Œä¹Ÿç±»ä¼¼ä¸Šé¢ä¸¤ç§ï¼Œå¡«å†™xmlæ–‡ä»¶åœ°å€å³å¯</p>
<a href="/p/e620710b2f05/image-20221211173911628.png" class="gallery-item"><img src="/p/e620710b2f05/image-20221211173911628.png" class="" title="image-20221211173911628"></a></li>
</ol>
<h2 id="ç»“è¯­">ç»“è¯­</h2>
<p>threegatesçš„sitemapå·²ç»ä¸Šä¼ åˆ°ä¸Šè¿°å‡ ä¸ªæœç´¢å¹³å°ä¸Šäº†ï¼Œæœªæ¥å‡ å¤©ä¼šå…³æ³¨ä¸€ä¸‹æœç´¢å¾—åˆ°çš„ç»“æœå¦‚ä½•ï¼Œå¦‚æœæœ‰ä¸é”™çš„ç»“æœå†åˆ°è¿™ç¯‡åšå®¢é‡ŒåŒæ­¥ä¸€ä¸‹ã€‚</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>åšå®¢æ­å»º</category>
        <category>hexo</category>
      </categories>
      <tags>
        <tag>åšå®¢æ­å»º</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ŠThe Way to Goã€‹Chapter13 é”™è¯¯å¤„ç†ä¸æµ‹è¯•</title>
    <url>/p/e22df32995f4/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="chapter-13-é”™è¯¯å¤„ç†ä¸æµ‹è¯•">Chapter 13 é”™è¯¯å¤„ç†ä¸æµ‹è¯•</h1>
<h2 id="é”™è¯¯å¤„ç†ä¸æµ‹è¯•">é”™è¯¯å¤„ç†ä¸æµ‹è¯•</h2>
<ol type="1">
<li><p>Goé€šå¸¸åœ¨å‡½æ•°å’Œæ–¹æ³•ä¸­è¿”å›é”™è¯¯å¯¹è±¡ä½œä¸ºè¿”å›å€¼ï¼Œå¦‚æœè¿”å›nilåˆ™æ²¡æœ‰é”™è¯¯å‘ç”Ÿ</p></li>
<li><p>æ°¸è¿œä¸è¦å¿½ç•¥é”™è¯¯ï¼Œå¦åˆ™å¯èƒ½ä¼šå¯¼è‡´ç¨‹åºå´©æºƒï¼è°ƒç”¨å‡½æ•°åå¿…é¡»æ£€æŸ¥é”™è¯¯</p></li>
<li><p>ä¸ºäº†è®©ä»£ç æ›´æ¸…æ™°ï¼Œåº”è¯¥ä½¿ç”¨åŒ…å«é”™è¯¯å€¼å˜é‡çš„if ç¬¦åˆè¯­å¥</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">if value, err :&#x3D; pack1.Func1(param1); err !&#x3D; nil &#123;
	fmt.Printf(&quot;Error %s in pack1.Func1 with parameter %v&quot;, err.Error(), param1)
	return    &#x2F;&#x2F; or: return err
&#125; else &#123;
	&#x2F;&#x2F; Process(value)
&#125;</code></pre></p></li>
</ol>
<span id="more"></span>
<h2 id="é”™è¯¯å¤„ç†">é”™è¯¯å¤„ç†</h2>
<ol type="1">
<li><p>ä½¿ç”¨errorsåŒ…æ¥åˆ›å»ºä¸€ä¸ªé”™è¯¯ç±»å‹å¯¹è±¡ï¼Œé™„å¸¦ä¸Šé”™è¯¯ä¿¡æ¯</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">err :&#x3D; errors.New(&quot;math - square root of negative number&quot;)</code></pre></p></li>
<li><p>è‡ªå®šä¹‰ä¸€ä¸ªé”™è¯¯ç»“æ„ï¼Œé™¤äº†ä½å±‚çº§é”™è¯¯ä¿¡æ¯è¿˜é™„å¸¦ä¸€äº›é¢å¤–ä¿¡æ¯ï¼›åœ¨ä¸åŒé”™è¯¯å¯èƒ½å‘ç”Ÿçš„åœºæ™¯ä¸‹ï¼Œå¯¹é”™è¯¯ä½¿ç”¨ç±»å‹æ–­è¨€/ç±»å‹åˆ¤æ–­(type-switch)</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">&#x2F;&#x2F; PathError records an error and the operation and file path that caused it.
type PathError struct &#123;
	Op string    &#x2F;&#x2F; &quot;open&quot;, &quot;unlink&quot;, etc.
	Path string  &#x2F;&#x2F; The associated file.
	Err error  &#x2F;&#x2F; Returned by the system call. ä½å±‚çº§é”™è¯¯ä¿¡æ¯
&#125;

&#x2F;&#x2F;  err !&#x3D; nil
if e, ok :&#x3D; err.(*os.PathError); ok &#123;
	&#x2F;&#x2F; remedy situation
&#125;</code></pre></p></li>
</ol>
<h2 id="è¿è¡Œæ—¶å¼‚å¸¸å’Œpanic">è¿è¡Œæ—¶å¼‚å¸¸å’Œpanic</h2>
<ol type="1">
<li>å½“å‘ç”Ÿäº†éœ€è¦å°†ç¨‹åºåœæ­¢çš„é”™è¯¯æ—¶ï¼Œä½¿ç”¨<code>panic()</code>äº§ç”Ÿä¸€ä¸ªä¸­æ­¢ç¨‹åºçš„è¿è¡Œæ—¶é”™è¯¯ã€‚</li>
<li>ä¼ é€’ä»»æ„ç±»å‹çš„å‚æ•°ç»™<code>panic()</code>ï¼Œä¼šåœ¨ç¨‹åºç»ˆæ­¢çš„ä¿¡æ¯ä¸­è¢«æ‰“å°å‡ºæ¥ã€‚</li>
<li><code>panic()</code>æ‰€åœ¨å‡½æ•°çš„åä¸€è¡Œä»£ç ä¸ä¼šæ‰§è¡Œï¼Œä½†panicä¼šæŠŠæ‰§è¡Œæ§åˆ¶æƒäº¤è¿˜ç»™ä¸Šå±‚ï¼Œå¹¶æ‰§è¡Œæ¯å±‚çš„deferï¼Œè¿™ä¸ªè¿‡ç¨‹å«åš<code>panicking</code></li>
</ol>
<h2 id="ä»panicä¸­æ¢å¤recover">ä»panicä¸­æ¢å¤ï¼ˆrecoverï¼‰</h2>
<p><code>recover</code>åªèƒ½åœ¨<code>defer</code>ä¿®é¥°çš„å‡½æ•°ä¸­ä½¿ç”¨ï¼Œå¦‚æœå‘ç”Ÿäº†panicï¼Œé‚£ä¹ˆ<code>defer</code>ä¿®é¥°çš„å‡½æ•°ä¼šæ‰§è¡Œï¼Œä¸”<code>recover</code>å°†å¾—åˆ°å¯¹åº”çš„é”™è¯¯å€¼ï¼Œå¦è€…å°†è¿”å›nilå¹¶ä¸”æ²¡æœ‰å…¶ä»–æ•ˆæœ</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">func protect(g func()) &#123;
	defer func() &#123;
		log.Println(&quot;done&quot;)
		&#x2F;&#x2F; Println executes normally even if there is a panic
		if err :&#x3D; recover(); err !&#x3D; nil &#123;
			log.Printf(&quot;run time panic: %v&quot;, err)
		&#125; &#x2F;&#x2F; è¿™é‡Œä¹‹åæ‰§è¡Œprotect()ä¹‹åçš„æŒ‡ä»¤
	&#125;()
	log.Println(&quot;start&quot;)
	g() &#x2F;&#x2F;   possible runtime-error
&#125;</code></pre>
<h2
id="è‡ªå®šä¹‰åŒ…ä¸­çš„é”™è¯¯å¤„ç†å’Œpanicking">è‡ªå®šä¹‰åŒ…ä¸­çš„é”™è¯¯å¤„ç†å’Œpanicking</h2>
<p>åº”è¯¥éµå®ˆçš„æœ€ä½³å®è·µï¼š</p>
<ol type="1">
<li>åœ¨åŒ…å†…éƒ¨ï¼Œæ€»æ˜¯åº”è¯¥ä»panicä¸­recoverï¼Œä¸å…è®¸æ˜¾å¼çš„è¶…å‡ºåŒ…èŒƒå›´çš„panic()</li>
<li>å‘åŒ…çš„è°ƒç”¨è€…è¿”å›é”™è¯¯å€¼ï¼ˆè€Œä¸æ˜¯panicï¼‰</li>
</ol>
<h2 id="goä¸­çš„å•å…ƒæµ‹è¯•å’ŒåŸºå‡†æµ‹è¯•">Goä¸­çš„å•å…ƒæµ‹è¯•å’ŒåŸºå‡†æµ‹è¯•</h2>
<p>æµ‹è¯•ä½¿ç”¨çš„å·¥å…·æ˜¯gotestï¼Œä½¿ç”¨åä¸º<code>testing</code>çš„åŒ…ï¼Œæµ‹è¯•ä»£ç å’ŒåŒ…ä¸­çš„ä¸šåŠ¡ä»£ç æ˜¯åˆ†å¼€çš„ï¼Œ<code>_test</code>ä»£ç ä¸ç¨‹åºä¸ä¼šè¢«æ™®é€šçš„Goç¼–è¯‘å™¨ç¼–è¯‘ï¼Œåªæœ‰gotestä¼šç¼–è¯‘æ‰€æœ‰çš„ç¨‹åºã€‚</p>
<p>ä½¿ç”¨<code>go
test</code>æ¥ç¼–è¯‘æµ‹è¯•ç¨‹åºï¼Œå¯¹äºé€šè¿‡çš„æµ‹è¯•ä¼šæ‰“å°PASSï¼Œå¯¹äº<code>go test
-test.bench=.*</code>ä¼šè¿è¡ŒåŸºå‡†æµ‹è¯•ï¼Œè°ƒç”¨Næ¬¡å¹¶å±•ç¤ºNæ¬¡çš„å€¼å’Œæ‰§è¡Œçš„å¹³å‡æ—¶é—´ã€‚</p>
<h2 id="æ€§èƒ½è°ƒè¯•åˆ†æå¹¶ä¼˜åŒ–goç¨‹åº">æ€§èƒ½è°ƒè¯•ï¼šåˆ†æå¹¶ä¼˜åŒ–Goç¨‹åº</h2>
<ol type="1">
<li><p>unixå‘½ä»¤è¡Œä¸­å¯ä»¥ä½¿ç”¨<code>time</code>å‘½ä»¤ï¼Œè¾“å‡ºç¨‹åºçš„æ‰§è¡Œæ—¶é—´å’Œå†…å­˜å ç”¨ç­‰</p></li>
<li><p>ä½¿ç”¨Goä¸­çš„<code>testing</code>åŒ…è¿›è¡ŒåŸºå‡†æµ‹è¯•ï¼Œä½¿ç”¨-cpuprofile /
-memprofile æ ‡å¿—å‘æŒ‡å®šæ–‡ä»¶å†™å…¥CPUæˆ–å†…å­˜ä½¿ç”¨æƒ…å†µæŠ¥å‘Š</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">go test -x -v -cpuprofile&#x3D;prof.out -file x_test.go</code></pre></p></li>
<li><p>å¯ä»¥åœ¨ç¨‹åºä¸­å¼•å…¥ <code>runtime/pprof</code>
åŒ…ï¼Œè¿™ä¸ªåŒ…ä»¥pprofå¯è§†åŒ–å·¥å…·éœ€è¦çš„æ ¼å¼å†™å…¥è¿è¡Œæ—¶æŠ¥å‘Šæ•°æ®ã€‚gopprofæ˜¯Google
pprofC++
åˆ†æå™¨çš„ä¸€ä¸ªè½»å¾®å˜ç§ï¼Œå¦‚æœå¼€å¯æ­¤æ€§èƒ½åˆ†æï¼ŒGoç¨‹åºä¼šä»¥å¤§çº¦æ¯ç§’100æ¬¡çš„é¢‘ç‡é˜»å¡ã€‚ä¸ºå®ç°æ€§èƒ½åˆ†æï¼Œä½ å¯ä»¥åƒä¸‹é¢è¿™æ ·æ·»åŠ ä»£ç ï¼š</p></li>
</ol>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">var cpuprofile &#x3D; flag.String(&quot;cpuprofile&quot;, &quot;&quot;, &quot;write cpu profile to file&quot;)

func main() &#123;
	flag.Parse()
	if *cpuprofile !&#x3D; &quot;&quot; &#123;
		f, err :&#x3D; os.Create(*cpuprofile)
		if err !&#x3D; nil &#123;
			log.Fatal(err)
		&#125;
		pprof.StartCPUProfile(f)
		defer pprof.StopCPUProfile()
	&#125;
...</code></pre>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ç¼–ç¨‹è¯­è¨€</category>
        <category>Go</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹è¯­è¨€</tag>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ŠThe Way to Goã€‹Chapter14 åç¨‹</title>
    <url>/p/4aa7a9cb350b/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="chapter-14">Chapter 14</h1>
<h2
id="åç¨‹goroutineä¸é€šé“channel">åç¨‹ï¼ˆgoroutineï¼‰ä¸é€šé“ï¼ˆchannelï¼‰</h2>
<p>Goä¸ºæ„å»ºå¹¶å‘ç¨‹åºçš„åŸºæœ¬ä»£ç å—æ˜¯åç¨‹ä¸é€šé“ï¼Œéœ€è¦è¯­è¨€ã€ç¼–è¯‘å™¨å’Œruntimeæ”¯æŒã€‚Goè¯­è¨€æä¾›çš„åƒåœ¾å›æ”¶å™¨å¯¹å¹¶å‘ç¼–ç¨‹è‡³å…³é‡è¦ï¼ˆï¼Ÿï¼‰ã€‚</p>
<p>åŸåˆ™ï¼š<strong>ä¸è¦é€šè¿‡å…±äº«å†…å­˜æ¥é€šä¿¡ï¼Œè€Œé€šè¿‡é€šä¿¡æ¥å…±äº«å†…å­˜ã€‚</strong></p>
<span id="more"></span>
<h2 id="å¹¶å‘å¹¶è¡Œå’Œåç¨‹">å¹¶å‘ã€å¹¶è¡Œå’Œåç¨‹</h2>
<ol type="1">
<li>å¤ä¹ ï¼šè¿›ç¨‹çš„å¤æ•°çº¿ç¨‹æ˜¯å…±äº«åŒä¸€åœ°å€ç©ºé—´çš„ä¸€èµ·å·¥ä½œçš„æ‰§è¡Œä½“ï¼Œåªæœ‰åœ¨å¤šæ ¸ã€å¤šå¤„ç†å™¨ä¸Šå¹¶å‘ç¨‹åºæ‰èƒ½åšåˆ°å¹¶è¡Œã€‚</li>
<li>Goä¸­ï¼Œå¹¶å‘å¤„ç†çš„éƒ¨åˆ†è¢«ç§°ä¸º
<code>goroutinesï¼ˆgoåç¨‹ï¼‰</code>ï¼Œåœ¨åç¨‹ä¸æ“ä½œç³»ç»Ÿçº¿ç¨‹ä¹‹é—´æ— ä¸€å¯¹ä¸€çš„å…³ç³»ï¼›åç¨‹æ˜¯æ ¹æ®ä¸€ä¸ª/å¤šä¸ªçº¿ç¨‹çš„å¯ç”¨æ€§ï¼Œæ˜ å°„åœ¨å®ƒä»¬ä¹‹ä¸Šçš„ã€‚â€œåç¨‹è°ƒåº¦å™¨â€åœ¨<strong>Goè¿è¡Œæ—¶</strong>å®Œæˆè¿™ä¸ªå·¥ä½œã€‚</li>
<li>åç¨‹æ˜¯è½»é‡çš„ï¼Œæ¯”çº¿ç¨‹æ›´è½»ã€‚åœ¨å †ä¸­åˆ›å»ºåç¨‹ï¼Œä¸”åç¨‹å¯¹æ ˆè¿›è¡Œäº†åˆ†å‰²ï¼Œä»è€ŒåŠ¨æ€å¢åŠ ç¼©å‡å†…å­˜çš„ä½¿ç”¨ã€‚</li>
<li>åç¨‹é€šè¿‡å…³é”®å­—goè°ƒç”¨ï¼ˆæ‰§è¡Œä¸€ä¸ªå‡½æ•°æˆ–æ–¹æ³•ï¼‰æ¥å®ç°ï¼Œè°ƒç”¨åå³ä¼šåˆ†é…å‡ºç‹¬ç«‹çš„æ ˆï¼Œå¼€å§‹åŒæ—¶è¿›è¡Œçš„è®¡ç®—è¿‡ç¨‹ï¼ˆå¹¶å‘
/ å¹¶è¡Œï¼‰ï¼›åç¨‹çš„æ ˆä¼šæ ¹æ®éœ€è¦è¿›è¡Œä¼¸ç¼©ï¼Œä¸ä¼šå‡ºç°æ ˆæº¢å‡ºï¼ˆï¼Ÿï¼‰</li>
<li>mainå‡½æ•°ä¹Ÿè¢«çœ‹ä½œæ˜¯ä¸€ä¸ªgoåç¨‹</li>
<li>å½“mainå‡½æ•°è¿”å›çš„æ—¶å€™ï¼Œç¨‹åºé€€å‡ºï¼Œä¸ä¼šç­‰å¾…ä»»ä½•émainåç¨‹çš„ç»“æŸï¼Œæ‰€ä»¥åœ¨æœåŠ¡å™¨ç¨‹åºä¸­ï¼Œä¸€èˆ¬ä¼šç»™æ¯ä¸ªè¯·æ±‚å¯åŠ¨ä¸€ä¸ªåç¨‹ï¼Œè€Œserverå‡½æ•°ä½¿ç”¨ä¸€ä¸ªæ— é™å¾ªç¯æ¥ä¿æŒè¿è¡ŒçŠ¶æ€</li>
</ol>
<h3 id="ä½¿ç”¨-gomaxprocs">ä½¿ç”¨ GOMAXPROCS</h3>
<ol type="1">
<li>è®¾ç½®ç¯å¢ƒå˜é‡ï¼Œæˆ–è€…ä½¿ç”¨<code>runtime.GOMAXPROCS(n)</code>
æ¥è®¾ç½®å…è®¸è¿è¡Œæ—¶ä½¿ç”¨å¤šå°‘ä¸ªæ“ä½œç³»ç»Ÿçº¿ç¨‹ï¼Œå¦‚æœæœªè®¾ç½®<code>GOMAXPROCS</code>ï¼Œåˆ™æ‰€æœ‰åç¨‹ä¼šå…±äº«åŒä¸€ä¸ªçº¿ç¨‹ã€‚</li>
<li>ç»éªŒï¼šå¯¹nä¸ªæ ¸å¿ƒçš„æƒ…å†µè®¾ç½®GOMAXPROCSä¸ºn-1æ¥è·å¾—æœ€ä½³æ€§èƒ½</li>
<li>å¯ä»¥éµå¾ªçš„è§„åˆ™ï¼šåç¨‹çš„æ•°é‡ &gt; 1 + GOMAXPROCS &gt; 1</li>
</ol>
<h3 id="goåç¨‹ä¸åç¨‹">Goåç¨‹ä¸åç¨‹</h3>
<p>Goåç¨‹ä¸å…¶ä»–è¯­è¨€ä¸­çš„åç¨‹æœ‰ä¸¤ç‚¹ä¸åŒï¼š</p>
<ol type="1">
<li>Goåç¨‹æ„å‘³ç€å¹¶è¡Œï¼Œä½†åç¨‹ä¸€èˆ¬æ¥è¯´ä¸æ˜¯è¿™æ ·çš„</li>
<li>Goåç¨‹é€šè¿‡é€šé“channelæ¥é€šä¿¡ï¼›åç¨‹é€šè¿‡è®©å‡ºï¼ˆawaitï¼‰å’Œæ¢å¤ï¼ˆasyncï¼‰æ“ä½œæ¥é€šä¿¡</li>
</ol>
<h2 id="åç¨‹é—´çš„ä¿¡é“">åç¨‹é—´çš„ä¿¡é“</h2>
<ol type="1">
<li><p>Goå°†<strong>é€šé“(channel)</strong>ä½œä¸ºä¸€ç§ç‰¹æ®Šçš„ç±»å‹ï¼Œç”¨äºå‘é€ç±»å‹åŒ–æ•°æ®çš„ç®¡é“ï¼Œç”±å…¶è´Ÿè´£åç¨‹ä¹‹é—´çš„é€šä¿¡ã€‚åœ¨<strong>ä»»ä½•ç»™å®šæ—¶é—´</strong>ï¼Œä¸€ä¸ªæ•°æ®è¢«è®¾è®¡ä¸º<strong>åªæœ‰ä¸€ä¸ªåç¨‹å¯ä»¥å¯¹å…¶è®¿é—®</strong>ï¼Œæ‰€ä»¥ä¸ä¼šå‘ç”Ÿæ•°æ®ç«äº‰</p></li>
<li><p>é€šé“ä¹Ÿæ˜¯<strong>å¼•ç”¨ç±»å‹</strong>ï¼Œé€šé“çš„å£°æ˜ä¸å®ä¾‹åŒ–æ–¹å¼</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">var ch1 chan string
ch1 &#x3D; make(chan string)
&#x2F;&#x2F; ç²¾ç®€å½¢å¼
ch1 :&#x3D; make(chan string)</code></pre></p></li>
<li><p>ä½¿ç”¨æ“ä½œç¬¦<code>&lt;-</code> æ¥è¡¨ç¤ºæ•°æ®çš„ä¼ è¾“ï¼Œ<code>ch &lt;-
int1</code>
è¡¨ç¤ºç”¨é€šé“<code>ch</code>å‘é€å˜é‡<code>int1</code>ï¼Œ<code>int2 = â†
ch</code>
è¡¨ç¤ºï¼Œä»é€šé“<code>ch</code>ä¸­å–å‡ºæ•°æ®ï¼Œèµ‹å€¼ç»™<code>int2</code></p></li>
<li><p>é€šé“çš„å‘é€å’Œæ¥æ”¶éƒ½æ˜¯<strong>åŸå­æ“ä½œ</strong>ï¼Œå®ƒä»¬äº’ä¸å¹²æ‰°åœ°å®Œæˆ</p></li>
</ol>
<h3 id="é€šé“é˜»å¡">é€šé“é˜»å¡</h3>
<p>é»˜è®¤æƒ…å†µä¸‹é€šé“æ˜¯<strong>åŒæ­¥</strong>ä¸”<strong>æ— ç¼“å†²</strong>çš„ â†’
å‘é€/æ¥æ”¶æ“ä½œåœ¨å¯¹æ–¹å¤„ç†å®Œä¹‹å‰æ˜¯é˜»å¡çš„ï¼š</p>
<ol type="1">
<li>å¦‚æœé€šé“ä¸­çš„æ•°æ®æ— äººæ¥æ”¶ï¼Œå°±æ— æ³•å†ç»™é€šé“ä¼ å…¥å…¶ä»–æ•°æ®ï¼Œå‘é€è€…é˜»å¡ï¼›å‘é€æ“ä½œä¼šç­‰å¾…åˆ°é€šé“é‡æ–°å˜ä¸ºå¯ç”¨çŠ¶æ€ï¼Œå³é€šé“ä¸­æ²¡æœ‰æ•°æ®
/ é€šé“ä¸ºç©ºçš„æƒ…å†µ â†’
å³å‘å®Œä¹‹åå¦‚æœé€šé“æ²¡æœ‰è¢«æ¥æ”¶è€…å¤„ç†æ¸…ç©ºï¼Œå‘é€æ“ä½œé˜»å¡</li>
<li>å¦‚æœé€šé“ä¸­æ²¡æœ‰æ•°æ®ï¼Œæ¥æ”¶è€…é˜»å¡ï¼›æ¥æ”¶æ“ä½œä¼šç­‰å¾…åˆ°é€šé“é‡æ–°å˜ä¸ºå¯ç”¨çŠ¶æ€ï¼Œå³é€šé“ä¸­æœ‰æ•°æ®
/ é€šé“å·²æ»¡çš„æƒ…å†µ â†’
å³æ¥æ”¶å®Œä¹‹åå¦‚æœé€šé“æ²¡æœ‰è¢«å‘é€è€…å¡æ»¡ï¼Œè¯»å–æ“ä½œé˜»å¡</li>
</ol>
<p>ä¸å¸¦ç¼“å†²çš„é€šé“ä¼ é€’æœ‰ç‚¹åƒä¸¤ä¸ªäººä¼ é€’ä¸œè¥¿ï¼Œå¦‚æœä¼ å‡ºå»æ²¡æœ‰å¯¹æ–¹æ¥èµ°ï¼Œäººå°±ç¦»å¼€äº†ï¼ˆä¸é˜»å¡ï¼‰ï¼Œä¸œè¥¿å°±ä¼šæ‰ä¸‹å»ã€‚ä¼ å‡ºå»å¿…é¡»è¦ç­‰åˆ°å¯¹æ–¹æ¥èµ°ï¼Œè‡ªå·±æ‰èƒ½ç»§ç»­åšå…¶ä»–äº‹æƒ…ï¼Œæ‰€ä»¥æ˜¯åŒæ­¥çš„ã€‚</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">func f1(in chan int) &#123;
	fmt.Println(&lt;-in)
&#125;

func main() &#123;
	out :&#x3D; make(chan int)
	out &lt;- 2
	go f1(out) &#x2F;&#x2F; out ä¸­çš„ 2 æ— äººæ¥æ”¶ï¼Œmainåç¨‹ä¸­çš„&#39;go f1(out)&#39;è¢«é˜»å¡
&#125;</code></pre>
<h3 id="åŒæ­¥é€šé“-ä½¿ç”¨å¸¦ç¼“å†²çš„é€šé“">åŒæ­¥é€šé“-ä½¿ç”¨å¸¦ç¼“å†²çš„é€šé“</h3>
<p>ä¸å¸¦ç¼“å†²çš„é€šé“å®¹é‡æ˜¯0ï¼Œé€šä¿¡è¦åŒæ–¹éƒ½å‡†å¤‡å¥½äº†æ‰èƒ½è¿›è¡Œï¼Œå®¹é‡1å’Œæ— ç¼“å†²ç»å¯¹æ˜¯ä¸ä¸€æ ·çš„ã€‚</p>
<p>æ‹“å±•makeå‘½ä»¤æ¥è®¾ç½®é€šé“å®¹é‡ï¼Œç”¨äºæä¾›ç¼“å­˜</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">buf :&#x3D; 100
ch1 :&#x3D; make(chan string, buf) &#x2F;&#x2F; buf æ˜¯é€šé“å¯ä»¥å®¹çº³å…ƒç´ çš„ä¸ªæ•°</code></pre>
<p>å®¹é‡å¤§äº0çš„é€šé“å°±æ˜¯å¼‚æ­¥çš„äº†ï¼Œå¯¹äºå‘é€æ“ä½œæ¥è¯´ï¼Œåœ¨å‘é€åˆ°é€šé“æ»¡è½½ä¹‹å‰ä¸ä¼šé˜»å¡ï¼›å¯¹äºæ¥æ”¶æ“ä½œæ¥è¯´ï¼Œåœ¨æ¥æ”¶åˆ°é€šé“å˜ç©ºä¹‹å‰ä¹Ÿä¸ä¼šé˜»å¡ï¼›</p>
<h3 id="ä¿¡å·é‡æ¨¡å¼">ä¿¡å·é‡æ¨¡å¼</h3>
<p>å¯ä»¥åœ¨åç¨‹ç»“æŸæ—¶å¾€é€šé“ä¸­æ”¾ç½®ä¸€ä¸ªå€¼ä½œä¸ºå¤„ç†ç»“æŸçš„ä¿¡å·ï¼Œè€Œåœ¨<code>main()</code>åç¨‹ä¸­ç­‰å¾…ä»è¿™ä¸ªé€šé“ä¸­å–å¾—å€¼ï¼Œæ¥ä¿è¯<code>main</code>ä¸ä¼šæå‰ç»“æŸ</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">type Empty interface &#123;&#125;
var empty Empty
...
data :&#x3D; make([]float64, N)
res :&#x3D; make([]float64, N)
sem :&#x3D; make(chan Empty, N)
...
&#x2F;&#x2F; å¼€å§‹Nä¸ªåç¨‹
for i, xi :&#x3D; range data &#123;
	go func (i int, xi float64) &#123;
		res[i] &#x3D; doSomething(i, xi)
		sem &lt;- empty
	&#125; (i, xi)
&#125;
&#x2F;&#x2F; ç­‰å¾…æ‰€æœ‰çš„åç¨‹ç»“æŸ
for i :&#x3D; 0; i &lt; N; i++ &#123; &lt;-sem &#125;</code></pre>
<h3 id="ä½¿ç”¨å¸¦ç¼“å†²é€šé“å®ç°ä¿¡å·é‡">ä½¿ç”¨å¸¦ç¼“å†²é€šé“å®ç°ä¿¡å·é‡</h3>
<p>å£°æ˜ç©ºæ¥å£ç±»å‹ï¼Œå¹¶å£°æ˜ä¿¡å·é‡</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">type Empty interface &#123;&#125;
type semaphore chan Empty</code></pre>
<p>å°†å¯ç”¨èµ„æºçš„æ•°é‡Â <code>N</code>æ¥åˆå§‹åŒ–ä¿¡å·é‡Â <code>semaphore</code>ï¼š<code>sem
= make(semaphore, N)</code></p>
<p>ä¾¿å¯å®šä¹‰Pæ“ä½œä¸Væ“ä½œ</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">&#x2F;&#x2F; acquire n resources
func (s semaphore) P(n int) &#123;
	e :&#x3D; new(Empty)
	for i :&#x3D; 0; i &lt; n; i++ &#123;
		s &lt;- e
	&#125;
&#125;

&#x2F;&#x2F; release n resources
func (s semaphore) V(n int) &#123;
	for i:&#x3D; 0; i &lt; n; i++&#123;
		&lt;- s
	&#125;
&#125;</code></pre>
<h3 id="é€šé“çš„æ–¹å‘">é€šé“çš„æ–¹å‘</h3>
<p>å¯ä»¥é€šè¿‡æ³¨è§£æ¥è¡¨ç¤ºé€šé“åªå‘é€æˆ–è€…åªæ¥æ”¶æ•°æ®ï¼Œå¦‚ä¸‹</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">func source(ch chan&lt;- int)&#123;
	for &#123; ch &lt;- 1 &#125;
&#125;

func sink(ch &lt;-chan int) &#123;
	for &#123; &lt;-ch &#125;
&#125;</code></pre>
<p>é€šé“åœ¨åˆ›å»ºæ—¶éƒ½æ˜¯åŒå‘çš„ï¼Œå®ƒä»¬åˆ›å»ºåè¢«ç”¨äºåˆ†é…ç»™æœ‰æ–¹å‘çš„é€šé“å˜é‡</p>
<h2 id="å…³é—­é€šé“">å…³é—­é€šé“</h2>
<ol type="1">
<li><p>é€šé“å¯ä»¥è¢«æ˜¾å¼åœ°å…³é—­ï¼Œåªæœ‰æ¥æ”¶è€…ç¡®å®šä¸ä¼šæä¾›æ–°çš„å€¼æ‰éœ€è¦å…³é—­é€šé“</p></li>
<li><p>åªæœ‰å‘é€è€…éœ€è¦å…³é—­é€šé“ï¼Œå¯¹äºæ¥æ”¶è€…æ¥è¯´å…³é—­é€šé“æ²¡æœ‰æ„ä¹‰</p></li>
<li><p>é€šè¿‡é€—å·okæ¨¡å¼æ¥æ£€æµ‹é€šé“æ˜¯å¦è¢«å…³é—­</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">v, ok :&#x3D; &lt;-ch
if !ok &#123;
  break
&#125;
process(v)</code></pre></p></li>
<li><p>ä½¿ç”¨for-rangeæ¥è¯»å–é€šé“ï¼Œä¼šè‡ªåŠ¨æ£€æµ‹é€šé“æ˜¯å¦å…³é—­</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">for input :&#x3D; range ch &#123;
    process(input)
&#125;</code></pre></p></li>
</ol>
<h2 id="ä½¿ç”¨selectåˆ‡æ¢åç¨‹">ä½¿ç”¨selectåˆ‡æ¢åç¨‹</h2>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">select &#123;
case u:&#x3D; &lt;- ch1:
        ...
case v:&#x3D; &lt;- ch2:
        ...
        ...
default: &#x2F;&#x2F; no value ready to be received
        ...
&#125;</code></pre>
<ol type="1">
<li>ä»ä¸åŒå¹¶å‘æ‰§è¡Œçš„åç¨‹ä¸­è·å–å€¼å¯ä»¥é€šè¿‡<code>select</code>å®Œæˆï¼Œå®ƒé€‰æ‹©å¤„ç†åˆ—å‡ºçš„å¤šä¸ªé€šé“å…¶ä¸­ä¸€ä¸ªï¼š
<ul>
<li>å¦‚æœé€šé“éƒ½é˜»å¡äº†ï¼Œä¼šç­‰å¾…ç›´åˆ°å…¶ä¸­ä¸€ä¸ªå¯ä»¥å¤„ç†</li>
<li>å¦‚æœæœ‰å¤šä¸ªé€šé“å¯ä»¥å¤„ç†ï¼Œä¼šéšæœºé€‰æ‹©å‡ºä¸€ä¸ª</li>
<li>å¦‚æœæ²¡æœ‰é€šé“å¯ä»¥å¤„ç†å¹¶ä¸”æœ‰<code>default</code>è¯­å¥ï¼Œé‚£ä¹ˆ<code>default</code>è¯­å¥å°†æ‰§è¡Œ</li>
</ul></li>
<li>åœ¨æ— é™å¾ªç¯ä¸­ä½¿ç”¨ä¸€ä¸ª<code>select</code>è¯­å¥ï¼Œæ¥å®ç°ä¸€ç§ç›‘å¬æ¨¡å¼ã€‚åœ¨æ­¤æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨<code>break</code>æ¥ä½¿å¾ªç¯é€€å‡º</li>
</ol>
<h2 id="é€šé“è¶…æ—¶å’Œè®¡æ—¶å™¨ticker">é€šé“ã€è¶…æ—¶å’Œè®¡æ—¶å™¨ï¼ˆTickerï¼‰</h2>
<ol type="1">
<li><p>åœ¨å·¥å‚å‡½æ•°Â <code>time.NewTicker</code>ä¸­ä»¥Â <code>Duration</code>Â ç±»å‹çš„å‚æ•°ä¼ å…¥ï¼š<code>func
NewTicker(dur) *Ticker</code>ï¼Œæ—¶é—´é—´éš”å•ä½çº³ç§’</p></li>
<li><p>ä½¿ç”¨<code>time.Tick()</code>æ¥è¿”å›ä¸€ä¸ªæŒ‡å®šæ—¶é—´é—´éš”å‘é€æ—¶é—´çš„é€šé“</p></li>
<li><p>å®šæ—¶å™¨<code>Timer</code>å’Œè®¡æ—¶å™¨<code>Ticker</code>ç±»ä¼¼ï¼Œä½†å®šæ—¶å™¨åªå‘é€ä¸€æ¬¡æ—¶é—´ï¼Œä½¿ç”¨<code>time.After(d
Duration)</code> æ¥è¿”å›ä¸€ä¸ªé€šé“</p></li>
<li><p>åœºæ™¯ï¼šä»å¤šä¸ªæ•°æ®åº“åŒæ—¶è¯»å–ï¼Œåªéœ€è¦æ¥æ”¶é¦–å…ˆåˆ°è¾¾çš„ç­”æ¡ˆï¼šè¿™ä¸ªåœºæ™¯ä¹Ÿæ¼”ç¤ºäº†ä¸€ä¸ªå‘é€æ•°æ®è€Œä¸æ˜¯æ¥æ”¶æ•°æ®çš„<code>select</code></p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">func Query(conns []Conn, query string) Result &#123;
    ch :&#x3D; make(chan Result, 1) 
    for _, conn :&#x3D; range conns &#123; &#x2F;&#x2F; å‘å¤šä¸ªæ•°æ®åº“å‘èµ·è¯·æ±‚
        go func(c Conn) &#123;
            select &#123;
            case ch &lt;- c.DoQuery(query): &#x2F;&#x2F; å¦‚æœè¿˜æ²¡æœ‰åˆ°è¾¾çš„ç­”æ¡ˆï¼Œç»“æœä¼šè¢«æ”¾å…¥é€šé“
            default: &#x2F;&#x2F; å¦åˆ™è¿›å…¥åˆ°defaultè¯­å¥é€€å‡º
            &#125;
        &#125;(conn)
    &#125;
    return &lt;- ch &#x2F;&#x2F; æ¥æ”¶è€…ï¼Œä»…è¿”å›ç¬¬ä¸€ä¸ªåˆ°è¾¾é€šé“çš„ç»“æœ
&#125;</code></pre></p>
<p>æ³¨æ„ï¼šä½¿ç”¨å®¹é‡ä¸º1çš„é€šé“chï¼Œè¿™æ ·ä¸ä¼šå¯¼è‡´ç¬¬ä¸€ä¸ªç»“æœåˆ°è¾¾æ—¶ç”±äºæ¥æ”¶è€…
<code>â† ch</code>æ²¡æœ‰å‡†å¤‡å¥½è€Œæ— æ³•è¢«æ¥æ”¶</p></li>
<li></li>
</ol>
<h2 id="æ–°æ—§æ¨¡å‹å¯¹æ¯”ä»»åŠ¡å’Œworker">æ–°æ—§æ¨¡å‹å¯¹æ¯”ï¼šä»»åŠ¡å’Œworker</h2>
<p>å¯¹äºä»»ä½•å¯ä»¥å»ºæ¨¡ä¸º Master-Worker èŒƒä¾‹çš„é—®é¢˜ï¼Œä¸€ä¸ªç±»ä¼¼äº worker
ä½¿ç”¨é€šé“è¿›è¡Œé€šä¿¡å’Œäº¤äº’ã€Master è¿›è¡Œæ•´ä½“åè°ƒçš„æ–¹æ¡ˆéƒ½èƒ½å®Œç¾è§£å†³ã€‚</p>
<p>æ€ä¹ˆé€‰æ‹©æ˜¯è¯¥ä½¿ç”¨é”è¿˜æ˜¯é€šé“ï¼Ÿ</p>
<p>ä¸‹é¢åˆ—å‡ºä¸€ä¸ªæ™®éçš„ç»éªŒæ³•åˆ™ï¼š</p>
<ul>
<li>ä½¿ç”¨é”çš„æƒ…æ™¯ï¼š
<ul>
<li>è®¿é—®å…±äº«æ•°æ®ç»“æ„ä¸­çš„ç¼“å­˜ä¿¡æ¯</li>
<li>ä¿å­˜åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡å’ŒçŠ¶æ€ä¿¡æ¯æ•°æ®</li>
</ul></li>
<li>ä½¿ç”¨é€šé“çš„æƒ…æ™¯ï¼š
<ul>
<li>ä¸å¼‚æ­¥æ“ä½œçš„ç»“æœè¿›è¡Œäº¤äº’</li>
<li>åˆ†å‘ä»»åŠ¡</li>
<li>ä¼ é€’æ•°æ®æ‰€æœ‰æƒ</li>
</ul></li>
</ul>
<p>å½“ä½ å‘ç°ä½ çš„é”ä½¿ç”¨è§„åˆ™å˜å¾—å¾ˆå¤æ‚æ—¶ï¼Œå¯ä»¥åçœä½¿ç”¨é€šé“ä¼šä¸ä¼šä½¿é—®é¢˜å˜å¾—ç®€å•äº›ã€‚</p>
<h2 id="æƒ°æ€§ç”Ÿæˆå™¨çš„å®ç°">æƒ°æ€§ç”Ÿæˆå™¨çš„å®ç°</h2>
<p>ç”Ÿæˆå™¨æ˜¯æŒ‡è¢«è°ƒç”¨æ—¶è¿”å›ä¸€ä¸ªåºåˆ—ä¸­ä¸‹ä¸€ä¸ªå€¼çš„å‡½æ•°ï¼Œç”Ÿæˆå™¨åªåœ¨éœ€è¦çš„æ—¶å€™æ±‚å€¼ï¼ŒåŒæ—¶ä¿ç•™ç›¸å…³å˜é‡èµ„æºï¼Œæ˜¯ä¸€é¡¹åœ¨éœ€è¦æ—¶å¯¹è¡¨è¾¾å¼è¿›è¡Œæ±‚å€¼çš„æŠ€æœ¯ã€‚</p>
<p>å¯ä»¥é€šè¿‡ä¼ å…¥åŒ¿åå‡½æ•°ï¼Œå°†å‡½æ•°çš„è®¡ç®—ç»“æœè¾“å‡ºåˆ°é€šé“ï¼Œå†è¿”å›å¦ä¸€ä¸ªå‡½æ•°ä½œä¸ºç”Ÿæˆå™¨ï¼Œç”¨äºå°†é€šé“ä¸­çš„å†…å®¹è¾“å‡ºã€‚éœ€è¦ç”Ÿæˆå™¨ç»“æœæ—¶è°ƒç”¨å‡½æ•°å³å¯ã€‚</p>
<h2 id="é™åˆ¶åŒæ—¶å¤„ç†çš„è¯·æ±‚æ•°">é™åˆ¶åŒæ—¶å¤„ç†çš„è¯·æ±‚æ•°</h2>
<p>ä½¿ç”¨å¸¦ç¼“å†²åŒºçš„é€šé“å¯ä»¥å¾ˆå®¹æ˜“åœ°å®ç°ï¼Œå…¶ç¼“å†²åŒºå®¹é‡å°±æ˜¯åŒæ—¶å¤„ç†è¯·æ±‚çš„æœ€å¤§æ•°é‡ã€‚</p>
<p>ä¸‹è¿°ç¤ºä¾‹å½“ä¿¡å·é€šé“è¡¨ç¤ºç¼“å†²åŒºå·²æ»¡æ—¶ï¼Œhandle()
å‡½æ•°ä¼šé˜»å¡ä¸”ä¸å†å¤„ç†å…¶ä»–è¯·æ±‚ã€‚</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">package main

const MAXREQS &#x3D; 50

var sem &#x3D; make(chan int, MAXREQS)

func process(r *Request) &#123;
	&#x2F;&#x2F; do something
&#125;

func handle(r *Request) &#123;
	sem &lt;- 1 &#x2F;&#x2F; doesn&#39;t matter what we put in it
	process(r)
	&lt;-sem &#x2F;&#x2F; one empty place in the buffer: the next request can start
&#125;</code></pre>
<h2 id="é“¾å¼åç¨‹">é“¾å¼åç¨‹</h2>
<p>è¿™æ ·çš„é€šé“è¡¨è¾¾å¼ä¹Ÿæ˜¯å¯è¡Œçš„ï¼š</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">func f(left, right chan int) &#123; left &lt;- 1 + &lt;-right &#125;</code></pre>
<h2 id="åœ¨å¤šæ ¸å¿ƒä¸Šå¹¶è¡Œè®¡ç®—">åœ¨å¤šæ ¸å¿ƒä¸Šå¹¶è¡Œè®¡ç®—</h2>
<p>å¦‚æœéœ€è¦æŠŠè®¡ç®—é‡åˆ†é…åˆ°æ¯ä¸€ä¸ªå¤„ç†å™¨ä¸Šï¼Œè®©æ¯ä¸€éƒ¨åˆ†ä¸å…¶ä»–éƒ¨åˆ†å¹¶è¡Œï¼Œå¯ä»¥å…ˆç”¨å¸¦ç¼“å†²åŒºçš„é€šé“ï¼Œåœ¨æ¯ä¸€ä¸ªè®¡ç®—éƒ¨åˆ†å®Œæˆåå‘é€ä¿¡å·ï¼›åŒæ—¶è¿˜è¦é€šè¿‡runtime.GOMAXPROCS(N)é™å®šä½¿ç”¨çš„å¤„ç†å™¨ä¸ªæ•°ã€‚</p>
<h2 id="ä½¿ç”¨é€šé“å¹¶å‘è®¿é—®å¯¹è±¡">ä½¿ç”¨é€šé“å¹¶å‘è®¿é—®å¯¹è±¡</h2>
<p>å¯ä»¥ä½¿ç”¨åç¨‹åœ¨åå°é¡ºåºæ‰§è¡ŒåŒ¿åå‡½æ•°æ¥æ›¿ä»£ä½¿ç”¨åŒæ­¥äº’æ–¥é”ã€‚æ¯”å¦‚åœ¨æ„é€ å‡½æ•°ä¸­å¯åŠ¨ä¸€ä¸ªåå°åç¨‹ï¼Œç„¶åæŠŠå¯¹è±¡çš„è¯»å†™éƒ½å®ç°ä¸ºåŒ¿åå‡½æ•°ï¼Œè®©å…¶æŒ‰é¡ºåºå¤„ç†ï¼Œæœ‰æ•ˆåœ°å°†å®ƒä»¬åºåˆ—åŒ–ä»è€Œæä¾›äº†å®‰å…¨çš„å¹¶å‘è®¿é—®ã€‚</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">&#x2F;&#x2F; æ„é€ æ—¶å¼€å¯åç¨‹
func NewPerson(name string, salary float64) *Person &#123;
	p :&#x3D; &amp;Person&#123;name, salary, make(chan func())&#125;
	go p.backend()
	return p
&#125;

func (p *Person) backend() &#123;
	for f :&#x3D; range p.chF &#123;
		f()
	&#125;
&#125;

&#x2F;&#x2F; è¯»å†™func()
&#x2F;&#x2F; Set salary.
func (p *Person) SetSalary(sal float64) &#123;
	p.chF &lt;- func() &#123; p.salary &#x3D; sal &#125;
&#125;

&#x2F;&#x2F; Retrieve salary.
func (p *Person) Salary() float64 &#123;
	fChan :&#x3D; make(chan float64)
	p.chF &lt;- func() &#123; fChan &lt;- p.salary &#125;
	return &lt;-fChan
&#125;</code></pre>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ç¼–ç¨‹è¯­è¨€</category>
        <category>Go</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹è¯­è¨€</tag>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ŠThe Way to Goã€‹Chapter16 å¸¸è§é™·é˜±ä¸é”™è¯¯</title>
    <url>/p/c629bb3de01f/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="chapter16-å¸¸è§é™·é˜±ä¸é”™è¯¯">Chapter16 å¸¸è§é™·é˜±ä¸é”™è¯¯</h1>
<p>å‰15ç« æåŠäº†ä¸€äº›é”™è¯¯ä½¿ç”¨æ–¹å¼ï¼Œå°±ä¸å†èµ˜è¿°ï¼Œ<a
href="https://github.com/unknwon/the-way-to-go_ZH_CN/blob/master/eBook/16.0.md">https://github.com/unknwon/the-way-to-go_ZH_CN/blob/master/eBook/16.0.md</a>
ä¸­ä¹Ÿéƒ½åˆ—å‡ºäº†ï¼Œé‡è¦çš„æ˜¯æœ‰ä»¥ä¸‹æœ€ä½³å®è·µï¼š</p>
<ol type="1">
<li>ä½¿ç”¨æ­£ç¡®çš„æ–¹å¼åˆå§‹åŒ–å€¼æ˜¯åˆ‡ç‰‡sliceçš„ä¸€ä¸ªæ˜ å°„map</li>
<li>ä½¿ç”¨é€—å·okæ¨¡å¼è¿›è¡Œç±»å‹æ–­è¨€</li>
<li>ä½¿ç”¨ä¸€ä¸ªå·¥å‚å‡½æ•°åˆ›å»ºå¹¶å®ä¾‹åŒ–è‡ªå·±çš„å®šä¹‰çš„ç±»å‹</li>
<li>åªæœ‰å½“æƒ³è¦æ”¹å˜ç»“æ„ä½“æ—¶ï¼Œä½¿ç”¨ç»“æ„ä½“æŒ‡é’ˆä½œä¸ºæ–¹æ³•æ¥æ”¶è€…ï¼Œå¦åˆ™éƒ½ä½¿ç”¨ç»“æ„ä½“å€¼ç±»å‹</li>
</ol>
<span id="more"></span>
<h3 id="è¯¯ç”¨çŸ­å£°æ˜å¯¼è‡´å˜é‡è¦†ç›–">è¯¯ç”¨çŸ­å£°æ˜å¯¼è‡´å˜é‡è¦†ç›–</h3>
<p>å¦‚æœåœ¨è¯­å¥å—å†…ä½¿ç”¨äº†çŸ­å£°æ˜<code>:=</code>ï¼Œé‚£ä¹ˆè¯­å¥å—å†…çš„åŒåå˜é‡ä»…åœ¨è¯­å¥å—å†…æœ‰æ•ˆï¼Œé€€å‡ºè¯­å¥å—åä»ç„¶æ˜¯å¤–éƒ¨çš„å˜é‡ç”Ÿæ•ˆ</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">var remember bool &#x3D; false
if something &#123;
    remember :&#x3D; true &#x2F;&#x2F;é”™è¯¯
&#125;
&#x2F;&#x2F; ä½¿ç”¨rememberï¼Œå¾—åˆ°çš„ä»ç„¶æ˜¯false

&#x2F;&#x2F; ------
&#x2F;&#x2F; æ­£ç¡®åšæ³•
if something &#123;
    remember &#x3D; true
&#125;</code></pre>
<h3 id="è¯¯ç”¨å­—ç¬¦ä¸²">è¯¯ç”¨å­—ç¬¦ä¸²</h3>
<p>å­—ç¬¦ä¸²æ˜¯ä¸å¯å˜çš„ï¼Œä½¿ç”¨ <code>a+=b</code>
ä¼šå¯¼è‡´å¤§é‡å†…å­˜å¼€é”€å’Œæ‹·è´ï¼Œè€ƒè™‘ä½¿ç”¨å­—ç¬¦æ•°ç»„ä»£æ›¿å­—ç¬¦ä¸²ï¼Œå°†å­—ç¬¦ä¸²å†…å®¹å†™å…¥åˆ°ç¼“å­˜ä¸­ï¼Œå³
<code>bytes.Buffer</code></p>
<h3 id="é”™è¯¯åœ°ä½¿ç”¨defer">é”™è¯¯åœ°ä½¿ç”¨defer</h3>
<p><code>defer</code>ä»…åœ¨å‡½æ•°è¿”å›æ—¶æ‰§è¡Œï¼Œåœ¨å¾ªç¯çš„ç»“å°¾æˆ–è€…æœ‰é™èŒƒå›´çš„ä»£ç å†…ä¸ä¼šæ‰§è¡Œ</p>
<h3 id="ä½•æ—¶ä½¿ç”¨newå’Œmake">ä½•æ—¶ä½¿ç”¨new()å’Œmake()</h3>
<p>é‡å¤å†…å®¹ï¼š</p>
<ol type="1">
<li>å¯¹åˆ‡ç‰‡sliceã€æ˜ å°„mapã€é€šé“channelä½¿ç”¨make()</li>
<li>å¯¹æ•°ç»„ã€ç»“æ„ä½“å’Œå€¼ç±»å‹ï¼Œä½¿ç”¨new()</li>
</ol>
<h3
id="ä¸è¦å¯¹æ¥å£ä½¿ç”¨æŒ‡é’ˆç±»å‹å‡å°‘å¯¹å€¼ç±»å‹ä½¿ç”¨æŒ‡é’ˆ">ä¸è¦å¯¹æ¥å£ä½¿ç”¨æŒ‡é’ˆç±»å‹ï¼Œå‡å°‘å¯¹å€¼ç±»å‹ä½¿ç”¨æŒ‡é’ˆ</h3>
<p>å¦‚ä½¿ç”¨æ¥å£çš„æŒ‡é’ˆç±»å‹å‡½æ•°å‚æ•°ï¼Œè¿™ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ â†’
æ¥å£æœ¬èº«å·²æ˜¯ä¸€ä¸ªæŒ‡é’ˆ</p>
<p>å°½ç®¡å€¼ç±»å‹çš„æ‹·è´ä¼¼ä¹æ˜¯å¯¹å†…å­˜çš„æ»¥ç”¨ï¼Œä½†å€¼ç±»å‹å†…å­˜çš„æ ˆä¸Šåˆ†é…å¿«é€Ÿä¸”å¼€é”€å°ï¼›å¦‚æœä¼ é€’å€¼ç±»å‹çš„æŒ‡é’ˆä¼šå¯¼è‡´å¯¹è±¡çš„åˆ›å»ºï¼Œä¸”ç§»åŠ¨åˆ°äº†å †ä¸Šã€‚</p>
<h3 id="é—­åŒ…ä¸åç¨‹çš„ä½¿ç”¨">é—­åŒ…ä¸åç¨‹çš„ä½¿ç”¨</h3>
<p>æ³¨æ„åœ¨å¾ªç¯ä¸­å¯¹ç´¢å¼•å€¼ï¼ˆindexï¼‰ä½¿ç”¨é—­åŒ…æ—¶ï¼Œå¯èƒ½æŒ‡å‘çš„æ˜¯åŒä¸€ä¸ªå˜é‡ï¼Œåœ¨é—­åŒ…é€»è¾‘æ‰§è¡Œæ—¶ï¼Œå¯èƒ½å¾ªç¯å·²ç»ç»“æŸï¼Œå¾—åˆ°çš„éƒ½æ˜¯ç´¢å¼•çš„æœ€ç»ˆå€¼ï¼›å¯é€‰çš„æ–¹æ³•æ˜¯åˆ›å»ºå±€éƒ¨å˜é‡ï¼ˆå€¼å¤åˆ¶ï¼‰ï¼Œè®©é—­åŒ…æŒ‡å‘è¿™äº›å˜é‡ï¼Œæˆ–è€…ç”¨è¿™äº›å€¼å¯åŠ¨åç¨‹</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">var values &#x3D; [5]int&#123;10, 11, 12, 13, 14&#125;
func main() &#123;
		&#x2F;&#x2F; ...
    &#x2F;&#x2F; ç‰ˆæœ¬ Bï¼šå’Œ A ç‰ˆæœ¬ç±»ä¼¼ï¼Œä½†æ˜¯é€šè¿‡è°ƒç”¨é—­åŒ…ä½œä¸ºä¸€ä¸ªåç¨‹
    for ix :&#x3D; range values &#123;
        go func() &#123;
            fmt.Print(ix, &quot; &quot;)
        &#125;()
    &#125;
    fmt.Println()
    time.Sleep(5e9)
		&#x2F;&#x2F; 4 4 4 4 4
    &#x2F;&#x2F; ç‰ˆæœ¬ Cï¼šæ­£ç¡®çš„å¤„ç†æ–¹å¼
    for ix :&#x3D; range values &#123;
        go func(ix interface&#123;&#125;) &#123;
            fmt.Print(ix, &quot; &quot;)
        &#125;(ix)
    &#125;
    fmt.Println()
    time.Sleep(5e9)
		&#x2F;&#x2F; 1 0 3 4 2
&#125;
</code></pre>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ç¼–ç¨‹è¯­è¨€</category>
        <category>Go</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹è¯­è¨€</tag>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>ã€ŠThe Way to Goã€‹é˜…è¯»ç¬”è®°</title>
    <url>/p/e842888b11eb/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="chapter1">Chapter1</h1>
<h3 id="goè¯­è¨€çš„å‘å±•ç›®æ ‡">goè¯­è¨€çš„å‘å±•ç›®æ ‡</h3>
<p>ç»“åˆé™æ€è¯­è¨€çš„å®‰å…¨æ€§å’Œé«˜æ•ˆæ€§ï¼ŒåŠ¨æ€è¯­è¨€çš„æ˜“å¼€å‘æ€§ã€‚</p>
<p>æ³¨æ„ï¼Œgoæ˜¯<strong>é™æ€è¯­è¨€ï¼ˆé™æ€ç±»å‹è¯­è¨€ï¼‰</strong>ã€‚æ˜¯ç±»å‹å®‰å…¨å’Œå†…å­˜å®‰å…¨çš„ç¼–ç¨‹è¯­è¨€ã€‚é€šè¿‡goroutineæ¥å®ç°å¹¶å‘å¹¶è¡Œç¼–ç¨‹ï¼Œé€šè¿‡channelæ¥å®ç°gorountineä¹‹é—´é€šä¿¡ã€‚</p>
<p>åƒå…¶ä»–é™æ€è¯­è¨€ä¸€æ ·æ‰§è¡Œæœ¬åœ°ä»£ç ï¼Œä½†ä¾æ—§è¿è¡ŒæŸç§æ„ä¹‰ä¸Šçš„è™šæ‹Ÿæœºè¿›è¡Œåƒåœ¾å›æ”¶ï¼Œä¸éœ€è¦å¼€å‘äººå‘˜è€ƒè™‘å†…å­˜ç®¡ç†çš„é—®é¢˜ã€‚</p>
<h3 id="è¯­è¨€çš„ç‰¹æ€§">è¯­è¨€çš„ç‰¹æ€§</h3>
<p>æ²¡æœ‰ç±»å’Œç»§æ‰¿æ¦‚å¿µï¼Œä½¿ç”¨æ¥å£ï¼ˆinterfaceï¼‰æ¥å®ç°å¤šæ€æ€§ï¼Œå‡½æ•°æ˜¯åŸºæœ¬æ„ä»¶</p>
<p>ä½¿ç”¨é™æ€ç±»å‹ï¼Œå¼ºç±»å‹è¯­è¨€ï¼Œéšå¼çš„ç±»å‹è½¬æ¢ä¸è¢«å…è®¸</p>
<span id="more"></span>
<h1 id="chapter2">Chapter2</h1>
<h2 id="å¹³å°ä¸æ¶æ„">å¹³å°ä¸æ¶æ„</h2>
<p>Goè¯­è¨€æœ‰ä¸¤ä¸ªç‰ˆæœ¬ç¼–è¯‘å™¨ï¼šGoåŸç”Ÿç¼–è¯‘å™¨gcå’ŒéåŸç”Ÿç¼–è¯‘å™¨gccgoï¼ŒGoè¯­è¨€çš„ç¼–è¯‘å™¨å’Œé“¾æ¥å™¨éƒ½æ˜¯Cè¯­è¨€ç¼–å†™å¹¶äº§ç”Ÿæœ¬åœ°ä»£ç </p>
<p>Goçš„<strong>è‡ªä¸¾</strong>ï¼šåœ¨ 1.4 ç‰ˆæœ¬åï¼ŒGo ç¼–è¯‘å™¨å®ç°äº†è‡ªä¸¾ï¼Œå³é€šè¿‡
1.4 ç‰ˆæœ¬æ¥ç¼–è¯‘å®‰è£…ä¹‹åç‰ˆæœ¬çš„ç¼–è¯‘å™¨ã€‚</p>
<a href="/p/e842888b11eb/Untitled.png" class="gallery-item"><img src="/p/e842888b11eb/Untitled.png" class="" title="åœ¨è‡ªå·±çš„æœåŠ¡å™¨ä¸Šç¼–è¯‘Go"></a>
<h2 id="goç¯å¢ƒå˜é‡">Goç¯å¢ƒå˜é‡</h2>
<ul>
<li>$GOROOTï¼šGoåœ¨ç”µè„‘ä¸Šçš„å®‰è£…ä½ç½®ï¼Œä¸€èˆ¬æ˜¯$Home/goï¼ˆæ³¨æ„ä¸è¦é…ç½®æˆbinç›®å½•äº†ï¼Œbinç›®å½•æ˜¯æ·»åŠ åˆ°pathè®©ä½ æ–¹ä¾¿æ‰§è¡Œgo.exeçš„â€¦ï¼‰</li>
<li>$GOPATHï¼šæ­¤è·¯å¾„ä¸‹å¿…é¡»åŒ…å«src / pkg /
binä¸‰ä¸ªç›®å½•å­˜æ”¾æºç ï¼ŒåŒ…æ–‡ä»¶å’Œå¯æ‰§è¡Œæ–‡ä»¶</li>
<li>$GOMAXPROCSï¼šç”¨äºè®¾ç½®åº”ç”¨ç¨‹åºå¯ä½¿ç”¨çš„å¤„ç†å™¨ä¸ªæ•°ä¸æ ¸æ•°</li>
</ul>
<h3 id="go-è¿è¡Œæ—¶runtime">Go è¿è¡Œæ—¶ï¼ˆruntimeï¼‰</h3>
<ul>
<li>å°½ç®¡Goç¼–è¯‘å™¨äº§ç”Ÿçš„æ˜¯æœ¬åœ°å¯æ‰§è¡Œä»£ç ï¼Œä½†ä»ç„¶è¿è¡Œåœ¨Goçš„runtimeä¸­ï¼Œè¿™ä¸ªruntimeè² è²¬ç®¡ç†åŒ…æ‹¬å†…å­˜åˆ†é…ã€åƒåœ¾å›æ”¶ã€æ ˆå¤„ç†ã€goroutineã€channelã€åˆ‡ç‰‡ã€mapå’Œåå°„ã€‚Goçš„runtimeåµŒå…¥åˆ°æ¯ä¸€ä¸ªå¯æ‰§è¡Œæ–‡ä»¶å½“ä¸­ï¼Œæ‰€ä»¥å¯æ‰§è¡Œæ–‡ä»¶ä¼šæ¯”ç›¸åº”çš„æºæ–‡ä»¶å¤§å¾—å¤šã€‚</li>
</ul>
<h1 id="chapter4">Chapter4</h1>
<h2 id="goç¨‹åºåŸºæœ¬ç»“æ„å’Œè¦ç´ ">Goç¨‹åºåŸºæœ¬ç»“æ„å’Œè¦ç´ </h2>
<p>æ¯ä¸ªç¨‹åºéƒ½ç”±åŒ…ï¼ˆé€šå¸¸ç®€ç§°ä¸º
pkgï¼‰çš„æ¦‚å¿µç»„æˆï¼Œå¯ä»¥ä½¿ç”¨è‡ªèº«çš„åŒ…æˆ–è€…ä»å…¶å®ƒåŒ…ä¸­å¯¼å…¥å†…å®¹ã€‚æ¯ä¸ªGoæ–‡ä»¶éƒ½å±äºä¸”ä»…å±äºä¸€ä¸ªåŒ…ï¼Œä¸€ä¸ªåŒ…å¯ä»¥ç”±è®¸å¤š.goæºæ–‡ä»¶ç»„æˆï¼Œæ–‡ä»¶åå’ŒåŒ…åä¸€èˆ¬éƒ½æ˜¯ä¸åŒçš„ã€‚</p>
<p>å¦‚æœè¦ç¼–è¯‘åŒ…åä¸æ˜¯ä¸ºmainçš„æºæ–‡ä»¶å¦‚pack1ï¼Œç¼–è¯‘åäº§ç”Ÿçš„å¯¹è±¡æ–‡ä»¶å°†ä¼šæ˜¯pack1.aè€Œä¸æ˜¯å¯æ‰§è¡Œç¨‹åºã€‚</p>
<p>æ‰€æœ‰åŒ…ååº”è¯¥ä½¿ç”¨å°å†™å­—æ¯ã€‚</p>
<p>Goæ ‡å‡†åº“ä½äºGoæ ¹ç›®å½•ä¸‹çš„å­ç›®å½•pkgï¼Œä»¥64ä½windowsä¸ºä¾‹ï¼Œæ ‡å‡†åº“ä½äºwindows_amd64ä¸‹ã€‚</p>
<a href="/p/e842888b11eb/Untitled_1.png" class="gallery-item"><img src="/p/e842888b11eb/Untitled_1.png" class="" title="windows_amd64ç›®å½•"></a>
<p><strong>åŒ…çš„å¯¼å…¥å’Œæœç´¢</strong></p>
<p>å¦‚æœåŒ…åä¸æ˜¯ä»¥Â <code>.</code>æˆ–Â <code>/</code>å¼€å¤´ï¼Œå¦‚Â <code>"fmt"</code>æˆ–è€…Â <code>"container/list"</code>ï¼Œåˆ™
Go ä¼šåœ¨å…¨å±€æ–‡ä»¶è¿›è¡ŒæŸ¥æ‰¾ï¼›å¦‚æœåŒ…åä»¥Â <code>./</code>å¼€å¤´ï¼Œåˆ™ Go
ä¼šåœ¨ç›¸å¯¹ç›®å½•ä¸­æŸ¥æ‰¾ï¼›å¦‚æœåŒ…åä»¥Â <code>/</code>å¼€å¤´ï¼ˆåœ¨ Windows
ä¸‹ä¹Ÿå¯ä»¥è¿™æ ·ä½¿ç”¨ï¼‰ï¼Œåˆ™ä¼šåœ¨ç³»ç»Ÿçš„ç»å¯¹è·¯å¾„ä¸­æŸ¥æ‰¾ã€‚</p>
<p><strong>å¯è§æ€§è§„åˆ™</strong></p>
<p>åŒ…é€šè¿‡è¿™ä¸ªå¼ºåˆ¶æ‰§è¡Œçš„è§„åˆ™å†³å®šè‡ªèº«ä»£ç æ˜¯å¦æš´éœ²ç»™å¤–éƒ¨æ–‡ä»¶ï¼šå¦‚æœæ ‡è¯†ç¬¦ï¼ˆåŒ…æ‹¬å¸¸é‡ã€å˜é‡ã€ç±»å‹ã€å‡½æ•°åã€ç»“æ„å­—æ®µç­‰ç­‰ï¼‰ä»¥å¤§å†™å­—æ¯å¼€å¤´ï¼Œé‚£ä¹ˆå¯ä»¥è¢«å¤–éƒ¨åŒ…ä½¿ç”¨ï¼Œå¦‚æœä»¥å°å†™å­—æ¯å¼€å¤´ï¼Œå°±å¯¹åŒ…å¤–ä¸å¯è§ï¼Œä»…åœ¨åŒ…å†…å¯è§å¹¶ä¸”å¯ç”¨ã€‚</p>
<p>åªæœ‰å½“æŸä¸ªå‡½æ•°éœ€è¦è¢«å¤–éƒ¨åŒ…è°ƒç”¨çš„æ—¶å€™æ‰ä½¿ç”¨å¤§å†™å­—æ¯å¼€å¤´ï¼Œå¹¶éµå¾ª Pascal
å‘½åæ³•ï¼›å¦åˆ™å°±éµå¾ªéª†é©¼å‘½åæ³•ï¼Œå³ç¬¬ä¸€ä¸ªå•è¯çš„é¦–å­—æ¯å°å†™ï¼Œå…¶ä½™å•è¯çš„é¦–å­—æ¯å¤§å†™ã€‚</p>
<h3 id="å‡½æ•°">å‡½æ•°</h3>
<p>æ¯ä¸€ä¸ªå¯æ‰§è¡Œç¨‹åºå¿…é¡»åŒ…å«main()ï¼Œæ˜¯é™¤init()å¤–å¯åŠ¨åç¬¬ä¸€ä¸ªæ‰§è¡Œçš„å‡½æ•°ã€‚å¦‚æœmainåŒ…çš„æ²¡æœ‰åŒ…å«mainå‡½æ•°ä¼šå¼•å‘build
errorã€‚mainæ²¡æœ‰å‚æ•°ä¹Ÿæ²¡æœ‰è¿”å›ç±»å‹ã€‚</p>
<p>å¯¹ç›¸åŒç±»å‹çš„å‡½æ•°å‚æ•°ï¼Œå¯ä»¥è¿™æ ·æè¿°å‡½æ•°</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">func Add(param1, param2 int) int &#123;
	&#x2F;&#x2F; ...
&#125;</code></pre>
<h3 id="ç±»å‹">ç±»å‹</h3>
<p>ä½¿ç”¨ var
å£°æ˜çš„å˜é‡çš„å€¼ä¼š<strong>è‡ªåŠ¨åˆå§‹åŒ–ä¸ºè¯¥ç±»å‹çš„é›¶å€¼</strong>ã€‚</p>
<p>ç±»å‹å®šä¹‰äº†æŸä¸ªå˜é‡çš„å€¼çš„é›†åˆä¸å¯å¯¹å…¶è¿›è¡Œæ“ä½œçš„é›†åˆã€‚</p>
<p>ç±»å‹å¯ä»¥æ˜¯åŸºæœ¬ç±»å‹ï¼Œå¦‚ï¼šintã€floatã€boolã€stringï¼›ç»“æ„åŒ–çš„ï¼ˆå¤åˆçš„ï¼‰ï¼Œå¦‚ï¼šstructã€arrayã€sliceã€mapã€channelï¼›åªæè¿°ç±»å‹çš„è¡Œä¸ºçš„ï¼Œå¦‚ï¼šinterfaceã€‚</p>
<p>ç»“æ„åŒ–çš„ç±»å‹æ²¡æœ‰çœŸæ­£çš„å€¼ï¼Œå®ƒä½¿ç”¨ nil ä½œä¸ºé»˜è®¤å€¼ï¼ˆåœ¨ Objective-C ä¸­æ˜¯
nilï¼Œåœ¨ Java ä¸­æ˜¯ nullï¼Œåœ¨ C å’Œ C++ ä¸­æ˜¯NULLæˆ– 0ï¼‰ã€‚å€¼å¾—æ³¨æ„çš„æ˜¯ï¼ŒGo
è¯­è¨€ä¸­ä¸å­˜åœ¨ç±»å‹ç»§æ‰¿ã€‚</p>
<h2 id="å¸¸é‡">å¸¸é‡</h2>
<p>å¸¸é‡å€¼å¿…é¡»åœ¨ç¼–è¯‘æ—¶èƒ½å¤Ÿç¡®å®šï¼ŒåŒæ—¶æ— æ³•åœ¨è¿è¡Œè¿‡ç¨‹ä¿®æ”¹å®ƒçš„å€¼</p>
<h2 id="å˜é‡">å˜é‡</h2>
<p>ä½¿ç”¨å…³é”®è¯<code>var</code>æ¥å£°æ˜ä¸€ä¸ªå˜é‡</p>
<p>åœ¨<strong>åŒ…çº§åˆ«</strong>å£°æ˜å˜é‡</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">var a int &#x3D; 5 &#x2F;&#x2F; æ˜¾å¼å£°æ˜ç±»å‹
var b &#x3D; 5 &#x2F;&#x2F; éšå¼å£°æ˜ç±»å‹</code></pre>
<p>åœ¨<strong>å‡½æ•°å†…éƒ¨</strong>çš„ç®€çŸ­å½¢å¼ï¼Œçœç•¥var</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">func Sample() &#123;
	a :&#x3D; 5
&#125;</code></pre>
<p>äº¤æ¢å˜é‡ï¼Œä¸ç”¨å†™tmpäº†</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">a, b &#x3D; b, a</code></pre>
<h3 id="å€¼ç±»å‹ä¸å¼•ç”¨ç±»å‹">å€¼ç±»å‹ä¸å¼•ç”¨ç±»å‹</h3>
<p>åŸºæœ¬æ•°å€¼ç±»å‹ï¼Œå­—ç¬¦ä¸²ï¼Œæ•°ç»„ï¼Œç»“æ„éƒ½æ˜¯å€¼ç±»å‹ï¼Œå†…å®¹ç›´æ¥å­˜æ”¾åœ¨å˜é‡åˆ†é…å¾—çš„å†…å­˜ä¸Š</p>
<p>æ›´å¤æ‚çš„ç±»å‹ï¼ˆï¼Ÿï¼‰ä½¿ç”¨å¼•ç”¨ç±»å‹ä¿å­˜ï¼Œå˜é‡åˆ†é…å¾—çš„å†…å­˜ä¸Šï¼Œå­˜æ”¾â€œå†…å®¹æ‰€åœ¨çš„åœ°å€â€</p>
<h3 id="æ ¼å¼å­—ç¬¦ä¸²">æ ¼å¼å­—ç¬¦ä¸²</h3>
<p>ç”¨æ¥è®°å½•ä¸€äº›è¾“å‡ºç±»å‹ï¼ˆæ ¼å¼åŒ–è¯´æ˜ç¬¦ï¼‰</p>
<ul>
<li>%v é€šç”¨</li>
<li>%t å¸ƒå°”å‹</li>
<li>%d æ ¼å¼åŒ–æ•´æ•°ï¼ˆ%xå’Œ%Xç”¨äºæ ¼å¼åŒ–16è¿›åˆ¶</li>
<li>%g æ ¼å¼åŒ–æµ®ç‚¹å‹ï¼ˆ%fè¾“å‡ºæµ®ç‚¹æ•°ï¼Œ%eè¾“å‡ºç§‘å­¦è®¡æ•°æ³•</li>
<li>%p æ˜¾ç¤ºåœ°å€æ ¼å¼</li>
</ul>
<h3 id="initå‡½æ•°">initå‡½æ•°</h3>
<p>ä¸èƒ½è¢«äººä¸ºè°ƒç”¨ï¼Œåœ¨åŒ…å®Œæˆåˆå§‹åŒ–ï¼ˆå˜é‡å…¨å±€å£°æ˜åˆå§‹åŒ–ï¼‰åè‡ªåŠ¨æ‰§è¡Œï¼Œå¯ä»¥ä½œä¸ºå¦ä¸€ç§åˆå§‹åŒ–é€”å¾„</p>
<p>åˆå§‹åŒ–ä»¥å•çº¿ç¨‹æ‰§è¡Œï¼Œä¸”æŒ‰ç…§åŒ…çš„ä¾èµ–å…³ç³»æ‰§è¡Œï¼Œå¦ä¸€ç§ç”¨é€”å¯ä»¥åœ¨å¼€å§‹æ‰§è¡Œç¨‹åºå‰å¯¹æ•°æ®è¿›è¡Œæ£€éªŒä¿®å¤</p>
<h2 id="åŸºæœ¬ç±»å‹ä¸è¿ç®—ç¬¦">åŸºæœ¬ç±»å‹ä¸è¿ç®—ç¬¦</h2>
<p>æ³¨æ„goæ²¡æœ‰éšå¼ç±»å‹è½¬æ¢ï¼Œåœ¨ç±»å‹è½¬æ¢æ˜¯è¦æ³¨æ„ç”¨æ˜¾å¼çš„æ–¹å¼è¿›è¡Œ</p>
<h3 id="æ•°å­—ç±»å‹">æ•°å­—ç±»å‹</h3>
<p>Go ä¹Ÿæœ‰åŸºäºæ¶æ„çš„ç±»å‹ï¼Œä¾‹å¦‚ï¼šintã€uint å’Œ
uintptrã€‚è¿™äº›ç±»å‹çš„é•¿åº¦éƒ½æ˜¯<strong>æ ¹æ®è¿è¡Œç¨‹åºæ‰€åœ¨çš„æ“ä½œç³»ç»Ÿç±»å‹æ‰€å†³å®š</strong>çš„ï¼š</p>
<ul>
<li><code>int</code>Â å’ŒÂ <code>uint</code>Â åœ¨ 32 ä½æ“ä½œç³»ç»Ÿä¸Šï¼Œå®ƒä»¬å‡ä½¿ç”¨
32 ä½ï¼ˆ4 ä¸ªå­—èŠ‚ï¼‰ï¼Œåœ¨ 64 ä½æ“ä½œç³»ç»Ÿä¸Šï¼Œå®ƒä»¬å‡ä½¿ç”¨ 64 ä½ï¼ˆ8
ä¸ªå­—èŠ‚ï¼‰ã€‚</li>
<li><code>uintptr</code>Â çš„é•¿åº¦è¢«è®¾å®šä¸ºè¶³å¤Ÿå­˜æ”¾ä¸€ä¸ªæŒ‡é’ˆå³å¯ã€‚</li>
</ul>
<p>Go è¯­è¨€ä¸­æ²¡æœ‰ float ç±»å‹ã€‚ï¼ˆGoè¯­è¨€ä¸­åªæœ‰ float32 å’Œ
float64ï¼‰æ²¡æœ‰doubleç±»å‹ã€‚</p>
<p>float32 ç²¾ç¡®åˆ°å°æ•°ç‚¹å 7 ä½ï¼Œfloat64 ç²¾ç¡®åˆ°å°æ•°ç‚¹å 15
ä½ã€‚ç”±äºç²¾ç¡®åº¦çš„ç¼˜æ•…ï¼Œä½ åœ¨ä½¿ç”¨Â <code>==</code>
Â æˆ–è€…Â <code>!=</code>æ¥æ¯”è¾ƒæµ®ç‚¹æ•°æ—¶åº”å½“éå¸¸å°å¿ƒã€‚</p>
<h3 id="ç®—æœ¯è¿ç®—ç¬¦">ç®—æœ¯è¿ç®—ç¬¦</h3>
<ul>
<li>ç›¸å¯¹äºä¸€èˆ¬è§„åˆ™è€Œè¨€ï¼ŒGo
åœ¨è¿›è¡Œå­—ç¬¦ä¸²æ‹¼æ¥æ—¶å…è®¸ä½¿ç”¨å¯¹è¿ç®—ç¬¦Â <code>+</code>Â çš„é‡è½½ï¼Œä½† Go
æœ¬èº«ä¸å…è®¸å¼€å‘è€…è¿›è¡Œè‡ªå®šä¹‰çš„è¿ç®—ç¬¦é‡è½½</li>
<li><code>/</code>Â å¯¹äºæ•´æ•°è¿ç®—è€Œè¨€ï¼Œç»“æœä¾æ—§ä¸ºæ•´æ•°ï¼Œä¾‹å¦‚ï¼š<code>9 / 4
-&gt; 2</code>ã€‚å–ä½™è¿ç®—ç¬¦åªèƒ½ä½œç”¨äºæ•´æ•°ï¼š<code>9 % 4 -&gt;
1</code>ã€‚</li>
<li>ä½ å¯ä»¥å°†è¯­å¥Â <code>b = b + a</code> ç®€å†™ä¸ºÂ <code>b += a</code></li>
<li>å¸¦æœ‰Â <code>++</code>å’ŒÂ <code>--</code>Â çš„<strong>åªèƒ½ä½œä¸ºè¯­å¥ï¼Œè€Œéè¡¨è¾¾å¼</strong>ï¼Œå› æ­¤Â <code>n
= i++</code>Â è¿™ç§å†™æ³•æ˜¯æ— æ•ˆçš„ï¼Œ</li>
</ul>
<h3 id="ç±»å‹åˆ«å">ç±»å‹åˆ«å</h3>
<p>ç»™æŸä¸ªç±»å‹èµ·å¦ä¸€ä¸ªåå­—ï¼Œæ–°ç±»å‹ä¸ä¼šæ‹¥æœ‰åŸç±»å‹é™„å¸¦æ–¹æ³•ï¼Œæ–°ç±»å‹ä¹Ÿå¯è‡ªå®šä¹‰æ–¹æ³•</p>
<h3 id="å­—ç¬¦ç±»å‹">å­—ç¬¦ç±»å‹</h3>
<p><code>byte</code>ç±»å‹æ˜¯Â <code>uint8</code>Â çš„åˆ«åï¼Œå¯¹äºåªå ç”¨ 1
ä¸ªå­—èŠ‚çš„ä¼ ç»Ÿ ASCII ç¼–ç çš„å­—ç¬¦æ¥è¯´</p>
<p><code>\x</code>æ€»æ˜¯ç´§è·Ÿç€é•¿åº¦ä¸º 2 çš„ 16 è¿›åˆ¶æ•°</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">var ch byte &#x3D; 65 æˆ– var ch byte &#x3D; &#39;\x41&#39; &#x2F;&#x2F; one byte</code></pre>
<p>Go åŒæ ·æ”¯æŒ Unicodeï¼ˆUTF-8ï¼‰ï¼Œå› æ­¤å­—ç¬¦åŒæ ·ç§°ä¸º Unicode ä»£ç ç‚¹æˆ–è€…
runesï¼Œå¹¶åœ¨å†…å­˜ä¸­ä½¿ç”¨ int æ¥è¡¨ç¤ºã€‚åœ¨ä¹¦å†™ Unicode å­—ç¬¦æ—¶ï¼Œéœ€è¦åœ¨ 16
è¿›åˆ¶æ•°ä¹‹å‰åŠ ä¸Šå‰ç¼€Â <code>\u</code>Â æˆ–è€…Â <code>\U</code>ã€‚</p>
<p>å› ä¸º Unicode è‡³å°‘å ç”¨ 2
ä¸ªå­—èŠ‚ï¼Œæ‰€ä»¥æˆ‘ä»¬ä½¿ç”¨Â <code>int16</code>Â æˆ–è€…Â <code>int</code>Â ç±»å‹æ¥è¡¨ç¤ºã€‚å¦‚æœéœ€è¦ä½¿ç”¨åˆ°
4
å­—èŠ‚ï¼Œåˆ™ä¼šåŠ ä¸ŠÂ <code>\U</code>Â å‰ç¼€ï¼›å‰ç¼€Â <code>\u</code>Â åˆ™æ€»æ˜¯ç´§è·Ÿç€é•¿åº¦ä¸º
4 çš„ 16 è¿›åˆ¶æ•°ï¼Œå‰ç¼€Â <code>\U</code>Â ç´§è·Ÿç€é•¿åº¦ä¸º 8 çš„ 16 è¿›åˆ¶æ•°ã€‚</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">var ch int &#x3D; &#39;\u0041&#39; &#x2F;&#x2F; two bytes
var ch2 int &#x3D; &#39;\u03B2&#39;
var ch3 int &#x3D; &#39;\U00101234&#39; &#x2F;&#x2F; four bytes</code></pre>
<p>åŒ…<code>unicode</code>åŒ…å«çš„æµ‹è¯•å­—ç¬¦å‡½æ•°</p>
<ul>
<li>åˆ¤æ–­æ˜¯å¦ä¸ºå­—æ¯ï¼š<code>unicode.IsLetter(ch)</code></li>
<li>åˆ¤æ–­æ˜¯å¦ä¸ºæ•°å­—ï¼š<code>unicode.IsDigit(ch)</code></li>
<li>åˆ¤æ–­æ˜¯å¦ä¸ºç©ºç™½ç¬¦å·ï¼š<code>unicode.IsSpace(ch)</code></li>
</ul>
<h2 id="å­—ç¬¦ä¸²">å­—ç¬¦ä¸²</h2>
<p>å­—ç¬¦ä¸²æ˜¯UTF-8å­—ç¬¦çš„åºåˆ—ï¼Œæ‰€ä»¥å­—ç¬¦ä¸²å†…çš„å­—ç¬¦å¯èƒ½æ ¹æ®éœ€è¦å ç”¨1è‡³4å­—èŠ‚ï¼Œä¸å…¶ä»–è¯­è¨€ä¸åŒï¼Œå¥½å¤„æ˜¯å‡å°‘å†…å­˜ã€ç¡¬ç›˜ç©ºé—´å ç”¨ï¼Œä¹Ÿä¸éœ€è¦è¿›è¡Œæ–‡æœ¬ç¼–ç è§£ç ã€‚</p>
<p>åŒå¼•å·å†…çš„è½¬ä¹‰ç¬¦ç…§å¸¸å¤„ç†ï¼›åå¼•å·å†…çš„ä¼šè§£é‡Šä¸ºå­—ç¬¦ä¸²ï¼Œä¼šå°†è½¬ä¹‰ç¬¦åŸæ ·è¾“å‡º</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">&#96;This is a raw string \n&#96; ä¸­çš„ &#96;\n\&#96; ä¼šè¢«åŸæ ·è¾“å‡ºã€‚</code></pre>
<ul>
<li>å¯ä»¥è¿›è¡Œç´¢å¼•ï¼Œä½†ç´¢å¼•åˆ°çš„æ˜¯å­—èŠ‚</li>
<li>æ ¹æ®é•¿åº¦é™å®šï¼Œè€Œä¸æ˜¯ç‰¹æ®Šå­—ç¬¦â€™\0â€™</li>
<li>æ˜¯ä¸€ç§<strong>å€¼ç±»å‹</strong>ï¼Œå†…å®¹ä¸å¯å˜ï¼Œæ˜¯å­—èŠ‚çš„å®šé•¿æ•°ç»„</li>
</ul>
<p>å­—ç¬¦ä¸²ä¸[]byteçš„è½¬æ¢</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">&#x2F;&#x2F; é€†è½¬ï¼
func ReverseString(input string) string &#123;
	c :&#x3D; []byte(input)
	for i :&#x3D; 0; i &lt; len(c)&#x2F;2; i++ &#123;
		other :&#x3D; len(c) - i - 1
		c[i], c[other] &#x3D; c[other], c[i]
	&#125;

	return string(c)
&#125;</code></pre>
<h1 id="chapter5">Chapter5</h1>
<h2 id="if-else-ç»“æ„">if-else ç»“æ„</h2>
<p>ç‰¹ç‚¹ï¼šæ¡ä»¶ä¸éœ€è¦åœ†æ‹¬å·ï¼Œä½†æ˜¯è¯­å¥éœ€è¦å¤§æ‹¬å·</p>
<p>å¯ä»¥ä½¿ç”¨åˆå§‹åŒ–è¯­å¥ï¼Œåœ¨ifè¯­å¥çš„ä½œç”¨åŸŸä¸­å£°æ˜ä¸€ä¸ªå˜é‡ï¼Œéœ€è¦åœ¨å£°æ˜è¯­å¥åé¢è·Ÿä¸Šä¸€ä¸ªåˆ†å·</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">if val :&#x3D; 10; val &gt; max &#123;
	&#x2F;&#x2F; do something
&#125;</code></pre>
<h2 id="æµ‹è¯•å¤šè¿”å›å€¼å‡½æ•°çš„é”™è¯¯">æµ‹è¯•å¤šè¿”å›å€¼å‡½æ•°çš„é”™è¯¯</h2>
<p>Goè¯­è¨€å‡½æ•°ç»å¸¸ä½¿ç”¨ä¸¤ä¸ªè¿”å›å€¼æ¥è¡¨ç¤ºæ‰§è¡Œæ˜¯å¦æˆåŠŸï¼Œé€šå¸¸è¿”å›é›¶å€¼ã€nilã€falseæ¥è¡¨ç¤ºå¤±è´¥ï¼Œæˆ–è€…ä½¿ç”¨ä¸€ä¸ªerrorç±»å‹çš„å˜é‡æ¥ä»£æ›¿ä½œä¸ºç¬¬äºŒä¸ªè¿”å›å€¼ï¼›æˆåŠŸæ‰§è¡Œçš„è¯ï¼Œerrorå€¼ä¸ºnilã€‚</p>
<p>å¦‚æœåˆ¤æ–­å‡½æ•°æ‰§è¡Œä¸€å®šèƒ½æˆåŠŸï¼Œå¯ä»¥ä½¿ç”¨<code>_</code>æ¥æ¥æ”¶ç¬¬äºŒä¸ªå‚æ•°ã€‚</p>
<p>æœ‰æ—¶å½“é”™è¯¯æ²¡æœ‰å‘ç”Ÿæ—¶ï¼Œç»§ç»­è¿è¡Œå°±æ˜¯å”¯ä¸€è¦åšçš„äº‹æƒ…ï¼Œæ‰€ä»¥ifè¯­å¥å—åé¢ä¸éœ€è¦ä½¿ç”¨elseåˆ†æ”¯ï¼ˆå«è¯­å¥ï¼‰</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">value, err :&#x3D; pack1.Function1(param1)
if err !&#x3D; nil &#123;
	fmt.Printf(&quot;An error occured in pack1.Function1 with parameter %v&quot;, param1)
	return err
&#125;
&#x2F;&#x2F; æœªå‘ç”Ÿé”™è¯¯ï¼Œç»§ç»­æ‰§è¡Œï¼š</code></pre>
<h2 id="switch-è¯­å¥">switch è¯­å¥</h2>
<p>ä¸å…¶ä»–è¯­è¨€switchè¯­å¥çš„ä¸åŒä¹‹å¤„ï¼š</p>
<ol type="1">
<li><p>å¯ä»¥åŒæ—¶æµ‹è¯•å¤šä¸ªç¬¦åˆæ¡ä»¶çš„å€¼ï¼šcase val1, val2, val3</p></li>
<li><p>åŒ¹é…æŸä¸ªåˆ†æ”¯åï¼Œä¼šé€€å‡ºæ•´ä¸ªswitchè¯­å¥ï¼Œæ‰€ä»¥ä¸éœ€è¦ç‰¹åˆ«ä½¿ç”¨breakæ¥ç»“æŸ</p></li>
<li><p>å¦‚æœæƒ³è¦æ‰§è¡Œåç»­åˆ†æ”¯çš„ä»£ç ï¼Œå¯ä»¥ä½¿ç”¨<code>fallthrough</code>å…³é”®å­—</p></li>
<li><p>switchè¯­å¥ä¹Ÿå¯ä»¥ä¸æä¾›ä»»ä½•è¢«åˆ¤æ–­çš„å€¼ï¼Œç„¶ååœ¨æ¯ä¸ªcaseåˆ†æ”¯ä¸­è¿›è¡Œä¸åŒæ¡ä»¶çš„æµ‹è¯•ï¼Œå¯ç”¨äºæ›¿ä»£æµ‹è¯•æ¡ä»¶éå¸¸å¤šçš„<code>if-else</code>è¯­å¥</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">switch &#123;
	case i &lt; 0:
		f1()
	case i &#x3D;&#x3D; 0:
		f2()
	case i &gt; 0:
		f3()
&#125;</code></pre></p></li>
<li><p>åŒæ ·çš„ç±»ä¼¼if-elseç»“æ„ï¼Œä¹Ÿå¯ä»¥åœ¨switchåè·Ÿä¸Šä¸€ä¸ªåˆå§‹åŒ–è¯­å¥</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">switch result :&#x3D; calculate(); &#123;
	case result &lt; 0:
		...
	case result &gt; 0:
		...
	default:
		&#x2F;&#x2F; 0
&#125;</code></pre></p></li>
<li></li>
</ol>
<h2 id="for-ç»“æ„">for ç»“æ„</h2>
<ol type="1">
<li>å¸¸è§çš„forç»“æ„ä¸å…¶ä»–è¯­è¨€ä¸€è‡´ for A; B; C { }</li>
<li>æ²¡æœ‰whileç»“æ„ï¼Œå­˜åœ¨æ ¹æ®æ¡ä»¶åˆ¤æ–­è¿›è¡Œçš„ for condition {}</li>
<li>æ— é™å¾ªç¯ç»“æ„å½¢å¦‚ï¼Œfor {}</li>
<li>å½¢å¦‚foreachçš„ç»“æ„ï¼Œä½¿ç”¨<strong>range</strong>å…³é”®å­—ï¼Œfor pos, value
<strong>range</strong> array {}
æ³¨æ„valueä¸ºé›†åˆä¸­å¯¹åº”ç´¢å¼•çš„<strong>å€¼æ‹·è´</strong>ï¼Œå› æ­¤å®ƒä¸€èˆ¬åªå…·æœ‰åªè¯»æ€§è´¨ï¼ˆå¦‚æœvalueä¸ºæŒ‡é’ˆï¼Œåˆ™ä¼šäº§ç”ŸæŒ‡é’ˆçš„æ‹·è´ï¼Œä¾æ—§å¯ä»¥ä¿®æ”¹é›†åˆä¸­çš„åŸå€¼ï¼‰å†™æ“ä½œå¹¶ä¸ç”Ÿæ•ˆ</li>
<li>ï¼ˆ5.5-5.6ï¼‰ break, continue, goto æ²¡æœ‰ä»€ä¹ˆä¸åŒ</li>
</ol>
<h1 id="chapter6">Chapter6</h1>
<h2 id="å‡½æ•°-ä»‹ç»">å‡½æ•°-ä»‹ç»</h2>
<ol type="1">
<li>goä¸­ä¸æ”¯æŒå‡½æ•°é‡è½½ï¼ˆå‡½æ•°é‡è½½éœ€è¦å¤šä½™çš„ç±»å‹åŒ¹é…ï¼Œå½±å“æ€§èƒ½ï¼‰ï¼ŒåŒåå‡½æ•°å°†ä¼šå¯¼è‡´ç¼–è¯‘æŠ¥é”™</li>
<li>å‡½æ•°æ˜¯ä¸€ç­‰å…¬æ°‘ï¼ˆfirst-class valueï¼‰ï¼Œå¯ä»¥èµ‹å€¼ç»™å˜é‡</li>
<li>goæ²¡æœ‰æ³›å‹çš„æ¦‚å¿µï¼Œåœ¨æ³¨é‡æ€§èƒ½çš„åœºåˆæœ€å¥½ä¸ºæ¯ä¸€ä¸ªç±»å‹å•ç‹¬åˆ›å»ºä¸€ä¸ªå‡½æ•°ï¼Œä½¿ä»£ç å¯è¯»æ€§æ›´å¼º</li>
</ol>
<h2 id="å‡½æ•°å‚æ•°ä¸è¿”å›å€¼">å‡½æ•°å‚æ•°ä¸è¿”å›å€¼</h2>
<ol type="1">
<li><p>goé»˜è®¤ä½¿ç”¨æŒ‰å€¼ä¼ é€’æ¥ä¼ é€’å‚æ•°ï¼Œä¹Ÿå°±æ˜¯ä¼ é€’å‚æ•°çš„å‰¯æœ¬</p></li>
<li><p>å¦‚æœå¸Œæœ›ç›´æ¥ä¿®æ”¹å‚æ•°çš„å€¼ï¼Œå¯ä»¥ä¼ é€’å‚æ•°çš„åœ°å€ï¼ˆ&amp;variableï¼‰ï¼Œç›¸å½“äºä¼ é€’ä¸€ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥é€šè¿‡è¿™ä¸ªæŒ‡é’ˆæ¥ä¿®æ”¹æŒ‡å‘åœ°å€ä¸Šçš„å€¼ã€‚</p></li>
<li><p>æ³¨æ„æŒ‡é’ˆä¹Ÿæ˜¯å˜é‡ï¼ŒæŒ‡é’ˆå˜é‡çš„å€¼æ˜¯å¦ä¸€ä¸ªå˜é‡çš„åœ°å€ï¼Œæ‰€ä»¥ä¼ é€’æŒ‡é’ˆä¹Ÿæ˜¯æŒ‰å€¼ä¼ é€’ã€‚å½“å‡½æ•°å†…æ”¹å˜ä¸€ä¸ªå ç”¨å†…å­˜è¾ƒå¤§çš„å˜é‡æ—¶ï¼Œä¼ é€’æŒ‡é’ˆä¸éœ€è¦èµ‹å€¼å˜é‡çš„å€¼ï¼Œæ€§èƒ½ä¼˜åŠ¿å°±æ›´åŠ æ˜æ˜¾äº†ã€‚</p></li>
<li><p>ä½¿ç”¨å¤šé‡è¿”å›å€¼ï¼šå¯ä»¥ä½¿ç”¨å‘½åè¿”å›å€¼ï¼Œæˆ–è€…éå‘½åè¿”å›å€¼ï¼›<strong>å°½é‡ä½¿ç”¨å‘½åè¿”å›å€¼ï¼Œä½¿ä»£ç æ›´å®¹æ˜“è¯»æ‡‚</strong></p></li>
<li><p>ä½¿ç”¨å‘½åè¿”å›å€¼æ—¶ï¼Œå¯ä»¥ä¸ºè¿”å›å€¼å˜é‡èµ‹å€¼åreturnï¼Œä¹Ÿå¯ä»¥returnå¯¹åº”çš„è¿”å›å€¼å˜é‡ï¼Œä½†ä»¥è¿”å›çš„æ˜ç¡®å€¼ä¸ºå‡†</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">func GetX2AndX3_2(input int) (x2 int, x3 int) &#123; &#x2F;&#x2F; å‡è®¾è¾“å…¥ä¸º10
	x2 &#x3D; input * 2
	x3 &#x3D; input * 3
	&#x2F;&#x2F;return &#x2F;&#x2F; è¿”å› 20ï¼Œ30
	&#x2F;&#x2F;return x2, x3 &#x2F;&#x2F; åŒæ ·è¿”å› 20ï¼Œ30
	return input, input &#x2F;&#x2F; è¿”å›10ï¼Œ10ï¼Œx2å’Œx3ä¹Ÿè¢«èµ‹å€¼ä¸º10
&#125;</code></pre></p></li>
</ol>
<h2 id="ä¼ é€’å˜é•¿å‚æ•°">ä¼ é€’å˜é•¿å‚æ•°</h2>
<ol type="1">
<li><p>å¦‚æœå‡½æ•°æœ€åä¸€ä¸ªå‚æ•°é‡‡ç”¨...typeçš„å½¢å¼ï¼Œè¿™ä¸ªå‡½æ•°å°±å¯ä»¥å¤„ç†ä¸€ä¸ªå˜é•¿å‚æ•°ï¼Œæ¥æ”¶ä¸€ä¸ªç±»ä¼¼äºåˆ‡ç‰‡ï¼ˆsliceï¼‰çš„å‚æ•°ï¼Œå¦‚ä¸‹ï¼Œå˜é‡Â <code>who</code>çš„å€¼ä¸ºÂ <code>[]string&#123;"Joe",
"Anna", "Eileen"&#125;</code></p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">func Greeting(prefix string, who ...string)
Greeting(&quot;hello:&quot;, &quot;Joe&quot;, &quot;Anna&quot;, &quot;Eileen&quot;)</code></pre></p></li>
<li><p>å¦‚æœå‚æ•°å­˜å‚¨åœ¨sliceç±»å‹å˜é‡<code>slice</code>ä¸­ï¼Œå¯ä»¥é€šè¿‡<code>slice...</code>çš„å½¢å¼æ¥ä¼ é€’å‚æ•°ï¼Œè°ƒç”¨å˜å‚å‡½æ•°</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">slice :&#x3D; []int&#123;7,9,3,5,1&#125;
x &#x3D; min(slice...)</code></pre></p></li>
</ol>
<h2 id="defer-å’Œè¿½è¸ª">defer å’Œè¿½è¸ª</h2>
<ol type="1">
<li>å…³é”®å­—<code>defer</code>å…è®¸å°†æŸä¸ªè¯­å¥æˆ–å‡½æ•°çš„æ‰§è¡Œæ¨è¿Ÿåˆ°å‡½æ•°è¿”å›ä¹‹å‰ï¼ˆæˆ–è€…è¯´ä»»æ„ä½ç½®çš„<code>return</code>è¯­å¥ä¹‹åï¼‰ï¼Œç±»ä¼¼C#ä¸Javaä¸­çš„finallyè¯­å¥å—</li>
<li>æ³¨æ„å¦‚æœ<code>defer</code>çš„å‡½æ•°aä¸­çš„æŸä¸ªå‚æ•°ä½¿ç”¨äº†å‡½æ•°bçš„è°ƒç”¨ç»“æœï¼Œå‡½æ•°bä¼šé©¬ä¸Šæ‰§è¡Œè€Œä¸ä¼šç­‰åˆ°å‡½æ•°è¿”å›å‰æ‰æ‰§è¡Œï¼Œè§<a
href="https://github.com/unknwon/the-way-to-go_ZH_CN/blob/master/eBook/examples/chapter_6/defer_tracing2.go">ç¤ºä¾‹
6.11</a></li>
</ol>
<h2 id="å°†å‡½æ•°ä½œä¸ºå‚æ•°">å°†å‡½æ•°ä½œä¸ºå‚æ•°</h2>
<p>å‡½æ•°å¯ä»¥ä½œä¸ºå…¶ä»–å‡½æ•°çš„å‚æ•°è¿›è¡Œä¼ é€’ï¼Œå‡½æ•°å‚æ•°çš„æ ¼å¼å¦‚ä¸‹ï¼š</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">&#x2F;&#x2F; strings.IndexFunc
func IndexFunc(s string, f func(c rune) bool) int
&#x2F;&#x2F; å‡½æ•°è¿”å›å€¼æ˜¯å­—ç¬¦ä¸²sä¸­ç¬¬ä¸€ä¸ªä½¿f(c)è¿”å›trueçš„unicodeå­—ç¬¦</code></pre>
<h2 id="é—­åŒ…">é—­åŒ…</h2>
<ol type="1">
<li><p>ä½¿ç”¨åŒ¿åå‡½æ•°ï¼Œä¾‹<code>func(x, y int) int &#123; return x+ y &#125;</code>
é™¤äº†æ²¡æœ‰åå­—å’Œå£°æ˜ä¸€ä¸ªå‡½æ•°æ˜¯ä¸€æ ·çš„</p></li>
<li><p>è¿™æ ·çš„ä¸€ä¸ªåŒ¿åå‡½æ•°ä¸èƒ½ç‹¬ç«‹å­˜åœ¨ï¼Œéœ€è¦å°†å®ƒèµ‹å€¼äºæŸä¸ªå˜é‡ï¼Œå†é€šè¿‡è¿™ä¸ªå˜é‡åè¿›è¡Œè°ƒç”¨ï¼›æˆ–è€…ç›´æ¥å¯¹è¿™ä¸ªåŒ¿åå‡½æ•°è¿›è¡Œè°ƒç”¨</p></li>
<li><p>å¯¹ä¸‹è¿°ä¾‹å­ä¸­çš„å‡½æ•°å˜é‡ï¼Œå˜é‡ä»£è¡¨çš„æ˜¯<code>func(int)</code>ï¼Œå˜é‡çš„å€¼æ˜¯ä¸€ä¸ªå†…å­˜åœ°å€</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">	for i :&#x3D; 0; i &lt; 4; i++ &#123;
		g :&#x3D; func(i int) &#123; fmt.Printf(&quot;%d &quot;, i) &#125;
		g(i)
		fmt.Printf(&quot; - g is of type %T and has value %v\n&quot;, g, g)
	&#125;

&#x2F;&#x2F; -- output
0 - g is of type func(int) and has value 0x681a80
1 - g is of type func(int) and has value 0x681b00
2 - g is of type func(int) and has value 0x681ac0
3 - g is of type func(int) and has value 0x681400</code></pre></p></li>
<li><p>é—­åŒ…ï¼šåŒ¿åå‡½æ•°è¢«å…è®¸å»æ•æ‰ä¸€äº›å¤–éƒ¨çŠ¶æ€ï¼Œä¾‹å¦‚å‡½æ•°è¢«åˆ›å»ºæ—¶çš„çŠ¶æ€ï¼›åˆæˆ–è€…è¯´é—­åŒ…ç»§æ‰¿äº†å‡½æ•°å£°æ˜æ—¶çš„ä½œç”¨åŸŸã€‚ä½œç”¨åŸŸå†…çš„å˜é‡è¢«å…±äº«åˆ°é—­åŒ…çš„ç¯å¢ƒä¸­ï¼Œå¯ä»¥åœ¨é—­åŒ…ä¸­è¢«æ“ä½œï¼Œç›´åˆ°é—­åŒ…é”€æ¯ã€‚</p></li>
</ol>
<h2 id="ä½¿ç”¨é—­åŒ…è°ƒè¯•">ä½¿ç”¨é—­åŒ…è°ƒè¯•</h2>
<p>ä½¿ç”¨runtimeåŒ…ä¸­çš„runtime.Calleræ¥æ‰“å°å½“å‰çš„æ‰§è¡Œæ–‡ä»¶ä¸æ‰§è¡Œè¡Œæ•°</p>
<h1 id="chapter7">Chapter7</h1>
<h2 id="æ•°ç»„ä¸åˆ‡ç‰‡-å£°æ˜å’Œåˆå§‹åŒ–">æ•°ç»„ä¸åˆ‡ç‰‡ å£°æ˜å’Œåˆå§‹åŒ–</h2>
<p>æ•°ç»„ï¼šå…·æœ‰ç›¸åŒå”¯ä¸€ç±»å‹çš„é•¿åº¦å›ºå®šçš„æ•°æ®é¡¹åºåˆ—ï¼Œæ•°ç»„é•¿åº¦å¿…é¡»æ˜¯å¸¸é‡è¡¨è¾¾å¼ï¼Œç¼–è¯‘æ—¶éœ€è¦çŸ¥é“æ•°ç»„é•¿åº¦ä»¥ä¾¿åˆ†é…å†…å­˜ã€‚</p>
<p>æ•°ç»„çš„å£°æ˜æ–¹å¼ï¼ˆå€¼ç±»å‹ï¼Œå£°æ˜å’Œåˆå§‹åŒ–å¯ä»¥åŒæ—¶å‘ç”Ÿï¼‰ï¼š</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">var identifier [len]type
&#x2F;&#x2F; ä¸¾ä¾‹ä¸€ä¸ªæ•°ç»„çš„åˆå§‹åŒ–
func main() &#123;
	var arr1 [5]int &#x2F;&#x2F; åˆå§‹åŒ–ä¸ºå…¨0

	for i:&#x3D;0; i &lt; len(arr1); i++ &#123;
		arr1[i] &#x3D; i * 2
	&#125;

	for i:&#x3D;0; i &lt; len(arr1); i++ &#123;
		fmt.Printf(&quot;Array at index %d is %d\n&quot;, i, arr1[i])
	&#125;
&#125;</code></pre>
<p>æ³¨æ„ï¼ŒGoè¯­è¨€ä¸­çš„æ•°ç»„æ˜¯<strong>å€¼ç±»å‹</strong>ï¼Œä¸åƒC/C++ä¸­æ˜¯æŒ‡å‘é¦–å…ƒç´ çš„æŒ‡é’ˆï¼Œæ‰€ä»¥æŠŠä¸€ä¸ªæ•°ç»„èµ‹å€¼ç»™å¦ä¸€ä¸ªæ—¶ï¼Œæˆ–è€…å°†æ•°ç»„ä½œä¸ºå‚æ•°ä¼ å…¥æ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿ<strong>æ•°ç»„æ‹·è´</strong>ã€‚</p>
<p>å°†ä¸€ä¸ªå¤§æ•°ç»„ä¼ é€’ç»™å‡½æ•°ä¼šæ¶ˆè€—å¾ˆå¤šå†…å­˜ï¼Œé€šè¿‡ä¼ é€’æ•°ç»„çš„æŒ‡é’ˆï¼Œæˆ–è€…ä½¿ç”¨æ•°ç»„çš„<strong>åˆ‡ç‰‡</strong>æ¥é¿å…è¿™ç§æƒ…å†µã€‚</p>
<h3 id="æ•°ç»„å¸¸é‡">æ•°ç»„å¸¸é‡</h3>
<p>å¦‚æœæ•°ç»„å†…å®¹å·²ç»æå‰çŸ¥é“ï¼Œé‚£ä¹ˆå¯ä»¥ç”¨æ•°ç»„å¸¸é‡æ¥åˆå§‹åŒ–è€Œä¸ç”¨ä¾æ¬¡èµ‹å€¼</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">var arrAge &#x3D; [5]int&#123;18, 20, 15, 22, 16&#125;
var arrKeyValue &#x3D; [5]string&#123;3: &quot;Chris&quot;, 4: &quot;Ron&quot;&#125; &#x2F;&#x2F; åªæœ‰ç´¢å¼•3å’Œ4è¢«èµ‹äºˆå®é™…çš„æŒ‡ï¼Œå…¶ä»–å…ƒç´ éƒ½è¢«è®¾ç½®ä¸ºç©ºçš„å­—ç¬¦ä¸²</code></pre>
<h2 id="åˆ‡ç‰‡">åˆ‡ç‰‡</h2>
<p>åˆ‡ç‰‡ï¼ˆsliceï¼‰æ˜¯å¯¹æ•°ç»„ä¸€ä¸ªè¿ç»­ç‰‡æ®µçš„å¼•ç”¨ï¼š</p>
<ol type="1">
<li><p>åˆ‡ç‰‡çš„é•¿åº¦å¯ä»¥åœ¨è¿è¡Œæ—¶ä¿®æ”¹ï¼Œæ˜¯ä¸€ä¸ªé•¿åº¦å¯å˜çš„æ•°ç»„</p></li>
<li><p>åˆ‡ç‰‡æä¾›è®¡ç®—å®¹é‡çš„å‡½æ•°<code>cap()</code>ï¼Œå¯¹åˆ‡ç‰‡<code>s</code>ï¼Œ<code>cap(s)</code>å°±æ˜¯ä»<code>s[0]</code>åˆ°åˆ‡ç‰‡æ¥æºæ•°ç»„<strong>æœ«å°¾</strong>çš„é•¿åº¦ï¼Œå¯¹åˆ‡ç‰‡sæ°¸è¿œæˆç«‹ï¼š<code>0â‰¤len(s)â‰¤cap(s)</code></p></li>
<li><p>è¡¨ç¤ºåŒä¸€ä¸ªæ•°ç»„ç‰‡æ®µçš„å¤šä¸ªåˆ‡ç‰‡ä¹‹é—´å…±äº«æ•°æ®ï¼Œå› ä¸ºæ˜¯å¼•ç”¨ï¼Œæ‰€ä»¥ä¸éœ€è¦ä½¿ç”¨é¢å¤–å†…å­˜</p></li>
<li><p>å£°æ˜åˆ‡ç‰‡ä»¥åŠåˆå§‹åŒ–åˆ‡ç‰‡çš„æ–¹å¼ï¼š</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">var identifier []type &#x2F;&#x2F; å£°æ˜ï¼Œæœªåˆå§‹åŒ–æ—¶ä¸ºnil
var slice1 []type &#x3D; arr1[start:end] &#x2F;&#x2F; åˆå§‹åŒ–ï¼Œä¸åŒ…å«æœ«å°¾ç´¢å¼•ï¼Œå·¦é—­å³å¼€
var slice2 []type &#x3D; arr1[:] &#x2F;&#x2F; åˆå§‹åŒ–ï¼ŒåŒ…å«æ•°ç»„å†…çš„æ‰€æœ‰å…ƒç´ 
s :&#x3D; [3]int&#123;1,2,3&#125;[:] &#x2F;&#x2F; ï¼ˆç­‰ä»·äºå…ˆç”¨ s :&#x3D; [3]int&#123;1, 2, 3&#125; ç”Ÿæˆæ•°ç»„, å†ä½¿ç”¨ s[:] è½¬æˆåˆ‡ç‰‡ï¼‰
s :&#x3D; []int&#123;1,2,3&#125; &#x2F;&#x2F; ç”šè‡³æ›´ç²¾ç®€çš„å½¢å¼ï¼Œç±»ä¼¼æ•°ç»„çš„åˆå§‹åŒ–æ–¹å¼

type intSlice []int &#x2F;&#x2F; ä½¿ç”¨type aliasï¼Œåˆå§‹åŒ–æ›´ç®€å•äº†
s :&#x3D; intSlice&#123;1,2,3&#125; &#x2F;&#x2F; æ˜¯ s :&#x3D; intSlice([]int&#123;1,2,3&#125;) çš„ç²¾ç®€å½¢å¼</code></pre></p></li>
<li><p>å¯¹åˆ‡ç‰‡çš„å¤§å°è¿›è¡Œæ“ä½œï¼Œåˆ‡ç‰‡åªèƒ½å‘åç§»åŠ¨ï¼Œå‘å‰ç§»åŠ¨ï¼ˆs2 = s2[-1:]ï¼‰
ä¼šå¯¼è‡´ç¼–è¯‘é”™è¯¯ï¼š</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">slice1 &#x3D; slice1[:len(slice1)-1] &#x2F;&#x2F; å»æ‰æœ€åä¸€ä¸ªå…ƒç´ 
slice1 &#x3D; slice1[:cap(slice1)] &#x2F;&#x2F; æ‰©å¤§åˆ°å¤§å°ä¸Šé™
s2 &#x3D; s2[1:] &#x2F;&#x2F; å¯ä»¥å°† s2 å‘åç§»åŠ¨ä¸€ä½ï¼Œä½†æ˜¯æœ«å°¾æ²¡æœ‰ç§»åŠ¨</code></pre></p></li>
<li><p><strong>ä¸è¦ç”¨æŒ‡é’ˆæŒ‡å‘åˆ‡ç‰‡</strong>ï¼Œåˆ‡ç‰‡æœ¬èº«å°±æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå·²ç»æ˜¯å¼•ç”¨ç±»å‹</p></li>
<li><p>å½“æ•°ç»„æ²¡æœ‰å®šä¹‰æ—¶ï¼Œä½¿ç”¨makeæ¥åˆå§‹åŒ–/åˆ›å»ºä¸€ä¸ªåˆ‡ç‰‡ï¼ˆå½“ç„¶åŒæ—¶ä¹Ÿåˆ›å»ºäº†ç›¸å…³æ•°ç»„ï¼‰</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">var slice1 []type &#x3D; make([]type, len) &#x2F;&#x2F; len ä¸ºåˆ‡ç‰‡é•¿åº¦
slice1 :&#x3D; make([]type, len) &#x2F;&#x2F; ç²¾ç®€å½¢å¼
slice1 :&#x3D; make([]type, len, cap) &#x2F;&#x2F; ç²¾ç®€å½¢å¼, æ¥æ”¶capä¸ºåˆ‡ç‰‡å®¹å™¨å¤§å°</code></pre></p></li>
<li><p><strong>new</strong>å’Œ<strong>make</strong>çš„åŒºåˆ«ï¼š</p>
<ol type="1">
<li><code>new(T)</code>ä¸ºç±»å‹Tåˆ†é…ä¸€ç‰‡å†…å­˜ï¼Œåˆå§‹åŒ–ä¸º0å¹¶è¿”å›ç±»å‹*TæŒ‡é’ˆï¼Œä¸ä¼šåšé¢å¤–çš„åˆå§‹åŒ–æ“ä½œï¼ˆæ‰€ä»¥å†…å»ºç±»å‹éœ€è¦<code>make</code>ï¼‰ï¼Œé€‚ç”¨äºå€¼ç±»å‹å¦‚<strong>æ•°ç»„</strong>å’Œ<strong>ç»“æ„ä½“</strong></li>
<li><code>make(T)</code>è¿”å›ç±»å‹Tçš„åˆå§‹å€¼ï¼Œåªé€‚ç”¨äºå†…å»ºå¼•ç”¨ç±»å‹ï¼š<code>slice</code>ã€<code>map</code>ä¸<code>channe</code>ï¼Œä¸‰è€…åœ¨å†…å­˜ä¸­æœ‰å¤šä¸ªç»„æˆéƒ¨åˆ†ï¼Œéœ€è¦å¯¹å†…å­˜ä¸­çš„ç»„æˆéƒ¨åˆ†åˆå§‹åŒ–æ‰èƒ½ä½¿ç”¨ï¼Œmakeå°±æ˜¯å¯¹ä¸‰è€…è¿›è¡Œåˆå§‹åŒ–çš„ä¸€ç§æ“ä½œæ–¹å¼</li>
<li>è¯•å›¾<code>make()</code>ä¸€ä¸ªç»“æ„ä½“å˜é‡ä¼šå¼•å‘ç¼–è¯‘é”™è¯¯ï¼Œè¿˜ä¸ç®—å¤ªç³Ÿç³•ï¼Œä½†<code>new</code>ä¸€ä¸ª<code>map</code>å¹¶è¯•å›¾å‘å…¶å¡«å……æ•°æ®ï¼Œå°†ä¼šå¼•å‘è¿è¡Œæ—¶é”™è¯¯ï¼Œå› ä¸º<code>new(map)</code>è¿”å›çš„æ˜¯<code>nil</code>æŒ‡é’ˆï¼Œå®ƒå°šæœªè¢«åˆ†é…å†…å­˜</li>
</ol></li>
</ol>
<h3 id="bytesåŒ…">bytesåŒ…</h3>
<p>ç±»ä¼¼java / C#
ä¸­çš„StringBuilderç±»ï¼Œé€šè¿‡å£°æ˜bytes.Bufferå¯¹è±¡ï¼Œæˆ–è€…newä¸€ä¸ªå‡ºæ¥ï¼Œæˆ–è€…é€šè¿‡å‡½æ•°<code>func
NewBuffer(buf []byte)
*Buffer</code>ï¼Œåˆ›å»ºä¸€ä¸ªÂ <code>Buffer</code>å¯¹è±¡å¹¶ä¸”ç”¨Â <code>buf</code>åˆå§‹åŒ–å¥½</p>
<h2 id="for-range-ç»“æ„">for-range ç»“æ„</h2>
<ol type="1">
<li><p>åœ¨for-rangeç»“æ„ä¸­ä½¿ç”¨_æ¥å¿½ç•¥ç´¢å¼• / å˜é‡</p></li>
<li><p>å¦‚æœåªéœ€è¦ç´¢å¼•ï¼Œå¯ä»¥ç›´æ¥å¿½ç•¥ç¬¬äºŒä¸ªå˜é‡</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">seasons :&#x3D; []string&#123;&quot;Spring&quot;, &quot;Summer&quot;, &quot;Autumn&quot;, &quot;Winter&quot;&#125;
for _, season &#x3D; range seasons &#123;
		fmt.Printf(&quot;%s\n&quot;, season)
&#125;

for ix :&#x3D; range seasons &#123;
	fmt.Printf(&quot;%d&quot;, ix)
&#125;</code></pre></p></li>
</ol>
<h2 id="åˆ‡ç‰‡é‡ç»„reslice">åˆ‡ç‰‡é‡ç»„ï¼ˆresliceï¼‰</h2>
<h2 id="åˆ‡ç‰‡å¤åˆ¶ä¸è¿½åŠ ">åˆ‡ç‰‡å¤åˆ¶ä¸è¿½åŠ </h2>
<ol type="1">
<li>ä½¿ç”¨<code>copy(to []T, from
[]T)</code>æ¥å°†fromåˆ‡ç‰‡ä¸­çš„å†…å®¹æ‹·è´åˆ°toåˆ‡ç‰‡ä¸­ï¼Œè¦†ç›–toç°æœ‰çš„å…ƒç´ ï¼Œå‡½æ•°è¿”å›èµ‹å€¼çš„ä¸ªæ•°</li>
<li>ä½¿ç”¨<code>append(s []T, x
...T)</code>æ¥å°†å¤šä¸ªç›¸åŒç±»å‹å…ƒç´ ï¼ˆå¦‚æœéœ€è¦è¿½åŠ åˆ‡ç‰‡ï¼Œå°†ç¬¬äºŒä¸ªå‚æ•°æ‹“å±•æˆå‚æ•°åˆ—è¡¨<code>x
= append(x,
y...)</code>ï¼‰è¿½åŠ åˆ°åˆ‡ç‰‡åï¼Œå¹¶è¿”å›æ–°çš„åˆ‡ç‰‡ã€‚å¦‚æœåŸåˆ‡ç‰‡å®¹é‡ä¸è¶³ï¼Œä¼šåˆ†é…æ–°çš„æ•°ç»„ç»™åˆ‡ç‰‡ï¼Œæ‰€ä»¥æ–°çš„åˆ‡ç‰‡<strong>å¯èƒ½</strong>ä¸å†æŒ‡å‘åŒä¸€ä¸ªæ•°ç»„ã€‚</li>
<li>ç”±2å¯ä»¥å¾—åˆ°ï¼Œå¦‚æœå°†åˆ‡ç‰‡ä½œä¸ºå‡½æ•°å‚æ•°ä¼ å…¥ï¼Œåœ¨å‡½æ•°å†…éƒ¨å¯¹åˆ‡ç‰‡è¿›è¡Œäº†æ‰©å®¹ï¼Œæœ€å¥½å†å°†åˆ‡ç‰‡ä½œä¸ºè¿”å›å€¼ä¼ å‡ºï¼Œæ‰èƒ½åœ¨å‡½æ•°å¤–éƒ¨å¾—åˆ°æ‰©å®¹åçš„åˆ‡ç‰‡</li>
</ol>
<h2 id="å­—ç¬¦ä¸²æ•°ç»„å’Œåˆ‡ç‰‡çš„åº”ç”¨">å­—ç¬¦ä¸²ã€æ•°ç»„å’Œåˆ‡ç‰‡çš„åº”ç”¨</h2>
<ol type="1">
<li>ä½¿ç”¨<code>substr := str[start:end]</code>
æ¥è·å–ä»ç´¢å¼•startåˆ°end-1çš„å­å­—ç¬¦ä¸²</li>
<li>å…³äºåˆ‡ç‰‡çš„æ“ä½œï¼Œå¯ä»¥å‚è€ƒ<a
href="https://github.com/unknwon/the-way-to-go_ZH_CN/blob/master/eBook/07.6.md#767-append-%E5%87%BD%E6%95%B0%E5%B8%B8%E8%A7%81%E6%93%8D%E4%BD%9C">7.6.7
append() å‡½æ•°å¸¸è§æ“ä½œ</a></li>
<li>åˆ‡ç‰‡åº•å±‚æŒ‡å‘ä¸€ä¸ªæ•°ç»„ï¼Œåªæœ‰ä¸è¢«ä»»ä½•åˆ‡ç‰‡æŒ‡å‘çš„æ—¶å€™ï¼Œæ•°ç»„çš„å†…å­˜æ‰ä¼šè¢«é‡Šæ”¾ï¼Œæ‰€ä»¥æ³¨æ„åˆ‡ç‰‡æŒ‡å‘çš„æ•°ç»„ï¼Œåœ¨å¿…è¦æ—¶ï¼Œä»¥éƒ¨åˆ†å†…å®¹æ–°å»ºä¸€ä¸ªåˆ‡ç‰‡</li>
<li>ä½¿ç”¨<code>c :=
byte[](str)</code>æ¥å°†å­—ç¬¦ä¸²è½¬åŒ–ä¸ºå­—ç¬¦åˆ‡ç‰‡ï¼Œä»è€Œä¿®æ”¹å­—ç¬¦ä¸²å†…å®¹ï¼Œå­—ç¬¦ä¸²å†…å®¹æ— æ³•è¢«ç›´æ¥ç´¢å¼•ä¿®æ”¹ï¼ˆæ”¾åœ¨ç­‰å·å·¦è¾¹ï¼‰</li>
</ol>
<h1 id="chapter8">Chapter8</h1>
<h2 id="map-çš„å£°æ˜åˆå§‹åŒ–å’Œmake">Map çš„å£°æ˜ã€åˆå§‹åŒ–å’Œmake</h2>
<ol type="1">
<li><p>è‡ªç„¶çš„ï¼Œmapæ˜¯å¼•ç”¨ç±»å‹</p></li>
<li><p>mapçš„å£°æ˜æ ¼å¼å¦‚ä¸‹ï¼Œä¸éœ€è¦é•¿åº¦ï¼Œå› ä¸ºå¤§å°å¯ä»¥åŠ¨æ€å¢é•¿</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">var map1 map[keytype]valuetype
var map1 map[string]int</code></pre></p></li>
<li><p>keyéœ€è¦æ—¶å¯ä»¥ç”¨æ“ä½œç¬¦æ¯”è¾ƒçš„ç±»å‹ï¼Œvalueå¯ä»¥æ˜¯ä»»ä½•ç±»å‹</p></li>
<li><p>mapå¯ä»¥ç”¨Â <code>map[keyType]valueType&#123;key1: val1, key2:
val2&#125;</code>çš„æè¿°æ–¹æ³•æ¥åˆå§‹åŒ–ï¼Œå°±åƒæ•°ç»„å’Œç»“æ„ä½“ä¸€æ ·</p></li>
<li><p>å¼•ç”¨ç±»å‹çš„mapä½¿ç”¨<code>make</code>è¿›è¡Œåˆå§‹åŒ–</p></li>
<li><p>ä½¿ç”¨<code>make</code>åˆå§‹åŒ–mapæ—¶å¯ä»¥æ ‡æ˜åˆå§‹å®¹é‡ï¼Œå½“å¢é•¿åˆ°å®¹é‡ä¸Šé™æ—¶ï¼Œmapå¤§å°ä¼šè‡ªåŠ¨+1</p></li>
<li><p>å°†valueå®šä¹‰æˆ<code>[]int</code>ç±»å‹æˆ–è€…å…¶ä»–ç±»å‹çš„åˆ‡ç‰‡ï¼Œæ¥è§£å†³ä¸€ä¸ªvalueå¯¹åº”å¤šä¸ªå€¼çš„é—®é¢˜</p></li>
</ol>
<h2 id="é”®å€¼å¯¹æ£€æŸ¥å…ƒç´ åˆ é™¤">é”®å€¼å¯¹æ£€æŸ¥ï¼Œå…ƒç´ åˆ é™¤</h2>
<ol type="1">
<li>å¯ä»¥ä½¿ç”¨Â <code>val1 =
map1[key1]</code>çš„æ–¹æ³•è·å–Â <code>key1</code>Â å¯¹åº”çš„å€¼Â <code>val1</code>ã€‚å¦‚æœÂ <code>map</code>ä¸­ä¸å­˜åœ¨Â <code>key1</code>ï¼Œ<code>val1</code>å°±æ˜¯ä¸€ä¸ªå€¼ç±»å‹çš„ç©ºå€¼ã€‚</li>
<li>å¦‚ä½•åŒºåˆ†key1ä¸å­˜åœ¨è¿˜æ˜¯å¯¹åº”valueæ˜¯ç©ºå€¼ï¼Ÿå¯ä»¥ä½¿ç”¨<code>val1, isPresent
=
map1[key1]</code>ï¼Œå½“keyå­˜åœ¨äºmapä¸­æ—¶ï¼Œ<code>isPresent</code>ä¼šè¿”å›true</li>
</ol>
<h2 id="for-range-é…å¥—ç”¨æ³•éå†map">for-range é…å¥—ç”¨æ³•ï¼ˆéå†mapï¼‰</h2>
<ol type="1">
<li>å’Œå‰é¢ç±»ä¼¼çš„ï¼Œå¦‚æœåªå…³å¿ƒå€¼ä¸å…³å¿ƒkeyï¼Œå¯ä»¥<code>_,value := range
map</code> ï¼Œåä¹‹å¦‚æœåªå…³å¿ƒkeyä¸å…³å¿ƒå€¼ï¼Œå¯ä»¥ <code>key := range
map</code></li>
<li>æ³¨æ„ï¼Œmapçš„æœ¬è´¨æ˜¯æ•£åˆ—è¡¨ï¼Œmapçš„å¢é•¿æ‰©å®¹ä¼šå¯¼è‡´é‡æ–°æ•£åˆ—ï¼ŒåŒæ—¶Goè®¾è®¡è€…ä¹Ÿè®©æ¯æ¬¡éå†çš„èµ·ç‚¹ä¸ä¸€æ ·ï¼Œæ‰€ä»¥éå†mapæ€»æ˜¯æ— åºçš„ï¼Œä¸ºäº†è®©æˆ‘ä»¬ä¸ä¾èµ–mapçš„éå†æ’åºä¸­çš„é¡ºåº</li>
<li>å¦‚æœæƒ³è¦è·å¾—<code>map</code>ç±»å‹çš„åˆ‡ç‰‡ï¼Œå°±éœ€è¦ä½¿ç”¨ä¸¤æ¬¡<code>make()</code>å‡½æ•°ï¼Œç¬¬ä¸€æ¬¡ç”¨äºåˆ†é…åˆ‡ç‰‡ï¼Œç¬¬äºŒæ¬¡ç”¨äºåˆ†é…åˆ‡ç‰‡ä¸­çš„æ¯ä¸ª<code>map</code>å…ƒç´ ï¼›æ³¨æ„ï¼Œå½“ä½ ä½¿ç”¨<code>range</code>æ¥éå†åˆ†é…æ—¶ï¼Œè·å¾—çš„åªæ˜¯mapå€¼çš„æ‹·è´ï¼Œæ‰€ä»¥å¹¶ä¸èƒ½çœŸæ­£è¿›è¡Œ<code>map</code>å…ƒç´ çš„åˆå§‹åŒ–</li>
</ol>
<h2 id="mapçš„æ’åº">mapçš„æ’åº</h2>
<ol type="1">
<li>ç”±äº<code>map</code>çš„æ— åºæ€§ï¼Œå½“éœ€è¦ä¸º<code>map</code>æ’åºæ—¶ï¼Œè€ƒè™‘å°†keyæˆ–valueæ‹·è´åˆ°åˆ‡ç‰‡ä¸­ï¼Œå¯¹åˆ‡ç‰‡è¿›è¡Œæ’åºï¼Œå†å¯¹åˆ‡ç‰‡ä½¿ç”¨<code>for-range</code>ï¼Œæ‰“å°å‡ºæ‰€æœ‰key-value</li>
</ol>
<h1 id="chapter9">Chapter9</h1>
<h2 id="æ ‡å‡†åº“æ¦‚è¿°">æ ‡å‡†åº“æ¦‚è¿°</h2>
<p>ç®€å•è®°å½•ä¸€ä¸‹ï¼Œæ„Ÿè§‰ç”¨å¾—ä¸Šçš„</p>
<ol type="1">
<li>ioï¼šåŸºæœ¬è¾“å…¥è¾“å‡º</li>
<li>bufioï¼šç¼“å†²è¾“å…¥è¾“å‡º</li>
<li>path/filepathï¼šç³»ç»Ÿç›®æ ‡æ–‡ä»¶åç›®å½•</li>
<li>stringsï¼šå­—ç¬¦ä¸²æ“ä½œ</li>
<li>strconvï¼šå­—ç¬¦ä¸²è½¬æ¢ä¸ºåŸºç¡€ç±»å‹</li>
<li>regexpï¼šæ­£åˆ™è¡¨è¾¾å¼</li>
<li>bytesï¼šå­—ç¬¦å‹åˆ†ç‰‡</li>
<li>mathï¼šæ•°å­¦å‡½æ•°</li>
<li>math/randï¼šä¼ªéšæœºæ•°ç”Ÿæˆ</li>
<li>sortï¼šæ•°ç»„æ’åºå’Œè‡ªå®šä¹‰é›†åˆ</li>
<li>encoding/jsonï¼šç¼–ç è§£ç jsonæ•°æ®</li>
<li>runtimeï¼šGoç¨‹åºè¿è¡Œæ—¶äº¤äº’ï¼Œåƒåœ¾å›æ”¶/åç¨‹åˆ›å»º</li>
<li>reflectï¼šè¿è¡Œæ—¶åå°„</li>
</ol>
<h2 id="é”ä¸syncåŒ…">é”ä¸syncåŒ…</h2>
<ol type="1">
<li><p><code>sync.Mutex</code>æ˜¯ä¸€ä¸ªäº’æ–¥é”ï¼Œå®ˆæŠ¤åœ¨ä¸´ç•ŒåŒºå…¥å£ä¿è¯åŒä¸€æ—¶é—´åªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ä¸´ç•ŒåŒº</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">type Info struct &#123;
	mu sync.Mutex
	&#x2F;&#x2F; ... other fields, e.g.: Str string
&#125;

&#x2F;&#x2F; example
info.mu.Lock()
&#x2F;&#x2F; ä¸´ç•ŒåŒºä¿®æ”¹
info.mu.Unlock()</code></pre></p></li>
<li><p><code>sync.RWMutex</code>é”ï¼Œèƒ½é€šè¿‡<code>RLock()</code>æ¥å…è®¸åŒä¸€æ—¶é—´å¤šä¸ªçº¿ç¨‹å¯¹å˜é‡è¿›è¡Œè¯»æ“ä½œï¼Œä½†åªæœ‰ä¸€ä¸ªç°æˆèƒ½è¿›è¡Œå†™æ“ä½œ</p></li>
</ol>
<h2 id="ç²¾å¯†è®¡ç®—ä¸bigåŒ…">ç²¾å¯†è®¡ç®—ä¸bigåŒ…</h2>
<p>å¯¹äºæ•´æ•°çš„é«˜ç²¾åº¦è®¡ç®—ï¼Œæä¾›äº†Â <code>big</code>åŒ…ï¼Œè¢«åŒ…å«åœ¨Â <code>math</code>åŒ…ä¸‹ï¼šæœ‰ç”¨æ¥è¡¨ç¤ºå¤§æ•´æ•°çš„Â <code>big.Int</code>
å’Œè¡¨ç¤ºå¤§æœ‰ç†æ•°çš„Â <code>big.Rat</code>ç±»å‹</p>
<h2 id="è‡ªå®šä¹‰åŒ…ä¸å¯è§æ€§">è‡ªå®šä¹‰åŒ…ä¸å¯è§æ€§</h2>
<ol type="1">
<li><p>import çš„ä¸€èˆ¬æ ¼å¼ï¼š<code>import
â€œåŒ…çš„è·¯å¾„æˆ–URLåœ°å€â€</code>ï¼Œéè‡ªå®šä¹‰æœ¬åœ°åŒ…ä¸€èˆ¬å­˜æ”¾åœ¨$GOROOT/srcï¼ˆå®˜æ–¹åŒ…ï¼‰ä¸‹æˆ–â€‹$GOPATH/srcï¼ˆç¬¬ä¸‰æ–¹åŒ…ï¼‰ä¸‹</p></li>
<li><p><strong>ï¼ˆmodule
modeï¼‰</strong>ç”¨ç›¸å¯¹è·¯å¾„ï¼ˆâ€./â€ï¼‰importè‡ªå®šä¹‰åŒ…åœ¨module
modeä¸‹ä¸æ”¯æŒï¼Œå¯ä»¥ä½¿ç”¨ä»moduleåï¼ˆåœ¨go.modä¸­å®šä¹‰ï¼‰å¼€å§‹ç›¸å¯¹è·¯å¾„çš„æ–¹å¼è¿›è¡Œimport</p>
<p></p>
<p><a href="/p/e842888b11eb/Untitled_3.png" class="gallery-item"><img src="/p/e842888b11eb/Untitled_3.png" class="" title="è¿™é‡Œåœ¨IDEä¸­enable-go-modules-integrationåçš„çŠ¶æ€"></a></p>
<p>è¿™é‡Œæ˜¯enable go modules integrationçŠ¶æ€</p></li>
<li><p><strong>ï¼ˆmodule modeï¼‰</strong>å¦‚æœéœ€è¦ç”¨go install / go get
æ¥ä¸‹è½½packageï¼Œéœ€è¦æ‰“å¼€module mode</p>
<p><a href="/p/e842888b11eb/Untitled_4.png" class="gallery-item"><img src="/p/e842888b11eb/Untitled_4.png" class="" title="æç¤ºå½“å‰modulesè¢«å…³é—­"></a></p></li>
<li><p><strong>ï¼ˆmodule modeï¼‰</strong>é€šè¿‡go env æ¥æŸ¥çœ‹æ˜¯å¦æ‰“å¼€äº†GO
MODULE MODE</p>
<p><a href="/p/e842888b11eb/Untitled_5.png" class="gallery-item"><img src="/p/e842888b11eb/Untitled_5.png" class="" title="go envè¾“å‡ºç»“æœ"></a></p></li>
<li><p><strong>ï¼ˆmodule modeï¼‰</strong>é€šè¿‡go install / go
getä¸‹è½½çš„packageï¼Œä¼šè¢«ä¸‹è½½åˆ°$GOPATHçš„pkgç›®å½•ä¸‹</p></li>
<li><p><strong>ï¼ˆmodule
modeï¼‰</strong>è¦ä½¿ç”¨ä¸‹è½½çš„packageï¼Œéœ€è¦ç¼–è¾‘é¡¹ç›®çš„go.modï¼ˆæ˜¯ä¸æ˜¯IDEå¸®æˆ‘è‡ªåŠ¨ç¼–è¾‘äº†æˆ‘ä¸æ˜¯å¾ˆæ¸…æ¥šï¼‰</p>
<p><a href="/p/e842888b11eb/Untitled_6.png" class="gallery-item"><img src="/p/e842888b11eb/Untitled_6.png" class="" title="go.modæ–‡ä»¶å†…å®¹"></a></p></li>
<li><p>ä½¿ç”¨<code>import [name]
â€œpathâ€</code>ï¼Œæ¥ç»™importçš„åŒ…èµ·ä¸€ä¸ªåˆ«åï¼Œä½¿ç”¨<code>import _
â€œpathâ€</code>ï¼Œæ¥å¿½ç•¥è¿™ä¸ªåŒ…ï¼Œä»…é€šè¿‡importæ‰§è¡Œpackageçš„initæ–¹æ³•</p></li>
</ol>
<h1 id="chapter10">Chapter10</h1>
<h2 id="ç»“æ„ä¸æ–¹æ³•">ç»“æ„ä¸æ–¹æ³•</h2>
<ol type="1">
<li>Goé€šè¿‡ç±»å‹åˆ«åå’Œç»“æ„ä½“çš„å½¢å¼æ”¯æŒç”¨æˆ·è‡ªå®šä¹‰ç±»å‹</li>
<li>ç»“æ„ä½“ä¹Ÿæ˜¯<strong>å€¼ç±»å‹</strong>ï¼Œæ‰€ä»¥é€šè¿‡<code>new()</code>å‡½æ•°æ¥åˆ›å»º</li>
<li>Goè¯­è¨€ä¸­æ²¡æœ‰ç±»çš„æ¦‚å¿µï¼Œå› æ­¤ç»“æ„ä½“æœ‰ç€æ›´ä¸ºé‡è¦çš„åœ°ä½</li>
</ol>
<h2 id="ç»“æ„ä½“å®šä¹‰">ç»“æ„ä½“å®šä¹‰</h2>
<ol type="1">
<li><p>ç»“æ„ä½“çš„å®šä¹‰æ–¹å¼ï¼š</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">type identifier struct &#123;
	field1 type1
	field2 type2
&#125;</code></pre></p></li>
<li><p>å£°æ˜ç»“æ„ä½“å˜é‡çš„æ–¹å¼</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">var t *T
t &#x3D; new(T) &#x2F;&#x2F; ä½¿ç”¨new()ï¼Œtçš„ç±»å‹æ˜¯*T

var s T
T.a &#x3D; 5 &#x2F;&#x2F; ç›´æ¥å£°æ˜ç»“æ„ä½“å˜é‡ï¼Œtçš„ç±»å‹æ˜¯T

&#x2F;&#x2F;ç»“æ„ä½“å­—é¢é‡ï¼šstruct-literal
ms :&#x3D; struct1&#123;10, 15.5, &quot;Chris&quot;&#125; &#x2F;&#x2F;å¿…é¡»æŒ‰ç…§å­—æ®µé¡ºåºå†™ï¼Œmsçš„ç±»å‹æ˜¯struct1
ms :&#x3D; &amp;struct1&#123;10, 15.5, &quot;Chris&quot;&#125; &#x2F;&#x2F; åŒä¸Šï¼Œmsçš„ç±»å‹æ˜¯*struct1
intr :&#x3D; Interval&#123;end:5, start:1&#125; &#x2F;&#x2F; å¯ä»¥ä¸æŒ‰ç…§å­—æ®µé¡ºåºï¼Œå¯ä»¥ä¸ç»™æ¯ä¸€ä¸ªå­—æ®µèµ‹å€¼
r1 :&#x3D; Rect1&#123;Point&#123;10, 20&#125;, Point&#123;50, 60&#125;&#125; &#x2F;&#x2F; åµŒå¥—</code></pre></p></li>
<li><p>å¯¹äºä¸€ä¸ªç»“æ„ä½“ç±»å‹å’Œä¸€ä¸ªç»“æ„ä½“ç±»å‹æŒ‡é’ˆï¼Œéƒ½å¯ä»¥ç”¨ç›¸åŒçš„<strong>é€‰æ‹©å™¨ç¬¦ï¼ˆselector-notationï¼‰</strong>ï¼Œå³<code>.</code>ç¬¦å·æ¥å¼•ç”¨ç»“æ„ä½“çš„å­—æ®µ</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">type myStruct struct &#123; i int &#125;
var v myStruct    &#x2F;&#x2F; v æ˜¯ç»“æ„ä½“ç±»å‹å˜é‡
var p *myStruct   &#x2F;&#x2F; p æ˜¯æŒ‡å‘ä¸€ä¸ªç»“æ„ä½“ç±»å‹å˜é‡çš„æŒ‡é’ˆ
v.i
p.i &#x2F;&#x2F; è¿™é‡Œä¼šæŠ¥é”™ï¼Œå› ä¸ºpæŒ‡é’ˆä¸ºnil</code></pre></p></li>
<li><p>å½“ä¸ºç»“æ„ä½“å®šä¹‰äº†ä¸€ä¸ª<code>alias</code>ç±»å‹æ—¶ï¼Œç»“æ„ä½“å’Œå®ƒçš„<code>alias</code>ç±»å‹å…·æœ‰ç›¸åŒçš„åº•å±‚ç±»å‹ï¼Œå¯ä»¥äº’ç›¸è½¬æ¢</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">type number struct &#123;
    f float32
&#125;

type nr number   &#x2F;&#x2F; alias type</code></pre></p></li>
<li><p>ä½¿ç”¨Â <code>fmt.Println()</code>æ‰“å°ä¸€ä¸ªç»“æ„ä½“çš„é»˜è®¤è¾“å‡ºå¯ä»¥å¾ˆå¥½çš„æ˜¾ç¤ºå®ƒçš„å†…å®¹ï¼Œç±»ä¼¼ä½¿ç”¨Â <code>%v</code>é€‰é¡¹ã€‚ä½¿ç”¨<code>%+v</code>é€‰é¡¹ä¼šå…ˆè¾“å‡ºå­—æ®µåå­—å†è¾“å‡ºå­—æ®µçš„å€¼ï¼Œä½¿ç”¨<code>%#v</code>å­—æ®µä¼šåœ¨å‰è€…åŸºç¡€ä¸Šå…ˆè¾“å‡ºç»“æ„ä½“çš„åå­—</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">The name of person is &#123;EDWARD CHEN&#125;
The name of person is &amp;&#123;firstName:EDWARD lastName:CHEN&#125;
The name of person is chapter10.Person&#123;firstName:&quot;EDWARD&quot;, lastName:&quot;CHEN&quot;&#125;</code></pre></p></li>
<li><p><code>fmt.Printf</code> / <code>fmt.Print</code> /
<code>fmt.Println</code> å‡ä¼šè‡ªåŠ¨ä½¿ç”¨ç»“æ„ä½“çš„String
æ–¹æ³•ï¼Œé€šè¿‡ç»™å‡ºç»“æ„ä½“ä¸ºæ¥æ”¶è€…çš„Stringæ–¹æ³•æ¥è¿›è¡Œè‡ªå®šä¹‰</p></li>
</ol>
<h2 id="ä½¿ç”¨å·¥å‚æ–¹æ³•åˆ›å»ºç»“æ„ä½“å®ä¾‹">ä½¿ç”¨å·¥å‚æ–¹æ³•åˆ›å»ºç»“æ„ä½“å®ä¾‹</h2>
<ol type="1">
<li>Goè¯­è¨€ä¸æ”¯æŒé¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ä¸­çš„æ„é€ æ–¹æ³•ï¼Œä½†æ˜¯å¯ä»¥å¯ä»¥å¾ˆå®¹æ˜“å®ç°â€œæ„é€ å­å·¥å‚â€æ–¹æ³•ï¼ŒæŒ‰æƒ¯ä¾‹ä»¥â€œnewâ€¦â€æˆ–â€œNewâ€¦â€å¼€å¤´</li>
<li>é€šè¿‡å¯è§æ€§åŸåˆ™å¯ä»¥å°†ç»“æ„ä½“ç”±å°å†™å¼€å§‹ï¼Œæ¥ç¦æ­¢ä½¿ç”¨<code>new()</code>å‡½æ•°ï¼Œå¼ºåˆ¶ç”¨æˆ·ä½¿ç”¨å·¥å‚æ–¹æ³•</li>
</ol>
<h2 id="å¸¦æ ‡ç­¾çš„ç»“æ„ä½“">å¸¦æ ‡ç­¾çš„ç»“æ„ä½“</h2>
<p>ç±»ä¼¼æ³¨é‡Šï¼Œåœ¨ç»“æ„ä½“çš„å­—æ®µç±»å‹åé¢å¯ä»¥ç”¨<code>""</code>è¿›è¡Œå­—æ®µçš„è§£é‡Šï¼Œç§°ä¸ºæ ‡ç­¾(tag)</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">type TagType struct &#123; &#x2F;&#x2F; tags
	field1 bool   &quot;An important answer&quot;
	field2 string &quot;The name of the thing&quot;
	field3 int    &quot;How much there are&quot;
&#125;</code></pre>
<h2 id="åŒ¿åå­—æ®µå’Œå†…åµŒç»“æ„ä½“">åŒ¿åå­—æ®µå’Œå†…åµŒç»“æ„ä½“</h2>
<ol type="1">
<li>å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªåŒ¿åå­—æ®µï¼Œè¿™äº›å­—æ®µåªæœ‰<strong>ç±»å‹</strong>æ˜¯å¿…é¡»çš„ï¼ŒåŒ¿åå­—æ®µæœ¬èº«ä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªç»“æ„ä½“ï¼Œå³å†…åµŒç»“æ„ä½“ï¼›ç»“æ„ä½“ä¸­æ¯ä¸€ç§æ•°æ®ç±»å‹åªèƒ½æœ‰ä¸€ä¸ªåŒ¿åå­—æ®µ</li>
<li>åŒ¿åå­—æ®µ/å†…åµŒç»“æ„ä½“
è¢«ç”¨æ¥æ¨¡æ‹Ÿç±»ä¼¼ç»§æ‰¿çš„è¡Œä¸ºï¼ŒGoè¯­è¨€é€šè¿‡<strong>å†…åµŒæˆ–ç»„åˆ</strong>æ¥å®ç°</li>
<li>å½“åªæœ‰ä¸€ä¸ªå†…åµŒç»“æ„ä½“æ—¶ï¼Œå¯èƒ½çœ‹èµ·æ¥åƒæ˜¯ç»§æ‰¿ï¼›å½“æœ‰å¤šä¸ªå†…åµŒç»“æ„ä½“ï¼Œçœ‹èµ·æ¥å°±ä¼šåƒæ˜¯ç»„åˆï¼›å®é™…ä¸Šå½“åªæœ‰ä¸€ä¸ªå†…åµŒç»“æ„ä½“æ—¶ï¼ŒæŒ‰ç»„åˆå»ç†è§£ä¹Ÿä¼šæ›´è´´è¿‘goçš„è®¾è®¡</li>
<li>ä¸éš¾å¾—åˆ°ï¼Œç±»å‹Aå†…åµŒäº†ç±»å‹Bæ—¶ï¼Œç±»å‹BæŒ‡é’ˆæ— æ³•æŒ‡å‘ç±»å‹Aå®ä¾‹ï¼ˆå³ä½¿ç±»å‹Bæ˜¯å”¯ä¸€çš„å†…åµŒç±»å‹ï¼‰</li>
<li>å¤–å±‚ç»“æ„ä½“å¯ä»¥ç›´æ¥é€šè¿‡é€‰æ‹©å™¨ç¬¦<code>.</code>ç›´æ¥è®¿é—®å†…å±‚ç»“æ„ä½“çš„å­—æ®µ</li>
<li>ä¸¤ä¸ªå­—æ®µæ‹¥æœ‰ç›¸åŒåå­—æ—¶ï¼šå¤–å±‚åå­—è¦†ç›–å†…å±‚åå­—ï¼ŒåŒä¸€å±‚çº§çš„ç›¸åŒåå­—å­—æ®µéœ€è¦æ˜ç¡®æ¥è‡ªå“ªä¸€ä¸ªç±»å‹ï¼ˆc.A.aï¼Œc.B.aï¼‰</li>
</ol>
<h2 id="æ–¹æ³•">æ–¹æ³•</h2>
<h3 id="æ–¹æ³•-1">æ–¹æ³•</h3>
<ol type="1">
<li>ç»“æ„ä½“åƒæ˜¯ç±»çš„ç®€åŒ–å½¢å¼ï¼Œè€Œæ–¹æ³•æ˜¯åœ¨æ¥æ”¶è€…ä¸Šçš„å‡½æ•°ï¼Œæ¥æ”¶è€…å¯ä»¥æ˜¯æŸç§ç±»å‹çš„å€¼ï¼Œæˆ–è€…æ˜¯å…¶ä»–å…è®¸ç±»å‹çš„æŒ‡é’ˆã€‚</li>
<li>æ¥æ”¶å™¨ä¸å¯ä»¥æ˜¯ä¸€ä¸ªæ¥å£ç±»å‹ï¼Œå› ä¸ºæ¥å£æ˜¯æŠ½è±¡å®šä¹‰ã€‚</li>
<li>ä¸€ä¸ªç»“æ„ä½“åŠ ä¸Šå®ƒçš„æ–¹æ³•ç­‰ä»·äºé¢å‘å¯¹è±¡ä¸­çš„ä¸€ä¸ªç±»ï¼Œåœ¨Goä¸­ç»“æ„ä½“å’Œç»‘å®šçš„æ–¹æ³•å¯ä»¥ä¸åœ¨ä¸€èµ·ï¼Œä½†æ˜¯éœ€è¦åœ¨åŒä¸€ä¸ªåŒ…å†…</li>
<li>ä¸å…è®¸æ–¹æ³•é‡è½½ï¼Œå¯ä»¥é‡è½½ç±»å‹</li>
<li>è°ƒç”¨æ–¹æ³•çš„æ–¹å¼ï¼š<code>recv.Method1()</code>ï¼Œå¦‚æœrecvå¯ä»¥æ˜¯ç±»å‹å€¼ï¼Œæˆ–ç±»å‹æŒ‡é’ˆï¼ˆè‡ªåŠ¨è§£å¼•ç”¨ï¼‰</li>
</ol>
<h3 id="å‡½æ•°æ–¹æ³•çš„åŒºåˆ«">å‡½æ•°æ–¹æ³•çš„åŒºåˆ«</h3>
<p>å‡½æ•°å°†å˜é‡ä½œä¸ºå‚æ•°ï¼š<code>Function1(recv)</code>ï¼Œæ–¹æ³•åœ¨å˜é‡ä¸Šè¢«è°ƒç”¨ï¼š<code>recv.Method1()</code></p>
<h3 id="æŒ‡é’ˆæˆ–å€¼ä½œä¸ºæ¥æ”¶è€…">æŒ‡é’ˆæˆ–å€¼ä½œä¸ºæ¥æ”¶è€…</h3>
<ol type="1">
<li>recvå¸¸è§çš„æ˜¯ä¸€ä¸ªæŒ‡å‘receiver_typeçš„æŒ‡é’ˆï¼Œè¿™æ ·å°±ä¸ä¼šäº§ç”Ÿç»“æ„ä½“çš„æ‹·è´ï¼Œè€Œä¸”å¯ä»¥ä¿®æ”¹ç»“æ„ä½“çš„å†…å®¹</li>
<li>æŒ‡é’ˆæ–¹æ³•å’Œå€¼æ–¹æ³•éƒ½å¯ä»¥åœ¨æŒ‡é’ˆæˆ–è€…éæŒ‡é’ˆï¼ˆå€¼ï¼‰ä¸Šè¢«è°ƒç”¨ï¼Œgoä¼šè‡ªåŠ¨ä¸ºä½ åšç±»å‹è½¬æ¢</li>
</ol>
<h3 id="æ–¹æ³•ä¸æœªå¯¼å‡ºå­—æ®µ">æ–¹æ³•ä¸æœªå¯¼å‡ºå­—æ®µ</h3>
<p>å¯¹äºæœªå¯¼å‡ºçš„å­—æ®µï¼Œä½¿ç”¨<code>getter</code>å’Œ<code>setter</code>æ–¹æ³•è¿›è¡Œä¿®æ”¹ï¼Œåœ¨Goä¸­<code>setter</code>æ–¹æ³•ä¼šä½¿ç”¨Setå‰ç¼€ï¼Œè€Œ<code>getter</code>åªä½¿ç”¨æˆå‘˜å</p>
<h3 id="å†…åµŒç±»å‹çš„æ–¹æ³•å’Œç»§æ‰¿">å†…åµŒç±»å‹çš„æ–¹æ³•å’Œç»§æ‰¿</h3>
<ol type="1">
<li><p>åŒ¿åç±»å‹è¢«å†…åµŒåˆ°ç»“æ„ä½“ä¸­æ—¶ï¼ŒåŒ¿åç±»å‹çš„å¯è§æ–¹æ³•ä¹Ÿè¢«å†…åµŒï¼Œè¿™ç›¸å½“äºå®ç°äº†ç»§æ‰¿</p></li>
<li><p>å†…åµŒå°†ä¸€ä¸ªå·²å­˜åœ¨ç±»å‹çš„å­—æ®µå’Œæ–¹æ³•æ³¨å…¥åˆ°äº†å¦ä¸€ä¸ªç±»å‹é‡Œï¼šåŒ¿åå­—æ®µä¸Šçš„æ–¹æ³•â€œæ™‹å‡â€æˆä¸ºäº†å¤–å±‚ç±»å‹çš„æ–¹æ³•ã€‚</p></li>
<li><p>å¤–å±‚ç±»å‹çš„æ–¹æ³•ä¼šè¦†å†™å†…åµŒç±»å‹å¯¹åº”çš„æ–¹æ³•ï¼Œæƒ³è¦è°ƒç”¨å†…åµŒç±»å‹çš„æ–¹æ³•ï¼Œç”¨å†…åµŒç±»å‹åè¿›è¡Œè®¿é—®</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">func (n *NamedPoint) Abs() float64 &#123;
	return n.Point.Abs() * 100.
&#125;</code></pre></p></li>
</ol>
<h3 id="å¦‚ä½•åœ¨ç±»å‹ä¸­åµŒå…¥åŠŸèƒ½">å¦‚ä½•åœ¨ç±»å‹ä¸­åµŒå…¥åŠŸèƒ½</h3>
<ol type="1">
<li><p>èšåˆï¼ˆç»„åˆï¼‰ï¼šåŒ…å«æ‰€éœ€åŠŸèƒ½ç±»å‹çš„å…·ä½“å­—æ®µï¼›å†…åµŒï¼šä½¿ç”¨å†…åµŒç±»å‹ï¼ŒæŠŠæ‰€éœ€çš„åŠŸèƒ½ç±»å‹å†…åµŒ</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">&#x2F;&#x2F; èšåˆï¼ˆç»„åˆï¼‰
type Customer struct &#123;
	Name string
	log  *Log
&#125;
&#x2F;&#x2F; å†…åµŒ
type Customer struct &#123;
	Name string
	Log
&#125;</code></pre></p></li>
</ol>
<h3 id="å¤šé‡ç»§æ‰¿">å¤šé‡ç»§æ‰¿</h3>
<p>åœ¨ç±»å‹ä¸­åµŒå…¥å¿…è¦çš„çˆ¶ç±»å‹å°±èƒ½ç®€å•åœ°å®ç°å¤šé‡ç»§æ‰¿</p>
<h3 id="ä¸å…¶ä»–é¢å‘å¯¹è±¡è¯­è¨€çš„æ¯”è¾ƒ">ä¸å…¶ä»–é¢å‘å¯¹è±¡è¯­è¨€çš„æ¯”è¾ƒâ€¦</h3>
<ol type="1">
<li>goä¸­åˆ†ç¦»äº†ç±»å‹ä¸æ–¹æ³•ï¼Œæ–¹æ³•åªè¦å®šä¹‰å°±å¯ä»¥è°ƒç”¨ï¼Œä¸å…¶ä»–ç±»å‹æ˜¯å¦å­˜åœ¨æ–¹æ³•å¹¶æ— å…³ç³»</li>
<li>goä¸­å¹¶ä¸ä½¿ç”¨ç±»ç»§æ‰¿çš„æ¦‚å¿µï¼Œâ€œç»§æ‰¿â€çš„ä¸¤ä¸ªå¥½å¤„ï¼Œä»£ç å¤ç”¨é€šè¿‡<strong>ç»„åˆ</strong>å’Œ<strong>å§”æ‰˜</strong>å®ç°ï¼Œå¤šæ€é€šè¿‡<strong>æ¥å£</strong>çš„ä½¿ç”¨æ¥å®ç°ã€‚åˆæ˜¯è¿™ä¹Ÿå«<strong>ç»„ä»¶ç¼–ç¨‹
(Component Programming) <a
href="https://www.notion.so/OOP-0c9b2e9623044a28b70d39fe959e34be">é¢å‘å¯¹è±¡è®¾è®¡
OOP</a></strong></li>
</ol>
<h2 id="åƒåœ¾å›æ”¶ä¸setfinalizer">åƒåœ¾å›æ”¶ä¸SetFinalizer</h2>
<p>å¦‚æœéœ€è¦åœ¨ä¸€ä¸ªå¯¹è±¡è¢«å†…å­˜ç§»å‡ºå‰åšä¸€äº›ç‰¹æ®Šæ“ä½œï¼Œå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•è°ƒç”¨å®ç°</p>
<h1 id="chapter11">Chapter11</h1>
<h2 id="æ¥å£">æ¥å£</h2>
<ol type="1">
<li><p>æ¥å£å®šä¹‰äº†ä¸€ç»„æ–¹æ³•ï¼Œä¸åŒ…å«å®ç°ï¼Œä¸åŒ…å«å˜é‡</p></li>
<li><p>å¯ä»¥å£°æ˜ä¸€ä¸ªæ¥å£ç±»å‹çš„å˜é‡ï¼Œåˆå§‹å€¼ä¸ºnilï¼Œæœ¬è´¨æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼ˆå†…éƒ¨çš„receiverä¸ºç±»å‹å˜é‡ï¼Œmethod
table ptræŒ‡å‘è¯¥ç±»å‹çš„æ–¹æ³•è¡¨ï¼‰</p>
<p><a href="/p/e842888b11eb/Untitled_7.png" class="gallery-item"><img src="/p/e842888b11eb/Untitled_7.png" class="" title="ä¸€ä¸ªæ¥å£å˜é‡çš„å†…å®¹"></a></p></li>
<li><p><strong>å¦‚æœç±»å‹çš„æ‰€æœ‰æ–¹æ³•ç»„æˆçš„é›†åˆï¼ŒåŒ…å«äº†è¯¥æ¥å£çš„æ–¹æ³•é›†ï¼Œè¿™ä¸ªç±»å‹å°±å®ç°äº†è¿™ä¸ªæ¥å£</strong></p></li>
<li><p>é™¤äº†æ¥å£è¢«<strong>éšå¼</strong>åœ°å®ç°ï¼Œå…¶ä»–éƒ½ä¸ä½ ç†Ÿæ‚‰çš„æ¥å£å·®ä¸å¤š</p></li>
<li><p>æ¥å£ç±»å‹çš„å˜é‡å¯ä»¥æŒ‡å‘å®ç°äº†æ­¤æ¥å£çš„å®ä¾‹</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">type Shaper interface &#123;
	Area() float32
&#125;

type Square struct &#123;
	side float32
&#125;

func (sq *Square) Area() float32 &#123;
	return sq.side * sq.side
&#125;

func main() &#123;
	sq1 :&#x3D; new(Square)
	sq1.side &#x3D; 5

	var areaIntf Shaper
	areaIntf &#x3D; sq1
	&#x2F;&#x2F; shorter,without separate declaration:
	&#x2F;&#x2F; areaIntf :&#x3D; Shaper(sq1)
	&#x2F;&#x2F; or even:
	&#x2F;&#x2F; areaIntf :&#x3D; sq1
	fmt.Printf(&quot;The square has area: %f\n&quot;, areaIntf.Area())
&#125;</code></pre></p></li>
<li><p>å®ç°äº†åŒä¸€æ¥å£çš„å®ä¾‹å¯ä»¥å¡«å……åˆ°åŒä¸€ä¸ªæ•°ç»„ / åˆ‡ç‰‡ä¸­</p></li>
<li><p>æ¥å£æ˜¯ä¸€ç§å¥‘çº¦ï¼Œå®ç°æ¥å£çš„ç±»å‹å¿…é¡»æ»¡è¶³å®ƒï¼Œå®ƒæè¿°äº†ç±»å‹çš„è¡Œä¸ºï¼Œè§„å®šç±»å‹å¯ä»¥åšä»€ä¹ˆã€‚æ¥å£å°†ç±»å‹èƒ½åšä»€ä¹ˆï¼Œä¸å¦‚ä½•åšåˆ†ç¦»å¼€æ¥ï¼Œä½¿å¾—å˜é‡å¯ä»¥åœ¨ä¸åŒæ—¶åˆ»è¡¨ç°å‡ºä¸åŒè¡Œä¸ºã€‚</p></li>
</ol>
<h2 id="æ¥å£åµŒå¥—æ¥å£">æ¥å£åµŒå¥—æ¥å£</h2>
<p>ä¸€ä¸ªæ¥å£å¯ä»¥åŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå…¶ä»–æ¥å£ï¼Œç›¸å½“äºå°†å†…åµŒæ¥å£çš„æ–¹æ³•åˆ—ä¸¾åœ¨å¤–å±‚æ¥å£ä¸­</p>
<h2 id="ç±»å‹æ–­è¨€">ç±»å‹æ–­è¨€</h2>
<ol type="1">
<li><p>ä½¿ç”¨ç±»å‹æ–­è¨€æ¥æ£€æµ‹æ¥å£varIæ˜¯å¦åŒ…å«ç±»å‹Tçš„å€¼</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">if v, ok :&#x3D; varI.(T); ok &#123;  &#x2F;&#x2F; checked type assertion
    Process(v)
    return
&#125;
&#x2F;&#x2F; varI is not of type T
&#x2F;&#x2F; -------
&#x2F;&#x2F; å¦‚æœåªæ˜¯æƒ³æµ‹è¯•ä¸€ä¸‹æ˜¯å¦æ˜¯ç±»å‹T
if _, ok :&#x3D; varI.(T); ok &#123;
    &#x2F;&#x2F; ...
&#125;</code></pre></p></li>
<li><p>æ³¨æ„å¦‚æœå®ç°æ¥å£çš„receiveræ˜¯<code>T</code>ç±»å‹ï¼Œé‚£ä¹ˆ<code>T</code>å’Œ<code>*T</code>çš„æ£€æµ‹éƒ½å¯è¡Œï¼ˆä¸ä¼šæœ‰ç¼–è¯‘æŠ¥é”™ï¼Œæ˜¯å¦é€šè¿‡å–å†³äº3â†“ï¼‰ï¼›å¦‚æœreceiveræ˜¯<code>*T</code>ç±»å‹ï¼Œé‚£ä¹ˆ<code>T</code>çš„æ£€æµ‹ä¼šæœ‰ç¼–è¯‘æŠ¥é”™</p></li>
<li><p><strong>å³ï¼šä½¿ç”¨TæŒ‡é’ˆç±»å‹ä½œä¸ºreceiverï¼Œå¯¼è‡´ï¼š</strong></p>
<ol type="1">
<li>æ— æ³•è¿›è¡Œæ¥å£å˜é‡çš„Tç±»å‹æ–­è¨€</li>
<li>æ— æ³•å°†Tç±»å‹å€¼èµ‹å€¼ç»™æ¥å£å˜é‡</li>
</ol>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">&#x2F;&#x2F; ä¸¾ä¾‹ï¼šreceiveræ˜¯*Tç±»å‹
type Shaper interface &#123;
	Area() float32
&#125;

func (sq *Square) Area() float32 &#123;
	return sq.side * sq.side
&#125;

func main() &#123;
	var areaIntf Shaper
	sq1 :&#x3D; new(Square)
	sq1.side &#x3D; 5

	areaIntf &#x3D; sq1
	&#x2F;&#x2F; Is Square the type of areaIntf?
	if t, ok :&#x3D; areaIntf.(*Square); ok &#123;
		fmt.Printf(&quot;The type of areaIntf is: %T\n&quot;, t)
	&#125;
&#125;</code></pre></p>
<p><a href="/p/e842888b11eb/Untitled_8.png" class="gallery-item"><img src="/p/e842888b11eb/Untitled_8.png" class="" title="å®ç°Shaperæ¥å£çš„æ˜¯*Squareç±»å‹ï¼Œå¯¹Squareç±»å‹æ–­è¨€ä¼šæœ‰ç¼–è¯‘æŠ¥é”™"></a></p></li>
<li><p>è‡³äº<code>T</code>ç±»å‹è¿˜æ˜¯<code>*T</code>ç±»å‹çš„æ£€æµ‹ä¼šé€šè¿‡ï¼Œå–å†³äºèµ‹å€¼ç»™æ¥å£å˜é‡çš„æ˜¯ç»“æ„ä½“å€¼è¿˜æ˜¯ç»“æ„ä½“çš„æŒ‡é’ˆ</p></li>
</ol>
<h2 id="ç±»å‹åˆ¤æ–­">ç±»å‹åˆ¤æ–­</h2>
<p>æ¥å£å˜é‡çš„ç±»å‹å¯ä»¥ç”¨ä»¥ä¸‹ç‰¹æ®Šå½¢å¼ï¼ˆåœ¨11.3çš„ç±»å‹å¤„ä½¿ç”¨<code>type</code>å…³é”®å­—ï¼‰çš„switchè¯­å¥æ¥è¿›è¡Œæ£€æµ‹ï¼š<code>type-switch</code></p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">switch t :&#x3D; areaIntf.(type) &#123; &#x2F;&#x2F; &lt;-
case *Square:
	fmt.Printf(&quot;Type Square %T with value %v\n&quot;, t, t)
case *Circle:
	fmt.Printf(&quot;Type Circle %T with value %v\n&quot;, t, t)
case nil:
	fmt.Printf(&quot;nil value: nothing to check?\n&quot;)
default:
	fmt.Printf(&quot;Unexpected type %T\n&quot;, t)
&#125;</code></pre>
<h2 id="æµ‹è¯•æ˜¯å¦å®ç°äº†æ¥å£">æµ‹è¯•æ˜¯å¦å®ç°äº†æ¥å£</h2>
<p>ä¸11.3ç±»ä¼¼ï¼Œä¸åŒçš„æ˜¯å°†ç±»å‹æ›¿æ¢ä¸ºæ¥å£åï¼Œå³å¯æ£€æµ‹å˜é‡æ˜¯å¦å®ç°äº†ç‰¹å®šæ¥å£</p>
<h2 id="ä½¿ç”¨æ–¹æ³•é›†ä¸æ¥å£">ä½¿ç”¨æ–¹æ³•é›†ä¸æ¥å£</h2>
<p>åœ¨æ–¹æ³•ä¸€èŠ‚æˆ‘ä»¬è®¨è®ºè¿‡ï¼Œå½“è°ƒç”¨å˜é‡çš„æ–¹æ³•æ˜¯ï¼Œå˜é‡æ˜¯æŒ‡é’ˆè¿˜æ˜¯å€¼éƒ½èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚ä½†æ˜¯å½“å˜é‡æ˜¯æ¥å£ç±»å‹æ—¶å¤šäº†ä¸€äº›é™åˆ¶ï¼ŒåŸå› æ˜¯æ¥å£å˜é‡ä¸­å­˜å‚¨çš„å…·ä½“å€¼æ˜¯<strong>ä¸å¯å¯»å€</strong>çš„ï¼ˆå¯ä»¥ç†è§£ä¸ºæ¥å£å˜é‡å†…å­˜å‚¨äº†ä¸€ä¸ªç»“æ„ä½“çš„å€¼ï¼Œè€Œéå­˜å‚¨äº†å­˜æœ‰ç»“æ„ä½“åœ°å€çš„æŒ‡é’ˆï¼Œä½†æ˜¯unsafe.Sizeofæ‰“å°å‡ºæ¥å¤§å°éƒ½æ˜¯ä¸¤ä¸ªåœ°å€çš„16byteâ€¦ï¼‰ï¼š</p>
<p>æ‰€ä»¥åˆ†ä¸¤ç§è°ƒç”¨æ–¹æ³•çš„æƒ…å†µï¼šï¼ˆ1ï¼‰å°†ç»“æ„ä½“<strong>å€¼</strong>èµ‹å€¼ç»™äº†æ¥å£å˜é‡ï¼Œä»¥åŠï¼ˆ2ï¼‰å°†ç»“æ„ä½“<strong>æŒ‡é’ˆ</strong>èµ‹å€¼ç»™äº†æ¥å£å˜é‡ã€‚</p>
<p>å¯¹äºåè€…ï¼Œç»“æ„ä½“å®ç°çš„æ¥å£æ–¹æ³•ä¸­ï¼Œæ¥æ”¶è€…æ˜¯å€¼ä»¥åŠæ˜¯æŒ‡é’ˆçš„æ–¹æ³•éƒ½èƒ½æ­£å¸¸è°ƒç”¨ï¼›ä½†æ˜¯å¯¹äºå‰è€…ï¼Œç»“æ„ä½“å®ç°çš„æ¥å£æ–¹æ³•ä¸­ï¼Œæ¥æ”¶è€…æ˜¯æŒ‡é’ˆçš„æ–¹æ³•å°†æ— æ³•è°ƒç”¨</p>
<p><strong>æ€»ç»“</strong></p>
<ul>
<li>æŒ‡é’ˆæ–¹æ³•å¯ä»¥é€šè¿‡æŒ‡é’ˆè°ƒç”¨</li>
<li>å€¼æ–¹æ³•å¯ä»¥é€šè¿‡å€¼è°ƒç”¨</li>
<li>æ¥æ”¶è€…æ˜¯å€¼çš„æ–¹æ³•å¯ä»¥é€šè¿‡æŒ‡é’ˆè°ƒç”¨ï¼Œå› ä¸ºæŒ‡é’ˆä¼šé¦–å…ˆè¢«è§£å¼•ç”¨</li>
<li>æ¥æ”¶è€…æ˜¯æŒ‡é’ˆçš„æ–¹æ³•ä¸å¯ä»¥é€šè¿‡å€¼è°ƒç”¨ï¼Œå› ä¸ºå­˜å‚¨åœ¨æ¥å£ä¸­çš„å€¼æ²¡æœ‰åœ°å€</li>
</ul>
<p><strong>ç»“åˆ11.3 å¯ä»¥å¾—åˆ°</strong></p>
<ol type="1">
<li>åªè¦å­˜åœ¨ä¸€ä¸ªç”¨ç±»å‹æŒ‡é’ˆä½œä¸ºæ¥æ”¶è€…çš„æ¥å£æ–¹æ³•ï¼Œå°±ä¸èƒ½ç”¨å€¼æ¥ç»™æ¥å£å˜é‡èµ‹å€¼ï¼Œä»è€Œå€¼ç±»å‹æ–­è¨€ä¹Ÿæ²¡æœ‰æ„ä¹‰äº†ï¼›</li>
<li>åä¹‹ï¼Œå¦‚æœæ‰€æœ‰çš„æ¥å£æ–¹æ³•éƒ½åªç”¨å€¼ä½œä¸ºæ¥æ”¶è€…å®ç°ï¼Œå°±æœ‰å¾ˆå¤§çš„å±€é™æ€§ï¼ˆæ–¹æ³•ä¸èƒ½æ”¹å˜ç»“æ„æˆå‘˜ï¼‰ï¼Œåè€Œæ²¡æœ‰æ„ä¹‰ï¼›è™½ç„¶å¯ä»¥è‡ªç”±åœ°ç”¨å€¼
/
æŒ‡é’ˆç»™æ¥å£å˜é‡èµ‹å€¼ï¼Œä½†æ˜¯æ„ä¹‰ä¸å¤§ï¼›ä¸ç”¨æ‹…å¿ƒæ— æ³•è°ƒç”¨æ¥æ”¶è€…æ˜¯æŒ‡é’ˆçš„æ–¹æ³•ï¼Œå› ä¸ºä¸å­˜åœ¨è¿™ç§æ–¹æ³•ï¼›</li>
<li>æ‰€ä»¥å¯ä»¥è€ƒè™‘ä¸€èˆ¬æƒ…å†µä¸‹ï¼šå®ç°æ¥å£æ–¹æ³•æ—¶ï¼Œæ¥æ”¶è€…æ˜¯å€¼è¿˜æ˜¯æŒ‡é’ˆä»å®é™…å‡ºå‘ï¼Œå¹¶ä¸”ç»Ÿä¸€ç”¨æŒ‡é’ˆç»™æ¥å£å˜é‡èµ‹å€¼ï¼Œç±»å‹æ–­è¨€ä¹Ÿç”¨æŒ‡é’ˆç±»å‹æ¥åˆ¤æ–­ï¼›è™½ç„¶æ— æ³•ç”¨å€¼ç»™æ¥å£å˜é‡èµ‹å€¼ï¼Œå°‘ä¸€ç§é€‰æ‹©åè€Œå°‘ä¸€äº›è´Ÿæ‹…ï¼Œä¸ç”¨æ‹…å¿ƒæ— æ³•è°ƒç”¨æ¥æ”¶è€…æ˜¯æŒ‡é’ˆçš„æ–¹æ³•ï¼Œå› ä¸ºä¸ä¼šç”¨å€¼æ¥ç»™æ¥å£å˜é‡èµ‹å€¼ã€ä¹Ÿè®©ç±»å‹æ–­è¨€å˜ç®€å•ï¼Œåªè¦è€ƒè™‘æ¥å£çš„æŒ‡é’ˆç±»å‹æ–­è¨€å°±å¯ä»¥äº†</li>
</ol>
<p>*å®é™…ä¸Šæ˜¯ç±»å‹Aå®ç°äº†æ¥å£è¿˜æ˜¯æŒ‡é’ˆç±»å‹Aå®ç°äº†æ¥å£æœ¬èº«å°±æ˜¯ä¸¤ç§æƒ…å†µï¼Œä¸è¦æ··ä¸ºä¸€è°ˆä¼šæ›´å¥½ç†è§£ã€‚æ–¹æ³•è°ƒç”¨æ—¶ä¸åŒºåˆ†å€¼è¿˜æ˜¯æŒ‡é’ˆå¯ä»¥çœ‹ä½œæ˜¯è¯­æ³•ç³–ï¼Œè€Œæ­¤å¤„æŒ‡é’ˆèµ‹å€¼çš„æ¥å£å˜é‡ï¼Œå¯ä»¥è°ƒç”¨æ¥æ”¶è€…æ˜¯å€¼å¾—æ–¹æ³•ä¹Ÿæ˜¯åšäº†é¢å¤–å¤„ç†ã€‚</p>
<h2 id="ç©ºæ¥å£">ç©ºæ¥å£</h2>
<p>ä¸€ä¸ªç©ºæ¥å£å¯¹å®ç°ä¸åšä»»ä½•è¦æ±‚</p>
<pre class="line-numbers language-go" data-language="go"><code class="language-go">type Any interface &#123;&#125; &#x2F;&#x2F; å¯¹äºå‡½æ•°å‚æ•° interface &#123;&#125; ä¹Ÿæ˜¯å¯è¡Œçš„
var val interface &#123;&#125; &#x2F;&#x2F; ç©ºæ¥å£ç±»å‹</code></pre>
<ol type="1">
<li><p>ç©ºæ¥å£ç±»ä¼¼Â <code>Java/C#</code>ä¸­æ‰€æœ‰ç±»çš„åŸºç±»ï¼šÂ <code>Object</code>ç±»ï¼ŒäºŒè€…çš„ç›®æ ‡ä¹Ÿå¾ˆç›¸è¿‘ï¼Œå¯ä»¥ç»™ä¸€ä¸ªç©ºæ¥å£ç±»å‹å˜é‡èµ‹ä»»ä½•ç±»å‹çš„å€¼</p></li>
<li><p>ä½¿ç”¨ç©ºæ¥å£æ¥å®ç°ç±»ä¼¼æ³›å‹çš„åŠŸèƒ½ï¼Œå°†ä¸€ä¸ªç©ºæ¥å£ç±»å‹ä½œä¸ºElement</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">type Vector struct &#123;
	a []Element
&#125;

func (p *Vector) At(i int) Element &#123;
	return p.a[i]
&#125;

func (p *Vector) Set(i int, e Element) &#123;
	p.a[i] &#x3D; e
&#125;</code></pre></p></li>
<li><p>ä¸èƒ½å°†ç‰¹å®šç±»å‹çš„åˆ‡ç‰‡ç›´æ¥èµ‹å€¼ç»™ç©ºæ¥å£åˆ‡ç‰‡ï¼Œå› ä¸ºä»–ä»¬çš„å†…å­˜å¸ƒå±€ä¸ä¸€è‡´ï¼Œéœ€è¦for-rangeæ¥ä¸€ä¸ªä¸€ä¸ªæ˜¾å¼èµ‹å€¼</p></li>
<li><p>ä¸€ä¸ªæ¥å£çš„å€¼å¯ä»¥èµ‹å€¼ç»™å¦ä¸€ä¸ªæ¥å£å˜é‡ï¼Œåªè¦åº•å±‚ç±»å‹å®ç°äº†å¿…è¦çš„æ–¹æ³•ï¼Œæ³¨æ„è¿™ä¸ªè½¬æ¢åœ¨<strong>è¿è¡Œæ—¶</strong>æ£€æŸ¥ï¼Œè½¬æ¢å¤±è´¥å°†å¯¼è‡´ä¸€ä¸ª<strong>è¿è¡Œæ—¶é”™è¯¯</strong></p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">type myPrintInterface interface &#123;
	print()
&#125;

func f3(x myInterface) &#123;
	x.(myPrintInterface).print() &#x2F;&#x2F; type assertion to myPrintInterface
&#125;</code></pre></p></li>
</ol>
<h2 id="åå°„">åå°„</h2>
<ol type="1">
<li>ä½¿ç”¨reflectåŒ…æ¥è¿›è¡Œåå°„</li>
<li><code>reflect.TypeOf</code>å’Œ<code>reflect.ValueOf</code>ç”¨äºè¿”å›è¢«æ£€æŸ¥å¯¹è±¡çš„ç±»å‹å’Œå€¼ï¼Œä»–ä»¬çš„å‚æ•°ç±»å‹éƒ½æ˜¯interface{}</li>
<li><code>reflect.ValueOf</code>è¿”å›çš„reflect.Valueç±»å‹å¯¹è±¡å­˜åœ¨<code>Type()</code>è¿”å›ç±»å‹ï¼Œ<code>Kind()</code>è¿”å›ä¸€ä¸ªå¸¸é‡æ¥è¡¨ç¤ºç±»å‹ï¼ŒåŒæ ·å½“ä½ ç¡®å®šäº†reflect.Valueçš„ç¡®åˆ‡ç±»å‹ï¼Œæœ‰å«åšInt()ï¼ŒFloat()çš„æ–¹æ³•æ¥è·å–å­˜å‚¨å€¼ï¼Œæˆ–è€…ç›´æ¥ç”¨<code>Interface</code>æ¥è·å–ç©ºæ¥å£ç±»å‹å€¼</li>
<li>é€šè¿‡åå°„æ¥ä¿®æ”¹å€¼æ—¶ï¼Œå¯ä»¥é€šè¿‡å¯¹Valueçš„CanSetæ–¹æ³•æ¥æ£€æŸ¥æ˜¯å¦å¯è®¾ç½®ï¼Œå¦‚æœæƒ³è¦Valueå¯¹è±¡å¯è®¾ç½®ï¼Œæœ‰æ—¶éœ€è¦ç”¨æŒ‡é’ˆæ¥è°ƒç”¨<code>ValueOf</code>ï¼Œå¹¶ä¸”éœ€è¦ä½¿ç”¨<code>Elem()</code>å‡½æ•°</li>
<li>ä½¿ç”¨<code>Field(index
int)</code>æ¥è·å–ç»“æ„ä½“çš„æˆå‘˜ï¼Œå¹¶ä¸”é€šè¿‡<code>SetInt</code>ï¼Œ<code>SetString</code>ç­‰æ¥å£è®¾ç½®å€¼</li>
<li>ä½¿ç”¨<code>NumField</code>æ¥è·å–ç»“æ„ä½“æœ‰å¤šå°‘ä¸ªæˆå‘˜</li>
<li>ä½¿ç”¨<code>Method(index
int)</code>æ¥è·å–ç»“æ„ä½“çš„æ–¹æ³•ï¼Œå¹¶ä¸”ä½¿ç”¨<code>Call()</code>è¿›è¡Œè°ƒç”¨</li>
</ol>
<h2 id="æ¥å£ä¸åŠ¨æ€ç±»å‹">æ¥å£ä¸åŠ¨æ€ç±»å‹</h2>
<ol type="1">
<li><p>Goä¸­æ²¡æœ‰ç±»ï¼Œæ•°æ®ï¼ˆç»“æ„ä½“æˆ–æ˜¯ä¸€èˆ¬ç±»å‹ï¼‰ä¸æ–¹æ³•æ˜¯ä¸€ç§æ¾è€¦åˆçš„æ­£äº¤å…³ç³»</p></li>
<li><p>Goä¸­çš„æ¥å£éƒ½æ˜¯å¿…é¡»æä¾›ä¸€ä¸ªæ–¹æ³•é›†çš„å®ç°ï¼Œä½†æ˜¯æ›´çµæ´»ï¼Œéƒ½æ˜¯éšå¼å®ç°è€Œä¸ç”¨æ˜¾å¼å£°æ˜ï¼Œç±»å‹å’Œæ¥å£ä¹‹é—´ä¹Ÿæ˜¯æ¾è€¦åˆçš„</p></li>
<li><p>ä½¿ç”¨æ¥å£ç±»å‹ä½œä¸ºå‚æ•°çš„å‡½æ•°ï¼Œç±»ä¼¼äºåŠ¨æ€ç±»å‹ï¼Œæ›´çœ‹é‡å¯¹è±¡èƒ½åšä»€ä¹ˆï¼Œè€Œä¸æ˜¯å¯¹è±¡æ˜¯ä»€ä¹ˆ</p></li>
<li><p>Goçš„åŠ¨æ€æ–¹æ³•è°ƒç”¨ï¼Œéœ€è¦ç¼–è¯‘å™¨é™æ€æ£€æŸ¥çš„æ”¯æŒï¼Œå˜é‡èµ‹å€¼ç»™æ¥å£ç±»å‹å˜é‡æ—¶ï¼Œç¼–è¯‘å™¨ä¼šæ£€æŸ¥ç±»å‹æ˜¯å¦å®ç°äº†æ¥å£æ‰€æœ‰çš„å‡½æ•°ã€‚ä¸€èˆ¬ä¼ å…¥åƒ<code>interface&#123;&#125;</code>è¿™æ ·çš„æ³›å‹å˜é‡ï¼Œä¹‹åå†ç”¨ç±»å‹æ–­è¨€æ¥è¿›è¡Œå˜é‡çš„æ£€æŸ¥ã€‚</p></li>
<li><p>æ¥å£çš„ç»§æ‰¿ï¼šå½“ç±»å‹å†…åµŒå¦ä¸€ä¸ªå®ç°äº†æ¥å£çš„ç±»å‹æŒ‡é’ˆæ—¶ï¼Œè¯¥ç±»å‹å°±å¯ä»¥ä½¿ç”¨å¦ä¸€ä¸ªç±»å‹çš„æ‰€æœ‰æ¥å£æ–¹æ³•ï¼Œé€šè¿‡ç»„åˆçš„æ–¹å¼å®ç°äº†ç»§æ‰¿</p>
<p><pre class="line-numbers language-go" data-language="go"><code class="language-go">type Task struct &#123;
	Command string
	*log.Logger &#x2F;&#x2F; log.Loggerå®ç°äº†Log()æ–¹æ³•
&#125;

task.Log() &#x2F;&#x2F; Taskç±»å‹çš„å®ä¾‹è°ƒç”¨Loggerçš„Log()æ–¹æ³•</code></pre></p></li>
</ol>
<h2 id="goä¸­çš„é¢å‘å¯¹è±¡æ€»ç»“">Goä¸­çš„é¢å‘å¯¹è±¡æ€»ç»“</h2>
<p>é¢å‘å¯¹è±¡ä¸­çš„é‡è¦æ¦‚å¿µï¼šå°è£…ã€ç»§æ‰¿ã€å¤šæ€</p>
<p>ï¼ˆä¹‹å‰è¯»åˆ°çš„å†…å®¹è¯´ç»§æ‰¿æ˜¯å®ç°å¤šæ€çš„ä¸€ç§æ–¹å¼ <a
href="https://www.notion.so/OOP-0c9b2e9623044a28b70d39fe959e34be">é¢å‘å¯¹è±¡è®¾è®¡
OOP</a>
â€¦ä¸è¿‡è¿™é‡Œå°±å…ˆä¸æŠŠé—®é¢˜å¤æ‚åŒ–äº†ï¼Œå…ˆçœ‹Goè¯­è¨€å¦‚ä½•å®ç°é¢å‘å¯¹è±¡çš„é‡è¦æ¦‚å¿µï¼‰</p>
<p><strong>å°è£…</strong>ï¼šç®€åŒ–çš„è®¿é—®å±‚çº§ï¼Œé¦–å­—æ¯å°å†™çš„æ ‡è¯†ç¬¦åŒ…å†…å¯è§ï¼Œé¦–å­—æ¯å¤§å†™çš„æ ‡è¯†ç¬¦åŒ…å¤–å¯è§</p>
<p><strong>ç»§æ‰¿</strong>ï¼šç”¨å†…åµŒç±»å‹è¿™æ ·â€œç»„åˆâ€çš„æ–¹å¼æ¥å®ç°</p>
<p><strong>å¤šæ€</strong>ï¼šç”¨æ¥å£æ¥å®ç°ï¼Œå®ç°äº†æ¥å£è§„å®šæ–¹æ³•é›†çš„ç±»å‹å®ä¾‹ï¼Œå¯ä»¥èµ‹ç»™æ¥å£ç±»å‹å˜é‡</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ç¼–ç¨‹è¯­è¨€</category>
        <category>Go</category>
      </categories>
      <tags>
        <tag>ç¼–ç¨‹è¯­è¨€</tag>
        <tag>Go</tag>
      </tags>
  </entry>
  <entry>
    <title>unityä¸­çš„åŸç”Ÿå¯¹è±¡ä¸æ‰˜ç®¡å¯¹è±¡</title>
    <url>/p/27ad02cebc90/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="åº">åº</h2>
<p>æœ€åˆåœ¨å·¥ä½œä¸­æ¥è§¦åˆ°å¼•æ“åŸç”Ÿå±‚ç›¸å…³çš„é—®é¢˜ï¼Œæ˜¯é¡¹ç›®å®ç°çš„å»¶æ—¶æ‰§è¡Œæ¨¡å—ï¼Œæ¨¡å—æä¾›æ¥å£æ¥è¿›è¡Œå§”æ‰˜çš„å»¶æ—¶è°ƒç”¨ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F; è¿”å›ä¸€ä¸ªtokenç”¨äºåç»­çš„CancelDelayCall
m_DelayExecuteGuidance &#x3D; GameFacade.CurrentGame.DelayCall(8.0f, OnPlayerGuideFinished);

&#x2F;&#x2F; å»¶æ—¶æ‰§è¡Œçš„ä»£ç ç¤ºä¾‹
private void OnPlayerGuideFinished()
&#123;
    &#x2F;&#x2F; ä½œä¸ºMonoBehaviourçš„æˆå‘˜æ–¹æ³•ï¼Œè®¿é—®gameObject
    Debug.Log(gameObject.name);
    &#x2F;&#x2F; something else...
&#125;</code></pre>
<p>å»¶æ—¶æ‰§è¡Œæ¨¡å—ä¸åç¨‹ä¸åŒï¼Œä¸ä¼šå› ä¸ºgameObjectçš„é”€æ¯è€Œå–æ¶ˆæ‰§è¡Œï¼Œå‡è®¾åœ¨æŒ‡å®šçš„8såï¼Œç»„ä»¶ç»‘å®šçš„gameObjectå·²ç»é”€æ¯ï¼Œé‚£ä¹ˆè¯•å›¾åœ¨è®¿é—®æ—¶å°±ä¼šäº§ç”Ÿè¿™æ ·çš„æŠ¥é”™ï¼š</p>
<a href="/p/27ad02cebc90/image-20211221124140635.png" class="gallery-item"><img src="/p/27ad02cebc90/image-20211221124140635.png" class="" title="Unity consoleçª—å£å†…æŠ¥é”™æ—¥å¿—"></a>
<p>å¯ä»¥çœ‹åˆ°å»¶æ—¶æ¨¡å—ä»ç„¶ä¿ç•™äº†å¯¹MonoBehaviourçš„å¼•ç”¨ï¼Œä½†åœ¨è¯•å›¾é€šè¿‡propertyè®¿é—®gameObejctçš„æ—¶å€™å‘ç”Ÿäº†æŠ¥é”™ï¼Œä¸”æç¤ºä»£ç ä½ç½®ä¸ºâ€œmanaged-to-nativeâ€ï¼Œä½“ç°äº†æœ¬æ–‡çš„ä¸»ä½“ï¼šå¼•æ“çš„æ‰˜ç®¡ï¼ˆmanagedï¼‰ä»£ç å¯¹åŸç”Ÿï¼ˆnativeï¼‰ä»£ç çš„è®¿é—®ï¼Œä¸‹é¢æˆ‘ä»¬å°±é›†ä¸­ä»‹ç»Unityå¼•æ“ä¸­çš„åŸç”Ÿå¯¹è±¡ä¸æ‰˜ç®¡å¯¹è±¡ã€‚</p>
<span id="more"></span>
<h2 id="åŸç”Ÿå¯¹è±¡ä¸æ‰˜ç®¡å¯¹è±¡">åŸç”Ÿå¯¹è±¡ä¸æ‰˜ç®¡å¯¹è±¡</h2>
<p>Unityä½œä¸ºC++å®ç°çš„æ¸¸æˆå¼•æ“ï¼Œåœ¨è¿è¡Œæ—¶å¤§éƒ¨åˆ†çš„é€»è¾‘å’Œå†…å­˜ç®¡ç†éƒ½æ˜¯åœ¨åŸç”Ÿå±‚ï¼ˆC++
codeï¼‰è¿›è¡Œï¼Œè¿™é‡Œå°±å°†å¼•æ“åœ¨åŸç”Ÿå±‚åˆ›å»ºçš„å¯¹è±¡ç§°ä¸ºåŸç”Ÿå¯¹è±¡ï¼ˆnative
objectï¼‰ï¼ŒåŸºäºå¼•æ“çš„æ¸¸æˆé€»è¾‘ä¸­åˆ›å»ºçš„å¯¹è±¡æˆä¸ºæ‰˜ç®¡å¯¹è±¡ï¼ˆmanaged
objectï¼‰ã€‚å½“Unityåˆ›å»ºä¸€ä¸ªObjectçš„æ—¶å€™ï¼Œå­˜åœ¨ç€æ ¸å¿ƒçš„åŸç”Ÿå±‚é¢çš„é€»è¾‘ï¼Œå¦ä¸€éƒ¨åˆ†åˆ™æ˜¯æ›´ä¸ºå¸¸ç”¨çš„æ‰˜ç®¡å±‚é¢çš„C#é€»è¾‘ï¼Œä¸‹é¢å°±å…ˆä»Unityå¼•æ“ä¸­çš„Objectè¯´èµ·ã€‚</p>
<hr />
<h2 id="understanding-unity-engine-objects">Understanding Unity Engine
Objects</h2>
<blockquote>
<p>èŠ‚é€‰ç¿»è¯‘è‡ª
https://blog.eyas.sh/2020/10/unity-for-engineers-pt5-object-component/</p>
</blockquote>
<p>Unityå¼•æ“è¿è¡Œæ—¶ä½¿ç”¨C++å®ç°ï¼Œå¤§å¤šæ•°å¼•æ“çš„è¦ç´ ï¼ˆgameObjectä»¥åŠcomponentç­‰ç­‰ï¼‰éƒ½å¤„äºC++ä¾§ã€‚ä½ ä¹Ÿè®¸ä¹ŸçŸ¥é“Unityå¼•æ“çš„APIæ˜¯ä»¥C#å½¢å¼æä¾›çš„ã€‚è¿™äº›APIä¸ºä½ æä¾›äº†å¯¹UnityåŸç”Ÿå¯¹è±¡çš„è®¿é—®ï¼Œä»¥è‡³äºè¿™äº›å¯¹è±¡ç”¨èµ·æ¥å°±åƒæ˜¯C#å¯¹è±¡ä¸€æ ·äº²åˆ‡æ˜“æ‡‚ã€‚</p>
<a href="/p/27ad02cebc90/object-hierarchy.svg" class="gallery-item"><img src="/p/27ad02cebc90/object-hierarchy.svg" class="" title="A GameObject, MonoBehaviour, and ScriptableObject all inherit from UnityEngine Object"></a>
<h3 id="unityengine.object">UnityEngine.Object</h3>
<p>åœ¨ç»§æ‰¿é“¾çš„é¡¶ç«¯çš„æ˜¯<code>UnityEngine.Object</code>ã€‚å¤§å¤šæ•°æƒ…å†µä¸‹éƒ½æä¾›<code>name</code>å­—ç¬¦ä¸²ï¼Œ<code>GetInstanceID()</code>æ¥å£ï¼Œä»¥åŠä¸€ç³»åˆ—æ¯”è¾ƒå™¨ï¼ˆequality
comparersï¼‰ã€‚</p>
<p>è¿™ä¸ªç±»åŒæ—¶æä¾›äº†é™æ€æ–¹æ³• <code>static void Destroy(Object obj)</code>
æ¥é”€æ¯ä¸€ä¸ª <code>UnityEngine.Object</code>
ä»¥åŠå®ƒçš„ä¸€åˆ‡å­ç±»ã€‚å½“ä¸€ä¸ªObjectè¢«é”€æ¯æ—¶ï¼Œè¿™ä¸ªå¯¹è±¡çš„åŸç”Ÿå±‚éƒ¨åˆ†å·²è¢«ä»å†…å­˜ä¸­é‡Šæ”¾ï¼Œè€Œç›¸å¯¹å°çš„æ‰˜ç®¡å±‚éƒ¨åˆ†å°†ä¼šåœ¨å®ƒæ²¡æœ‰è¢«å¼•ç”¨æ—¶è¢«åƒåœ¾å›æ”¶ã€‚</p>
<p>å› ä¸ºä½ åœ¨æ‰˜ç®¡å±‚å¯¹<code>UnityEngine.Object</code>çš„å¼•ç”¨å¯èƒ½æŒ‡å‘ä¸€ä¸ªå·²ç»è¢«é”€æ¯çš„åŸç”Ÿå±‚å¯¹è±¡ï¼Œæ‰€ä»¥<code>UnityEngine.Object</code>é‡å†™äº†C#çš„<code>operator==</code>ä»¥åŠ<code>operator!=</code>è®©ä¸€ä¸ªå·²è¢«é”€æ¯çš„Objectèƒ½å¤Ÿè¡¨ç°ä¸ºnullã€‚æ‰€ä»¥å¯¹å·²åœ¨åŸç”Ÿå±‚è¢«é”€æ¯çš„Objectè¿›è¡Œnullåˆ¤å®šä¼šè¿”å›trueï¼Œæˆ–è€…ç›´æ¥å¼•å‘<code>NullRefrenceException</code>ï¼Œæ¥å‘Šè¯‰ä½ è¯¥å¯¹è±¡å·²ç»è¢«é”€æ¯ã€‚</p>
<p>å¯ä»¥åœ¨C#ä¾§çœ‹åˆ°Objectå®ç°ä¸­ï¼Œè‹¥ä¸nullè¿›è¡Œæ¯”è¾ƒï¼Œä¼šè°ƒç”¨<code>IsNativeObjectAlive</code>è¿›è¡Œåˆ¤å®šã€‚</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F; UnityEngine.Object.CompareBaseObjects
private static bool CompareBaseObjects(Object lhs, Object rhs)
&#123;
  bool flag1 &#x3D; (object) lhs &#x3D;&#x3D; null;
  bool flag2 &#x3D; (object) rhs &#x3D;&#x3D; null;
  if (flag2 &amp;&amp; flag1)
    return true;
  if (flag2)
    return !Object.IsNativeObjectAlive(lhs);
  return flag1 ? !Object.IsNativeObjectAlive(rhs) : lhs.m_InstanceID &#x3D;&#x3D; rhs.m_InstanceID;
&#125;</code></pre>
<h4 id="è¿›è¡Œä¸€ä¸‹å›é¡¾éåŸæ–‡å†…å®¹">è¿›è¡Œä¸€ä¸‹å›é¡¾ï¼ˆéåŸæ–‡å†…å®¹ï¼‰</h4>
<p>åœ¨æ–‡ç« å¼€å§‹æ—¶æˆ‘ä»¬ç»™å‡ºäº†ä¾‹å­<code>GameFacade.CurrentGame.DelayCall</code>ï¼Œç°åœ¨æˆ‘ä»¬åœ¨å»¶æ—¶æ‰§è¡Œçš„ä»£ç ä¸­åŠ ä¸Šè¿™äº›åˆ¤æ–­è¯­å¥ï¼Œå¹¶è®°å½•å…³é”®æ—¥å¿—ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">private void OnPlayerGuideFinished()
&#123;
    Debugger.Log(&quot;[UINewAutoPickUpSettingController.OnPlayerGuideFinished]&quot;);
    if (this &#x3D;&#x3D; null)
    &#123;
        Debugger.Log(&quot;[UINewAutoPickUpSettingController.OnPlayerGuideFinished] this is null&quot;);
    &#125;

    var mono &#x3D; this as MonoBehaviour;
    if (mono &#x3D;&#x3D; null)
    &#123;
        Debugger.Log(&quot;[UINewAutoPickUpSettingController.OnPlayerGuideFinished] mono is null&quot;);
    &#125;

    if (m_View.GuideCoverBtn &#x3D;&#x3D; null)
    &#123;
        Debugger.Log(&quot;[UINewAutoPickUpSettingController.OnPlayerGuideFinished] m_View.GuideCoverBtn is null&quot;);
    &#125;

    if (m_View.GuideCoverBtn.gameObject &#x3D;&#x3D; null)
    &#123;
        Debugger.Log(&quot;[UINewAutoPickUpSettingController.OnPlayerGuideFinished] m_View.GuideCoverBtn.gameObject is null&quot;);
    &#125;

    m_View.GuideCoverBtn.gameObject.SetActive(false);
&#125;</code></pre>
<p>è¿è¡Œæµ‹è¯•æ—¶ï¼Œæˆ‘ä»¬ä¼šå‘ç°è¿™äº›å°½ç®¡æ‰˜ç®¡å±‚ä»æŒæœ‰è¿™äº›MonoBehaviourçš„å¼•ç”¨ï¼Œä½†è¿™äº›å¼•ç”¨å·²ç»å…¨éƒ¨è¢«åˆ¤å®šä¸ºnullï¼Œè¿™æ˜¯ç”±äºæˆ‘ä»¬é”€æ¯gameObjectæ—¶ï¼ŒåŸç”Ÿå±‚å¯¹åº”çš„å¯¹è±¡å·²ç»è¢«ä»å†…å­˜ä¸­é”€æ¯ï¼Œå¯¹åº”å†…å†…å­˜ç©ºé—´è¢«é‡Šæ”¾ï¼Œæ‰€ä»¥å°½ç®¡æ‰˜ç®¡å±‚çš„<code>Object</code>å¯¹è±¡è¿˜æ²¡æœ‰è¢«åƒåœ¾å›æ”¶ï¼Œå¯¹è±¡ä»ç„¶å¯ä»¥è¢«è®¿é—®ï¼Œä½†å¯¹è‡ªèº«çš„nullåˆ¤å®šä¼šå…¨éƒ¨ä¸ºtrueã€‚</p>
<p>åŒæ—¶æˆ‘ä»¬ä¹Ÿè¦æ³¨æ„åˆ°nullåˆ¤å®šä¸ºtrueæ˜¯å› ä¸º<code>operator==</code>çš„é‡å†™ï¼Œä½†æ˜¯ä»ç„¶æŒ‡å‘ä¸€ä¸ªæ‰˜ç®¡å±‚çš„<code>Object</code>å¯¹è±¡ï¼Œè¿™ä¸ªå¯¹è±¡çš„æˆå‘˜ï¼ˆå¦‚m_Viewï¼Œæ˜¯ä¸€ä¸ªçº¯C#ä¾§å¯¹è±¡ï¼‰ä»ç„¶æ˜¯å¯ä»¥è¢«è®¿é—®çš„ï¼Œåªåœ¨æœ€ç»ˆè®¿é—®åˆ°åŸç”Ÿå±‚å¯¹è±¡ï¼Œæˆ–è€…è¯•å›¾è·å–åŸç”Ÿå±‚å¯¹è±¡æ—¶æŠ¥é”™ã€‚</p>
<a href="/p/27ad02cebc90/image-20211221143715637.png" class="gallery-item"><img src="/p/27ad02cebc90/image-20211221143715637.png" class="" title="image-20211221143715637"></a>
<p>ä¸Šå›¾ä¸ºè¿è¡Œæ—¥å¿—ç»“æœï¼ŒæŠ¥é”™çš„ä¸º<code>UnityEngine.Component</code>ä¸­çš„<code>getter</code>æ–¹æ³•ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F;&#x2F; &lt;summary&gt;
&#x2F;&#x2F;&#x2F;   &lt;para&gt;The game object this component is attached to. A component is always attached to a game object.&lt;&#x2F;para&gt;
&#x2F;&#x2F;&#x2F; &lt;&#x2F;summary&gt;
&#x2F;&#x2F;&#x2F; &lt;footer&gt;&lt;a href&#x3D;&quot;https:&#x2F;&#x2F;docs.unity3d.com&#x2F;2018.4&#x2F;Documentation&#x2F;ScriptReference&#x2F;30_search.html?q&#x3D;Component-gameObject&quot;&gt;&#96;Component.gameObject&#96; on docs.unity3d.com&lt;&#x2F;a&gt;&lt;&#x2F;footer&gt;
public extern GameObject gameObject &#123; [FreeFunction(&quot;GetGameObject&quot;, HasExplicitThis &#x3D; true), MethodImpl(MethodImplOptions.InternalCall)] get; &#125;</code></pre>
<p>å¯ä»¥çœ‹åˆ°è¿™é‡Œå°±æ˜¯åœ¨è¯•å›¾è·å–åŸç”Ÿå±‚gameObjectæ—¶æŠ›å‡ºäº†é”™è¯¯</p>
<h3 id="gameobject-component">GameObject &amp; Component</h3>
<h4 id="gameobject">GameObject</h4>
<blockquote>
<p>æ­¤éƒ¨åˆ†å†…å®¹è¿›è¡Œçœç•¥ï¼Œå¯è·³è½¬åˆ°åŸæ–‡æŸ¥çœ‹å®Œæ•´å†…å®¹</p>
</blockquote>
<p><code>GameObject</code>ä»<code>Object</code>ç»§æ‰¿è€Œæ¥ï¼Œç”¨ä»¥ä»£è¡¨ä½ åœºæ™¯ä¸­çš„ä¸€åˆ‡å¯¹è±¡ã€‚ä¸€ä¸ªGameObjectæŒæœ‰ä¸€ä¸ªComponentçš„åˆ—è¡¨ï¼Œä¸”è‡³å°‘æ‹¥æœ‰ä¸€ä¸ªComponentï¼Œå³Transformï¼Œç”¨ä»¥æè¿°GameObjectçš„ç©ºé—´ä¿¡æ¯ï¼Œå¦‚positionå’Œrotationç­‰ã€‚</p>
<h4 id="component">Component</h4>
<blockquote>
<p>æ­¤éƒ¨åˆ†å†…å®¹è¿›è¡Œçœç•¥ï¼Œå¯è·³è½¬åˆ°åŸæ–‡æŸ¥çœ‹å®Œæ•´å†…å®¹</p>
<p>Unityé€šè¿‡Componentå¯¹è±¡çš„ç»„åˆæ¥å®šä¹‰gameObjectçš„è¡Œä¸ºè¡¨ç°ï¼Œè¿™æ˜¯è¢«æ¸¸æˆå¼•æ“ï¼ˆæ¸¸æˆå¼€å‘è€…ï¼‰æˆä¸ºEntity
Component Systemçš„æ ¸å¿ƒæè¿°/ä¿¡æ¡...
å®¹æ˜“æ··æ·†çš„æ˜¯Unityä¹Ÿå°†ä»–ä»¬æ¨å‡ºçš„æ¬¡ä¸–ä»£é«˜æ€§èƒ½æ¸¸æˆç¼–ç¨‹èŒƒå¼ï¼ˆparadigmï¼‰æˆä¸ºECSï¼Œå³ä¸ä»…å¼•æ“é€»è¾‘ï¼Œæ¸¸æˆé€»è¾‘ä¹Ÿä½¿ç”¨ECSæ¥å®ç°ï¼Œä»è€Œæˆä¸ºä¸€ç§æ•°æ®é©±åŠ¨çš„è®¾è®¡ã€‚</p>
</blockquote>
<p>GameObjectçš„è¡Œä¸ºé€šè¿‡Componentçš„ç»„åˆæ¥é©±åŠ¨ï¼Œç”¨æˆ·å®ç°çš„ç»„ä»¶é€šå¸¸éœ€è¦ç»§æ‰¿ç±»<code>MonoBehaviour</code>ã€‚å¯¹äºComponentæ¥è¯´ï¼š</p>
<ol type="1">
<li>å¿…é¡»å½’å±äºä¸€ä¸ªGameObjectï¼Œé€šè¿‡å±æ€§<code>gameObject</code>è¿›è¡Œè®¿é—®</li>
<li>å¯ä»¥æ¥æ”¶åˆ°<strong>messages</strong>ï¼Œç”¨äºé©±åŠ¨è‡ªèº«çš„ç‰¹æ®Šè¡Œä¸ºï¼ˆå³äº‹ä»¶æ–¹æ³•ï¼‰</li>
</ol>
<p>Componentæœ€é‡è¦çš„åŠŸèƒ½ç”±Unity Messagesé©±åŠ¨ï¼ˆä¹Ÿç§°ä¸ºUnity Event
Functionsï¼‰ï¼Œè¿™äº›éƒ½æ˜¯å¼•æ“åœ¨ç‰¹å®šæ—¶é—´ä¸‹è§¦å‘çš„callbackæ–¹æ³•ï¼Œè¯¦æƒ…å¯ä»¥å‚è€ƒå®˜æ–¹æ–‡æ¡£ã€‚</p>
<p>è‹¥ä½ éœ€è¦åœ¨ç‰¹å®šæ—¶æœºæ‰§è¡Œä¸€äº›é€»è¾‘ï¼Œæ·»åŠ è¿™äº›messageçš„åŒåæ–¹æ³•å³å¯ï¼Œå¼•æ“è¿è¡Œæ—¶ï¼ˆruntimeï¼‰ä¼šä½¿ç”¨åå°„æ¥è¿›è¡Œæ–¹æ³•è°ƒç”¨ï¼Œè¿™å°±æ˜¯ä¸ºä»€ä¹ˆä½ åœ¨è¿™äº›æ–¹æ³•ä¸Šçœ‹ä¸åˆ°<code>override</code>å…³é”®å­—ã€‚æ¯ä¸ªComponentç±»å‹çš„<code>Update</code>ï¼Œ<code>LateUpdate</code>ï¼Œ<code>FixedUpdate</code>è¿™äº›æ¶ˆæ¯éƒ½åªä¼šè¢«åå°„è·å–ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸ç”¨æ‹…å¿ƒåå°„åœ¨æ¯ä¸ªæ¸¸æˆå¸§éƒ½è¢«æ‰§è¡Œï¼ˆæœ‰å…³å†…å®¹å¯ä»¥å‚é˜…
https://blog.unity.com/technology/1k-update-callsï¼‰ã€‚</p>
<p><code>Behaviour</code>æ˜¯å¯ä»¥è¢«è®¾ç½®enabled / disabled
çŠ¶æ€çš„Componentï¼Œåœ¨disableçš„çŠ¶æ€ä¸‹ï¼Œä¸€äº›äº‹ä»¶æ–¹æ³•å°†ä¸ä¼šæ‰§è¡Œã€‚è€Œ<code>MonoBehaviour</code>æ˜¯å¯ä»¥ä½¿ç”¨åç¨‹ï¼ˆå—Unity
Engineç®¡ç†ï¼‰çš„Behaviourã€‚</p>
<p>å¼€å‘çš„æ—¶å€™é‡åˆ°ä¸€ä¸ªé—®é¢˜ï¼Œä¸ºä»€ä¹ˆunityé¡¹ç›®ä¸­çš„C#ä»£ç ä¼šæç¤ºæ— æ³•å»newä¸€ä¸ªcomponentå‘¢ï¼ˆnew
GameObjectå´æ˜¯å¯è¡Œçš„ï¼‰ã€‚åŸå› æ˜¯componentæ˜¯éœ€è¦ä¾èµ–gameObjectå­˜åœ¨çš„ï¼Œéœ€è¦gameObjecté©±åŠ¨å„ç§ç”Ÿå‘½å‘¨æœŸã€‚è€ŒC#çš„newè¡Œä¸ºå¹¶ä¸èƒ½åœ¨åˆ›å»ºcomponentæŒ‡æ´¾componentä¾é™„çš„å¯¹è±¡ï¼Œè¿™å°±å¯¼è‡´ä¸€äº›åŠŸèƒ½ä¸èƒ½æ­£å¸¸ä½œç”¨ã€‚å‚è€ƒäº†unityè®ºå›æ­¤å›ç­”ï¼šhttps://answers.unity.com/questions/653904/you-are-trying-to-create-a-monobehaviour-using-the-2.html</p>
<h3 id="è¦ç‚¹">è¦ç‚¹</h3>
<ol type="1">
<li>Unity objectåœ¨åŸç”Ÿå±‚é”€æ¯åè¡¨ç°ä¸ºnullï¼Œ<code>==
null</code>åˆ¤å®šå¯èƒ½åšäº†ä¸€äº›ä½ æ–™æƒ³ä¹‹å¤–çš„å·¥ä½œ</li>
<li>å› æ­¤ï¼Œå…¶ä»–çš„nullè¿ç®—ç¬¦ï¼ˆå¦‚?.ï¼‰å¯èƒ½ä¸èµ·ä½œç”¨</li>
<li>Unity Messages å¯ä»¥æ˜¯ç§æœ‰çš„ï¼</li>
<li>å¦‚æœæ²¡æœ‰å¿…è¦çš„è¯ï¼Œä¸è¦å£°æ˜<code>Update</code>è¿™æ ·çš„æ–¹æ³•ç”¨äºoverrideç­‰ï¼Œè¿™ä¼šè®©å¼•æ“å¤šè°ƒç”¨ä¸€äº›é¢å¤–çš„æ–¹æ³•</li>
<li>å¯¹æ— ç”¨çš„Objectæˆ–è€…Componentè¿›è¡Œdisableæ˜¯é™åˆ¶æ¸¸æˆé€»è¾‘æˆ–èŠ‚çœCPUå¼€é”€çš„ä¸€ç§æ–¹å¼ï¼Œä½†è¿™äº›å¯¹è±¡ä»ç„¶ä¼šå ç”¨å†…å­˜</li>
</ol>
<hr />
<h2 id="åŸç”Ÿå¯¹è±¡ä¸æ‰˜ç®¡å¯¹è±¡çš„å¼•æ“ç®¡ç†">åŸç”Ÿå¯¹è±¡ä¸æ‰˜ç®¡å¯¹è±¡çš„å¼•æ“ç®¡ç†</h2>
<p>åŸè®¡åˆ’æ˜¯æ¬è¿ä¸€ä¸‹å‚è€ƒæ–‡ç« 3ä¸­ï¼Œç»“æœç²—ç•¥çœ‹ä¸‹æ¥å‚è€ƒ3æ›´å¤šæ˜¯è¯´ä¸€äº›åºåˆ—åŒ– /
ååºåˆ—åŒ–åœ¨Editor /
AssetBundleä¸­çš„åº”ç”¨ä»¥åŠå®ç°åŸç†ï¼Œè€Œæ²¡æœ‰å¤ªå¤šæ¶‰åŠæ¸¸æˆè¿è¡Œæ—¶çš„å†…å®¹ï¼Œåç»­æ·±å…¥å­¦ä¹ çš„æ—¶å€™å†è¡¥å……äº†</p>
<h2 id="å‚è€ƒæ–‡ç« ">å‚è€ƒæ–‡ç« </h2>
<ol type="1">
<li><a href="https://blog.eyas.sh/2020/10/unity-for-engineers-pt5-object-component/" title="" target="">Understanding Unity Engine Objects</a></li>
<li><a href="https://blog.unity.com/technology/1k-update-calls" title="æ–‡ç« 1ä¸­çš„æ¨èé˜…è¯»" target="">unity blog: 10000 Update() calls</a></li>
<li><a href="https://developer.unity.cn/projects/6152e4fbedbc2a0020584027" title="" target="">æ­ç§˜Unityçš„é»‘ç›’ä¸–ç•Œï¼ŒåŸç”Ÿå¯¹è±¡å’Œæ‰˜ç®¡å¯¹è±¡æµ…è°ˆ</a></li>
</ol>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>æ¸¸æˆå¼€å‘</category>
        <category>å¼•æ“å®ç°åŸç†</category>
      </categories>
      <tags>
        <tag>æ¸¸æˆå¼€å‘</tag>
        <tag>Unity</tag>
      </tags>
  </entry>
  <entry>
    <title>TableCraft is finally here!</title>
    <url>/p/fc631eddaa53/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="tablecraft-is-finally-here">TableCraft is finally here!</h1>
<h2 id="tablecraft-å‘å¸ƒ">TableCraft å‘å¸ƒï¼</h2>
<p>ä»21å¹´èµ·ç»è¿‡ä¸¤å¹´æ–­æ–­ç»­ç»­çš„å¼€å‘ï¼ŒTableCraftç»ˆäºå‘å¸ƒäº†<a
href="https://github.com/kalulas/TableCraft/releases/tag/v1.0.0">v1.0.0</a>ç‰ˆæœ¬ï¼Œå¹¶å¼€å§‹æä¾›ç»™é¡¹ç›®ç»„åŒäº‹ä½¿ç”¨äº†ã€‚è¿™ç¯‡æ–‡ç« ä¼šä»‹ç»ä»æœ€åˆç«‹é¡¹åˆ°æœ€ç»ˆå‘å¸ƒTableCraftçš„è®¾è®¡å‘ç”Ÿäº†æ€æ ·çš„å˜åŒ–ï¼ŒTableCraftç°é˜¶æ®µå­˜åœ¨çš„ä¸€äº›é—®é¢˜ï¼Œä»¥åŠæœªæ¥çš„å‘å±•ç›®æ ‡ã€‚</p>
<span id="more"></span>
<h2 id="èµ·å§‹">èµ·å§‹</h2>
<p>å¼€å‘TableCraftçš„åˆè¡·æ˜¯ä¸ºäº†è®©è‡ªå·±èƒ½ä»æ‰‹å†™è¯»è¡¨ä»£ç çš„ç—›è‹¦ä¸­è§£æ”¾å‡ºæ¥ï¼šé‡å¤è€Œæœºæ¢°çš„å·¥ä½œï¼Œé™¤äº†å¾’å¢å‡ºé”™çš„é£é™©æ²¡æœ‰ä»»ä½•æ„ä¹‰ã€‚</p>
<p>åœ¨è¿™å‡ å¹´çš„é¡¹ç›®å¼€å‘è¿‡ç¨‹ä¸­ï¼Œç¨‹åºç»„ä¹Ÿå‡ºäºç¼©çŸ­å¯åŠ¨æ—¶é—´ï¼Œå‡å°‘è§£æé…ç½®è¡¨çš„å†…å­˜åˆ†é…ã€å†…å­˜å ç”¨ï¼Œæ¨è¿›è¿‡å‡ æ¬¡è¯»è¡¨ä»£ç çš„ä¼˜åŒ–ï¼Œå¦‚å¤šçº¿ç¨‹è¯»å–è§£æï¼Œcsvæ ¼å¼é…ç½®è½¬ä¸ºbinaryæ ¼å¼ã€‚æ¦‚æ‹¬ä¸‹æ¥ï¼Œæ‰‹å†™è¯»è¡¨ä»£ç é™¤äº†ç´¯äººï¼Œè‡ªè¡Œå®ç°çš„è¯»è¡¨ä»£ç æä¾›äº†è¿‡é«˜çš„è‡ªç”±åº¦ï¼Œè¿˜ä¼šå¸¦æ¥é¢å¤–çš„é—®é¢˜ï¼š</p>
<ul>
<li>ä¸åŒé…ç½®è¡¨ä¸­ç›¸åŒæ•°å€¼ç±»å‹å­—æ®µçš„è¯»å–è¡Œä¸ºå¯èƒ½ä¸ä¸€è‡´ï¼ˆç©ºå­—ç¬¦ä¸²ä»£è¡¨falseï¼Ÿtrueï¼Ÿï¼‰ï¼Œé…ç½®è´Ÿè´£äººéš¾ä»¥å½¢æˆä¹ æƒ¯ï¼Œé…ç½®é”™è¯¯é£é™©é«˜ã€‚</li>
<li>å°†csvæ ¼å¼è½¬æ¢ä¸ºbinaryæ ¼å¼å¯èƒ½ä¸¢å¤±éƒ¨åˆ†ä¿¡æ¯ï¼Œä½¿å¾—éš¾ä»¥ç”Ÿæˆã€ç”šè‡³æ— æ³•ç”Ÿæˆå¯¹åº”çš„binaryè¯»è¡¨ä»£ç ã€‚</li>
<li>ä¸åŒçš„é…ç½®è¡¨ä¹‹é—´å¯èƒ½å­˜åœ¨ä¾èµ–ï¼Œä½¿å¾—å¤šçº¿ç¨‹ä¼˜åŒ–å·¥ä½œéš¾ä»¥å±•å¼€ã€‚</li>
<li>å¼€å‘è€…è‡ªèº«æ°´å¹³é—®é¢˜å¯¼è‡´è¯»è¡¨ä»£ç æ•ˆç‡å·®ï¼Œèµ„æºå ç”¨å¤šã€‚</li>
</ul>
<p>åŒæ—¶æ­£æ‰€è°“ç”±å¥¢å…¥ä¿­éš¾ï¼Œåœ¨å…ˆå‰é¡¹ç›®ç»„ä½“éªŒè¿‡å¤šç«¯ä¸€è‡´ï¼ˆC++ï¼ŒC#ï¼ŒLuaï¼Œåº”ç”¨äºå®¢æˆ·ç«¯è¿è¡Œæ—¶ï¼Œå®¢æˆ·ç«¯ç¼–è¾‘å™¨ï¼ŒæœåŠ¡å™¨ï¼‰çš„é…ç½®è¡¨è¯»å–åº“ï¼Œä¸é…ç½®è¡¨ç¼–è¾‘ã€ä»£ç ç”Ÿæˆå·¥å…·åï¼Œæ¯æ¬¡æ‰‹å†™è¯»è¡¨ä»£ç éƒ½æ˜¯ä¸€ç§ç…ç†¬ã€‚äºæ˜¯åœ¨21å¹´æœ«çš„ä¸€ä¸ªç¨ç¨æœ‰ç©ºçš„å‘¨æœ«ï¼ŒTableCraftçš„å¼€å‘å·¥ä½œå¼€å§‹äº†ã€‚</p>
<h2 id="ç»ç”±">ç»ç”±</h2>
<p>TableCraftæœ€åˆçš„è®¾è®¡æ„æƒ³å¦‚ä¸‹ï¼š</p>
<ol type="1">
<li>å…¼å®¹å¸¸è§çš„é…ç½®æ–‡ä»¶æ ¼å¼</li>
<li>ä¸ºé…ç½®æ–‡ä»¶è®¾è®¡å…ƒæ•°æ®æ–‡ä»¶ï¼Œè¡¥å…¨ç”Ÿæˆè¯»è¡¨ä»£ç æ‰€éœ€çš„æè¿°ä¿¡æ¯</li>
<li>æä¾›è¯»è¡¨ä»£ç çš„æ–‡æœ¬å½¢å¼æ¨¡æ¿ï¼ˆTemplateï¼‰æ–‡ä»¶ï¼Œè€Œä¸å°†è¯»è¡¨ä»£ç å†…å®¹ç¡¬ç¼–ç åˆ°å·¥å…·ä¸­ï¼Œç›®çš„æœ‰ï¼š
<ol type="1">
<li>å·¥å…·å¯è·¨é¡¹ç›®ç»„ä½¿ç”¨ï¼Œå‡å°‘é‡å¤å¼€å‘å·¥ä½œé‡</li>
<li>è€ƒè™‘åˆ°è¯»è¡¨ä»£ç å‘ç”Ÿæ”¹å˜çš„é¢‘ç‡è¾ƒé«˜ï¼Œå°†ä»£ç æ¨¡æ¿åŒ–å¯ä»¥å‡å°‘é‡å¤ç¼–è¯‘</li>
</ol></li>
<li>å°†é…ç½®æ–‡ä»¶ä¸å…ƒæ•°æ®æ–‡ä»¶ã€ä»£ç æ¨¡æ¿æ–‡ä»¶ç»“åˆï¼Œç”Ÿæˆå„ç§è¯­è¨€çš„è¯»è¡¨ä»£ç </li>
<li>æä¾›å•ç‹¬çš„libraryæ–‡ä»¶ï¼Œå¯å¼€å‘å‘½ä»¤è¡Œè„šæœ¬ç”¨äºæ„å»ºä»»åŠ¡ï¼Œä¹Ÿå¯å¼€å‘å›¾å½¢åŒ–å·¥å…·ç”¨äºæ—¥å¸¸å¼€å‘ä½¿ç”¨</li>
</ol>
<p>æœ‰äº†åŸºæœ¬ç›®æ ‡ä¹‹åï¼Œ21å¹´æœ«å°±ç€æ‰‹ä»¥C#è¿›è¡Œæ ¸å¿ƒdllçš„å¼€å‘ï¼ˆä¹Ÿå°±æ˜¯è¿™æ—¶æˆ‘å‘å¸ƒäº†
<a href="https://www.threegates.net/p/ab7a58fcc8d2/" title="" target="">å…³äºé…ç½®ä»£ç ç”Ÿæˆå™¨çš„æ„æƒ³</a>ï¼‰ï¼Œä½†å¡åœ¨äº†ä¸¤ç‚¹ä¸Šï¼š</p>
<ol type="1">
<li>è‹¥è¦å®ç°è¯»è¡¨ä»£ç æ¨¡æ¿åŒ–ï¼Œæ„å‘³ç€éœ€è¦è®¾è®¡è‡ªå·±çš„æ¨¡æ¿è¯­æ³•ï¼Œä»¥åŠæ¨¡æ¿æ–‡ä»¶ç¼–è¯‘å™¨ï¼›è™½è¯´ä¸è‡³äºæ— ä»ä¸‹æ‰‹ï¼Œä½†å·¥ä½œé‡æ¯”é¢„æœŸçš„å¤§å¾ˆå¤šã€‚</li>
<li>å¯¹ä½¿ç”¨ä»€ä¹ˆGUIå¼€å‘æ¡†æ¶æ²¡æœ‰ä¸‹å®šä¸»æ„ï¼Œå½“æ—¶ç”šè‡³æƒ³è¿‡ä½¿ç”¨ImGUI</li>
</ol>
<p>ç”±äºé¡¹ç›®ç»„çš„å·¥ä½œä¹Ÿç¹å¿™èµ·æ¥ï¼ŒTableCraftçš„å¼€å‘å·¥ä½œå°±æš‚ä¸”æç½®äº†ã€‚ä½†ç°åœ¨å›æƒ³èµ·æ¥ï¼Œä¹Ÿåº†å¹¸å½“æ—¶åŠæ—¶åœæ‰‹äº†ï¼Œæ‰èƒ½åœ¨åæ¥æ‰¾åˆ°æ›´ä¸ºæˆç†Ÿçš„è§£å†³æ–¹æ¡ˆã€‚çœ‹æ¥æœ‰äº›æ—¶å€™é—·å¤´å¹²æ´»çœŸçš„ä¸å¯å–ï¼Œæ”¾ä¸‹æ‰§å¿µï¼Œæ²‰ä¸‹å¿ƒå­¦ç‚¹ä¸œè¥¿æ‰æ˜¯å“è¶Šä¹‹è·¯å•Šã€‚</p>
<p>23å¹´åœ¨å†™åšå®¢çš„æ—¶å€™å‘ç°ï¼Œæ”¯æŒmarkdownæ ¼å¼çš„åšå®¢æ¡†æ¶å…¶å®éƒ½åº”ç”¨äº†ç±»ä¼¼çš„æ¨¡æ¿ï¼ˆTemplateï¼‰æŠ€æœ¯ï¼Œä½¿ç”¨ç”¨æˆ·æäº¤çš„markdownæ–‡æœ¬ï¼Œæ ¹æ®ä¸€äº›é¢„è®¾å¥½çš„è§„åˆ™ï¼Œæ¥ç”Ÿæˆå‡ºæœ€ç»ˆçš„é™æ€htmlé¡µé¢ã€‚è¿™æ—¶å€™æˆ‘æ‰æ„è¯†åˆ°ï¼Œæœç´¢çš„å…³é”®å­—åº”è¯¥æ˜¯æ¨¡æ¿ï¼ˆTemplateï¼‰ã€‚</p>
<p>æœä¸å…¶ç„¶ï¼Œ.NET ä¸­ä¹Ÿæœ‰ç±»ä¼¼çš„è§£å†³æ–¹æ¡ˆï¼Œç§°ä½œ
<a href="https://learn.microsoft.com/en-us/visualstudio/modeling/code-generation-and-t4-text-templates?view=vs-2022" title="" target="">T4 Text Template</a>ï¼Œä¹Ÿä¸æ˜¯ä»€ä¹ˆæ–°é²œæŠ€æœ¯äº†ï¼Œç”šè‡³åœ¨å¼€å‘æ—¶è¿˜æ˜¯å€Ÿç”¨äº†ç¬¬ä¸‰æ–¹åº“æ‰å®ç°äº†å…¼å®¹
.net6ã€‚</p>
<p>è€ŒGUIæ¡†æ¶çš„é€‰å–ä¸Šï¼Œåˆ™æ˜¯é‡‡ç”¨äº†é¡¹ç›®ç»„å‰è¾ˆæ¨èçš„
<a href="https://docs.avaloniaui.net/" title="" target="">Avalonia UI</a>ã€‚ç°åœ¨å›æƒ³èµ·æ¥ï¼Œå…¶å®åº”è¯¥ä»WPFå¼€å§‹ä½“éªŒçš„å¥½ï¼Œç›´æ¥å…¥æ‰‹
AvaloniaUI å¯èƒ½ç¼ºå¤±äº†ä¸€äº›æ¯”è¾ƒçš„è¿‡ç¨‹ï¼Œä¸è¿‡ä¸å¾—ä¸æ‰¿è®¤é€‰å–AvaloniaUI
å¤§å¤§æé«˜äº†å¼€å‘é€Ÿåº¦ã€‚</p>
<p>æœ€ç»ˆï¼ŒTableCraftä»¥è¿™æ ·çš„å½¢å¼å‘ˆç°äº†å‡ºæ¥ï¼š</p>
<ol type="1">
<li>æ ¸å¿ƒåº“ nuget: <a href="https://www.nuget.org/packages/TableCraft.Core" title="" target="">TableCraft.Core</a></li>
<li>æ ¸å¿ƒåº“ github page: <a href="https://github.com/kalulas/TableCraft.Core" title="" target="">TableCraft.Core</a></li>
<li>åŸºäºAvaloniaçš„å¯è§†åŒ–ç¼–è¾‘å™¨ github page: <a href="https://github.com/kalulas/TableCraft" title="" target="">TableCraft(Editor)</a></li>
</ol>
<h2 id="ç¼ºé™·">ç¼ºé™·</h2>
<p>åœ¨TableCraftæ­£å¼æŠ•å…¥ä½¿ç”¨çš„è¿™ä¸€æ®µæ—¶é—´å†…ï¼Œå¯¹å·¥å…·çš„åæ€ä¹Ÿåœ¨æŒç»­è¿›è¡Œä¸­ã€‚</p>
<p>ä»å…·ä½“å®ç°çš„è§’åº¦ï¼ŒTableCraftå­˜åœ¨ä»¥ä¸‹å‡ ç‚¹é—®é¢˜ï¼š</p>
<ol type="1">
<li>å—æ¸¸æˆå¼€å‘ç»éªŒçš„å½±å“ä½¿ç”¨äº†LitJsonåº“ï¼Œå®é™…ä¸Šå¯¹äºç°ä»£çš„.net
åº”ç”¨å¼€å‘ï¼Œä½¿ç”¨æ ‡å‡†çš„Newtonsoft.Jsonä¼šæ›´å¥½ä¸€äº›ã€‚</li>
<li>é…ç½®æ–‡ä»¶åˆ†æ•£ä¸”é…ç½®æ–¹å¼æ¯”è¾ƒåŸå§‹ã€‚</li>
</ol>
<p>è€Œä»è®¾è®¡æ€è·¯çš„è§’åº¦æ¥çœ‹ï¼ŒTableCraftå¯èƒ½å­˜åœ¨ä¸€äº›æ›´ä¸¥é‡çš„é—®é¢˜ï¼š</p>
<ol type="1">
<li>TableCraftä¸å¯é¿å…åœ°ç¡¬ç¼–ç äº†é…ç½®è¡¨å…ƒæ•°æ®çš„jsonæ ¼å¼ï¼Œå¯¹äºä½¿ç”¨å·¥å…·çš„ç”¨æˆ·æ¥è¯´ï¼Œäº†è§£å¹¶ä½¿ç”¨æ­¤jsonæ ¼å¼æ˜¯ä¸å¯é¿å…çš„ã€‚å¦‚æœå‡ºç°ç›®å‰å…ƒæ•°æ®ä¸èƒ½æ»¡è¶³çš„éœ€æ±‚ï¼Œå®é™…ä¸Šè¿˜æ˜¯æ ¹æ®é¡¹ç›®çš„éœ€æ±‚æ‰©å±•
TableCraft.Coreã€‚</li>
<li>TableCraftè™½ç„¶è®¾è®¡äº†æ•°æ®æºæ–‡ä»¶ï¼ˆSourceï¼‰ä»¥åŠæè¿°æ–‡ä»¶ï¼ˆDecoratorï¼‰çš„æ¥å£ç±»å‹ï¼Œä½†å®é™…ä¸Šè‹¥è¦æ”¯æŒæ–°çš„æ–‡ä»¶ç±»å‹ï¼Œè¿˜æ˜¯éœ€è¦é¢å¤–çš„å¼€å‘é‡ï¼Œè¿™ä¹Ÿæ˜¯å¾ˆéš¾é¿å…çš„ã€‚ä¸åŒé¡¹ç›®æ‰€éœ€è¦çš„æ”¯æŒçš„æ–‡ä»¶ç±»å‹å¯èƒ½ä¸åŒï¼Œç†æƒ³æƒ…å†µæ˜¯å¯ä»¥ä½¿ç”¨æ’ä»¶å½¢å¼æ¥åšæ”¯æŒï¼Œå¦‚æœåšæˆ
all-in-one å°±æœ‰äº›è‡ƒè‚¿äº†ã€‚</li>
<li>T4 Text Template
å¹¶ä¸æ˜¯æ™®åŠåº¦å¾ˆå¹¿çš„è§£å†³æ–¹æ¡ˆï¼Œè™½ç„¶å¯ä»¥ä½¿ç”¨C#è¿›è¡Œç¼–ç ï¼Œä½†æœ‰ä¸€å®šå­¦ä¹ æˆæœ¬ã€‚å¹¶ä¸”å³ä½¿æ˜¯åœ¨IDEé‡Œè¿›è¡Œç¼–å†™Template(.txt)æ–‡ä»¶ï¼Œä½“éªŒä¹Ÿæ¯”ä¸ä¸Šç›´æ¥ç¼–è¾‘æºæ–‡ä»¶ã€‚è¿™ç‚¹å¯èƒ½ä¼šå¯¹æ¨¡æ¿æ–‡ä»¶çš„ç»´æŠ¤å¸¦æ¥è´Ÿé¢å½±å“ã€‚</li>
</ol>
<p>ç»“åˆä¸Šè¿°é—®é¢˜çœ‹ï¼Œå¯¹äºä¸€ä¸ªæ²¡æœ‰ä»»ä½•ç°æˆè§£å†³æ–¹æ¡ˆçš„æ–°é¡¹ç›®å¼€å‘ç»„æ¥è¯´ï¼Œå¦‚æœå¯¹ç¡¬ç¼–ç è¯»è¡¨ä»£ç æ²¡æœ‰å¤ªå¤§æŠµè§¦ï¼Œè‡ªè¡Œè®¾è®¡å…ƒæ•°æ®æ ¼å¼ï¼Œå¹¶è‡ªè¡Œå¼€å‘é…ç½®æ–‡ä»¶ç¼–è¾‘å™¨ï¼Œç”Ÿæˆè¯»è¡¨ä»£ç ï¼Œå®é™…ä¸Šå·¥ä½œé‡ä¹Ÿä¸æ¯”ä½¿ç”¨TableCraftå¤§å¤šå°‘ã€‚è€Œå®é™…ä¸Šï¼Œé…ç½®è§£å†³æ–¹æ¡ˆåœ¨åŒä¸€å¼€å‘ç»„/å…¬å¸çš„é¡¹ç›®é—´ä¸€èˆ¬éƒ½ä¼šè¿›è¡Œæµé€šï¼Œæ‰€ä»¥ç›¸ä¿¡å¤§å¤šæ•°æ–°é¡¹ç›®ä¹Ÿéƒ½ä¼šæœ‰ç°æˆçš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>æ‰€ä»¥TableCraftçš„å®Œå·¥è™½ç„¶å¯å–œå¯è´ºï¼Œä½†è€ƒè™‘åˆ°ä¸Šè¿°é—®é¢˜ï¼Œæƒ³è¦çœ‹åˆ°TableCraftâ€œæµè¡Œèµ·æ¥â€å¯èƒ½è¿˜æ˜¯æœ‰ç›¸å½“éš¾åº¦çš„ã€‚ä½†æˆ–è®¸ä¹Ÿæ­£æ˜¯å®Œæˆäº†TableCraftï¼Œæ‰è®©æˆ‘æ„è¯†åˆ°äº†ä¸Šé¢è¿™äº›é—®é¢˜ï¼Œä»è¿™ä¸ªè§’åº¦æ¥çœ‹ï¼Œ23å¹´çš„ä¸ŠåŠå¹´ä¹Ÿå¯ä»¥å½“ä½œæ˜¯æ²¡æœ‰ç™½è´¹äº†ã€‚</p>
<h2 id="å±•æœ›">å±•æœ›</h2>
<p>é‚£ä¹ˆTableCraftæ˜¯å¦è¿˜ä¼šæœ‰æ–°å†…å®¹ä¸Šä¼ å‘¢ï¼Ÿç­”æ¡ˆæ˜¯è‚¯å®šçš„ï¼Œè™½ç„¶æ—¶é—´ä¸Šç»™ä¸å‡ºä»€ä¹ˆä¿è¯ï¼ˆç¬‘ï¼‰ã€‚æ¥ä¸‹æ¥æˆ‘å°†ç›®å‰èƒ½æƒ³åˆ°çš„ä¸€äº›å¯ä»¥å¼€å±•çš„å·¥ä½œè®°å½•åœ¨è¿™é‡Œï¼Œä¼šæŒ‰ç…§å®ç°æˆæœ¬ä»ä½åˆ°é«˜çš„æ¬¡åºæ’åºï¼š</p>
<ol type="1">
<li>è€ƒè™‘åˆ°æœªæ¥é…ç½®è¡¨çš„æ•°é‡å¯èƒ½ä¼šå˜å¾—å¾ˆå¤šï¼Œé…ç½®è¡¨æµè§ˆåˆ—è¡¨å’Œå­—æ®µæµè§ˆåˆ—è¡¨ä¼šæ–°å¢ä¸€ä¸ªæœç´¢æ¡†ã€‚</li>
<li>ä¼šåœ¨TableCraftä¸­æ–°å¢ä¸€ä¸ªå¼¹å‡ºçª—å£æ¥é…ç½®appsetting.jsonä¸­çš„å†…å®¹ã€‚</li>
<li>ç‰ˆæœ¬æ§åˆ¶ç›¸å…³æ›´éšç§çš„è´¦å·å¯†ç å†…å®¹å¯èƒ½è¿˜æ˜¯å†™è¿›æ³¨å†Œè¡¨çš„å¥½ã€‚</li>
<li>å¦‚æœè¦åšæˆçœ‹èµ·æ¥æ›´å®Œå–„çš„å·¥å…·ï¼Œè€ƒè™‘ç”¨installerçš„å½¢å¼æ¥å®‰è£…ï¼Œè¿˜éœ€è¦å·¥å…·çš„å‘å¸ƒä¸æ›´æ–°æ£€æµ‹ã€‚</li>
</ol>
<p>æœ€åè¦è¡¥å……çš„ä¸€ä¸ªå†…å®¹ä¹Ÿæ˜¯æ¥è‡ªæ—¥å¸¸å·¥ä½œä¸­çš„ä½“ä¼šï¼šåœ¨è¿™å‡ å¹´çš„å·¥ä½œä¸­æ²¡å°‘å¬ç­–åˆ’åŒäº‹å…³äºé…è¡¨çš„æŠ±æ€¨ï¼Œå®é™…ä¸Šåœ¨éœ€è¦è®©é…ç½®è¡¨æ»¡è¶³å¤šç¯å¢ƒã€å¤šåœ°åŒºã€å¤šç”¨é€”éœ€æ±‚çš„æƒ…å†µä¸‹ï¼Œæƒ³è¦å‡å°‘é‡å¤é…ç½®é‡ã€å‡å°‘é…ç½®é”™è¯¯å±å®æ˜¯å¾ˆå›°éš¾çš„ä¸€ä»¶äº‹ã€‚</p>
<p>åœ¨è¿™ç§ç¯å¢ƒä¸‹ï¼Œç»å¸¸ä¼šè¯ç”Ÿå‡ºå¾ˆå¤šå¥‡æ€ªçš„é…ç½®è¡¨æœºåˆ¶ï¼Œä¾‹å¦‚é…ç½®è¡¨çš„å…¶ä¸­ä¸€åˆ—æ˜¯æ¯”ç‰¹ä½ï¼Œæ­¤è¡Œä»…åœ¨ç‰¹å®šåœ°åŒºã€ç‰¹å®šç¯å¢ƒç”Ÿæ•ˆï¼›æˆ–è€…åœ¨æŸæŸæ¡ä»¶ä¸‹ï¼Œä¸€å¼ å°è¡¨èƒ½å¤Ÿåˆå¹¶åˆ°åŸå…ˆçš„åŒåå¤§è¡¨ä¸­ï¼›åœ¨æŸæŸæ¡ä»¶ä¸‹ï¼Œå»è¯»Aè·¯å¾„çš„é…ç½®è¡¨è€Œä¸è¯»Bè·¯å¾„çš„é…ç½®è¡¨ã€‚</p>
<p>å› æ­¤ï¼Œé…ç½®è¡¨<strong>ç¼–è¾‘å™¨</strong>çš„å¼€å‘çœ‹ä¸Šå»å°±éå¸¸å¿…è¦äº†ã€‚è®¾æƒ³ä¸­çš„é…ç½®è¡¨ç¼–è¾‘å™¨åº”è¯¥æœ‰è¿™äº›åŠŸèƒ½ï¼š</p>
<ol type="1">
<li>å­—æ®µç±»å‹æ£€æŸ¥ã€‚ç±»å‹æ£€æŸ¥æ˜¯å‡å°‘é…ç½®é—®é¢˜çš„é‡ä¸­ä¹‹é‡ã€‚</li>
<li>ä¸»é”®å’Œå¤–é”®ã€‚æ•°æ®åº“ä¸­çš„æ¦‚å¿µåœ¨è¿™é‡Œä¾ç„¶æœ‰ç”¨ï¼Œä½¿ç”¨å¤–é”®æ›´å¥½åœ°æ”¯æŒé…ç½®è¡¨çš„è·³è½¬ä¸KeyExistæ£€æŸ¥ã€‚</li>
<li>é…ç½®è¡¨çš„å£°æ˜ï¼ŒåŒæ—¶åˆ›å»ºå…ƒæ•°æ®è¿›è¡Œæè¿°ã€‚ä¸€ä¸ªâ€œé…ç½®è¡¨â€ä¸å†ä¸ä¸€ä¸ªæ–‡ä»¶ä¸€ä¸€å¯¹åº”ï¼Œè€Œæ˜¯ä¸€ç»„æ–‡ä»¶çš„æŠ½è±¡ï¼šå¯ä»¥æ˜¯ä¸åŒç¯å¢ƒï¼ˆå®¢æˆ·ç«¯ï¼Œåå°æœåŠ¡å™¨...ï¼‰ä¸‹çš„é…ç½®è¡¨ï¼Œä¹Ÿå¯ä»¥æ˜¯åŒæ„ç¯å¢ƒä¸‹ä¸åŒåœ°åŒºçš„é…ç½®è¡¨ã€‚</li>
<li>åŸå‹æ¨¡å¼çš„æ”¯æŒï¼Œå³å¯å£°æ˜åŸºäºé…ç½®è¡¨Açš„é…ç½®è¡¨Bã€‚é…ç½®è¡¨Bçš„æ•°æ®æ˜¯åŸºäºAçš„å¢åˆ æ”¹ï¼Œé…ç½®è¡¨Båªéœ€è¦ç¼–è¾‘æ”¹åŠ¨ï¼Œä¹Ÿåªå‚¨å­˜æ”¹åŠ¨æ•°æ®ã€‚è€Œåœ¨Buildé˜¶æ®µåï¼Œè¿è¡Œæ—¶ï¼Œé…ç½®è¡¨Bå°†æœ‰åŸºäºAçš„å®Œæ•´é…ç½®æ•°æ®ã€‚</li>
<li>é…ç½®æ•°æ®çš„å¯¼å‡ºã€‚æœ‰äº†ä¸Šè¿°çš„é…ç½®è¡¨å…ƒæ•°æ®æè¿°è¿™å°±å¾ˆå¥½åŠäº†ï¼Œè¿è¡Œæ—¶è¦ç”¨csvï¼Œjsonï¼Œbinaryéƒ½å¯ä»¥ã€‚</li>
</ol>
<p>ä¸è¿‡è‡ªç„¶ï¼Œå¼€å‘è¿™äº›åŠŸèƒ½ä¹Ÿè¦ä¸å°‘å·¥ä½œé‡ï¼Œä¹Ÿä¸æ˜¯å¯ä»¥ä¸å’Œé¡¹ç›®ç»„æ²Ÿé€šä¸€ä¸ªäººé—·å¤´åšçš„ï¼Œæ‰€ä»¥ç›®å‰ä¹Ÿåªåœç•™åœ¨â€œæƒ³æƒ³è€Œå·²â€çš„é˜¶æ®µã€‚æˆ–è®¸æœªæ¥åœ¨ä¸€äº›åˆ«çš„é¡¹ç›®ç»„å¹²æ´»ä¼šå‘ç°ä»–ä»¬å·²ç»æœ‰ç°æˆçš„å·¥å…·äº†å‘¢ï¼ˆæˆ‘è§‰å¾—æ˜¯åº”è¯¥è¦æœ‰çš„ï¼‰ã€‚</p>
<p>é‚£ä¹ˆè¿™ç¯‡æ–‡ç« ä¹Ÿå°±åˆ°æ­¤å‘Šä¸€æ®µè½å•¦ï¼Œå¸Œæœ›æˆ‘ä»¬ä¸ä¹…åè¿˜ä¼šå†è§ï¼</p>
<p>2024æ–°å¹´å¿«ä¹ï¼</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>å·¥å…·</category>
      </categories>
      <tags>
        <tag>æ¸¸æˆå¼€å‘å·¥å…·</tag>
      </tags>
  </entry>
  <entry>
    <title>Godotå¼•æ“è´¡çŒ®æœ€ä½³å®è·µ</title>
    <url>/p/13902132f155/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><p>ç¿»è¯‘è‡ªGodotå¼•æ“è´¡çŒ®æŒ‡å—ï¼ŒåŸæ–‡ï¼š<a
href="https://docs.godotengine.org/en/latest/contributing/development/best_practices_for_engine_contributors.html">best_practices_for_engine_contributors</a></p>
<h2 id="é—®é¢˜æ€»è¦æ”¾åœ¨ç¬¬ä¸€ä½">#1 é—®é¢˜æ€»è¦æ”¾åœ¨ç¬¬ä¸€ä½</h2>
<p>è®¸å¤šä»£ç è´¡çŒ®è€…éå¸¸çš„æœ‰åˆ›é€ åŠ›ï¼Œä»–ä»¬äº«å—è®¾è®¡æŠ½è±¡æ•°æ®ç»“æ„ï¼Œæ­å»ºä¼˜ç§€çš„äº¤äº’ç•Œé¢çš„è¿‡ç¨‹ï¼Œåˆæˆ–è®¸ä»–ä»¬åªæ˜¯å•çº¯åœ°çƒ­çˆ±ç¼–ç¨‹ã€‚ä»£ç è´¡çŒ®è€…ä»¬æ€»æ˜¯æœ‰ä¸€äº›å¾ˆé…·çš„æƒ³æ³•ï¼Œä½†è¿™äº›æƒ³æ³•æˆ–è®¸èƒ½ã€æˆ–è®¸ä¸èƒ½è§£å†³çœŸå®çš„é—®é¢˜ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/06/29/w19dxybmLja7ZMB.png" title="best_practices1" class="gallery-item"><img src="https://s2.loli.net/2023/06/29/w19dxybmLja7ZMB.png"
alt="best_practices1" /></a>
<figcaption aria-hidden="true">best_practices1</figcaption>
</figure>
<p>è¿™å°±è¢«ç§°ä¸º<em>å¯»æ‰¾é—®é¢˜çš„è§£å†³æ–¹æ¡ˆ</em>ã€‚åœ¨ç†æƒ³çš„ä¸–ç•Œï¼Œå®ƒä»¬ä¹Ÿè®¸å¹¶ä¸æœ‰å®³ï¼Œä½†åœ¨ç°å®ä¸–ç•Œä¸­ï¼Œä»£ç æ˜¯éœ€è¦æ—¶é—´å»å®Œæˆçš„ï¼Œå®ƒä»¬å ç”¨ç©ºé—´ï¼Œè€Œä¸”ä¸€ç»å­˜åœ¨å°±éœ€è¦æ—¶é—´å»ç»´æŠ¤ã€‚é¿å…ä¸€åˆ‡ä¸å¿…è¦çš„äº‹ç‰©ï¼Œåœ¨è½¯ä»¶å¼€å‘ä¸­ä¸€ç›´è¢«è§†ä½œä¸€ç§å¥½çš„å®è·µæ–¹å¼ã€‚</p>
<span id="more"></span>
<h2 id="é—®é¢˜è¦å…ˆå­˜åœ¨æ‰èƒ½è¢«è§£å†³">#2 é—®é¢˜è¦å…ˆå­˜åœ¨ï¼Œæ‰èƒ½è¢«è§£å†³</h2>
<p>å…³è”æ–‡ç« ï¼š<a
href="https://cerebralab.com/Imaginary_Problems_Are_the_Root_of_Bad_Software?utm_source=hackernewsletter&amp;utm_medium=email&amp;utm_term=fav">Imaginary
Problems Are the Root of Bad Software</a></p>
<p>è¿™æ˜¯å‰ä¸€ç§å®è·µæ–¹å¼çš„å˜ä½“ã€‚æ·»åŠ ä¸€åˆ‡ä¸å¿…è¦çš„äº‹ç‰©ä¸æ˜¯ä¸€ä¸ªå¥½ä¸»æ„ï¼Œä½†æ€ä¹ˆå†³å®šä»€ä¹ˆæ˜¯â€œå¿…è¦çš„â€ï¼Œä»€ä¹ˆåˆä¸æ˜¯å‘¢ï¼Ÿ</p>
<figure>
<a href="https://s2.loli.net/2023/06/29/6ZRbFksv27PajYV.png" title="best_practices2" class="gallery-item"><img src="https://s2.loli.net/2023/06/29/6ZRbFksv27PajYV.png"
alt="best_practices2" /></a>
<figcaption aria-hidden="true">best_practices2</figcaption>
</figure>
<p>ç­”æ¡ˆæ˜¯ï¼šé—®é¢˜è¦å…ˆå­˜åœ¨ï¼Œæ‰èƒ½è¢«è§£å†³ã€‚å®ƒä¸èƒ½æ˜¯ä¸€ç§å‡æƒ³ï¼Œæˆ–æ˜¯ä¸€ç§è®¤å®šã€‚ç”¨æˆ·ä¸€å®šæ˜¯åœ¨ä½¿ç”¨è¿™ä¸ªè½¯ä»¶ï¼Œæ¥åˆ›é€ ä¸€äº›ä»–ä»¬éœ€è¦çš„ä¸œè¥¿ã€‚åœ¨æ­¤è¿‡ç¨‹ä¸­ï¼Œç”¨æˆ·å¯èƒ½éœ€è¦è§£å†³ä¸€ä¸ªé—®é¢˜æ‰èƒ½ç»§ç»­æ¨è¿›å·¥ä½œï¼Œæˆ–è¾¾åˆ°æ›´é«˜çš„äº§å‡ºã€‚åœ¨è¿™ä¸ªæƒ…å¢ƒä¸‹ï¼Œ<em>ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå°±æ˜¯å¿…é¡»çš„äº†</em>ã€‚</p>
<p>â€œä¸€äº›é—®é¢˜å¯èƒ½åœ¨æœªæ¥å‘ç”Ÿï¼Œè½¯ä»¶å¿…é¡»è¦åœ¨é—®é¢˜å‘ç”Ÿå‰åšå¥½å‡†å¤‡â€ï¼Œè¿™ç§æƒ³æ³•è¢«ç§°ä¸ºâ€œé¢å‘æœªæ¥â€ï¼Œä»¥ä¸‹å°±æ˜¯ä¸€äº›å¾ˆæœ‰è±¡å¾æ€§çš„æƒ³æ³•ï¼š</p>
<ul>
<li>æˆ‘è®¤ä¸ºè¿™ä¸ªæ–¹æ¡ˆä¼šå¯¹ç”¨æˆ·å¾ˆæœ‰å¸®åŠ©...</li>
<li>æˆ‘è®¤ä¸ºç”¨æˆ·æœ€ç»ˆä¼šéœ€è¦ä¸€ä¸ª...</li>
</ul>
<p>è¿™è¢«æ™®éåœ°è®¤ä¸ºæ˜¯ä¸€ä¸ªä¸å¥½çš„ä¹ æƒ¯ï¼Œå› ä¸ºè¯•å›¾è§£å†³ä¸€ä¸ªå½“ä¸‹ä¸å­˜åœ¨çš„é—®é¢˜ï¼Œå¾€å¾€ä¼šäº§å‡ºä¸€äº›ä»æœªè¢«ä½¿ç”¨çš„ä»£ç ï¼Œæˆ–è€…æ˜¯ä¸€äº›æ¯”å®é™…éœ€è¦æ›´å¤æ‚ã€æ›´éš¾ç»´æŠ¤çš„ä»£ç ã€‚</p>
<h2 id="é—®é¢˜éœ€è¦æ˜¯å¤æ‚æˆ–é¢‘ç¹çš„">#3 é—®é¢˜éœ€è¦æ˜¯å¤æ‚æˆ–é¢‘ç¹çš„</h2>
<p>è½¯ä»¶çš„å­˜åœ¨æ˜¯ä¸ºäº†è§£å†³é—®é¢˜ï¼Œä½†æ˜¯æˆ‘ä»¬ä¸èƒ½æŒ‡æœ›è§£å†³æ‰€æœ‰é—®é¢˜ã€‚ä½œä¸ºä¸€ä¸ªæ¸¸æˆå¼•æ“ï¼ŒGodotä¼šå¸®åŠ©ä½ è®©æ¸¸æˆæ›´å¥½æ›´å¿«ï¼Œä½†æ˜¯å®ƒä¸èƒ½å¸®ä½ æŠŠæ•´ä¸ªæ¸¸æˆåšå®Œã€‚åœ¨è¿™é‡Œï¼Œå¿…é¡»è¦åˆ’æ¸…ç•Œé™ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/07/03/jTdZQzW7pyNG65c.png" title="best_practices3" class="gallery-item"><img src="https://s2.loli.net/2023/07/03/jTdZQzW7pyNG65c.png"
alt="best_practices3" /></a>
<figcaption aria-hidden="true">best_practices3</figcaption>
</figure>
<p>é—®é¢˜æ˜¯å¦å€¼å¾—è§£å†³å–å†³äºè§£å†³é—®é¢˜æ‰€éœ€è¦çš„ä»˜å‡ºã€‚éœ€è¦çš„ä»˜å‡ºå–å†³äºï¼š</p>
<ul>
<li>é—®é¢˜çš„å¤æ‚åº¦</li>
<li>é—®é¢˜çš„å‘ç”Ÿé¢‘ç‡</li>
</ul>
<p>å¦‚æœè§£å†³é—®é¢˜å¯¹ç”¨æˆ·æ¥è¯´è¿‡äºå¤æ‚ï¼Œè½¯ä»¶åº”è¯¥ä¸ºè¿™ä¸ªé—®é¢˜æä¾›ä¸€ä¸ªå®Œå–„çš„è§£å†³æ–¹æ¡ˆã€‚åŒæ ·çš„ï¼Œå¦‚æœä¸€ä¸ªé—®é¢˜å¯¹ç”¨æˆ·æ¥è¯´å¾ˆå®¹æ˜“è§£å†³ï¼Œæä¾›ä¸€ä¸ªè§£å†³æ–¹æ¡ˆå°±æ˜¾å¾—æ²¡æœ‰å¿…è¦äº†ã€‚</p>
<p>ä¸€ä¸ªä¾‹å¤–æ˜¯ï¼Œå¦‚æœç”¨æˆ·é¢‘ç¹åœ°é‡åˆ°ç›¸åŒçš„é—®é¢˜ï¼Œæ¯æ¬¡éƒ½éœ€è¦è‡ªå·±æ¥è§£å†³å°±ä¼šå½¢æˆå›°æ‰°ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè½¯ä»¶åº”è¯¥æä¾›ä¸€ç§è§£å†³æ–¹æ¡ˆæ¥ç®€åŒ–ç”¨ä¾‹ã€‚</p>
<p>ä¸€èˆ¬æ¥è¯´åˆ¤æ–­ä¸€ä¸ªé—®é¢˜æ˜¯å¦å¤æ‚æˆ–é¢‘ç¹æ˜¯å¾ˆå®¹æ˜“çš„ï¼Œä½†æœ‰æ—¶ä¹Ÿå¯èƒ½å¾ˆå›°éš¾ã€‚è¿™å°±æ˜¯ä¸ºä»€ä¹ˆï¼ˆåœ¨ä¸‹ä¸€ç‚¹ï¼‰æˆ‘ä»¬ä¼šæ¨èä¸å…¶ä»–å¼€å‘è€…è¿›è¡Œè®¨è®ºã€‚</p>
<h2 id="é—®é¢˜éœ€è¦ä¸ä»–äººä¸€èµ·è®¨è®º">#4 é—®é¢˜éœ€è¦ä¸ä»–äººä¸€èµ·è®¨è®º</h2>
<p>é€šå¸¸ï¼Œå½“ç”¨æˆ·é‡åˆ°é—®é¢˜æ—¶ï¼Œä»–ä»¬å¾€å¾€æ²‰æµ¸åœ¨è‡ªå·±çš„é¡¹ç›®ä¸­ã€‚è¿™äº›ç”¨æˆ·ä¼šå¾ˆè‡ªç„¶åœ°ä»ä»–ä»¬çš„è§’åº¦æ¥è§£å†³é—®é¢˜ï¼Œåªè€ƒè™‘ä»–ä»¬è‡ªå·±çš„ç”¨ä¾‹ã€‚å› æ­¤ï¼Œç”¨æˆ·æå‡ºçš„è§£å†³æ–¹æ¡ˆå¹¶ä¸æ€»æ˜¯è€ƒè™‘æ‰€æœ‰çš„ç”¨ä¾‹ï¼Œå¾€å¾€åå‘äºç”¨æˆ·è‡ªèº«çš„éœ€æ±‚ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/07/03/Y4ZSJTuplaRBjL2.png" title="best_practices4" class="gallery-item"><img src="https://s2.loli.net/2023/07/03/Y4ZSJTuplaRBjL2.png"
alt="best_practices4" /></a>
<figcaption aria-hidden="true">best_practices4</figcaption>
</figure>
<p>å¼€å‘è€…çš„è§’åº¦åˆä¸ä¸€æ ·äº†ã€‚ä»–ä»¬å¯èƒ½ä¼šç”¨æˆ·çš„é—®é¢˜è¿‡äºç‹¬ç‰¹ï¼Œä»¥è‡³äºæ— æ³•ç»™å‡ºä¸€ä¸ªåˆé€‚çš„è§£å†³æ–¹æ¡ˆï¼Œæˆ–è€…ä»–ä»¬å¯èƒ½ä¼šæ¨èä¸€ä¸ªèƒ½è§£å†³å¹¿æ³›é—®é¢˜çš„è§£å†³æ–¹æ¡ˆï¼ˆæ›´ç®€å•çš„ï¼Œæˆ–è€…æ›´ä½å±‚æ¬¡çš„APIï¼‰æ¥è§£å†³éƒ¨åˆ†é—®é¢˜ï¼Œè€Œå°†å‰©ä¸‹çš„éƒ¨åˆ†ç•™ç»™ç”¨æˆ·ã€‚</p>
<p>æ— è®ºå¦‚ä½•ï¼Œåœ¨å°è¯•åšå‡ºè´¡çŒ®ä¹‹å‰ï¼Œä¸å…¶ä»–å¼€å‘è€…æˆ–è€…è´¡çŒ®è€…è®¨è®ºå®é™…é—®é¢˜æ˜¯éå¸¸é‡è¦çš„ï¼Œè¿™æ ·å¯ä»¥åœ¨å®ç°ä¸Šè¾¾æˆæ›´å¥½çš„ä¸€è‡´ã€‚</p>
<p>å”¯ä¸€çš„ä¾‹å¤–å½“ä¸€å—ä»£ç æœ‰ä¸€ä½æ˜ç¡®å•†å®šçš„è´Ÿè´£äººï¼Œä»–ç›´æ¥ä¸ç”¨æˆ·å¯¹è¯ï¼Œå¹¶ä¸”æœ‰ç€èƒ½å¤Ÿç›´æ¥å®ç°è§£å†³æ–¹æ¡ˆçš„ä¸°å¯ŒçŸ¥è¯†ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ï¼ŒGodotçš„è®¾è®¡ç†å¿µæ˜¯åå¥½æ˜“ç”¨ä¸å¯ç»´æŠ¤æ€§ï¼Œè€Œä¸æ˜¯æ€§èƒ½ã€‚æ€§èƒ½ä¼˜åŒ–ä¹Ÿä¼šè¢«çº³å…¥è€ƒé‡ï¼Œä½†è‹¥å®ƒä»¬è®©äº‹æƒ…å˜å¾—è¿‡äºå¤æ‚ï¼Œæˆ–è€…ç»™ä»£ç åº“æ·»åŠ äº†å¤ªå¤šå¤æ‚åº¦ï¼Œå®ƒä»¬æ˜¯ä¸ä¼šè¢«å…è®¸çš„ã€‚</p>
<h2 id="ç»™æ¯ä¸ªé—®é¢˜å±äºå®ƒè‡ªå·±çš„è§£å†³æ–¹æ¡ˆ">#5
ç»™æ¯ä¸ªé—®é¢˜å±äºå®ƒè‡ªå·±çš„è§£å†³æ–¹æ¡ˆ</h2>
<p>å¯¹ç¨‹åºå‘˜æ¥è¯´ï¼Œå¯»æ‰¾è§£å†³é—®é¢˜çš„æœ€ä¼˜è§£å†³æ–¹æ¡ˆä¸€ç›´ä¸€ä¸ªäº«å—çš„æŒ‘æˆ˜ã€‚ä½†æ˜¯ä¹Ÿå¾ˆå®¹æ˜“åšè¿‡å¤´ã€‚æœ‰äº›æ—¶å€™ï¼Œè´¡çŒ®è€…ä¼šè¯•å›¾æå‡ºèƒ½è§£å†³å°½å¯èƒ½å¤šé—®é¢˜çš„è§£å†³æ–¹æ¡ˆã€‚</p>
<p>å½“ç¨‹åºå‘˜è¯•å›¾è®©è§£å†³æ–¹æ¡ˆçœ‹èµ·æ¥æ›´å·§å¦™çµæ´»ï¼Œçº¯ç²¹åŸºäºå‡å®šæ¨æµ‹çš„é—®é¢˜ä¹Ÿç²‰å¢¨ç™»åœºï¼ˆå¦‚#2ä¸­æè¿°çš„ï¼‰ï¼Œæƒ…å†µå¾€å¾€æ€¥è½¬ç›´ä¸‹ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/07/08/oPZMeT7CfkxbOzF.webp" title="best_practices5" class="gallery-item"><img src="https://s2.loli.net/2023/07/08/oPZMeT7CfkxbOzF.webp"
alt="best_practices5" /></a>
<figcaption aria-hidden="true">best_practices5</figcaption>
</figure>
<p>æœ€ä¸»è¦çš„é—®é¢˜åœ¨äºï¼Œç°å®ç”Ÿæ´»ä¸­è¿™æ ·ä¸€èˆ¬æ˜¯è¡Œä¸é€šçš„ã€‚æœ‰æ—¶å€™ï¼Œä¸ºæ¯ä¸ªé—®é¢˜æä¾›å®ƒè‡ªå·±çš„ç‹¬ç«‹çš„è§£å†³æ–¹æ¡ˆï¼Œå¾€å¾€èƒ½è¾¾åˆ°æ›´ç²¾ç®€ï¼Œæ›´å¯ç»´æŠ¤çš„ä»£ç ã€‚</p>
<p>æ›´è¿›ä¸€æ­¥åœ°è¯´ï¼Œç›®æ ‡äºè§£å†³ç‹¬ç«‹é—®é¢˜çš„è§£å†³æ–¹æ¡ˆå¯¹ç”¨æˆ·æ¥è¯´æ˜¯æ›´å¥½çš„ã€‚æœ‰ç¡®å®šç›®æ ‡çš„è§£å†³æ–¹æ¡ˆèƒ½å¤Ÿè®©ç”¨æˆ·æ‰¾åˆ°ä»–ä»¬ç¡®åˆ‡éœ€è¦çš„ä¸œè¥¿ï¼Œè€Œä¸éœ€è¦ä¸ºäº†ç®€å•çš„ä»»åŠ¡å»å­¦ä¹ ä¸€ç³»åˆ—å¤æ‚çš„ç³»ç»Ÿã€‚</p>
<p>å¤§è€Œå¤æ‚çš„è§£å†³æ–¹æ¡ˆè¿˜æœ‰ä¸€ä¸ªç¼ºç‚¹åœ¨äºï¼Œéšç€æ—¶é—´æ¨ç§»ï¼Œå®ƒä»¬ä»ç„¶æ— æ³•è¦†ç›–æ‰€æœ‰ç”¨æˆ·çš„éœ€æ±‚ã€‚ç”¨æˆ·ä¼šæå‡ºæ›´å¤šéœ€æ±‚ï¼Œæœ€ç»ˆå¤§å¤§å¢åŠ äº†APIå’Œä»£ç åº“çš„å¤æ‚åº¦ã€‚</p>
<h2 id="è¿åˆå¸¸è§ç”¨ä¾‹ä¹Ÿä¸ºç½•è§ç‰¹ä¾‹ç•™ä¸‹å¯èƒ½">#6
è¿åˆå¸¸è§ç”¨ä¾‹ï¼Œä¹Ÿä¸ºç½•è§ç‰¹ä¾‹ç•™ä¸‹å¯èƒ½</h2>
<p>è¿™æ˜¯å‰ä¸€éƒ¨åˆ†çš„å»¶ç»­ï¼Œè¿›ä¸€æ­¥å±•å¼€è¯´æ˜äº†è¿™ç§ä¸ºä»€ä¹ˆå€¾å‘äºè¿™æ ·æ€è€ƒå’Œè®¾è®¡è½¯ä»¶çš„å½¢å¼ã€‚</p>
<p>åœ¨å…ˆå‰ä¹Ÿæåˆ°è¿‡äº†ï¼ˆ#2ï¼‰ï¼Œå¯¹æˆ‘ä»¬æ¥è¯´ï¼ˆä½œä¸ºè®¾è®¡è½¯ä»¶è€…ï¼‰å‡†ç¡®åœ°ç†è§£æ‰€æœ‰æœªæ¥ç”¨æˆ·çš„éœ€æ±‚æ˜¯éå¸¸å›°éš¾çš„ã€‚è¯•å›¾ä¸€æ¬¡æ€§åœ°å®Œæˆä¸€ä¸ªèƒ½å¤Ÿè¿åˆä¼—å¤šç”¨ä¾‹çš„ç»“æ„çµæ´»è§£å†³æ–¹æ¡ˆï¼Œå¾€å¾€æ˜¯ä¸€ä¸ªé”™è¯¯ã€‚</p>
<p>æˆ‘ä»¬å¯èƒ½ä¼šæå‡ºä¸€äº›æˆ‘ä»¬è®¤ä¸ºå¾ˆä¼˜ç§€çš„è§£å†³æ–¹æ¡ˆï¼Œä½†éšåå°±å‘ç°ç”¨æˆ·ç”šè‡³è¿å…¶ä¸­ä¸€èˆ¬çš„åŠŸèƒ½éƒ½ä¸ä¼šç”¨åˆ°ï¼Œæˆ–è€…ä»–ä»¬éœ€æ±‚çš„åŠŸèƒ½å¹¶ä¸èƒ½å¾ˆå¥½åœ°èå…¥åˆ°æˆ‘ä»¬çš„åˆå§‹è®¾è®¡ä¸­ã€‚è¿™å°±å¯¼è‡´æˆ‘ä»¬å¿…é¡»æ‰”æ‰æ•´å¥—è§£å†³æ–¹æ¡ˆï¼Œæˆ–è€…è®©å®ƒå˜å¾—æ›´åŠ å¤æ‚ã€‚</p>
<p>é—®é¢˜åœ¨äºï¼Œæˆ‘ä»¬è¦å¦‚ä½•å»è®¾è®¡è½¯ä»¶ï¼Œæ‰èƒ½åŒæ—¶æ»¡è¶³å½“ä¸‹å·²çŸ¥çš„ç”¨æˆ·éœ€æ±‚ï¼Œä»¥åŠæœªæ¥æœªçŸ¥çš„ç”¨æˆ·éœ€æ±‚ï¼Ÿ</p>
<figure>
<a href="https://s2.loli.net/2023/07/08/FPaQHnVb5CAtfqW.webp" title="best_practices6" class="gallery-item"><img src="https://s2.loli.net/2023/07/08/FPaQHnVb5CAtfqW.webp"
alt="best_practices6" /></a>
<figcaption aria-hidden="true">best_practices6</figcaption>
</figure>
<p>ç­”æ¡ˆå³ä¸ºï¼Œä¸ºäº†ä¿è¯èƒ½å¤Ÿæ»¡è¶³ç”¨æˆ·çš„éœ€æ±‚ï¼Œæˆ‘ä»¬éœ€è¦ä¸ºä»–ä»¬æä¾›å¯ç”¨çš„åº•å±‚APIï¼Œå°½ç®¡å¯¹äºä»–ä»¬æ¥è¯´å¯èƒ½éœ€è¦é‡æ–°å®ç°ä¸€äº›å·²ç»å­˜åœ¨çš„é€»è¾‘ã€‚</p>
<p>åœ¨ç°å®ç”Ÿæ´»ä¸­ï¼Œè¿™äº›ç”¨ä¾‹æ— è®ºå¦‚ä½•éƒ½æ˜¯éå¸¸ç½•è§çš„ï¼Œæ‰€ä»¥è®©ç”¨æˆ·å»å®ç°ä¸€ä¸ªå®¢åˆ¶åŒ–çš„è§£å†³æ–¹æ¡ˆæ˜¯æœ‰é“ç†çš„ã€‚æ‰€ä»¥ä»ç„¶å°†åŸºç¡€çš„æ„å»ºå—æä¾›ç»™ç”¨æˆ·ï¼Œè¿™ä¸€ç‚¹æ˜¯å¾ˆé‡è¦çš„ã€‚</p>
<h2 id="å€¾å‘äºæœ¬åœ°è§£å†³æ–¹æ¡ˆ">#7 å€¾å‘äºæœ¬åœ°è§£å†³æ–¹æ¡ˆ</h2>
<p>åœ¨æˆ‘ä¹ˆä»¬ä¸ºé—®é¢˜å¯»æ±‚ä¸€ä¸ªè§£å†³æ–¹æ¡ˆæ—¶ï¼Œå¯èƒ½æ˜¯å®ç°æ–°åŠŸèƒ½æˆ–è€…ä¿®å¤ä¸€ä¸ªbugï¼Œå¾ˆå¤šæ—¶å€™æœ€ç®€å•çš„æ–¹æ³•å°±æ˜¯å¾€æ ¸å¿ƒå±‚ä»£ç ä¸­æ·»åŠ æ•°æ®æˆ–è€…ä¸€ä¸ªæ–°çš„å‡½æ•°ã€‚</p>
<p>è¿™é‡Œæœ€ä¸»è¦çš„é—®é¢˜åœ¨äºï¼Œå¾€æ ¸å¿ƒå±‚ä¸­æ·»åŠ ä¸€äº›åªä¼šåœ¨å¾ˆè¿œåœ°æ–¹ï¼ˆå¾ˆä¸Šå±‚ï¼‰ä½¿ç”¨çš„ä»£ç ï¼Œä¸æ­¢ä¼šè®©ä»£ç æ›´éš¾è¯»æ‡‚ï¼Œè¿˜ä¼šè®©æ ¸å¿ƒAPIæ›´å¤§æ›´å¤æ‚ï¼ŒåŒæ ·æ›´éš¾ç†è§£ã€‚</p>
<p>è¿™æ˜¯å¾ˆç³Ÿç³•çš„ï¼Œå› ä¸ºæ ¸å¿ƒAPIçš„å¯è¯»æ€§å’Œæ¸…æ™°åº¦ä¸€ç›´æ˜¯è‡³å…³é‡è¦çš„ï¼Œæœ‰å¤§é‡çš„ä»£ç éƒ½å»ºç«‹åœ¨å®ƒä¹‹ä¸Šï¼ŒåŒæ—¶å®ƒä¹Ÿæ˜¯æ–°è¿›ä»£ç è´¡çŒ®è€…å­¦ä¹ ä»£ç åº“çš„èµ·ç‚¹ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/07/08/qgaOD3Mh9SWJtbG.webp" title="best_practices7" class="gallery-item"><img src="https://s2.loli.net/2023/07/08/qgaOD3Mh9SWJtbG.webp"
alt="best_practices7" /></a>
<figcaption aria-hidden="true">best_practices7</figcaption>
</figure>
<p>æƒ³è¦è¿™æ ·åšçš„ä¸€ä¸ªå¸¸è§ç†ç”±æ˜¯ï¼Œé€šå¸¸ç®€å•åœ°å¾€æ ¸å¿ƒå±‚åŠ ä¸€ä¸ªhackï¼Œä»£ç æ”¹åŠ¨é‡ä¼šæ¯”è¾ƒå°ã€‚</p>
<p>è¿™æ ·åšæ˜¯ä¸è¢«æ¨èçš„ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œè§£å†³æ–¹æ¡ˆçš„çš„ä»£ç åº”è¯¥ç¦»å‘ç”Ÿé—®é¢˜çš„ä»£ç å°½å¯èƒ½çš„è¿‘ï¼Œå°½ç®¡å¯èƒ½éœ€è¦é¢å¤–çš„ï¼Œé‡å¤çš„ï¼Œæ›´åŠ å¤æ‚æˆ–è€…æ›´ä½æ•ˆçš„ä»£ç ã€‚å¯èƒ½éœ€è¦ä¸€äº›é¢å¤–çš„åˆ›é€ æ€§ï¼Œä½†è¿™ä¸€ç›´æ˜¯æˆ‘ä»¬æ¨å´‡çš„åšæ³•ã€‚</p>
<h2 id="ä¸è¦ä¸ºç®€å•çš„é—®é¢˜ä½¿ç”¨å¤æ‚çš„ç½è£…æ–¹æ¡ˆcanned-solution">#8
ä¸è¦ä¸ºç®€å•çš„é—®é¢˜ä½¿ç”¨å¤æ‚çš„ç½è£…æ–¹æ¡ˆï¼ˆcanned solutionï¼‰</h2>
<p>ä¸æ˜¯æ¯ä¸ªé—®é¢˜éƒ½æœ‰ç®€å•çš„è§£å†³æ–¹æ¡ˆï¼Œå¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ­£ç¡®çš„é€‰æ‹©æ˜¯ä½¿ç”¨ä¸€ä¸ªç¬¬ä¸‰æ–¹åº“æ¥è§£å†³é—®é¢˜ã€‚</p>
<p>å› ä¸ºGodotéœ€è¦ç§»æ¤åˆ°å¾ˆå¤šç¡¬ä»¶å¹³å°ä¸Šï¼Œæˆ‘ä»¬ä¸èƒ½åŠ¨æ€åœ°é“¾æ¥åº“ã€‚æˆ‘ä»¬å¿…é¡»æŠŠè¿™äº›åº“é™æ€é“¾æ¥ï¼Œæ‰“åŒ…è¿›æºç ä¸­ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/07/08/udXT5Y3yF9cLr7R.webp" title="best_practices8" class="gallery-item"><img src="https://s2.loli.net/2023/07/08/udXT5Y3yF9cLr7R.webp"
alt="best_practices8" /></a>
<figcaption aria-hidden="true">best_practices8</figcaption>
</figure>
<p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯¹äºæ¥å…¥åœ°ç¬¬ä¸‰æ–¹åº“éå¸¸æŒ‘å‰”ï¼Œæˆ‘ä»¬å€¾å‘äºæ›´å°çš„åº“ï¼ˆä»…å¤´æ–‡ä»¶çš„åº“æ˜¯æˆ‘ä»¬çš„æœ€çˆ±ï¼‰ã€‚åªæœ‰å½“åˆ«æ— é€‰æ‹©çš„æ—¶å€™ï¼Œæˆ‘ä»¬æ‰ä¼šå°†å¤§çš„åº“æ‰“åŒ…è¿›æ¥ã€‚</p>
<p>åº“å¿…é¡»ä½¿ç”¨è¶³å¤Ÿå®½æ¾çš„è®¸å¯è¯æ‰èƒ½è¢«åŒ…å«åˆ° Godot ä¸­ã€‚ å¯æ¥å—çš„è®¸å¯è¯åŒ…æ‹¬
Apache 2.0ã€BSDã€MITã€ISC å’Œ MPL 2.0ã€‚ ç‰¹åˆ«çš„æ˜¯ï¼Œæˆ‘ä»¬ä¸èƒ½æ¥å—æ ¹æ® GPL æˆ–
LGPL
è®¸å¯çš„åº“ï¼Œå› ä¸ºè¿™äº›è®¸å¯è¯å®é™…ä¸Šç¦æ­¢ä¸“æœ‰è½¯ä»¶ä¸­çš„é™æ€é“¾æ¥ï¼ˆGodotå¤§å¤šæ•°å¯¼å‡ºé¡¹ç›®ä¸­éƒ½éœ€è¦æ˜¯é™æ€é“¾æ¥çš„ï¼‰ã€‚
è¿™ä¸ªè¦æ±‚ä¹Ÿé€‚ç”¨äºç¼–è¾‘å™¨ï¼Œå› ä¸ºæˆ‘ä»¬å¯èƒ½å¸Œæœ›é•¿æœŸåœ¨ iOS ä¸Šè¿è¡Œå®ƒã€‚ ç”±äº iOS
ä¸æ”¯æŒåŠ¨æ€é“¾æ¥ï¼Œå› æ­¤é™æ€é“¾æ¥æ˜¯è¯¥å¹³å°ä¸Šçš„å”¯ä¸€é€‰æ‹©ã€‚</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è½¯ä»¶å·¥ç¨‹</category>
        <category>è½¯ä»¶è®¾è®¡åŸåˆ™</category>
      </categories>
      <tags>
        <tag>Godot</tag>
        <tag>è½¯ä»¶è®¾è®¡åŸåˆ™</tag>
        <tag>ä»£ç è§„èŒƒ</tag>
      </tags>
  </entry>
  <entry>
    <title>Unity IL2CPP ç¼–ç é™åˆ¶</title>
    <url>/p/24d663e5b3a4/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h2 id="å‚è€ƒ">å‚è€ƒ</h2>
<ol type="1">
<li><a
href="https://docs.unity3d.com/2018.4/Documentation/Manual/ScriptingRestrictions.html">unity
documentation-Scripting restrictions 2018.4</a></li>
<li><a
href="https://docs.unity3d.com/2022.3/Documentation/Manual/ScriptingRestrictions.html">unity
documentations-Scripting restrictions 2022.3</a></li>
</ol>
<p>å†…å®¹ç›¸å·®ä¸å¤§ï¼Œ2022.3åœ¨2018.4çš„åŸºç¡€ä¸Šåšäº†ä¸€äº›è¡¥å……ï¼Œå¹¶å»é™¤äº†ä¸€ä¸ªå…³äºæ³›å‹è™šæ–¹æ³•ä¾‹å­ã€‚</p>
<h2 id="ahead-of-timeç¼–è¯‘aot">Ahead-of-timeç¼–è¯‘ï¼ˆAOTï¼‰</h2>
<p>ä¸€äº›å¹³å°ä¸å…è®¸è¿è¡Œæ—¶çš„ä»£ç ç”Ÿæˆï¼ˆè¿è¡Œæ—¶å¼€è¾Ÿå†…å­˜ç”¨äºå­˜æ”¾å¯æ‰§è¡Œçš„æœºå™¨æŒ‡ä»¤ï¼‰ã€‚å› æ­¤ï¼Œä¸€åˆ‡ä¾èµ–äºjust-in-timeï¼ˆJITï¼‰çš„æ‰˜ç®¡ä»£ç ï¼ˆmanaged
codeï¼‰åœ¨è¿™äº›å¹³å°ä¸Šéƒ½æ— æ³•è¿è¡Œã€‚ä¸ºæ­¤ï¼Œä½ éœ€è¦æŠŠæ‰€æœ‰çš„æ‰˜ç®¡ä»£ç éƒ½è¿›è¡ŒAOTç¼–è¯‘ã€‚åœ¨ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œè¿™ä¸ªé™åˆ¶ä¸ä¼šå¸¦æ¥ä»€ä¹ˆå½±å“ã€‚ä½†åœ¨AOTç¼–è¯‘çš„å¹³å°ä¸Šï¼Œä¹Ÿå­˜åœ¨ç€ä¸€äº›éœ€è¦é¢å¤–æ³¨æ„çš„è¦ç‚¹ã€‚</p>
<span id="more"></span>
<h3 id="è‡ªçœåå°„-reflection">è‡ªçœ/åå°„ Reflection</h3>
<p>åœ¨AOTå¹³å°ï¼Œåå°„ä»ç„¶æ˜¯æ”¯æŒçš„ã€‚ä½†å¦‚æœç¼–è¯‘å™¨ä¸èƒ½å¤Ÿæ¨æ–­å‡ºä¸€æ®µä»£ç ä¼šè¢«åå°„æ‰§è¡Œï¼Œé‚£ä¹ˆè¿™æ®µä»£ç åœ¨è¿è¡Œæ—¶å¯èƒ½å°±ä¸ä¼šå­˜åœ¨ï¼Œæ›´å¤šå†…å®¹å¯ä»¥å‚è€ƒ<a
href="https://docs.unity3d.com/2022.3/Documentation/Manual/ManagedCodeStripping.html">Managed
Code Stripping</a>ä¸€æ–‡ã€‚</p>
<h3 id="system.reflection.emit">System.Reflection.Emit</h3>
<p>åœ¨AOTçš„å¹³å°ä¸Šæ— æ³•å®ç°ä»»ä½•åœ¨<code>System.Reflection.Emit</code>å‘½åç©ºé—´ä¸‹çš„æ–¹æ³•ã€‚å…¶ä½™<code>System.Reflection</code>å‘½åç©ºé—´ä¸‹çš„å†…å®¹éƒ½å¯ä»¥æ­£å¸¸æ‰§è¡Œï¼Œåªè¦å¦‚ä¸Šæ‰€è¯´ï¼Œç¼–è¯‘å™¨èƒ½å¤Ÿæ¨æ–­å‡ºè¿™æ®µä»£ç ä¼šè¢«é€šè¿‡åå°„æ‰§è¡Œã€‚</p>
<h3 id="åºåˆ—åŒ–">åºåˆ—åŒ–</h3>
<p>AOTå¹³å°å¦‚æœåœ¨åºåˆ—åŒ–æˆ–è€…ååºåˆ—åŒ–çš„è¿‡ç¨‹ä½¿ç”¨äº†åå°„ï¼Œé‚£ä¹ˆæœ‰å¯èƒ½ä¼šé‡åˆ°é—®é¢˜ã€‚å¦‚æœä¸€ä¸ªç±»å‹æˆ–è€…æ–¹æ³•åªåœ¨åºåˆ—åŒ–æˆ–è€…ååºåˆ—åŒ–çš„è¿‡ç¨‹ä¸­é€šè¿‡åå°„è¢«è·å–åˆ°ï¼Œé‚£ä¹ˆAOTç¼–è¯‘å™¨å°±æ— æ³•æ¨æ–­å‡ºéœ€è¦ä¸ºè¿™ä¸ªç±»å‹æˆ–è€…æ–¹æ³•ç”Ÿæˆç›¸åº”çš„ä»£ç ã€‚</p>
<h3 id="æ³›å‹ç±»å‹ä¸æ–¹æ³•">æ³›å‹ç±»å‹ä¸æ–¹æ³•</h3>
<p>å¯¹äºæ³›å‹ç±»å‹å’Œæ–¹æ³•ï¼Œç¼–è¯‘å™¨å¿…é¡»åˆ¤æ–­å‡ºé‚£äº›æ³›å‹å®ä¾‹è¢«ä½¿ç”¨äº†ï¼Œå› ä¸ºä¸åŒçš„æ³›å‹å®ä¾‹å¯èƒ½éœ€è¦ä¸åŒçš„ç”Ÿæˆä»£ç ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œ<code>List&lt;int&gt;</code>å’Œ<code>List&lt;double&gt;</code>æ‰€éœ€è¦çš„çš„ç”Ÿæˆä»£ç å°±æ˜¯ä¸åŒçš„ã€‚ä¸è¿‡ï¼Œç”±äºIL2CPPä¼šåœ¨å¼•ç”¨ç±»å‹é—´å…±ç”¨ä»£ç ï¼Œæ‰€ä»¥<code>List&lt;object&gt;</code>å’Œ<code>List&lt;string&gt;</code>å°±ä¼šå…±ç”¨ä¸€ä»½ç”Ÿæˆä»£ç ã€‚</p>
<p>åœ¨ä¸‹åˆ—çš„è¿™äº›æƒ…å†µä¸­ï¼ŒIL2CPPå¾ˆå¯èƒ½æ— æ³•åœ¨ç¼–è¯‘æœŸé—´ç”Ÿæˆæ‰€éœ€çš„ä»£ç ï¼š</p>
<ol type="1">
<li><p>è¿è¡Œæ—¶åˆ›å»ºæ³›å‹å®ä¾‹ï¼š<code>Activator.CreateInstance(typeof(SomeGenericType&lt;&gt;).MakeGenericType(someType));</code></p></li>
<li><p>é€šè¿‡æ³›å‹å®ä¾‹è°ƒç”¨ä¸€ä¸ªé™æ€æ–¹æ³•ï¼š<code>typeof(SomeGenericType&lt;&gt;).MakeGenericType(someType)).GetMethod(â€œAMethodâ€).Invoke(null,
null);</code></p></li>
<li><p>è°ƒç”¨ä¸€ä¸ªé™æ€çš„æ³›å‹æ–¹æ³•ï¼š<code>typeof(SomeType).GetMethod(â€œGenericMethodâ€).MakeGenericMethod(someType).Invoke(null,
null);</code></p></li>
<li><p>ä¸€äº›åœ¨ç¼–è¯‘æœŸé—´æ— æ³•è¢«æ¨æ–­å‡ºçš„å¯¹æ³›å‹è™šæ–¹æ³•çš„è°ƒç”¨ï¼Œåœ¨2018.4çš„æ–‡æ¡£ä¸­ç»™å‡ºäº†è¿™æ ·ä¸€ä¸ªä¾‹å­</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">using UnityEngine;
using System;

public class AOTProblemExample : MonoBehaviour, IReceiver
&#123;
    public enum AnyEnum 
    &#123;
        Zero,
        One,
    &#125;

    void Start() 
    &#123;
        &#x2F;&#x2F; Subtle trigger: The type of manager *must* be
        &#x2F;&#x2F; IManager, not Manager, to trigger the AOT problem.
        IManager manager &#x3D; new Manager();
        manager.SendMessage(this, AnyEnum.Zero);
    &#125;

    public void OnMessage&lt;T&gt;(T value) 
    &#123;
        Debug.LogFormat(&quot;Message value: &#123;0&#125;&quot;, value);
    &#125;
&#125;

public class Manager : IManager 
&#123;
    public void SendMessage&lt;T&gt;(IReceiver target, T value) &#123;
        target.OnMessage(value);
    &#125;
&#125;

public interface IReceiver
&#123;
    void OnMessage&lt;T&gt;(T value);
&#125;

public interface IManager 
&#123;
    void SendMessage&lt;T&gt;(IReceiver target, T value);
&#125;</code></pre>
<p>ä½ ä¼šå¾—åˆ°è¿™æ ·çš„æŠ¥é”™ï¼š</p>
<blockquote>
<p>ExecutionEngineException: Attempting to call method
'AOTProblemExample::OnMessage&lt;AOTProblemExample+AnyEnum&gt;' for
which no ahead of time (AOT) code was generated. at
Manager.SendMessage[T] (IReceiver target, .T value) [0x00000] in
&lt;filename unknown&gt;:0 at AOTProblemExample.Start () [0x00000] in
&lt;filename unknown&gt;:0</p>
</blockquote></li>
<li><p>æ¶‰åŠé«˜åº¦åµŒå¥—çš„æ³›å‹å€¼ç±»å‹æ–¹æ³•è°ƒç”¨ï¼Œå¦‚
<code>Struct&lt;Struct&lt;Struct&lt;...&lt;Struct&lt;int&gt;&gt;&gt;&gt;</code></p></li>
</ol>
<p>IL2CPPä¸ºäº†æ”¯æŒä¸Šè¿°è¿™äº›æƒ…å†µï¼Œç”Ÿæˆäº†èƒ½å¤Ÿæ”¯æŒä»»ä½•ç±»å‹å‚æ•°çš„æ³›å‹ä»£ç ã€‚ä¸è¿‡è¿™ä»½ä»£ç æ‰§è¡Œèµ·æ¥ä¼šæ›´æ…¢ï¼Œå› ä¸ºå®ƒä¸èƒ½å°±ç±»å‹çš„å¤§å°æˆ–è€…å€¼ç±»å‹ã€å¼•ç”¨ç±»å‹çš„å·®å¼‚æ¥åšå‡ºå‡è®¾ã€‚å¦‚æœä½ éœ€è¦ä¸€ä»½æ‰§è¡Œæ•ˆç‡æ›´é«˜çš„æ³›å‹ç”Ÿæˆä»£ç ï¼Œä½ éœ€è¦è¿™æ ·åšï¼š</p>
<ul>
<li><p>å¦‚æœæ³›å‹å‚æ•°æ°¸è¿œæ˜¯å¼•ç”¨ç±»å‹ï¼Œä¸ºå®ƒåŠ ä¸Š<code>where:class</code>çš„é™åˆ¶ã€‚è¿™æ ·IL2CPPå°±ä¼šç”Ÿæˆä¸€ä¸ªä½¿ç”¨å¼•ç”¨ç±»å‹çš„fallbackæ–¹æ³•ï¼Œå®ƒä¸ä¼šå¸¦æ¥é¢å¤–çš„æ€§èƒ½æŸè€—ã€‚</p></li>
<li><p>å¦‚æœæ³›å‹å‚æ•°æ°¸è¿œæ˜¯å€¼ç±»å‹ï¼ŒåŠ ä¸Š<code>where:struct</code>é™åˆ¶ï¼Œè¿™å°†å¯ç”¨ä¸€äº›ä¼˜åŒ–ç­–ç•¥ï¼Œä½†å› ä¸ºå€¼ç±»å‹çš„å¤§å°å¯èƒ½ä¸åŒï¼Œç”Ÿæˆçš„ä»£ç æ‰§è¡Œèµ·æ¥ä»ç„¶ä¼šæ›´æ…¢ä¸€äº›ã€‚</p></li>
<li><p>æ–°å¢ä¸€ä¸ª<code>UsedOnlyForAOTCodeGeneration</code>æ–¹æ³•ï¼Œå¹¶ä¸”ä¸ºä½ å¸Œæœ›IL2CPPç”Ÿæˆçš„æ³›å‹ç±»å‹ã€æ³›å‹æ–¹æ³•åŠ ä¸Šå¼•ç”¨ã€‚è¿™ä¸ªæ–¹æ³•ä¸éœ€è¦è¢«è°ƒç”¨ï¼Œä¹Ÿä¸åº”è¯¥è¢«è°ƒç”¨ã€‚ä¸‹è¿°çš„ä¾‹å­ä¿è¯äº†<code>GenericType&lt;MyStruct&gt;</code>ä¼šè¢«ç”Ÿæˆã€‚</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public void UsedOnlyForAOTCodeGeneration()
&#123;
    &#x2F;&#x2F; Ensure that IL2CPP will create code for MyGenericStruct
    &#x2F;&#x2F; using MyStruct as an argument.
    new GenericType&lt;MyStruct&gt;();

    &#x2F;&#x2F; Ensure that IL2CPP will create code for SomeType.GenericMethod
    &#x2F;&#x2F; using MyStruct as an argument.
    new SomeType().GenericMethod&lt;MyStruct&gt;();

    public void OnMessage&lt;T&gt;(T value) 
    &#123;
        Debug.LogFormat(&quot;Message value: &#123;0&#125;&quot;, value);
    &#125;

    &#x2F;&#x2F; Include an exception so we can be sure to know if this
    &#x2F;&#x2F; method is ever called.
    throw new InvalidOperationException(
        &quot;This method is used for AOT code generation only. &quot; +
        &quot;Do not call it at runtime.&quot;);
&#125;</code></pre></li>
</ul>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“â€œFaster(smaller)
buildsâ€è®¾ç½®é¡¹å¯ç”¨æ—¶ï¼Œåªæœ‰ä¸€ä»½å®Œå…¨å…±ç”¨çš„æ³›å‹ä»£ç ä¼šè¢«ç”Ÿæˆå¹¶ç¼–è¯‘ã€‚è¿™å›è¾ƒå°‘ç”Ÿæˆçš„æ–¹æ³•æ•°é‡ï¼Œå‡å°‘ç¼–è¯‘æ—¶é•¿ä¸åŒ…ä½“å¤§å°ï¼Œä½†ä¼šå¸¦æ¥è¿è¡Œæ—¶çš„æ€§èƒ½å¼€é”€ã€‚</p>
<h3 id="ä»åŸç”Ÿå±‚native-codeè°ƒç”¨æ‰˜ç®¡å±‚managedæ–¹æ³•">ä»åŸç”Ÿå±‚ï¼ˆnative
codeï¼‰è°ƒç”¨æ‰˜ç®¡å±‚ï¼ˆmanagedï¼‰æ–¹æ³•</h3>
<p>åœ¨AOTå¹³å°ä¸Šï¼Œé‚£äº›éœ€è¦è¢«è½¬è¯‘ï¼ˆmarshaledï¼Ÿä¸ç¡®å®šå¦‚ä½•ç¿»è¯‘æ¯”è¾ƒå‡†ç¡®ï¼‰ä¸ºCæ–¹æ³•æŒ‡é’ˆä»¥ä¾¿äºä»åŸç”Ÿå±‚è°ƒç”¨çš„æ‰˜ç®¡å±‚æ–¹æ³•ï¼Œæœ‰ä¸€äº›é™åˆ¶ï¼š</p>
<ul>
<li><p>æ‰˜ç®¡æ–¹æ³•å¿…é¡»æ˜¯ä¸€ä¸ªé™æ€æ–¹æ³•</p></li>
<li><p>æ‰˜ç®¡æ–¹æ³•å¿…é¡»è¦æœ‰<code>[MonoPInvokeCallback]</code>
Attribute</p></li>
<li><p>å¦‚æœè¿™ä¸ªæ‰˜ç®¡æ–¹æ³•æ˜¯æ³›å‹çš„ï¼Œé‚£ä¹ˆä¾¿éœ€è¦ä½¿ç”¨<code>[MonoPInvokeCallback(Type)]</code>é‡è½½æ¥å£°æ˜å“ªäº›å…·ä½“çš„ç±»å‹éœ€è¦è¢«ä½¿ç”¨ã€‚Typeå¿…é¡»è¦æ˜¯å¸¦æœ‰æ­£ç¡®æ³›å‹å‚æ•°æ•°é‡çš„æ³›å‹å®ä¾‹ã€‚å¯¹ä¸€ä¸ªæ–¹æ³•ä½¿ç”¨å¤æ•°ä¸ª<code>[MonoPInvokeCallback]</code>æ˜¯å¯èƒ½çš„ï¼Œå¦‚ä¸‹ä¾‹ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F; Generates reverse P&#x2F;Invoke wrappers for NameOf&lt;long&gt; and NameOf&lt;int&gt;
&#x2F;&#x2F; Note that the types are only used to indicate the generic arguments.
[MonoPInvokeCallback(typeof(Action&lt;long&gt;))]
[MonoPInvokeCallback(typeof(Action&lt;int&gt;))]
private static string NameOfT&lt;T&gt;(T item) 
&#123;
    return typeof(T).Name;
&#125;</code></pre></li>
</ul>
<h2 id="çº¿ç¨‹ä¸æ”¯æŒ">çº¿ç¨‹ä¸æ”¯æŒ</h2>
<p>ä¸€äº›å¹³å°ä¸æ”¯æŒå¯¹çº¿ç¨‹çš„ä½¿ç”¨ï¼Œæ‰€ä»¥ä¸€åˆ‡ä½¿ç”¨äº†<code>System.Threading</code>å‘½åç©ºé—´çš„æ‰˜ç®¡å±‚ä»£ç éƒ½ä¼šåœ¨è¿è¡Œæ—¶å‡ºé”™ã€‚åŒæ—¶ï¼Œä¸€äº›.NETç±»åº“éšå¼åœ°ä¾èµ–äº†çº¿ç¨‹ã€‚ä¸€ä¸ªä¾èµ–çº¿ç¨‹æ”¯æŒçš„å¸¸è§ä¾‹å­å°±æ˜¯<code>System.Timers.Timer</code>ç±»ã€‚</p>
<h2 id="å¼‚å¸¸è¿‡æ»¤å™¨">å¼‚å¸¸è¿‡æ»¤å™¨</h2>
<p>IL2CPPæ”¯æŒå¼‚å¸¸è¿‡æ»¤å™¨ï¼Œä¸è¿‡å¼‚å¸¸è¿‡æ»¤è¯­å¥å’Œcatchå—çš„æ¬¡åºå¯èƒ½ä¼šå­˜åœ¨ä¸åŒï¼Œå› ä¸ºIL2CPPä½¿ç”¨C++çš„å¼‚å¸¸æ¥å®ç°æ‰˜ç®¡å±‚å¼‚å¸¸ã€‚ä¸€èˆ¬æƒ…å†µä¸‹è¿™ä¸ä¼šè¢«æ³¨æ„åˆ°ï¼Œé™¤éæœ‰è¿‡æ»¤å™¨é˜»æ­¢äº†å¯¹å­—æ®µçš„å†™æ“ä½œã€‚</p>
<h2 id="å…¶ä»–">å…¶ä»–</h2>
<ul>
<li>IL2CPPä¸æ”¯æŒè¿è¡Œæ—¶å¯¹<code>MarshalAs</code>ä»¥åŠ<code>FieldOffset</code>
Attributes çš„åå°„</li>
<li>IL2CPPä¸æ”¯æŒC#çš„<code>dynamic</code>å…³é”®å­—ï¼Œå› ä¸ºå®ƒéœ€è¦JITç¼–è¯‘</li>
<li>IL2CPPä¸æ”¯æŒ<code>Marshal.Prelink</code>æˆ–<code>Marshal.PrelinkAll</code>
APIæ–¹æ³•</li>
<li>IL2CPPä¸æ”¯æŒ<code>System.Diagnostics.Process</code> APIæ–¹æ³•</li>
</ul>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>æ¸¸æˆå¼€å‘</category>
        <category>å¼•æ“è„šæœ¬åç«¯</category>
      </categories>
      <tags>
        <tag>æ¸¸æˆå¼€å‘</tag>
        <tag>Unity</tag>
        <tag>IL2CPP</tag>
      </tags>
  </entry>
  <entry>
    <title>games101-lecture14 ç¬”è®°</title>
    <url>/p/9f45e6ee4d77/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="today">Today</h1>
<ul>
<li>Acceleration åŠ é€Ÿç»“æ„ï¼šä½¿ç”¨AABBæ¥åŠ é€Ÿå…‰çº¿è¿½è¸ª
<ul>
<li>Uniform grids</li>
<li>Spatial partitions</li>
</ul></li>
<li>Basic radiometryï¼ˆè¾å°„åº¦é‡å­¦ï¼‰
<ul>
<li>è¿›é˜¶ï¼šä¸åŒäºWhitted-Styleçš„å…‰çº¿è¿½è¸ª</li>
</ul></li>
</ul>
<h1 id="å…‰çº¿è¿½è¸ªåŠ é€Ÿç»“æ„">å…‰çº¿è¿½è¸ªåŠ é€Ÿç»“æ„</h1>
<h2 id="å‡åŒ€ç½‘æ ¼æ–¹æ¡ˆuniform-grids">å‡åŒ€ç½‘æ ¼æ–¹æ¡ˆï¼šUniform grids</h2>
<p><strong>é¢„å¤„ç†ï¼šæ„å»ºåŠ é€Ÿç½‘æ ¼</strong></p>
<p>æ‰¾ä¸€ä¸ªåŒ…å›´ç›’ï¼Œåœ¨åŒ…å›´ç›’ä¸­æ„å»ºå‡åŒ€ç½‘æ ¼ï¼Œè®°å½•æ¯ä¸€ä¸ªä¸ç‰©ä½“ç›¸äº¤çš„ç½‘æ ¼</p>
<p><strong>å…‰çº¿ä¸åœºæ™¯æ±‚äº¤</strong></p>
<p>å°„å‡ºä¸€é“å…‰çº¿ï¼Œè®©å…‰çº¿ä¸æ ¼å­æ±‚äº¤ï¼Œè‹¥æ ¼å­å†…å­˜åœ¨ç‰©ä½“ï¼Œå†è®©å…‰çº¿ä¸ç‰©ä½“æ±‚äº¤ï¼šå…‰çº¿ä¸æ ¼å­æ±‚äº¤æ˜¯å¿«é€Ÿçš„ï¼Œè€Œä¸å®é™…ç‰©ä½“æ±‚äº¤æ˜¯å¾ˆæ…¢çš„ï¼Œé€šè¿‡è¿™æ ·çš„ç†å¿µæ¥ä¼˜åŒ–</p>
<p><strong>ç»éªŒå‘Šè¯‰æˆ‘ä»¬</strong></p>
<p>å½“æ ¼å­æ•°ç­‰äºC * å¯¹è±¡æ•°æ—¶ï¼Œç»“æœä¼šæ¯”è¾ƒå¥½ï¼›ä¸‰ç»´ç©ºé—´ä¸‹å¸¸æ•°Cå¯ä»¥å–27</p>
<p><strong>ç¼ºé™·</strong></p>
<p>å½“ç»†èŠ‚ç‰©å“åœ¨ç©ºé—´ä¸­åˆ†å¸ƒä¸å‡åŒ€æ—¶ï¼Œå­˜åœ¨å¤§è§„æ¨¡é›†ä¸­ã€å¤§è§„æ¨¡ç©ºç™½ï¼šâ€Teapot
in a stadiumâ€ problem</p>
<p>*åœ¨ä¸€äº›åœºæ™¯ä¸‹è¿˜æ˜¯å¥½ç”¨çš„ï¼Œä»æœ‰åœ¨ä½¿ç”¨</p>
<h2 id="ç©ºé—´åˆ’åˆ†-spatial-partitions">ç©ºé—´åˆ’åˆ† Spatial partitions</h2>
<figure>
<a href="https://s2.loli.net/2023/09/17/QPXy1Yma5cLDHVo.png" title="ç©ºé—´åˆ’åˆ†æ ‘ç»“æ„" class="gallery-item"><img src="https://s2.loli.net/2023/09/17/QPXy1Yma5cLDHVo.png"
alt="ç©ºé—´åˆ’åˆ†æ ‘ç»“æ„" /></a>
<figcaption aria-hidden="true">ç©ºé—´åˆ’åˆ†æ ‘ç»“æ„</figcaption>
</figure>
<span id="more"></span>
<p><strong>Oct-Tree
å…«å‰æ ‘</strong>ï¼šä¸‰ç»´ç©ºé—´åˆ’åˆ†ä¸º8ä»½ï¼Œåœ¨æ ¼å­ç±»æ•°é‡è¶³å¤Ÿå°‘ï¼Œæˆ–è€…åˆ’åˆ†æ¬¡æ•°è¶³å¤Ÿå¤šæ—¶ä¸å†åˆ’åˆ†ã€‚</p>
<p>æƒ³è®©ç©ºé—´å¾—åˆ°åˆ’åˆ†ï¼Œä½†æ˜¯ä¸æƒ³éšç€ç»´åº¦ä¸æ–­æé«˜å­èŠ‚ç‚¹æŒ‡æ•°çº§å¢é•¿ï¼Œå‘æ˜äº†KD-Treeã€‚</p>
<p><strong>KD-Treeï¼ˆæœ¬æ¬¡é‡ç‚¹ï¼‰</strong>ï¼šæ¯æ¬¡å¯¹æ ¼å­åªè¿›è¡Œä¸€æ¬¡åˆ’åˆ†ï¼Œåˆ’åˆ†ä¸ºä¸¤ä¸ªåŒºåŸŸï¼›æ¯æ¬¡è¿›è¡Œåˆ’åˆ†æ—¶é‡‡å–ä¸ä¸Šä¸€æ¬¡ä¸åŒçš„è½´å‘ï¼Œå¯ä»¥å¾—åˆ°å°½å¯èƒ½å‡åŒ€çš„åˆ’åˆ†ç»“æœã€‚ï¼ˆRoot:
axis-xï¼Œlayer1: axis-yï¼Œlayer2: axis-zï¼‰</p>
<p><strong>BSP-Tree</strong>ï¼šåŒæ ·æ˜¯ç©ºé—´äºŒåˆ†æ–¹æ³•ï¼ŒåŒºåˆ«åœ¨äºä¸æ˜¯æ°´å¹³ç«–ç›´åœ°è¿›è¡Œåˆ’åˆ†</p>
<aside>
âš ï¸
åŒæ ·åƒä¸Šæ–‡çš„Uniform-Gridsï¼Œç©ºé—´åˆ’åˆ†æ˜¯åœ¨å…‰çº¿è¿½è¸ªå‰çš„é¢„å¤„ç†ï¼Œå…ˆå»ºç«‹KD-tree
</aside>
<figure>
<a href="https://s2.loli.net/2023/09/17/DXlbzgTZG3AHxYL.png" title="KD-treeåˆ’åˆ†ç»“æœ" class="gallery-item"><img src="https://s2.loli.net/2023/09/17/DXlbzgTZG3AHxYL.png"
alt="KD-treeåˆ’åˆ†ç»“æœ" /></a>
<figcaption aria-hidden="true">KD-treeåˆ’åˆ†ç»“æœ</figcaption>
</figure>
<h3 id="kd-trees-æ•°æ®ç»“æ„">KD-Trees æ•°æ®ç»“æ„</h3>
<p>ä¸­é—´èŠ‚ç‚¹å­˜å‚¨ï¼ˆAï¼ŒBï¼ŒCï¼‰ï¼š</p>
<ul>
<li>åˆ’åˆ†ä½¿ç”¨çš„è½´ï¼ˆx, y, zï¼‰</li>
<li>åˆ’åˆ†çš„ä½ç½®ï¼ˆåœ¨è½´å‘ä¸Šçš„ä»€ä¹ˆåœ°æ–¹åˆ’åˆ†ï¼‰</li>
<li>æ‰€æœ‰å­èŠ‚ç‚¹æŒ‡é’ˆ</li>
<li>æ³¨æ„ä¸­é—´èŠ‚ç‚¹ä¸å­˜å‚¨å¯¹è±¡ï¼ˆobjectsï¼‰</li>
</ul>
<p>å¶å­èŠ‚ç‚¹å­˜å‚¨ï¼ˆ1ï¼Œ2ï¼Œ3ï¼‰ï¼š</p>
<ul>
<li>å¯¹è±¡çš„åˆ—è¡¨å­˜å‚¨</li>
</ul>
<h2 id="éå†kd-treeè¿›è¡Œæ±‚äº¤">éå†KD-Treeè¿›è¡Œæ±‚äº¤</h2>
<p>å¦‚æœå…‰çº¿ä¸ä¸­é—´èŠ‚ç‚¹ä»£è¡¨çš„åŒºåŸŸç›¸äº¤ï¼Œå°±æ„å‘³ç€å…‰çº¿ä¹Ÿè¦ä¸ä¸­é—´èŠ‚ç‚¹åˆ’åˆ†å‡ºçš„å­èŠ‚ç‚¹åˆ¤å®šç›¸äº¤ï¼›é€’å½’æ­¤è¿‡ç¨‹ï¼Œæœ€åè¾¾åˆ°ä¸€ä¸ªå¶å­èŠ‚ç‚¹ï¼Œå°±å’Œå¶å­èŠ‚ç‚¹ä¸­çš„æ‰€æœ‰å¯¹è±¡æ±‚äº¤ã€‚</p>
<h3 id="è¿›é˜¶é—®é¢˜">è¿›é˜¶é—®é¢˜</h3>
<p><strong>å¦‚ä½•åˆ¤å®šå¯¹è±¡ä¸åŒ…å›´ç›’çš„ç›¸äº¤å…³ç³»</strong></p>
<p>éœ€è¦è€ƒè™‘ä¸‰è§’å½¢ä¸ç›’å­çš„æ±‚äº¤</p>
<p>ç©ºé—´åˆ’åˆ†æ¶‰åŠçš„é—®é¢˜ï¼Œå¦‚ä½•åˆ¤æ–­å¯¹è±¡æ˜¯å¦åœ¨æŸä¸ªåˆ’åˆ†çš„æ ¼å­å†…ï¼Ÿ</p>
<p>æˆ–è€…ï¼ŒæŸä¸ªåˆ’åˆ†å‡ºæ¥çš„å„è‡ªå†…æœ‰å“ªäº›å¯¹è±¡ï¼Ÿ</p>
<p>è™½ç„¶æœ‰ç°æˆçš„ç®—æ³•ï¼Œä½†æ˜¯ä¸å®¹æ˜“å†™å¯¹ï¼Œåœ¨ä¸€äº›æƒ…å¢ƒä¸‹å®¹æ˜“çŠ¯é”™ã€‚</p>
<p><strong>å¯¹è±¡é‡å¤å‡ºç°åœ¨ä¸åŒçš„åˆ’åˆ†æ ¼å­ä¸­</strong></p>
<figure>
<a href="https://s2.loli.net/2023/09/17/2mgejXkSHtpMG9s.png" title="é‡å¤å‡ºç°åœ¨ä¸åŒåˆ†åŒºä¸­çš„ç‰©ä½“" class="gallery-item"><img src="https://s2.loli.net/2023/09/17/2mgejXkSHtpMG9s.png"
alt="é‡å¤å‡ºç°åœ¨ä¸åŒåˆ†åŒºä¸­çš„ç‰©ä½“" /></a>
<figcaption aria-hidden="true">é‡å¤å‡ºç°åœ¨ä¸åŒåˆ†åŒºä¸­çš„ç‰©ä½“</figcaption>
</figure>
<p>å¦‚å›¾ä¸­çš„è¿™ä¸ªåœ†ï¼Œå‡ºç°åœ¨åˆ†åŒº3ï¼Œ4ï¼Œ5å†…ï¼Œå³è¿™ä¸‰ä¸ªåˆ†åŒºå†…ä¼šé‡å¤å‡ºç°è¿™ä¸ªåœ†</p>
<h2 id="object-partitions-bounding-volumn-hierarchybvh">Object
Partitions &amp; Bounding Volumn Hierarchy(BVH)</h2>
<p>è§£å†³äº†ä¸Šè¿°KD-Treeçš„ä¸¤ä¸ªé—®é¢˜ï¼Œç›®å‰å›¾å½¢å­¦æ›´å—æ¬¢è¿çš„ç»“æ„ã€‚</p>
<p>åˆ’åˆ†çš„ä¸æ˜¯ç©ºé—´ï¼Œè€Œæ˜¯æŠŠç‰©ä½“åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼›å¦‚ä¸‹ä¾‹ï¼ŒæŠŠä¸€ä¸ªç›’å­å†…çš„ä¸‰è§’å½¢åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼ˆåŸºäºæŸç§æ ‡å‡†ï¼‰ï¼Œä¹‹åå†åˆ†åˆ«è®¡ç®—ä¸¤ä¸ªéƒ¨åˆ†çš„åŒ…å›´ç›’ã€‚</p>
<figure>
<a href="https://s2.loli.net/2023/09/17/32mh5ERYDCQy4ZG.png" title="BVHç¤ºä¾‹" class="gallery-item"><img src="https://s2.loli.net/2023/09/17/32mh5ERYDCQy4ZG.png"
alt="BVHç¤ºä¾‹" /></a>
<figcaption aria-hidden="true">BVHç¤ºä¾‹</figcaption>
</figure>
<p>ç‰¹æ€§ï¼š</p>
<ul>
<li>ä¸€ä¸ªç‰©ä½“åªå¯èƒ½å‡ºç°åœ¨ä¸€ä¸ªæ ¼å­ï¼ˆåˆ†åŒºï¼‰é‡Œ</li>
<li>æ±‚æ‰€æœ‰ä¸‰è§’å½¢åŒ…å›´ç›’ç®—æ³•ä¹Ÿå¾ˆç®€å•ï¼Œä¸ç”¨è®¡ç®—ä¸‰è§’å½¢å’Œç›’å­çš„ç›¸äº¤å…³ç³»</li>
<li>æ¯ä¸ªåˆ†åŒºå¯èƒ½æœ‰ç›¸äº¤ï¼šå…³äºæ€ä¹ˆå°†å…¶åˆ’åˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œå¾ˆæœ‰è®²ç©¶ï¼Œæœ‰ç›¸å…³çš„ç ”ç©¶</li>
</ul>
<p>è¯¦è§£åšæ³•ï¼š</p>
<ol type="1">
<li>æ‰¾åˆ°ä¸€ä¸ªåŒ…å›´ç›’</li>
<li>é€’å½’åœ°å°†å…¶å†…éƒ¨çš„å¯¹è±¡åˆ†ä¸ºä¸¤ä¸ªå­é›†</li>
<li>é‡æ–°è®¡ç®—å­é›†åœ°åŒ…å›´ç›’</li>
<li>é€‚å½“åœ°åœæ­¢ï¼ˆå­é›†æ•°é‡è¶³å¤Ÿå°‘ï¼Œåˆ’åˆ†æ¬¡æ•°è¶³å¤Ÿå¤šï¼‰</li>
<li>å°†ç‰©ä½“å­˜å‚¨åœ¨æ¯ä¸€ä¸ªå¶å­èŠ‚ç‚¹ä¸­</li>
</ol>
<p>å¦‚ä½•åˆ’åˆ†ä¸€ä¸ªèŠ‚ç‚¹/åˆ†åŒºï¼š</p>
<ul>
<li>é€‰æ‹©ä¸€ä¸ªåˆ’åˆ†çš„ç»´åº¦</li>
<li>ç»éªŒè°ˆ
#1ï¼šæ²¿ç€åˆ†åŒºé‡Œæœ€é•¿çš„è½´å‘åˆ’åˆ†ï¼Œè®©å®ƒå˜çŸ­ï¼Œæ›´å®¹æ˜“å½¢æˆå‡åŒ€åˆ†åŒº</li>
<li>ç»éªŒè°ˆ
#2ï¼šå–â€ä¸­é—´â€çš„ç‰©ä½“ï¼šåœ¨å³å°†åˆ’åˆ†çš„è½´å‘ä¸Šï¼Œè¿›è¡Œæ’åºï¼ˆè‹¥åˆ’åˆ†xè½´ï¼Œåˆ™å¯¹xåæ ‡è¿›è¡Œæ’åºï¼‰ï¼Œå–ä¸­ä½æ•°åºå·ï¼ˆn/2ï¼‰çš„ç‰©ä½“è¿›è¡Œåˆ’åˆ†ï¼Œå¯ä»¥è®©ä¸¤ä¸ªå­åˆ†åŒºçš„æ•°é‡æ¥è¿‘ï¼Œä»è€Œè®©æ ‘çš„æ·±åº¦æ›´å°ï¼Œæœç´¢æ›´å¿«
<ul>
<li><strong>æ— åºæ•°ç»„ä¸­æ±‚ç¬¬iå¤§çš„æ•°</strong>ï¼Œå®é™…ä¸Šå¯ä»¥ä¸éœ€è¦æ’åº<span
class="math inline">\(O(nlgn)\)</span>ï¼šå¿«é€Ÿé€‰æ‹©ç®—æ³• <span
class="math inline">\(O(n)\)</span> â†’
å¿«é€Ÿæ’åºç®—æ³•çš„å¯å‘ï¼Œç®—æ³•ä¸­Partitionåšå®Œåï¼Œåªå¯¹å…¶ä¸­ä¸€è¾¹è¿›è¡Œæ“ä½œ</li>
</ul></li>
</ul>
<h3 id="bvhçš„æ•°æ®ç»“æ„">BVHçš„æ•°æ®ç»“æ„</h3>
<p>ä¸­é—´èŠ‚ç‚¹å­˜å‚¨ï¼š</p>
<ul>
<li>åŒ…å›´ç›’</li>
<li>å­èŠ‚ç‚¹çš„æŒ‡é’ˆ</li>
</ul>
<p>å¶å­èŠ‚ç‚¹å­˜å‚¨ï¼š</p>
<ul>
<li>åŒ…å›´ç›’</li>
<li>åŒ…å«å¯¹è±¡çš„åˆ—è¡¨</li>
</ul>
<h2 id="ä¸¤ç±»åˆ’åˆ†çš„æ¯”è¾ƒ">ä¸¤ç±»åˆ’åˆ†çš„æ¯”è¾ƒ</h2>
<h3 id="ç©ºé—´åˆ’åˆ†kd-tree">ç©ºé—´åˆ’åˆ†ï¼šKD-tree</h3>
<ul>
<li>å°†ç©ºé—´åˆ’åˆ†ä¸ºä¸é‡å çš„ä¸¤ä¸ªåˆ†åŒº</li>
<li>ä¸€ä¸ªç‰©ä½“å¯èƒ½å­˜åœ¨äºå¤šä¸ªåˆ†åŒºå†…</li>
</ul>
<h3 id="ç‰©ä½“åˆ’åˆ†bvh">ç‰©ä½“åˆ’åˆ†ï¼šBVH</h3>
<ul>
<li>å°†å¯¹è±¡åˆ’åˆ†ä¸ºä¸ç›¸äº¤çš„å­é›†</li>
<li>ä¸åŒé›†åˆçš„åŒ…å›´ç›’å¯èƒ½åœ¨ç©ºé—´ä¸Šé‡å </li>
</ul>
<p>å› ä¸ºå®ç°å®¹æ˜“ï¼Œæ•ˆç‡ä¹Ÿä¸é”™ï¼ŒBVHå¾—åˆ°äº†æ›´å¤§çš„åº”ç”¨</p>
<p>åŠ é€Ÿç»“æ„å®Œæˆåï¼Œå…‰çº¿å’Œåœºæ™¯çš„æ±‚äº¤å°±èƒ½åœ¨å¾ˆçŸ­çš„æ—¶é—´å†…å®Œæˆ</p>
<h1 id="è¾å°„åº¦é‡å­¦-radiometry">è¾å°„åº¦é‡å­¦ Radiometry</h1>
<h2 id="åŠ¨æœº-motivation">åŠ¨æœº motivation</h2>
<p>ä¸ºä»€ä¹ˆéœ€è¦è¾å°„åº¦é‡å­¦ï¼Ÿ</p>
<p>æ¥è‡ªè¿‡å»çš„ç–‘é—®ï¼š</p>
<ul>
<li>Blinn-Phongæ¨¡å‹ä¸­çš„å…‰çº¿å¼ºåº¦ <span
class="math inline">\(I=10\)</span>ï¼Œå•ä½æ˜¯ï¼Ÿ</li>
<li>Whitted styleçš„å…‰çº¿è¿½è¸ªçœ‹èµ·æ¥æ˜¯æ­£ç¡®ç»“æœå—ï¼Ÿ</li>
</ul>
<p>Blinn-Phongæ¨¡å‹æœ‰è®¸å¤šç®€åŒ–ï¼Œäººä¸ºè®¾ç½®çš„å†…å®¹ï¼Œè€Œè¾å°„åº¦é‡å­¦å¯ä»¥å¯¹å…‰çš„è¡Œä¸ºæä¾›ç²¾ç¡®æè¿°</p>
<h2 id="å†…å®¹">å†…å®¹</h2>
<ul>
<li>æµ‹åº¦ç³»ç»Ÿä¸å…‰ç…§çš„å•ä½</li>
<li>å¯¹å…‰çš„ç©ºé—´å±æ€§çš„ç²¾ç¡®æè¿°
<ul>
<li>å…‰ç…§çš„è‹¥å¹²å±æ€§ï¼šRadiant flux, intensity, irradiance, radiance</li>
</ul></li>
<li>é€šè¿‡ç‰©ç†ä¸Šæ­£ç¡®çš„æ–¹å¼ï¼ˆa physically correct
mannerï¼‰æ¥è¿›è¡Œå…‰ç…§è®¡ç®—</li>
</ul>
<aside>
â„¹ï¸ å­¦ä¹ æ–¹å¼çš„åˆ†äº«ï¼šWHY, WHAT, then
HOWã€‚å…ˆæ˜¯ä¸ºä»€ä¹ˆå­¦ï¼Œå†æ˜¯å­¦çš„æ˜¯ä»€ä¹ˆä¸œè¥¿ï¼Œæœ€åæ˜¯å…·ä½“çš„åŸç†ï¼Œå®ç°/åº”ç”¨æ–¹å¼
</aside>
<h3 id="radiant-energy-and-flux-power">Radiant Energy and Flux
(Power)</h3>
<p>Radiant energyï¼šç”µç£è¾å°„çš„èƒ½é‡ï¼Œå•ä½ç„¦è€³ï¼ˆJï¼‰</p>
<p><span class="math display">\[
\begin{equation}Q[\mathrm{~J}=\text { Joule }]\end{equation}
\]</span></p>
<p>Radiant flux(<strong>power</strong>)ï¼šå•ä½æ—¶é—´çš„èƒ½é‡ï¼Œenergy per unit
timeï¼Œå¾—åˆ°åŠŸç‡ï¼Œå•ä½ç“¦ç‰¹ï¼ˆWï¼‰ï¼Œå›¾å½¢å­¦ä½¿ç”¨çš„å¦ä¸€ä¸ªå•ä½ï¼ˆ<strong>lumen
æµæ˜</strong>ï¼‰</p>
<p><span class="math display">\[
\begin{equation}\Phi =\frac{\mathrm{d} Q}{\mathrm{~d}
t}[\mathrm{~W}=\mathrm{Watt}][\mathrm{lm}=\text { lumen
}]^*\end{equation}
\]</span></p>
<p>å¦ä¸€ç§fluxçš„ç†è§£ï¼šå•ä½æ—¶é—´å†…é€šè¿‡æ„Ÿå…‰å¹³é¢çš„å…‰å­æ•°é‡</p>
<p><strong>å…¶ä»–çš„é‡è¦ç‰©ç†é‡</strong></p>
<ul>
<li>å…‰æºè¾å°„å‡ºçš„èƒ½é‡ï¼šRadiant Intensity</li>
<li>è¡¨é¢æ¥æ”¶åˆ°çš„èƒ½é‡ï¼šIrradiance</li>
<li>å…‰çº¿æ²¿ç€å°„çº¿çš„ä¼ è¾“ï¼šRadiance</li>
</ul>
<h3 id="radiant-intensity">Radiant Intensity</h3>
<p>å®šä¹‰ï¼špower per uint solid angleï¼Œæ¯å•ä½ç«‹ä½“è§’çš„åŠŸç‡ï¼Œå•ä½
<strong>candela</strong></p>
<p><span class="math display">\[
\begin{equation}\left[\frac{\mathrm{W}}{\mathrm{sr}}\right]\left[\frac{\mathrm{lm}}{\mathrm{sr}}=\mathrm{cd}=\text
{ candela }\right]\end{equation}
\]</span></p>
<p><strong>ä»€ä¹ˆæ˜¯ç«‹ä½“è§’ï¼Ÿ</strong></p>
<figure>
<a href="https://s2.loli.net/2023/09/17/wI8arSMgVsCc7Ll.png" title="å•ä½ç«‹ä½“è§’" class="gallery-item"><img src="https://s2.loli.net/2023/09/17/wI8arSMgVsCc7Ll.png"
alt="å•ä½ç«‹ä½“è§’" /></a>
<figcaption aria-hidden="true">å•ä½ç«‹ä½“è§’</figcaption>
</figure>
<p>è§’åº¦çš„å®šä¹‰ï¼Œå¼§é•¿é™¤ä»¥åŠå¾„ï¼Œå¼§åº¦åˆ¶ã€‚</p>
<p><strong>ç«‹ä½“è§’</strong>ï¼šå¼§åº¦åœ¨ä¸‰ç»´ç©ºé—´çš„å»¶ä¼¸ã€‚åœ¨ä¸‰ç»´ç©ºé—´çš„çƒä¸­æ‰¾ä¸€ä¸ªé”¥ï¼Œè¿™ä¸ªé”¥åœ¨çƒä¸Šæœ‰ä¸€ä¸ªçƒè¡¨é¢ç§¯ï¼Œå°†è¿™ä¸ªé¢ç§¯é™¤ä»¥çƒåŠå¾„çš„å¹³æ–¹ã€‚å› ä¸ºçƒè¡¨é¢ç§¯æ˜¯
<span class="math inline">\(4\pi{r}^2\)</span>ï¼Œæ‰€ä»¥çƒæœ‰<span
class="math inline">\(4\pi\)</span>ç«‹ä½“è§’ï¼ˆsteradiansï¼‰</p>
<p>å•ä½ç«‹ä½“è§’ï¼ˆDifferential Solid Anglesï¼‰ï¼š</p>
<p><span class="math display">\[
\begin{equation}\begin{aligned}\mathrm{d} A &amp; =(r \mathrm{~d}
\theta)(r \sin \theta \mathrm{d} \phi) \\&amp; =r^2 \sin \theta
\mathrm{d} \theta \mathrm{d} \phi\end{aligned}\end{equation}
\]</span></p>
<p><span class="math display">\[
\begin{equation} \mathrm{d} \omega=\frac{\mathrm{d} A}{r^2}=\sin \theta
\mathrm{d} \theta \mathrm{d} \phi \end{equation}
\]</span></p>
<p>ä¸ºä»€ä¹ˆæ˜¯é¢ç§¯å¾®åˆ†<span class="math inline">\(\mathrm{d} A\)</span>
çš„ä¸€ä¸ªå› æ•°æ˜¯ <span class="math inline">\(r \sin \theta \mathrm{d}
\phi\)</span>ï¼Œå¯ä»¥çœ‹è“çº¿è¿™ä¸ªåœ†ä¸Šçš„å¼§</p>
<figure>
<a href="https://s2.loli.net/2023/09/17/2oKzTQVYgqm5ilL.png" title="çƒè¡¨é¢é¢ç§¯å¾®åˆ†" class="gallery-item"><img src="https://s2.loli.net/2023/09/17/2oKzTQVYgqm5ilL.png"
alt="çƒè¡¨é¢é¢ç§¯å¾®åˆ†" /></a>
<figcaption aria-hidden="true">çƒè¡¨é¢é¢ç§¯å¾®åˆ†</figcaption>
</figure>
<p><strong>å›å¤´çœ‹Intensityçš„å®šä¹‰</strong></p>
<p>intensityï¼Œå³ä¸ºpoweråœ¨æŸä¸€ä¸ªæ–¹å‘çš„å¾®åˆ†ã€‚æ‰€ä»¥å¦‚æœå¯¹äºå‡åŒ€çš„ç‚¹å…‰æºï¼Œæœ‰ä»¥ä¸‹ï¼š</p>
<p><span class="math display">\[
\begin{equation} I = \frac{\Phi}{4\pi}\end{equation}
\]</span></p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºå›¾å½¢å­¦</category>
        <category>RayTracing</category>
      </categories>
      <tags>
        <tag>è®¡ç®—æœºå›¾å½¢å­¦</tag>
        <tag>RayTracing</tag>
        <tag>ç©ºé—´åˆ’åˆ†</tag>
      </tags>
  </entry>
  <entry>
    <title>Linuxå†…å­˜ç®¡ç†ï¼ˆåŸºç¡€æ¦‚å¿µï¼‰</title>
    <url>/p/0a6e6f8be357/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><p>ç¿»è¯‘è‡ªï¼š<a
href="https://perfetto.dev/docs/case-studies/memory#heapprofd">https://perfetto.dev/docs/case-studies/memory#heapprofd</a></p>
<p>æƒ³çœ‹ä¸€ä¸‹é¡¹ç›®åœ¨çœŸæœºä¸Šçš„è¡¨ç°ï¼Œæ‰€ä»¥å·¥ä½œä¹‹ä½™ç”¨äº†Perfettoæ¥åšé¡¹ç›®çš„æ€§èƒ½æµ‹è¯•ã€‚é˜…è¯»å®˜æ–¹æ–‡æ¡£çš„æ—¶å€™å‘ç°äº†è¿™ä¸€ç« èŠ‚ä»‹ç»äº†Linuxå†…å­˜ç®¡ç†çš„ä¸€äº›åŸºç¡€æ¦‚å¿µï¼Œæ‰€ä»¥å°±ç®€å•ç¿»è¯‘äº†ä¸€ä¸‹ã€‚</p>
<hr />
<aside>
â„¹ï¸
åœ¨å¼€å§‹ä¹‹å‰æé†’ä¸€ä¸‹ï¼ŒKBå’ŒKiBå®é™…æ˜¯ä¸åŒçš„å•ä½ï¼Œä¸€èˆ¬æ˜¯ç”¨KBæŒ‡1,000byteï¼Œè€ŒKiBæŒ‡1,024byte
</aside>
<p>ä»å†…æ ¸çš„è§’åº¦ï¼Œå†…å­˜è¢«åˆ’åˆ†ä¸ºç­‰å¤§å°4KiBçš„å—ï¼Œè¿™äº›å—è¢«ç§°ä¸ºé¡µï¼ˆpagesï¼‰ã€‚</p>
<p>è¿™äº›é¡µè¢«ç»„ç»‡äºè¿ç»­çš„è™šæ‹Ÿç©ºé—´ä¸­ï¼Œæ­¤ç©ºé—´ç§°ä¸ºVMAï¼ˆVirtual Memory
Areaï¼‰ã€‚</p>
<p>å½“ä¸€ä¸ªè¿›ç¨‹é€šè¿‡ mmap()
ç³»ç»Ÿè°ƒç”¨è¯·æ±‚å†…å­˜æ—¶ï¼ŒVMAå°±ä¼šè¢«åˆ›å»ºã€‚ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œåº”ç”¨ä¸ä¼šç›´æ¥è°ƒç”¨mmap()ï¼Œè€Œæ˜¯é€šè¿‡å†…å­˜åˆ†é…å™¨é—´æ¥è°ƒç”¨ï¼Œåƒæ˜¯
C çš„Â <code>malloc()</code>, C++ çš„Â <code>operator new()</code>Â æˆ–æ˜¯ Java
çš„Â <code>new X()</code> ç­‰ç­‰ã€‚</p>
<p>VMAå¯ä»¥è¢«åˆ†ä¸ºä¸¤ç§ç±»å‹ï¼šæ–‡ä»¶åå¤‡é¡µï¼ˆfile-backedï¼‰ä¸åŒ¿åé¡µï¼ˆanonymousï¼‰ã€‚</p>
<span id="more"></span>
<h2 id="æ–‡ä»¶åå¤‡é¡µfile-backed-vmas"><strong>æ–‡ä»¶åå¤‡é¡µï¼ˆFile-backed
VMAsï¼‰</strong></h2>
<p>æ–‡ä»¶åœ¨å†…å­˜ä¸­çš„ä¸€ç§è§†å›¾ã€‚å®ƒä»¬å¯ä»¥é€šè¿‡å°†æ–‡ä»¶æè¿°ç¬¦ä¼ å…¥<code>mmap()</code>æ¥è·å¾—ã€‚å†…æ ¸ä¼šé€šè¿‡ä¼ å…¥çš„æ–‡ä»¶æ¥å¤„ç†VMAä¸Šå‘ç”Ÿçš„ç¼ºé¡µé”™è¯¯ï¼Œæ‰€ä»¥è¯»VMAä¸Šçš„æŒ‡é’ˆï¼Œå°±å’Œå¯¹æ–‡ä»¶è¿›è¡Œ
read() æ“ä½œæ˜¯ç­‰ä»·çš„äº†ã€‚å½“æ‰§è¡Œæ–°çš„è¿›ç¨‹ï¼ŒåŠ è½½åŠ¨æ€é“¾æ¥åº“ï¼Œå®‰å“æ¡†æ¶åŠ è½½.dex
åº“å’ŒAPKä¸­çš„èµ„æºæ–‡ä»¶æ—¶ï¼Œæ–‡ä»¶åå¤‡é¡µéƒ½ä¼šè¢«è®¿é—®ã€‚</p>
<h2 id="åŒ¿åé¡µanonymous-vmas"><strong>åŒ¿åé¡µï¼ˆAnonymous
VMAsï¼‰</strong></h2>
<p>ä¸è¢«ä»»ä½•æ–‡ä»¶å¤‡ç”¨çš„å†…å­˜ç©ºé—´ã€‚å†…å­˜åˆ†é…å™¨å°±æ˜¯é€šè¿‡è¿™ç§æ–¹å¼ä»å†…æ ¸è¯·æ±‚åŠ¨æ€å†…å­˜çš„ã€‚åŒ¿åé¡µå¯ä»¥é€šè¿‡è°ƒç”¨
<code>mmap(â€¦ MAP_ANONYMOUS â€¦)</code> æ¥è·å–ã€‚</p>
<p>å½“åº”ç”¨è¯•å›¾å¯¹VMAè¿›è¡Œè¯»å†™æ“ä½œæ—¶ï¼Œç‰©ç†å†…å­˜åªä¼šè¢«ä»¥é¡µçš„ç²’åº¦ï¼ˆgranularityï¼‰è¿›è¡Œåˆ†é…ã€‚è®¾æƒ³ä½ åœ¨é¡µä¸Šåˆ†é…äº†32MiBçš„å¤§å°ï¼Œä½†åªå¯¹å…¶ä¸­çš„ä¸€ä¸ªå­—èŠ‚åšäº†è¯»å†™æ“ä½œï¼Œé‚£ä¹ˆä½ çš„è¿›ç¨‹å®é™…ä¸Šåªä¼šå¢åŠ 4KiBçš„å†…å­˜å ç”¨ã€‚è™½ç„¶ä½ çš„è¿›ç¨‹ç¡®å®å¢åŠ äº†32MiBçš„è™šæ‹Ÿæ²¡å­˜ï¼Œä½†å®ƒçš„å¸¸é©»ï¼ˆresidentï¼‰ç‰©ç†å†…å­˜åªä¼šå¢åŠ 4KiBã€‚</p>
<p>å½“ä¼˜åŒ–ç¨‹åºçš„å†…å­˜ä½¿ç”¨æ—¶ï¼Œæˆ‘ä»¬ä¸€èˆ¬ç€çœ¼äºå‡å°‘å®ƒä»¬åœ¨ç‰©ç†å†…å­˜ä¸­çš„å ç”¨ï¼ˆfootprintï¼‰ã€‚å› ä¸ºåœ¨ç°ä»£çš„è®¾å¤‡å¹³å°ä¸Šï¼Œè¿‡é«˜çš„è™šæ‹Ÿå†…å­˜å ç”¨ä¸€èˆ¬ä¸éœ€è¦æˆ‘ä»¬è¿‡åˆ†å…³æ³¨ï¼ˆé™¤éè¿‡å¤šçš„å ç”¨å¯¼è‡´è™šæ‹Ÿåœ°å€ç©ºé—´ä¸è¶³ï¼Œè¿™åœ¨64ä½ç³»ç»Ÿä¸Šæ˜¯å¾ˆéš¾å‘ç”Ÿçš„ï¼‰ã€‚</p>
<p>æˆ‘ä»¬å°†ä¸€ä¸ªè¿›ç¨‹é©»ç•™åœ¨ç‰©ç†å†…å­˜ä¸Šçš„å†…å­˜ç§°ä¸ºå®ƒçš„<strong>RSS</strong>ï¼ˆResident
Set Sizeå¸¸é©»é›†å¤§å°ï¼‰ã€‚å°½ç®¡å¦‚æ­¤ï¼Œå¸¸é©»å†…å­˜ä¹Ÿå­˜åœ¨ç€ä¸åŒã€‚</p>
<p>ä»å†…å­˜æ¶ˆè€—çš„è§’åº¦æ¥çœ‹ï¼Œåœ¨VMAä¸­ç‹¬ç«‹çš„é¡µå¯èƒ½å­˜åœ¨ä»¥ä¸‹çŠ¶æ€ï¼š</p>
<ul>
<li><strong>Resident</strong>ï¼šæ­¤é¡µè¢«æ˜ å°„åˆ°ç‰©ç†å†…å­˜é¡µä¸Šã€‚å¸¸é©»é¡µå¯èƒ½æœ‰ä»¥ä¸‹ä¸¤ç§çŠ¶æ€ï¼š
<ul>
<li><strong>Clean</strong>ï¼ˆä»…å¯¹æ–‡ä»¶åå¤‡é¡µï¼‰ï¼šé¡µä¸Šçš„å†…å®¹ä¸ç¡¬ç›˜ï¼ˆå¤–å­˜ï¼Œon-diskï¼‰ä¸Šçš„å†…å®¹ä¸€è‡´ã€‚å½“å†…å­˜å‹åŠ›å¤§æ—¶ï¼Œå†…æ ¸å¯ä»¥æ›´è½»æ˜“åœ°ç§»é™¤cleançŠ¶æ€çš„é¡µã€‚å› ä¸ºå½“éœ€è¦è¿™äº›é¡µæ—¶ï¼Œå†…æ ¸åªè¦è¯»å–å®ƒä»¬ç›¸åº”çš„æ–‡ä»¶ï¼Œå°±èƒ½é‡å»ºå®ƒä»¬çš„å†…å®¹ã€‚</li>
<li><strong>Dirty</strong>ï¼šé¡µä¸Šçš„å†…å®¹ä¸ç¡¬ç›˜ä¸Šçš„å†…å®¹ä¸åŒï¼Œæˆ–è€…ï¼ˆæ›´å¸¸è§çš„æƒ…å†µï¼‰æ­¤é¡µæ²¡æœ‰ç¡¬ç›˜ä¸Šçš„å¤‡ä»½ï¼ˆåŒ¿åé¡µï¼‰ã€‚dirtyçŠ¶æ€çš„é¡µä¸èƒ½å¤Ÿè¢«ç§»é™¤ï¼Œå› ä¸ºè¿™å°†å¯¼è‡´æ•°æ®ä¸¢å¤±ã€‚ä¸è¿‡å®ƒä»¬å¯ä»¥è¢«ç§»å‡ºåˆ°ç¡¬ç›˜ï¼Œæˆ–è€…ZRAMä¸Šã€‚</li>
</ul></li>
<li><strong>Swapped</strong>ï¼šè„é¡µèƒ½å¤Ÿè¢«å†™å…¥åˆ°ç¡¬ç›˜ä¸Šçš„swapæ–‡ä»¶ï¼ˆå¤§å¤šæ•°linuxæ¡Œé¢å‘å¸ƒç‰ˆï¼‰ï¼Œæˆ–è€…è¿›è¡Œå‹ç¼©ï¼ˆåœ¨å®‰å“å’ŒCrOsä¸Šé€šè¿‡<strong>ZRAM</strong>è¿›è¡Œï¼‰ã€‚æ­¤é¡µä¼šä¿æŒswappedçŠ¶æ€ï¼Œç›´åˆ°è™šæ‹Ÿåœ°å€çš„ç¼ºé¡µé”™è¯¯å‘ç”Ÿï¼Œè¿™æ—¶å€™ï¼Œæ­¤é¡µä¼šé‡æ–°è¢«å¸¦å›ä¸»å­˜ã€‚</li>
<li><strong>Not
present</strong>ï¼šæ­¤é¡µä»æœªå‘ç”Ÿç¼ºé¡µé”™è¯¯ï¼Œä¸”æ­¤é¡µä¸ºcleançŠ¶æ€ï¼Œç¨åå°†è¢«ç§»é™¤ã€‚</li>
</ul>
<p>ä¸€èˆ¬æ¥è¯´å‡å°‘dirtyå†…å­˜çš„å ç”¨é‡æ˜¯æ›´é‡è¦çš„ï¼Œå› ä¸ºå®ƒä»¬ä¸èƒ½åƒcleanå†…å­˜é‚£æ ·è¢«å›æ”¶é‡ç”¨ã€‚åœ¨å®‰å“è®¾å¤‡ä¸Šï¼Œå³æ—¶å®ƒè¢«è½¬ç§»åˆ°ZRAMï¼Œå®ƒä»ç„¶ä¼šå ç”¨ï¼ˆåƒæ‰ï¼‰éƒ¨åˆ†çš„ç³»ç»Ÿå†…å­˜ã€‚æ‰€ä»¥åœ¨
<code>dumpsys meminfo</code> çš„ä¾‹å­ä¸­ï¼Œæˆ‘ä»¬ä¼šæ ¼å¤–å…³æ³¨ <em>Private
Dirty</em>ã€‚</p>
<p><strong>Shared</strong>
å†…å­˜èƒ½è¢«æ˜ å°„åˆ°å¤šä¸ªè¿›ç¨‹ä¸­ã€‚è¿™æ„å‘³ç€ä¸åŒè¿›ç¨‹çš„VMAå¯èƒ½ä¼šæŒ‡å‘åŒä¸€å—ç‰©ç†å†…å­˜ã€‚ä¸€ä¸ªå¸¸è§çš„ä¾‹å­æ˜¯é€šç”¨åº“ï¼ˆä¸¾ä¾‹
libc.soï¼Œframwork.dexï¼‰çš„æ–‡ä»¶åå¤‡å†…å­˜ï¼Œæˆ–è€…æ›´ç½•è§çš„ä¸€ä¸ªä¾‹å­æ˜¯ï¼Œä¸€ä¸ªè¿›ç¨‹æ‰§è¡Œäº†
<code>fork()</code>ï¼Œè€Œå­è¿›ç¨‹ç»§æ‰¿äº†æ¥è‡ªå®ƒçš„ dirty å†…å­˜ã€‚</p>
<p>è¿™å°±å¼•å…¥äº†<strong>PSS</strong>ï¼ˆProportional Set Size
æ¯”ä¾‹åˆ†é…é›†å¤§å°ï¼ŒProportional
ç­‰æ¯”åˆ†é…çš„ï¼‰çš„æ¦‚å¿µã€‚åœ¨<strong>PSS</strong>ä¸­ï¼Œå¤šä¸ªè¿›ç¨‹å ç”¨çš„ResidentçŠ¶æ€å†…å­˜ä¼šè¢«ç­‰æ¯”åœ°è¿›è¡Œåˆ†é…ã€‚å¦‚æœæˆ‘ä»¬å°†4KiBé¡µæ˜ å°„åˆ°å››ä¸ªè¿›ç¨‹ï¼Œé‚£ä¹ˆæ¯ä¸ªè¿›ç¨‹çš„<strong>PSS</strong>ä»…ä¼šæ–°å¢1KiBã€‚</p>
<h2 id="å›é¡¾">å›é¡¾</h2>
<ul>
<li>åŠ¨æ€åˆ†é…çš„å†…å­˜ï¼Œåƒæ˜¯é€šè¿‡ Cçš„Â <code>malloc()</code>,
C++çš„Â <code>operator new()</code>Â æˆ–è€… Javaçš„Â <code>new
X()</code>Â è¿›è¡Œåˆ†é…å†…å­˜æ€»æ˜¯ åŒ¿å ä¸” dirty çš„ï¼Œé™¤éå®ƒä»æœªè¢«ä½¿ç”¨è¿‡ã€‚</li>
<li>å¦‚æœå†…å­˜åœ¨ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰è¢«è¯»å†™ï¼Œä¸ºäº†å‡è½»å†…å­˜å‹åŠ›ï¼Œå®ƒä¼šè¢«æ¢å‡ºåˆ°ZRAMä¸Šå¹¶ä¸”è¿›å…¥åˆ°swappedçŠ¶æ€ã€‚</li>
<li>Residentï¼ˆä¸”dirtyï¼‰æˆ–æ˜¯swappedçŠ¶æ€çš„åŒ¿åå†…å­˜æ€»æ˜¯è€—è´¹èµ„æºçš„ï¼Œå¦‚æ— å¿…è¦ï¼Œéœ€è¦å°½å¯èƒ½é¿å…ã€‚</li>
<li>æ¥è‡ªä»£ç ï¼ˆjavaä»£ç ï¼ŒåŸç”Ÿä»£ç ï¼‰çš„æ–‡ä»¶æ˜ å°„å†…å­˜ï¼Œåº“ä»¥åŠèµ„æºæ–‡ä»¶å‡ ä¹æ€»æ˜¯cleançŠ¶æ€ã€‚CleançŠ¶æ€çš„å†…å­˜ä¸€æ ·ä¼šå¸¦æ¥ç³»ç»Ÿå†…å­˜å¼€é”€ï¼Œä½†é€šå¸¸åº”ç”¨å¼€å‘è€…å¯¹å®ƒæ²¡æœ‰å¤ªå¤§æ§åˆ¶æƒã€‚</li>
</ul>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>æ“ä½œç³»ç»Ÿ</category>
        <category>å†…å­˜ç®¡ç†</category>
      </categories>
      <tags>
        <tag>Linux</tag>
        <tag>å†…å­˜ç®¡ç†</tag>
      </tags>
  </entry>
  <entry>
    <title>Protocol Buffers ç¼–ç </title>
    <url>/p/783e3028351b/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="protocol-buffers-ç¼–ç ">Protocol Buffers ç¼–ç </h1>
<p>reference:</p>
<ul>
<li><a
href="https://www.zhihu.com/question/585411183">https://www.zhihu.com/question/585411183</a></li>
<li><a
href="https://protobuf.dev/programming-guides/encoding/">https://protobuf.dev/programming-guides/encoding/</a></li>
</ul>
<p>æœ¬æ–‡ç¿»è¯‘è‡ª<a
href="https://protobuf.dev/programming-guides/encoding/">å®˜æ–¹æ–‡æ¡£</a>ï¼Œè¡¥å……äº†éƒ¨åˆ†å‰ç½®çŸ¥è¯†ä¸å¸®åŠ©ç†è§£çš„ç¤ºä¾‹ã€‚</p>
<h2 id="ç®€ä»‹">ç®€ä»‹</h2>
<p>Protocol Buffers (a.k.a., <em>protobuf</em>) are Google's
language-neutral, platform-neutral, extensible mechanism for serializing
structured data.</p>
<p>Protocol Buffers
æ˜¯Googleç”±æ¨å‡ºçš„ï¼Œè·¨è¯­è¨€ã€è·¨å¹³å°çš„ç”¨äºåºåˆ—åŒ–æ•°æ®ç»“æ„çš„å¯æ‹“å±•æœºåˆ¶ /
åè®®ã€‚</p>
<h2 id="åºåˆ—åŒ–æ ¼å¼">åºåˆ—åŒ–æ ¼å¼</h2>
<p>Protobufçš„ç¼–ç åŸºäºå˜ç§çš„Base128ï¼Œä¸‹é¢å…ˆç®€å•ä»‹ç»Base64ï¼ŒBase128ä»¥åŠZigZagç¼–ç ã€‚</p>
<h3 id="base64ç¼–ç ">Base64ç¼–ç </h3>
<p>reference: <a
href="https://www.zhihu.com/question/585411183">https://www.zhihu.com/question/585411183</a></p>
<p>Base64ç¼–ç çš„è®¾è®¡åˆè¡·æ˜¯ä¸ºäº†è®©æ•°æ®åœ¨è®¾å¤‡é—´ä¼ è¾“æ—¶ï¼Œç›®æ ‡æœºå™¨èƒ½å¤Ÿæ­£ç¡®åœ°â€œç†è§£â€å­—èŠ‚æµä¸­çš„å†…å®¹ï¼šå­—èŠ‚æµä¸­çš„å†…å®¹å‡å¯ä»¥é€šè¿‡asciiå­—ç¬¦æ­£å¸¸æ˜¾ç¤ºã€‚</p>
<span id="more"></span>
<p>ä¸¾ä¾‹ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; è¾“å…¥ä¸‹è¿°å­—èŠ‚æµ
0b10100010 0b00001001 0b11000010 0b11010011
&#x2F;&#x2F; ä»¥6bitsä¸ºå•ä½è¿›è¡Œåˆ†ç»„ï¼Œå¹¶åœ¨æœ€åè¡¥0
0b101000 0b100000 0b100111 0b000010 0b110100 0b110000
&#x2F;&#x2F; æ¥ç€æ¯ä¸€ç»„6bitséƒ½åœ¨é«˜ä½è¡¥0
0b00101000 0b00100000 0b00100111 0b00000010 0b00110100 0b00110000</code></pre>
<p>é™„å›¾Base64ç¼–ç å¯¹ç…§è¡¨</p>
<figure>
<a href="https://s2.loli.net/2024/03/06/oFcVihdBrNn9JDL.png" title="TheBase64Alphabet" class="gallery-item"><img src="https://s2.loli.net/2024/03/06/oFcVihdBrNn9JDL.png"
alt="TheBase64Alphabet" /></a>
<figcaption aria-hidden="true">TheBase64Alphabet</figcaption>
</figure>
<p>æœ€ååœ¨æŒ‰ç…§6bitsä¸€ç»„åˆ’åˆ†åï¼Œå†ä»¥<code>(pad)=</code>
æ ¹æ®4å­—èŠ‚å¯¹é½ï¼Œå¾—åˆ°æœ€ç»ˆç¼–ç ç»“æœã€‚ç¼–ç ç»“æŸåï¼Œä»»æ„å­—ç¬¦æµå°±éƒ½èƒ½ç”¨æ•°å­—ã€å­—æ¯ä»¥åŠ
+ / = ç¬¦å·è¡¨ç¤ºäº†ï¼Œè¿™äº›éƒ½æ˜¯å¯ä»¥è¢«æ­£å¸¸æ˜¾ç¤ºçš„ ascii
å­—ç¬¦ï¼Œasciiå­—ç¬¦åœ¨ç»å¤§å¤šæ•°è®¡ç®—æœºå’Œæ“ä½œç³»ç»Ÿéƒ½è¢«è‰¯å¥½æ”¯æŒäº†ï¼Œå¯è¢«æ­£ç¡®åœ°å¤åˆ¶ã€ä¼ æ’­ã€è§£æã€‚</p>
<p>*åˆ°è¿™é‡Œå°±èƒ½æ„è¯†åˆ°ï¼ŒBase64ç¼–ç å¹¶ä¸æ˜¯è‡ªå·±ä»¥å‰æƒ³çš„ä»€ä¹ˆâ€œBased on
64â€ï¼Œè€Œå®ç¼–ç åçš„ç»“æœä»…æœ‰64ä¸ªå¯è§†çš„asciiå­—ç¬¦ã€‚</p>
<h3 id="base128ç¼–ç ">Base128ç¼–ç </h3>
<p>Base64ç¼–ç å­˜åœ¨çš„ä¸€ä¸ªé—®é¢˜å°±åœ¨äºå¯¹æ¯6æ¯”ç‰¹è¿›è¡Œè¡¥é›¶ï¼Œè¿™æ ·åœ¨æœ€ç†æƒ³çš„æƒ…å†µä¸‹ï¼ˆå³æ— æœ«å°¾è¡¥é›¶ï¼Œä¹Ÿæ— æœ«å°¾4å­—èŠ‚paddingï¼‰ä¹Ÿåªæœ‰75%çš„ç©ºé—´åˆ©ç”¨ç‡ã€‚</p>
<p>æŒ‰ç…§Base64çš„æ€è·¯ï¼Œå¯ä»¥å°†å­—èŠ‚æµæŒ‰ç…§7bitsè¿›è¡Œåˆ†ç»„ï¼Œç„¶ååŒæ ·å¯¹ä½ä½è¡¥0ï¼Œè¡¥è¶³ä¸€ç»„8bitsï¼Œå†è¿›è¡Œæœ«å°¾4å­—èŠ‚paddingã€‚</p>
<p>ä½†æ˜¯é—®é¢˜åœ¨äºï¼Œä½¿ç”¨Base128ä¼šå¯¼è‡´å®é™…éœ€è¦çš„å­—ç¬¦æœ‰128+1ä¸ªï¼Œè€Œasciiå­—ç¬¦é›†åªæœ‰128ä¸ªå¯ç”¨å­—ç¬¦ã€‚åŒæ—¶ï¼Œasciiå­—ç¬¦ä¸­è¿˜åŒ…å«äº†ä¸€äº›ä¸å¯æ­£å¸¸æ‰“å°çš„æ§åˆ¶å­—ç¬¦ï¼Œæ‰€ä»¥Base128æœªèƒ½å®Œå…¨æ›¿æ¢Base64ï¼Œè€Œæ˜¯ä»¥ä¸€äº›å˜ç§å­˜åœ¨ã€‚</p>
<h3 id="zigzagç¼–ç ">ZigZagç¼–ç </h3>
<p>ZigZagç¼–ç æ³•å°†æ­£æ•°ä¸è´Ÿæ•°ç©¿æ’æ’åˆ—ï¼Œä¸€ä¸ªç”¨ä¾‹æ˜¯åœ¨Base128Varintä¸­çš„ä½¿ç”¨ï¼Œç”¨äºé¿å…è´Ÿæ•°å¸¦æœ‰è¿‡å¤šçš„é«˜ä½1ã€‚</p>
<ul>
<li>æ‰€æœ‰çš„æ­£æ•° <code>p</code> å°†è¢«ç¼–ç ä¸º <code>2 *
p</code>ï¼ˆå…¨ä½“å¶æ•°ï¼‰</li>
<li>æ‰€æœ‰çš„è´Ÿæ•° <code>n</code> å°†è¢«ç¼–ç ä¸º <code>2 * |n| - 1</code></li>
</ul>
<p>ç»™å‡ºä¸€ä¸ª ZigZag æ³•ä¸‹çš„ä¾‹å­ï¼š</p>
<table>
<thead>
<tr class="header">
<th>Signed Original</th>
<th>Encoded As</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>0</td>
</tr>
<tr class="even">
<td>-1</td>
<td>1</td>
</tr>
<tr class="odd">
<td>1</td>
<td>2</td>
</tr>
<tr class="even">
<td>-2</td>
<td>3</td>
</tr>
<tr class="odd">
<td>â€¦</td>
<td>â€¦</td>
</tr>
<tr class="even">
<td>0x7fffffff</td>
<td>0xfffffffe</td>
</tr>
<tr class="odd">
<td>-0x80000000</td>
<td>0xffffffff</td>
</tr>
</tbody>
</table>
<p>ç»™å‡º ZigZag
æ³•çš„ä½è®¡ç®—å…¬å¼ï¼Œå¯¹32ä½å¸¦ç¬¦å·æ•°<code>n</code>æœ‰ï¼ˆæ³¨æ„è¿™é‡Œçš„nä½¿ç”¨æ˜¯è´Ÿæ•°çš„äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºï¼‰ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">(n &lt;&lt; 1) ^ (n &gt;&gt; 31)</code></pre>
<p>å¯¹64ä½å¸¦ç¬¦å·æ•°æœ‰ï¼š</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">(n &lt;&lt; 1) ^ (n &gt;&gt; 63)</code></pre>
<h3 id="base128-varints">Base128 Varints</h3>
<p>*ç¡®å®æ˜¯Varintï¼Œè¡¨ç¤ºè¾¹é•¿intï¼Œä¸æ˜¯Variant</p>
<p>Varints are a method of serializing integers using one or more bytes.
Smaller numbers take a smaller number of bytes.</p>
<p><strong>ç‰¹æ€§</strong></p>
<ol type="1">
<li>åªèƒ½å¯¹éƒ¨åˆ†ç±»å‹çš„æ•°æ®è¿›è¡Œç¼–ç ï¼Œä¸é€‚ç”¨äºæ‰€æœ‰å­—èŠ‚æµ</li>
<li>ç¼–ç åçš„å­—èŠ‚å¯ä»¥ä¸å­˜åœ¨äºasciiè¡¨ä¸­ï¼Œå› ä¸ºåº”ç”¨åœºæ™¯ä¸åŒï¼Œä¸éœ€è¦è€ƒè™‘æ˜¯å¦èƒ½å¤Ÿæ­£å¸¸æ‰“å°</li>
</ol>
<p><strong>ç¼–ç æ–¹å¼</strong></p>
<p>å¯¹Base128 varintå¤„ç†åçš„æ¯ä¸ªå­—èŠ‚ï¼Œä½7ä½ç”¨äºå‚¨å­˜æ•°æ®ï¼Œæœ€é«˜ä½ï¼ˆmost
significant
bitï¼Œç®€ç§°msbï¼‰ç”¨äºè¡¨ç¤ºæ­¤å­—èŠ‚åç»­æ˜¯å¦è¿˜æœ‰å†…å®¹ï¼Œå½“msbä¸º1æ—¶è¡¨ç¤ºåç»­è¿˜æœ‰æ•°æ®ï¼Œä¸º0æ—¶è¡¨ç¤ºå½“å‰å­—èŠ‚å·²æ˜¯æœ€åä¸€å­—èŠ‚ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;&#x2F; ä»¥intç±»å‹æ•°å€¼300ä¸ºä¾‹
0b100101100 0x012C
-&gt; 0b[1]0101100 0b[0]0000010</code></pre>
<p>protobufçš„varintsæœ€å¤šå¯ä»¥ç¼–ç 8å­—èŠ‚æ•°æ®ï¼Œå› ä¸ºç°ä»£è®¡ç®—æœºæœ€é«˜ä¹Ÿæ˜¯æ”¯æŒå¤„ç†64ä½æ•´å‹ã€‚</p>
<h2 id="æ”¯æŒçš„æ•°æ®ç±»å‹-wire-type">æ”¯æŒçš„æ•°æ®ç±»å‹ wire type</h2>
<p>protocol buffer
çš„æ¶ˆæ¯æ˜¯ä¸€ç³»åˆ—çš„é”®å€¼å¯¹ï¼Œè€Œåºåˆ—åŒ–çš„binaryä¿¡æ¯ä½¿ç”¨<strong>å­—æ®µåºå·ï¼ˆfield
numberï¼‰</strong>ä½œä¸ºkeyï¼Œæ¯ä¸ªå­—æ®µçš„åå­—å’Œå£°æ˜ç±»å‹ï¼ˆæŒ‡åœ¨ç‰¹å®šè¯­è¨€ä¸­çš„ç±»å‹ï¼Œè€Œä¸æ˜¯wire
typeï¼Œwire
typeæ˜¯å¯ä»¥åœ¨binaryä¿¡æ¯ä¸­æ‰¾åˆ°çš„ï¼‰åªæœ‰åœ¨è§£ç ç«¯å¯ä»¥é€šè¿‡æ¶ˆæ¯ä½“çš„ç±»å‹å®šä¹‰ï¼ˆ.protoï¼Œæˆ–.protoç”Ÿæˆæ–‡ä»¶ï¼‰è·å¾—ã€‚</p>
<p>å½“ä¿¡æ¯è¢«ç¼–ç æ—¶ï¼Œæ¯ä¸€ä¸ªé”®å€¼å¯¹éƒ½è¢«è½¬æ¢ä¸ºä¸€æ¡
<strong><em>è®°å½•(record)</em></strong>ï¼ŒåŒ…å«ä¸‹è¿°å†…å®¹ï¼š</p>
<ol type="1">
<li>wire_type</li>
<li>å­—æ®µåºå·ï¼ˆfield numberï¼‰</li>
<li>æœ‰æ•ˆè´Ÿè½½ï¼ˆpayloadï¼‰</li>
</ol>
<p>æ¯ä¸ªwiretypeéƒ½å‘Šè¯‰è§£æå™¨ï¼ˆparserï¼‰åç»­çš„è´Ÿè½½æœ‰å¤šå¤§ï¼Œæˆ–è€…è¯´åç»­çš„è´Ÿè½½è¯¥å¦‚ä½•è§£æã€‚</p>
<p>æ”¯æŒçš„å…­ç§wire_typeå¦‚ä»¥ä¸‹æ‰€ç¤ºï¼š</p>
<table>
<colgroup>
<col style="width: 6%" />
<col style="width: 9%" />
<col style="width: 84%" />
</colgroup>
<thead>
<tr class="header">
<th>ID</th>
<th>Name</th>
<th>Used For</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>VARINT</td>
<td>int32, int64, uint32, uint64, sint32, sint64, bool, enum</td>
</tr>
<tr class="even">
<td>1</td>
<td>I64</td>
<td>fixed64, sfixed64, double</td>
</tr>
<tr class="odd">
<td>2</td>
<td>LEN</td>
<td>string, bytes, embedded messages, packed repeated fields</td>
</tr>
<tr class="even">
<td>3</td>
<td>SGROUP</td>
<td>group start (deprecated)</td>
</tr>
<tr class="odd">
<td>4</td>
<td>EGROUP</td>
<td>group end (deprecated)</td>
</tr>
<tr class="even">
<td>5</td>
<td>I32</td>
<td>fixed32, sfixed32, float</td>
</tr>
</tbody>
</table>
<p>æ¯æ¡è®°å½•ä¸­çš„æ ‡ç­¾ï¼ˆtagï¼‰éƒ½ä½¿ç”¨å­—æ®µåºå·ï¼Œä»¥åŠwire_typeé€šè¿‡ä»¥ä¸‹å…¬å¼è®¡ç®—å¾—åˆ°ï¼Œè¿™ä¸ªæ ‡ç­¾æœ¬èº«ä¹Ÿä½¿ç”¨VARINTæ ¼å¼ã€‚ä¹Ÿå°±æ˜¯è¯´æ¯ä¸ªå­—æ®µçš„èµ·å§‹varintï¼Œä½ä¸‰ä½è¡¨ç¤ºwire_typeï¼Œè€Œå‰©ä½™å†…å®¹è¡¨ç¤ºå­—æ®µåºå·ã€‚</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">(field_number &lt;&lt; 3) | wire_type</code></pre>
<p>å¯ä»¥å¾—åˆ°tagå†…å®¹ä¸º <code>field_number * 8 + wire_type</code>
çš„äºŒè¿›åˆ¶è¡¨ç¤º</p>
<p>ä¸¾ä¾‹æœ‰ä¸‹è¿°è¾“å…¥ <code>0x0008
0x9601</code>ï¼Œä»¥å°ç«¯è€ƒè™‘ï¼Œè¯»å–å‰ä¸‰ä½å°±èƒ½å¾—åˆ°wire_typeä¸º0ï¼Œå†è¯»å–é«˜ä½å†…å®¹ä¾¿èƒ½å¾—åˆ°å­—æ®µåºå·ä¸º1ã€‚æ¥ä¸‹æ¥ä»¥wire_type
0ç±»å‹VARINTè§£æåç»­å†…å®¹<code>0x9601</code>ï¼Œè¾¹èƒ½å¾—åˆ°payloadå†…å®¹ä¸ºæ•°å€¼150ã€‚</p>
<p>æœ€å¤§æ”¯æŒçš„ field_number æ—¶ï¼Ÿå€¼å¾—ç ”ç©¶ä¸€ä¸‹ã€‚</p>
<h3 id="æ›´å¤šæ•´å‹ç±»å‹">æ›´å¤šæ•´å‹ç±»å‹</h3>
<p><strong>Enum &amp; Bool</strong></p>
<p>æšä¸¾å’Œå¸ƒå°”ç±»å‹éƒ½è¢«ä½œä¸ºint32å¤„ç†ï¼Œä»–ä»¬ä¹Ÿä½¿ç”¨VARINT wire_type
è¿›è¡Œç¼–ç </p>
<p><strong>Signed Integers</strong></p>
<p>varints
è¢«è§†ä½œæ— ç¬¦å·çš„æ•´å‹ï¼Œæ‰€ä»¥åœ¨å¤„ç†å¸¦ç¬¦å·æ•´å‹æœ‰ä¸åŒçš„è¡Œä¸ºï¼šå¦‚æœå¸¦ç¬¦å·æ•°ä½¿ç”¨äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºè´Ÿæ•°ï¼Œè´Ÿæ•°çš„æœ€é«˜ä½å°†æ€»æ˜¯1ã€‚å¦‚æœç›´æ¥æŒ‰ç…§ä¸Šè¿°çš„æ–¹å¼è½¬æ¢ä¸ºvarintï¼Œè´Ÿæ•°å°†å ç”¨æ•´æ•´10ä¸ªå­—èŠ‚ï¼Œè¿™ä¹Ÿæ˜¯varintçš„æœ€å¤§é•¿åº¦ã€‚</p>
<pre class="line-numbers language-c" data-language="c"><code class="language-c">&#x2F;&#x2F; ä¸¾ä¾‹æ•°å€¼sint64 -5çš„äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºè´Ÿæ•°
&#x2F;&#x2F; åŸç ï¼ˆlittle-endian high -&gt; lowï¼‰
00000000 00000000 00000000 00000000 00000000 00000000 00000000 00000101
&#x2F;&#x2F; -5 çš„äºŒè¿›åˆ¶è¡¥ç 
11111111 11111111 11111111 11111111 11111111 11111111 11111111 11111011
&#x2F;&#x2F; æŒ‰7bitsåˆ†ç»„
1 1111111 1111111 1111111 1111111 1111111 1111111 1111111 1111111 1111011
&#x2F;&#x2F; åˆ†ç»„8bitsè¡¥å…¨ï¼Œ10 bytes in total
[0]0000001 [1]1111111 [1]1111111 [1]1111111 [1]1111111 [1]1111111 [1]1111111 [1]1111111 [1]1111111 [1]1111011</code></pre>
<p>ï¼ˆå¤ä¹ ä¸€ä¸‹ï¼Œä½¿ç”¨äºŒè¿›åˆ¶è¡¥ç å–è´Ÿæ•°çš„æ–¹å¼ä¸ºï¼šç›¸åº”æ­£æ•°å–äºŒè¿›åˆ¶åç  + 1 /
æˆ–è€… ~0 - (positive) + 1ï¼‰</p>
<p><code>sintN</code> ä½¿ç”¨ â€œZigZagâ€
æ³•å–ä»£äºŒè¿›åˆ¶è¡¥ç è¿›è¡Œè´Ÿæ•°çš„ç¼–ç ï¼Œè¿™ç§ç¼–ç æ³•å°†æ­£æ•°ä¸è´Ÿæ•°ç©¿æ’æ’åˆ—ï¼Œå¦‚æ­¤ä¸€æ¥ï¼Œè´Ÿæ•°çš„ç¼–ç ç»“æœå°±ä¸ä¼šå› ä¸ºé«˜ä½çš„1å ç”¨è¿‡å¤šå­—èŠ‚äº†ã€‚</p>
<p>å½“ <code>sint32</code> å’Œ <code>sint64</code>
è§£æåï¼Œå€¼ä¼šè¢«é‡æ–°è§£ç ä¼šåŸå…ˆçš„å¸¦ç¬¦å·ï¼ˆäºŒè¿›åˆ¶è¡¥ç ï¼‰å½¢å¼ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œåœ¨
<strong>protoscope</strong> ä¸­ï¼Œä½¿ç”¨ <strong>z</strong>
åç¼€å³è¡¨ç¤ºè¯¥å€¼ä½¿ç”¨ZigZagæ³•ç¼–ç ï¼Œä¾‹ <code>-500z == 999</code> ã€‚</p>
<p><strong>éå˜é•¿æ•°å­—</strong></p>
<p>éå˜é•¿çš„æ•°å€¼ç±»å‹å¾ˆç®€å•ï¼Œ<code>double</code> ä¸ <code>fixed64</code>
éƒ½ä½¿ç”¨ wire_type <code>I64</code>ï¼Œå¯¹åº”çš„ <code>float</code> ä¸
<code>fixed32</code> éƒ½ä½¿ç”¨ wire_type
<code>I32</code>ï¼Œå‰è€…è§£æå™¨å°†è¯»å–8å­—èŠ‚æ•°æ®ï¼Œå¯¹åº”çš„åè€…è¯»å–4å­—èŠ‚æ•°æ®ã€‚</p>
<p>ä½¿ç”¨<code>i64</code>åç¼€ï¼Œæˆ–è€…<code>i32</code>åç¼€æ¥å°†æ•°å€¼æ ‡è®°ä¸ºå¯¹åº”çš„wire_typeã€‚</p>
<h3 id="scalar-value-types">Scalar Value Types</h3>
<p>see <a
href="https://protobuf.dev/programming-guides/proto2/#scalar">https://protobuf.dev/programming-guides/proto2/#scalar</a></p>
<h2 id="é•¿åº¦åˆ†å‰²è®°å½•-record">é•¿åº¦åˆ†å‰²è®°å½• Record</h2>
<p>wire_type(2) ä¸ºç±»å‹ LENï¼Œåœ¨tagåå­˜äº†ä¸€ä¸ª varint
è¡¨ç¤ºçš„æ•´æ•°è¡¨ç¤ºåç»­æœ‰å¤šå°‘å­—èŠ‚å†…å®¹ã€‚è·ç¦»å­—ç¬¦ä¸²â€testingâ€ï¼Œç¼–ç ä¸ºä»¥ä¸‹ç»“æœã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">12 07 [74 65 73 74 69 6e 67]</code></pre>
<p>tag ä¸­çš„ <code>12</code> è½¬æ¢ä¸ºäºŒè¿›åˆ¶è¡¨ç¤ºä¸º<code>00010
010</code>ï¼Œæœ‰wire_type
2ï¼Œå†å¾€åè¯»ä¸€å­—èŠ‚å³å¯å¾—åˆ°åç»­å­—ä¸²çš„é•¿åº¦ä¸º7å­—èŠ‚ã€‚</p>
<p>åŒæ ·çš„ï¼Œ bytes ç±»å‹å­—æ®µä¹Ÿä½¿ç”¨è¿™ç§å½¢å¼è¿›è¡Œç¼–ç ã€‚</p>
<h3 id="åµŒå¥—æ¶ˆæ¯ä½“">åµŒå¥—æ¶ˆæ¯ä½“</h3>
<p>å­æ¶ˆæ¯ä½“åŒæ ·ä½¿ç”¨ <code>LEN</code> wire
typeã€‚å­æ¶ˆæ¯ä½“çš„ç¼–ç ç»“æœä¼šå¦‚åŒä¸Šè¿°å­—ä¸²çš„å†…å®¹å­˜å‚¨åœ¨varinté•¿åº¦æ ‡å¿—åã€‚è¿™åŒæ ·è¦æ±‚äº†é€šä¿¡åŒç«¯å¯¹äºæ¶ˆæ¯ä½“çš„ç»“æ„è¦æœ‰è®¤çŸ¥ï¼Œå¦åˆ™å°±åªçŸ¥é“å­—èŠ‚æ•°ï¼Œè€Œä¸çŸ¥é“å¦‚ä½•åº”å½“è§£æï¼ˆååºåˆ—åŒ–ï¼‰ä¸ºä»€ä¹ˆå¯¹è±¡ã€‚</p>
<h2 id="å¯é€‰ä¸é‡å¤å…ƒç´ -optional-and-repeated">å¯é€‰ä¸é‡å¤å…ƒç´  Optional
and Repeated</h2>
<p>å¯¹äºOptionalå­—æ®µï¼Œå¦‚æœå­—æ®µæœªè¢«è®¾ç½®ï¼Œé‚£ä¹ˆå­—æ®µå°†åœ¨ç¼–ç æ—¶è¢«è·³è¿‡ã€‚</p>
<p>å¯¹äºRepeatedå­—æ®µï¼Œç¼–ç æ—¶å°†ä¼šä¸ºè¿™ä¸ªé›†åˆä¸­çš„æ¯ä¸€ä¸ªå…ƒç´ ç¼–ç ä¸€ä¸ªç›¸åŒçš„tagã€‚åŒæ—¶ç•™æ„ï¼ŒåŒä¸€ä¸ªrepeatedå­—æ®µçš„å…ƒç´ åœ¨ç¼–ç ç»“æœä¸­ä¸ä¸€å®šè¿ç»­ï¼Œä»–ä»¬åªéœ€è¦ä¿è¯ç›¸å¯¹ä½ç½®ä¸å‡ºé”™ã€‚</p>
<p>å¦‚å¯¹ä»¥ä¸‹ç»“æ„ä½“</p>
<pre class="line-numbers language-none"><code class="language-none">message Test4 &#123;
  optional string d &#x3D; 4; &#x2F;&#x2F; è®¾ç½®ä¸º &quot;hello&quot;
  repeated int32 e &#x3D; 5; &#x2F;&#x2F; è®¾ç½®ä¸º &#123;1, 2, 3&#125;
&#125;</code></pre>
<p>åˆ™ç¼–ç ç»“æœå¯èƒ½ä¸º</p>
<pre class="line-numbers language-none"><code class="language-none">4: &#123;&quot;hello&quot;&#125;
5: 1
5: 2
5: 3</code></pre>
<p>ä¹Ÿå¯èƒ½ä¸º</p>
<pre class="line-numbers language-none"><code class="language-none">5: 1
5: 2
4: &#123;&quot;hello&quot;&#125;
5: 3</code></pre>
<h3 id="oneofs">Oneofs</h3>
<p>æ ‡è¯†ä¸ºOneofsçš„å­—æ®µé—´å…±äº«å­˜å‚¨ç©ºé—´ï¼Œè®¾ç½®å…¶ä¸­çš„ä»»ä¸€å­—æ®µå°†æ¸…ç©ºå…¶ä»–å­—æ®µå†…å®¹ï¼Œä½†é™¤æ­¤ä¹‹å¤–å¹¶ä¸å½±å“ç¼–ç é€»è¾‘ï¼Œä¸ä¸Šè¿°å†…å®¹ä¸€è‡´</p>
<h3 id="last-one-wins">Last One Wins</h3>
<p>ä¸€èˆ¬æ¥è¯´ï¼Œç¼–ç çš„ä¿¡æ¯ä¸­ä¸åº”è¯¥å‡ºç°é repeated
å­—æ®µçš„é‡å¤å®ä¾‹ï¼Œä½†Parseré€šè¿‡æä¾›Mergeæ–¹æ³•å¤„ç†äº†è¿™ç§æƒ…å†µï¼Œè¿™ä¹Ÿè®©åˆå¹¶å¤šæ¡ä¿¡æ¯æˆä¸ºå¯èƒ½ã€‚</p>
<p>Parserçš„Mergeè¡Œä¸ºå‡†åˆ™æ˜¯æ¥æ”¶æœ€åä¸€æ¬¡çš„å€¼ç»“æœï¼Œå…·ä½“è¡Œä¸ºï¼š</p>
<ol type="1">
<li>å€¼ç±»å‹å­—æ®µï¼Œåæ¥çš„è¦†ç›–å‰é¢çš„</li>
<li>repeated å­—æ®µï¼Œå†…å®¹å°†è¢«è¿æ¥</li>
<li>åµŒå¥—æ¶ˆæ¯ä½“ï¼Œé€’å½’æ‰§è¡ŒMergeæ“ä½œ</li>
</ol>
<p>æ­¤è§„åˆ™çš„ç›´æ¥ç»“æœæ˜¯ä¸¤æ¡æ¶ˆæ¯çš„å­—èŠ‚æµè¿æ¥åè¿›è¡Œè§£ç ï¼Œä¸å„è‡ªè§£ç åå†å¯¹ç»“æœå®ä¾‹è¿›è¡ŒMergeæ“ä½œï¼Œå°†å¾—åˆ°ä¸€æ ·çš„ç»“æœï¼Œå³</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">MyMessage message;
message.ParseFromString(str1 + str2);</code></pre>
<p>ç­‰åŒäº</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">MyMessage message, message2;
message.ParseFromString(str1);
message2.ParseFromString(str2);
message.MergeFrom(message2);</code></pre>
<h3 id="packed-repeated-fileds">Packed Repeated Fileds</h3>
<p>é™¤ string bytes å¤–çš„ä»»ä½• scalar typeï¼ˆå¯ç®€å•ç†è§£ä¸ºå€¼ç±»å‹ï¼‰ å¯è¢«å£°æ˜ä¸º
packedã€‚proto2 ä¸­ packed éœ€è¦æ˜¾å¼ä½¿ç”¨ <code>[packed=true]</code>
å£°æ˜ï¼Œproto3ä¸­ä¸ºé»˜è®¤å€¼ã€‚</p>
<p>packed çš„ repeated å­—æ®µä¸å†æ¯ä¸ªå…ƒç´ ç‹¬ç«‹ä¸€æ¡è®°å½•ï¼Œè€Œæ˜¯ç¼–ç åˆ°åŒä¸€æ¡
<code>LEN</code>
è®°å½•ä¸­ã€‚è§£ç æ—¶ä¼šå°†é•¿åº¦æ ‡è¯†ç¬¦åç»­çš„å­—èŠ‚æµä¸€ä¸ªä¸€ä¸ªæŒ‰ç…§å£°æ˜çš„ç±»å‹è¿›è¡Œè§£ç ï¼Œä¸‹ä¸€å…ƒç´ çš„èµ·å§‹ä½ç½®å–å†³äºå‰ä¸€å…ƒç´ çš„é•¿åº¦ã€‚</p>
<p>ä¸¾ä¾‹ä¸‹è¿°ç»“æ„ä½“ï¼Œå…¶ä¸­å­—æ®µ f å¡«å……å€¼ä¸º 3ï¼Œ270ï¼Œ86942</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">message Test5 &#123;
  repeated int32 f &#x3D; 6 [packed&#x3D;true];
&#125;</code></pre>
<p>å¯ä»¥å¾—åˆ°æœ‰ä»¥ä¸‹ç¼–ç ç»“æœ</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">3206038e029ea705 &#x2F;&#x2F; hex
3206 03(3) 8e02(270) 9ea705(86942)
00110(field_number&#x3D;6) 010(LEN) 0000 0110(length&#x3D;6bytes) 0000 0011 ...</code></pre>
<p>æ³¨æ„å°½ç®¡åœ¨ç¼–ç çš„ç»“æœä¸­ï¼Œå£°æ˜ä¸ºpackedçš„åŒä¸€å­—æ®µä¸åº”é‡å¤å‡ºç°ï¼Œä½†parserä¾ç„¶è§†å…¶ä¸ºåˆæ³•è¾“å…¥ï¼Œä¸”éœ€è¦å¤„ç†æ­¤æƒ…å†µã€‚å¤„ç†æ–¹å¼ä¸ºå°†é‡å¤å‡ºç°çš„
key-value pair ä¸­valueå†…çš„å…ƒç´ ç›¸è¿ç»„åˆã€‚</p>
<p>åŒæ—¶ï¼Œparseréœ€è¦æ”¯æŒåœ¨æ¶ˆæ¯ä½“å­—æ®µè¢«å£°æ˜ä¸ºpackedä¸‹ï¼Œä¹Ÿèƒ½è§£ææ¥æ”¶åˆ°çš„épackedå­—èŠ‚å†…å®¹ã€‚åä¹‹è¦æ±‚ä»ç„¶æˆç«‹ã€‚é€šè¿‡å¦‚æ­¤è¦æ±‚parserï¼Œä½¿ç”¨è€…åœ¨ä¸ç ´åå‰å‘ã€åå‘å…¼å®¹æ€§çš„æƒ…å†µä¸‹ï¼Œå‘ç°æœ‰çš„å­—æ®µæ–°å¢æˆ–å»é™¤
packed æ ‡è®°ã€‚</p>
<h3 id="maps">Maps</h3>
<p>mapså¸¸è¢«ç”¨äºå­—å…¸/æ˜ å°„ï¼ŒMapså®é™…æ˜¯ç‰¹æ®Šçš„repeated å­—æ®µï¼Œè€ƒè™‘å°†
key=value pair ä½œä¸ºåµŒå¥—ç»“æ„ä½“Entryï¼Œç„¶åä½¿ç”¨ reapted å±æ€§å£°æ˜ï¼Œç¼–ç ä¸º
<code>LEN</code> ç±»å‹çš„è¿ç»­è®°å½•å³å¯ã€‚</p>
<p>ä¸¾ä¾‹ç»“æ„ä½“</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">message Test6 &#123;
  map&lt;string, int32&gt; g &#x3D; 7;
&#125;</code></pre>
<p>å°†è¢«ç¼–ç ä¸º</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">message Test6 &#123;
  message g_Entry &#123;
    optional string key &#x3D; 1;
    optional int32 value &#x3D; 2;
  &#125;
  repeated g_Entry g &#x3D; 7;
&#125;</code></pre>
<p>è€ƒè™‘é packed çš„ç¼–ç ç»“æœä¸ºï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">[7|LEN][single_entry_length]&#123;[1|LEN][length][key][2|VARINT][value]&#125;
[7|LEN][single_entry_length]&#123;[1|LEN][length][key][2|VARINT][value]&#125;...</code></pre>
<p>map åŒæ ·å¯ä»¥å£°æ˜ï¼ˆæˆ–é»˜è®¤ä¸ºï¼‰packedã€‚</p>
<h2 id="å­—æ®µé¡ºåº-field-order">å­—æ®µé¡ºåº Field Order</h2>
<p><code>.proto</code>
æ–‡ä»¶å¹¶æ²¡æœ‰å¯¹å­—æ®µåºå·çš„é¡ºåºè¿›è¡Œè¦æ±‚ï¼Œä¸”é¡ºåºå¹¶ä¸å½±å“æ¶ˆæ¯ä½“çš„åºåˆ—åŒ–è¡Œä¸ºã€‚</p>
<p>æ¶ˆæ¯ä½“è¢«åºåˆ—åŒ–æ—¶ï¼Œåºåˆ—åŒ–å™¨å¹¶ä¸èƒ½ä»¥ç¡®å®šçš„é¡ºåºå¯¹å·²çŸ¥çš„ã€æˆ–æœªçŸ¥çš„å­—æ®µè¿›è¡Œå†™å…¥ï¼ˆåºåˆ—åŒ–ï¼‰ï¼Œè¿™å–å†³äºå…·ä½“å®ç°ã€‚å› æ­¤ï¼Œprotol
buffer çš„åºåˆ—åŒ–å™¨å¿…é¡»åœ¨ä»»ä½•çš„è¯»å…¥é¡ºåºä¸‹éƒ½èƒ½å¤Ÿè§£æå­—æ®µã€‚</p>
<h3 id="å½±å“-implications">å½±å“ Implications</h3>
<ul>
<li>ä¸è¦å‡å®šåºåˆ—åŒ–ä¿¡æ¯çš„å­—èŠ‚è¾“å‡ºæ˜¯ç¨³å®šçš„ã€‚å¯¹äºé‚£äº›æ‹¥æœ‰ä¸€ä¸ª bytes
å­—æ®µç”¨äºæºå¸¦å¦ä¸€ä¸ªæ¶ˆæ¯ä½“çš„å¤§æ¶ˆæ¯ä½“ç‰¹åˆ«è¦æ³¨æ„è¿™ç‚¹ã€‚</li>
<li>å¯¹åŒä¸€ä¸ªæ¶ˆæ¯ä½“å®ä¾‹çš„å¤šæ¬¡åºåˆ—åŒ–æ“ä½œï¼Œå¹¶ä¸ä¿è¯èƒ½å¤Ÿæœ‰ç›¸åŒçš„å­—èŠ‚è¾“å‡ºï¼Œå³åºåˆ—åŒ–æ“ä½œå¹¶ä¸æ‹¥æœ‰ç¡®å®šæ€§ã€‚
<ul>
<li>ç¡®å®šæ€§åªæœ‰åœ¨åŒä¸€ä¸ªç‰ˆæœ¬çš„protocol buffer
å¯æ‰§è¡Œç¨‹åºä¸‹å¯ä»¥åŠè¯ï¼Œä¸åŒç‰ˆæœ¬é—´å¯èƒ½æœ‰ä¸åŒï¼ˆåŸæ–‡ä¸ºâ€œDeterministic
serialization only guarantees the same byte output for a particular
binaryâ€ï¼‰ã€‚</li>
</ul></li>
<li>å› æ­¤æœ‰ protocol buffer çš„æ¶ˆæ¯ä½“å®ä¾‹ fooï¼Œå…¶å¤æ•°æ¬¡
<code>SerializeAsString()</code> è¾“å‡ºï¼Œä»¥åŠç›¸åº”çš„ <code>Hash/CRC</code>
ç»“æœç­‰å‡ä¸èƒ½ä¿è¯ç›¸ç­‰</li>
<li>åœ¨ä¸‹è¿°æƒ…æ™¯ä¸­ï¼Œé€»è¾‘ç›¸ç­‰çš„ protocol buffer æ¶ˆæ¯ä½“å®ä¾‹ <code>foo</code>
ä¸ <code>bar</code> å¯èƒ½æœ‰ä¸åŒçš„åºåˆ—åŒ–è¾“å‡ºï¼š
<ul>
<li>å¯¹ <code>bar</code> è¿›è¡Œåºåˆ—åŒ–çš„æœåŠ¡å™¨ä½¿ç”¨äº†å¦ä¸€ç§è¯­è¨€çš„
protoå®ç°</li>
<li>å¯¹ <code>bar</code> è¿›è¡Œåºåˆ—åŒ–çš„æœåŠ¡å™¨æ›´æ–°äº† proto å®ç°</li>
<li>å¯¹ <code>bar</code> è¿›è¡Œåºåˆ—åŒ–æ—¶ï¼Œä¸€äº›æ–°å¢å­—æ®µè¢«å¤„ç†ä¸º unknown</li>
<li><code>bar</code> ä¸­å­˜åœ¨éç¡®å®šæ€§å­—æ®µ</li>
<li><code>bar</code> ä¸­å­˜åœ¨ bytes
ç±»å‹å­—æ®µï¼Œå…¶å†…å®¹ä¸ºå¦ä¸€ä¸ªæ¶ˆæ¯ä½“çš„åºåˆ—åŒ–ç»“æœ</li>
<li><code>foo</code> ä¸ <code>bar</code>
æ˜¯å¤šä¸ªç›¸åŒæ¶ˆæ¯ä½“å®ä¾‹ä»¥ä¸åŒé¡ºåºç›¸è¿æ¥çš„ç»“æœ</li>
</ul></li>
</ul>
<h2 id="ç¼–ç å¤§å°é™åˆ¶">ç¼–ç å¤§å°é™åˆ¶</h2>
<p>åºåˆ—åŒ–ç»“æœå¿…é¡»å°äº 2GiBï¼Œè®¸å¤š proto
å®ç°ä¼šæ‹’ç»åºåˆ—åŒ–ï¼Œæˆ–è€…è§£æè¶…è¿‡è¿™ä¸ªé™åˆ¶çš„æ¶ˆæ¯ä½“ã€‚</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ä¿¡æ¯è®º</category>
      </categories>
      <tags>
        <tag>ç¼–ç æ–¹æ¡ˆ</tag>
      </tags>
  </entry>
  <entry>
    <title>.NET source ç³»åˆ—ï¼šSystem.Collections.Generic.List</title>
    <url>/p/e5c0cabb6711/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1
id="system.collections.generic.list">System.Collections.Generic.List</h1>
<p>å‚è€ƒç‰ˆæœ¬ä¸º .net framework 4.8</p>
<p><a
href="https://referencesource.microsoft.com/#mscorlib/system/collections/generic/list.cs">https://referencesource.microsoft.com/#mscorlib/system/collections/generic/list.cs</a></p>
<h2 id="æ‘˜è¦">æ‘˜è¦</h2>
<ul>
<li>æ³›å‹ç±»å‹ <code>List&lt;T&gt;</code>ï¼Œå®ç°æ¥å£
IList&lt;T&gt;ï¼ŒIReadOnlyList&lt;T&gt;</li>
<li>ä½¿ç”¨æ•°ç»„ <code>T[] _items</code> å®ç°ï¼Œå½“å‰å·²å­˜å‚¨çš„å…ƒç´ ä¸ªæ•°ä¸º
<code>_size</code> / <code>Count</code>ï¼Œå½“å‰å®¹é‡å¤§å°é€šè¿‡
Capacityå¾—åˆ°ï¼Œç›´æ¥è¿”å›æ•°ç»„ <code>_items</code> çš„é•¿åº¦ã€‚</li>
</ul>
<span id="more"></span>
<h2 id="ä¸»è¦è¡Œä¸º">ä¸»è¦è¡Œä¸º</h2>
<h3 id="æ„é€ å‡½æ•°-ctor">æ„é€ å‡½æ•° ctor</h3>
<ul>
<li>ä½¿ç”¨ List çš„æ— å‚æ„é€ å‡½æ•°ï¼Œä¼šå°†Listå†…éƒ¨çš„é™æ€ç©ºæ•°ç»„ <code>static
readonly T[] _emptyArray = new T[0]</code> è®¾ç½®åˆ° <code>_items</code>
ä¸Šï¼Œè¿™æ˜¯ä¸€ä¸ªä½¿ç”¨é™æ€å˜é‡é¿å…é›¶å¤§å°æ•°ç»„é‡å¤åˆ›å»ºçš„æŠ€å·§ã€‚</li>
<li>ä½¿ç”¨å¸¦ <code>capacity</code>
å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œå¯ä»¥åœ¨æ„é€ æ—¶å°±åˆ†é…å‡ºæŒ‡å®šå¤§å°çš„æ•°ç»„ï¼Œé¿å…åç»­æ·»åŠ å…ƒç´ æ—¶çš„æ‰©å®¹ã€‚</li>
<li>ä½¿ç”¨ <code>IEnumerable&lt;T&gt; collection</code>
å‚æ•°çš„æ„é€ å‡½æ•°ï¼Œä¼šåœ¨å†…éƒ¨å…ˆæ£€æŸ¥æ˜¯å¦èƒ½è½¬æ¢ä¸º
<code>ICollection&lt;T&gt;</code>ï¼Œè¿™æ ·ç›´æ¥å¼€è¾Ÿå®šé•¿æ•°ç»„å¹¶ç›´æ¥
<code>CopyTo</code> æ˜¯æ›´é«˜æ•ˆçš„ï¼›å¦åˆ™å³ä½¿ç”¨ <code>GetEnumerator</code>
å¹¶éå†å…ƒç´ è¿›è¡Œ <code>Add()</code> çš„æ–¹å¼è¿›è¡Œæ„é€ ã€‚</li>
</ul>
<h3 id="prop-capacity">(prop) Capacity</h3>
<p>getter è·å–æ—¶ç›´æ¥è¿”å›å†…éƒ¨æ•°ç»„çš„é•¿åº¦</p>
<p>setter
é¦–å…ˆä¿è¯è®¾ç½®çš„å®¹é‡å¤§äºå…ƒç´ ä¸ªæ•°ï¼›å…¶æ¬¡è®¾ç½®çš„å®¹é‡å€¼é0ï¼Œç›´æ¥åˆ†é…å¯¹åº”å¤§å°çš„æ–°æ•°ç»„ï¼Œå¹¶å°†åŸå†…å®¹
<code>Array.Copy</code> ï¼Œåœ¨å®¹é‡å€¼ä¸º0çš„æƒ…å†µä¸‹ç›´æ¥ä»¤ <code>_items</code>
æŒ‡å‘ <code>_emptyArray</code></p>
<h3 id="prop-count">(prop) Count</h3>
<p>ä»… getterï¼Œç›´æ¥è¿”å›ä»£è¡¨å½“å‰å…ƒç´ ä¸ªæ•°çš„ <code>_size</code></p>
<h3 id="ensurecapacityint-min">EnsureCapacity(int min)</h3>
<p>åªæœ‰åœ¨ä¼ å…¥çš„minå¤§äºå†…éƒ¨æ•°ç»„é•¿åº¦æ—¶æ‰ä¼šå·¥ä½œã€‚</p>
<p>è‹¥å†…éƒ¨æ•°ç»„é•¿åº¦ä¸º0ï¼Œé‚£ä¹ˆç¬¬ä¸€æ¬¡æ‰©å®¹çš„é•¿åº¦ä¼šæ˜¯<strong>_defaultCapacity</strong>ï¼Œè¿™ä¸ªå€¼åœ¨å‚è€ƒçš„æºç ä¸­æ˜¯4ã€‚</p>
<p>è‹¥ä¸æ˜¯ç¬¬ä¸€æ¬¡æ‰©å®¹ï¼Œé‚£ä¹ˆé¢„æœŸçš„æ‰©å®¹é•¿åº¦æ˜¯<strong>å½“å‰æ•°ç»„é•¿åº¦
x2</strong>ã€‚</p>
<p>Capacityå­˜åœ¨ä¸Šç•Œï¼Œè¿™ä¸ªå€¼ä¸º
<code>Array_ReferenceSources.MaxArrayLength</code>ï¼Œè¿™ä¸ªå€¼ä¸º
<code>0X7FEFFFFF</code>ï¼ˆ2äº¿å¤šä¸€äº›ï¼‰ã€‚æ‰©å®¹çš„å¤§å°ä¸ä¼šè¶…è¿‡è¿™ä¸ªæ•°å€¼ã€‚</p>
<p>è‹¥é¢„æœŸæ‰©å®¹åçš„ä¸ªæ•°ä»ç„¶æ²¡æœ‰è¾¾åˆ°ä¼ å…¥çš„minï¼Œé‚£ä¹ˆç›´æ¥è®©æ–°çš„å®¹é‡å¤§å°ç­‰äºä¼ å…¥çš„minã€‚</p>
<p>æœ€åè¿™ä¸ª <code>newCapactiy</code> é€šè¿‡ä¸Šè¿° Capacity çš„ setter
è¿›è¡Œæ‰©å®¹ã€‚</p>
<h3 id="addt-item">Add(T item)</h3>
<p>è‹¥å½“å‰å…ƒç´ ä¸ªæ•°å·²è¾¾å†…éƒ¨æ•°ç»„å¤§å°ä¸Šé™ï¼Œé€šè¿‡
<code>EnsureCapacity(_size+1)</code> æ¥æ‰©å®¹</p>
<p>æ‰©å®¹åï¼Œæ–°å…ƒç´  item ä¼šè¢«æ”¾ç½®åˆ°æ–°æ•°ç»„çš„ _size++ ä½ç½®ä¸Š</p>
<p>*æ­¤æ–¹æ³•ä¼šæ›´æ–° _version</p>
<h3 id="clear">Clear()</h3>
<p>Clear æ–¹æ³•åªæ˜¯é‡Šæ”¾äº†å†…éƒ¨æ•°ç»„ä¸­æ¯ä¸ªå…ƒç´ çš„å¼•ç”¨ï¼Œå¹¶ä¸”å°† _size
é‡ç½®ä¸º0ï¼Œå³å†…éƒ¨æ•°ç»„ä»ç„¶å­˜åœ¨ Capacity
å³ç›¸åº”çš„å†…å­˜å ç”¨ï¼ŒåŒæ—¶ä¹Ÿå¾ˆå¯èƒ½ä¸ä¼šåœ¨ä¸‹ä¸€æ¬¡ Add() ä¸­å‘ç”Ÿæ‰©å®¹ã€‚</p>
<p>*æ­¤æ–¹æ³•ä¼šæ›´æ–° _version</p>
<h3 id="containst-item">Contains(T item)</h3>
<p>è‹¥ä¼ å…¥itemä¸ºnullï¼Œåˆ™è¿›è¡Œå†…éƒ¨æ•°ç»„æ‰€æœ‰å…ƒç´ ï¼ˆè½¬æ¢ä¸ºObjectï¼‰çš„null-check</p>
<p>è‹¥ä¸ä¸ºnullï¼Œåˆ™è·å–ç±»å‹Tçš„é»˜è®¤æ¯”è¾ƒå™¨è¿›è¡Œéå†æ¯”è¾ƒ</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">EqualityComparer&lt;T&gt; c &#x3D; EqualityComparer&lt;T&gt;.Default;
for(int i&#x3D;0; i&lt;_size; i++) &#123;
    if (c.Equals(_items[i], item)) return true;
&#125;
return false;</code></pre>
<h3 id="insertint-index-t-item">Insert(int index, T item)</h3>
<p>è‹¥Listå†…éƒ¨å…ƒç´ ä»¥è¾¾åˆ°å†…éƒ¨æ•°ç»„ä¸Šé™ï¼Œè§¦å‘ _size + 1 æ‰©å®¹ã€‚</p>
<p>å°†æ’å…¥ä½ç½®å¾€åçš„æ‰€æœ‰å…ƒç´ ä½¿ç”¨ <code>Array.Copy</code>
å…¨éƒ¨å³ç§»ã€‚Listå†…éƒ¨å…ƒç´ æ•°å¢åŠ ã€‚</p>
<p>*æ­¤æ–¹æ³•ä¼šæ›´æ–° _version</p>
<h3 id="insertrangeint-index-ienumerablet-collection">InsertRange(int
index, IEnumerable&lt;T&gt; collection)</h3>
<p>åŒæ ·ä¼šæ£€æµ‹ä¼ å…¥çš„ collection æ˜¯å¦æ˜¯ ICollectionï¼Œå¯¹äºä¸æ˜¯ ICollection
çš„æƒ…å†µæ¯”è¾ƒç®€å•ï¼Œä½¿ç”¨ <code>GetEnumerator()</code> éå†æ•´ä¸ª
collectionï¼Œé€ä¸€è¿›è¡Œ <code>Insert()</code>å³å¯ã€‚</p>
<p>å¯¹äºæ˜¯ ICollection çš„æƒ…å†µï¼š</p>
<ul>
<li>ä½¿ç”¨ _size + collection.Count å¤§å°è¿›è¡Œæ‰©å®¹</li>
<li>å°†æ’å…¥ index å¾€åçš„å†…å®¹ copy åˆ° index + count ä½ç½®</li>
<li>è‹¥å½“å‰æ’å…¥çš„ collection æ˜¯è‡ªå·±ï¼š
<ol type="1">
<li>å°†æ’å…¥ index å‰çš„å†…å®¹å¤åˆ¶åˆ° index ä½ç½®</li>
<li>å°†å‰é¢ä¿å­˜åœ¨ index + count ä½ç½®çš„å°¾éƒ¨å†…å®¹é‡æ–°å¤åˆ¶ä¸º index * 2 çš„ä½ç½®
[ part1 | (index) part1 | (index*2) part2 | (index+count) part2 ]</li>
</ol></li>
<li>è‹¥å½“å‰æ’å…¥çš„ collection ä¸æ˜¯è‡ªå·±ï¼šæ–°å¼€è¾ŸæŒ‡å®š Count å¤§å°çš„æ•°ç»„ï¼Œç›´æ¥
Copy åˆ° index ä½ç½®</li>
</ul>
<p>*æ­¤æ–¹æ³•ä¼šæ›´æ–° _version</p>
<h3 id="removet-item">Remove(T item)</h3>
<p>å®ç°ä¸º IndexOf(T item) å’Œ RemoveAt(int index) çš„ç»„åˆ</p>
<h3 id="removeatint-index">RemoveAt(int index)</h3>
<p>è‹¥æŒ‡å®šå°æ ‡å¤§äºç­‰äº _size å°†æŠ›å‡ºè¶Šç•Œå¼‚å¸¸</p>
<p>å‡å°Listçš„å…ƒç´ æ•°é‡ _sizeï¼Œå½“ index &lt; _size æ—¶è¿›è¡Œ Array.Copy</p>
<p>å› ä¸ºè‹¥éœ€è¦ç§»é™¤çš„ä½ç½®æ˜¯å½“å‰å…ƒç´ çš„æœ«å°¾ï¼Œç›´æ¥æ‰§è¡Œåç»­çš„
<code>_items[_size] = default(T)</code> å³å¯ï¼Œä¸éœ€è¦ç§»åŠ¨æ•°ç»„å…ƒç´ </p>
<p>*æ­¤æ–¹æ³•ä¼šæ›´æ–° _version</p>
<h3 id="removerangeint-index-int-count">RemoveRange(int index, int
count)</h3>
<p>RemoveRangeä¼šåœ¨æ–¹æ³•èµ·å§‹åšä¸€ç³»åˆ—è¶Šç•Œæ£€æµ‹ã€‚</p>
<p>å‰©ä¸‹çš„å†…å®¹ä¸ RemoveAt å·®åˆ«ä¸å¤§ï¼Œ_size
ä¼šå‡å»æŒ‡å®šçš„Countï¼ŒåŒæ—¶è¿›è¡Œæ•°ç»„çš„Copyã€‚</p>
<p>å·®åˆ«è¾ƒå¤§çš„æ˜¯è¿™é‡Œå¹¶ä¸å°†æ•°ç»„å…ƒç´ é€ä¸€è®¾ç½®ä¸º default(T)ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨
<code>Array.Clear</code> æŠ¹æ‰æŒ‡å®šä½ä¸Šçš„å†…å®¹ã€‚</p>
<p>ä¸ªäººè€Œè¨€ <code>Array.Clear</code>
å¹¶ä¸ç‰¹åˆ«å¸¸ç”¨ï¼Œåç»­å¯ä»¥å¤šå…³æ³¨è¿™ä¸€ç±»æ•°ç»„æä¾›çš„æ–¹æ³•ã€‚</p>
<p>*æ­¤æ–¹æ³•ä¼šæ›´æ–° _version</p>
<h3 id="trimexcess">TrimExcess()</h3>
<p>å°†Listçš„å†…éƒ¨æ•°ç»„å¤§å°ï¼Œå³å®¹é‡å¤§å°ï¼Œè®¾ç½®ä¸ºä¸¥æ ¼ä¸ _size
ä¸€è‡´ã€‚åªæœ‰ç”¨è¿™ä¸ªæ–¹æ³•ï¼ˆæˆ–è€…æ‰‹åŠ¨è®¾ç½®Capacityï¼‰èƒ½å¤ŸçœŸæ­£ç¼©å°Listçš„å†…éƒ¨æ•°ç»„å†…å­˜å ç”¨ï¼Œè¿™åœ¨å·²çŸ¥Listä¸ä¼šå†æœ‰æ–°å…ƒç´ æ—¶ç›¸å½“æœ‰ç”¨ã€‚</p>
<p>æƒ³è¦å®Œå…¨æ¸…ç©ºä¸€ä¸ªListå¹¶ä¸”é‡Šæ”¾æ‰€æœ‰å†…å­˜ï¼Œæ­£ç¡®çš„åšæ³•æ˜¯ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">list.Clear();
list.TrimExcess();</code></pre>
<h2 id="enumerator">Enumerator</h2>
<p>æ„é€  Enumerator æ—¶ï¼Œå†…éƒ¨ä¼šå­˜æœ‰åŸ List
å¯¹è±¡å¼•ç”¨ï¼Œæ–°å¢è¡¨ç¤ºéå†ä¸‹æ ‡çš„indexï¼Œè¡¨ç¤ºå½“å‰å…ƒç´ çš„Currentï¼ˆæ„é€ æ—¶è®¾ç½®ä¸º
default(T)ï¼‰ï¼Œå¹¶ä¸”è®°å½•æ„é€ æ—¶listçš„ç‰ˆæœ¬
list._versionï¼Œé˜²æ­¢éå†è¿‡ç¨‹ä¸­listå†…å®¹å‘ç”Ÿæ”¹å˜ã€‚</p>
<p>å¦‚æœåœ¨MoveNextè¿‡ç¨‹ä¸­ï¼Œversionå‘ç”Ÿäº†æ”¹å˜ï¼Œé‚£ä¹ˆå°†ä¼šç«‹å³æŠ›å‡º
<code>InvalidOperation_EnumFailedVersion</code> å¼‚å¸¸ã€‚</p>
<p>ç¬¬ä¸€æ¬¡è°ƒç”¨ <code>MoveNext()</code>
åï¼Œindexå’ŒCurrentä¾¿ä¼šæ˜¯Listå†…éƒ¨çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä½ç½®ã€‚æœ€åä¸€æ¬¡è°ƒç”¨
<code>MoveNext()</code> åï¼Œå°†ä¼šè¿›å…¥æ–¹æ³•
<code>MoveNextRare()</code>ï¼Œæ­¤æ—¶indexç­‰äº_sizeï¼ŒCurrentæ¢å¤ä¸ºdefault(T)ï¼Œ<code>MoveNextRare()</code>
å°†ä¼šè¿”å› False ä¿è¯éå†è¿‡ç¨‹åœæ­¢ã€‚</p>
<h2 id="what-about-unity">What about Unity?</h2>
<h3 id="working-with-2018.4.11f1">working with 2018.4.11f1</h3>
<p>æµ‹è¯•ç¯å¢ƒä¿¡æ¯ï¼š</p>
<ul>
<li>API Compatibiliy Level: .NET 2.0 Subset</li>
<li>Scripting Runtime: 3.5 equivalent</li>
<li>Unity version: 2018.4.11f1</li>
</ul>
<p>å†™åˆ°è¿™é‡Œæ—¶ï¼Œæ­£å¥½åœ¨ä¸€ä¸ªä½¿ç”¨è¾ƒä½ç‰ˆæœ¬Unityçš„é¡¹ç›®ç»„ä¸­å‚ä¸å¼€å‘å·¥ä½œï¼Œå› æ­¤è™½ç„¶å·²æœ‰è€³é—»é«˜ç‰ˆæœ¬çš„Unityåœ¨æ³›å‹å…±äº«æ–¹é¢æœ‰åšä¼˜åŒ–ï¼Œé˜…è¯»il2cppè¾“å‡ºå¯èƒ½æ„ä¹‰ä¸å¤§ï¼Œä½†è¿˜æ˜¯å‡ºäºå¥½å¥‡è§‚å¯Ÿäº†ä¸‹
<code>System.Collections.Generic.List</code> åœ¨ä½ç‰ˆæœ¬ unity / il2cpp
ä¸‹çš„ç”Ÿæˆå†…å®¹ã€‚</p>
<p>ç²—çœ‹ä¹‹ä¸‹ç±»å‹æˆå‘˜ï¼Œä»¥åŠé™æ€ç±»å‹æˆå‘˜çœ‹ä¸Šå»æ²¡æœ‰ä»€ä¹ˆä¸åŒã€‚</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">&#x2F;&#x2F; System.Collections.Generic.List&#96;1&lt;System.Int32&gt;
struct  List_1_t4A961510635950236678F1B3B2436ECCAF28713A  : public RuntimeObject
&#123;
public:
    &#x2F;&#x2F; T[] System.Collections.Generic.List&#96;1::_items
    Int32U5BU5D_t20AF77B812DFA3168922AE8F35FB9FD20D7EA074* ____items_1;
    &#x2F;&#x2F; System.Int32 System.Collections.Generic.List&#96;1::_size
    int32_t ____size_2;
    &#x2F;&#x2F; System.Int32 System.Collections.Generic.List&#96;1::_version
    int32_t ____version_3;
&#125;;

struct List_1_t4A961510635950236678F1B3B2436ECCAF28713A_StaticFields
&#123;
public:
    &#x2F;&#x2F; T[] System.Collections.Generic.List&#96;1::EmptyArray
    Int32U5BU5D_t20AF77B812DFA3168922AE8F35FB9FD20D7EA074* ___EmptyArray_4;
&#125;;</code></pre>
<p>ä½†æ˜¯æ²¡æœ‰å‘ç° <code>EnsureCapacity</code>ï¼Œå–è€Œä»£ä¹‹çš„æ˜¯
<code>GrowIfNeeded</code> æ–¹æ³•ã€‚</p>
<pre class="line-numbers language-cpp" data-language="cpp"><code class="language-cpp">&#x2F;&#x2F; System.Void System.Collections.Generic.List&#96;1&lt;System.Object&gt;::GrowIfNeeded(System.Int32)
extern &quot;C&quot; IL2CPP_METHOD_ATTR void List_1_GrowIfNeeded_m3C3B2872122BDF013830789D49EE77F7880CDEC5_gshared (List_1_tE72A517BD14F52539FF78EA90F58D1387FEED660 * __this, int32_t ___newCount0, const RuntimeMethod* method)
&#123;
    int32_t V_0 &#x3D; 0;
    &#123;
        int32_t L_0 &#x3D; (int32_t)__this-&gt;get__size_2();
        int32_t L_1 &#x3D; ___newCount0;
        V_0 &#x3D; (int32_t)((int32_t)il2cpp_codegen_add((int32_t)L_0, (int32_t)L_1));
        int32_t L_2 &#x3D; V_0;
        ObjectU5BU5D_t8D571697F3A1B33B696E2F80500C21F1A1748C5D* L_3 &#x3D; (ObjectU5BU5D_t8D571697F3A1B33B696E2F80500C21F1A1748C5D*)__this-&gt;get__items_1();
        NullCheck(L_3);
        if ((((int32_t)L_2) &lt;&#x3D; ((int32_t)(((int32_t)((int32_t)(((RuntimeArray *)L_3)-&gt;max_length)))))))
        &#123;
            goto IL_0031;
        &#125;
    &#125;
    &#123;
        NullCheck((List_1_tE72A517BD14F52539FF78EA90F58D1387FEED660 *)__this);
        int32_t L_4 &#x3D; ((  int32_t (*) (List_1_tE72A517BD14F52539FF78EA90F58D1387FEED660 *, const RuntimeMethod*))IL2CPP_RGCTX_METHOD_INFO(method-&gt;klass-&gt;rgctx_data, 18)-&gt;methodPointer)((List_1_tE72A517BD14F52539FF78EA90F58D1387FEED660 *)__this, &#x2F;*hidden argument*&#x2F;IL2CPP_RGCTX_METHOD_INFO(method-&gt;klass-&gt;rgctx_data, 18));
        int32_t L_5 &#x3D; Math_Max_m8B815B13982D8738EF051EA87C1CCB722CDF29B2((int32_t)((int32_t)il2cpp_codegen_multiply((int32_t)L_4, (int32_t)2)), (int32_t)4, &#x2F;*hidden argument*&#x2F;NULL);
        int32_t L_6 &#x3D; V_0;
        int32_t L_7 &#x3D; Math_Max_m8B815B13982D8738EF051EA87C1CCB722CDF29B2((int32_t)L_5, (int32_t)L_6, &#x2F;*hidden argument*&#x2F;NULL);
        NullCheck((List_1_tE72A517BD14F52539FF78EA90F58D1387FEED660 *)__this);
        ((  void (*) (List_1_tE72A517BD14F52539FF78EA90F58D1387FEED660 *, int32_t, const RuntimeMethod*))IL2CPP_RGCTX_METHOD_INFO(method-&gt;klass-&gt;rgctx_data, 19)-&gt;methodPointer)((List_1_tE72A517BD14F52539FF78EA90F58D1387FEED660 *)__this, (int32_t)L_7, &#x2F;*hidden argument*&#x2F;IL2CPP_RGCTX_METHOD_INFO(method-&gt;klass-&gt;rgctx_data, 19));
    &#125;

IL_0031:
    &#123;
        return;
    &#125;
&#125;</code></pre>
<p>è¿™å°±éœ€è¦æˆ‘ä»¬æŒ‰ç…§ä¸Šè¿°æµ‹è¯•ç¯å¢ƒæ‰¾åˆ°å‡†ç¡®çš„Monoç‰ˆæœ¬äº†ï¼Œå·²çŸ¥å½“å‰çš„
Scripting runtime å¯¹é½ï¼ˆequivalentï¼‰ .NET framework
3.5ï¼Œæ ¹æ®ä»¥ä¸‹è¡¨æ ¼å¯ä»¥å¯¹åº”åˆ° C# 3.0 ç‰ˆæœ¬ã€‚</p>
<figure>
<a href="https://s2.loli.net/2024/08/29/7LYwAR2mQ9XNdZ4.png" title="csharp-with-dotnet-framework-version" class="gallery-item"><img src="https://s2.loli.net/2024/08/29/7LYwAR2mQ9XNdZ4.png"
alt="csharp-with-dotnet-framework-version" /></a>
<figcaption
aria-hidden="true">csharp-with-dotnet-framework-version</figcaption>
</figure>
<p>å†æ ¹æ®è¿™å¼ è¡¨æ ¼å¯ä»¥å¾—åˆ° Mono å®ç° C# 3.0 çš„ç›¸åº”ç‰ˆæœ¬ä¸º mono
2.0ï¼Œè¿™æ ·å°±æ‰¾åˆ°æˆ‘ä»¬çš„æºç ç›®æ ‡äº†ã€‚éœ€è¦é¢å¤–æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œçš„è¡¨æ ¼ä¸­çš„ .net
2.0 æ˜¯ä¸ç°ä»£ .net 6/7/8 çš„åŒä¸€å¥—æ ‡å‡†çš„ä¸åŒç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯æŒ‡ .NET Standard
2.0ï¼Œä¸è¦æŠŠï¼ˆå¾ˆå®¹æ˜“ææ··çš„ï¼‰æ¦‚å¿µææ··äº†ã€‚</p>
<figure>
<a href="https://s2.loli.net/2024/08/29/Fe2TCPKOb5QZqcB.png" title="mono-with-dotnet-version" class="gallery-item"><img src="https://s2.loli.net/2024/08/29/Fe2TCPKOb5QZqcB.png"
alt="mono-with-dotnet-version" /></a>
<figcaption aria-hidden="true">mono-with-dotnet-version</figcaption>
</figure>
<p>from: <a
href="https://www.cnblogs.com/zhaoqingqing/p/5762867.html">https://www.cnblogs.com/zhaoqingqing/p/5762867.html</a></p>
<p>æ‰€ä»¥Project Settingé‡Œé¢çš„<strong>API Compatibility
Level</strong>å…¶å®ä¹Ÿæ˜¯å¾ˆé‡è¦çš„ä¿¡æ¯ï¼Œä¹‹å‰ä¸€ç›´ä¸‹æ„è¯†å¿½ç•¥æ‰äº†è¿™ä¸ªé€‰é¡¹ã€‚åœ¨æˆ‘ä»¬çš„è€é¡¹ç›®é‡Œï¼Œè¿™é‡Œå°±ç›´æ¥å‘Šè¯‰ä½ 
API çš„å…¼å®¹æ€§ç‰ˆæœ¬æ˜¯ <strong>.NET 2.0 Subset</strong>
äº†ã€‚å¦‚æœèƒ½æ—©ä¸€ç‚¹æ„è¯†åˆ°è¿™ä¸ªé€‰é¡¹èµ·åˆ°å†³å®šæ€§ä½œç”¨ï¼Œå°±ä¸ç”¨å…œå…œè½¬è½¬ä¸€å¤§åœˆäº†ã€‚</p>
<figure>
<a href="https://s2.loli.net/2024/09/23/ucRdJb64KE8TPrz.png" title="api-compatibility-level-in-project-setting" class="gallery-item"><img src="https://s2.loli.net/2024/09/23/ucRdJb64KE8TPrz.png"
alt="api-compatibility-level-in-project-setting" /></a>
<figcaption
aria-hidden="true">api-compatibility-level-in-project-setting</figcaption>
</figure>
<p>ï¼ˆåœ¨è‡ªå®¶ç”µè„‘ä¸Šæˆªçš„å›¾ï¼Œé€‰ç”¨çš„API Compatibility
Levelä¹Ÿï¼ˆç›¸å¯¹ï¼‰æ–°ä¸€ç‚¹ï¼‰</p>
<p>æœ€åè·³è½¬åˆ°ç›¸åº”çš„ <a
href="https://github.com/mono/mono/blob/mono-2-0/mcs/class/corlib/System.Collections.Generic/List.cs">mono-2.0
æºç </a>ï¼Œå°±èƒ½çœ‹åˆ°æ–¹æ³• <code>GrowIfNeeded</code> äº†ã€‚å¯ä»¥å‘ç°åœ¨å®ç°ä¸Šä¸
<code>EnsureCapacity</code>
ä¸åŒçš„æ˜¯ä¼ å…¥çš„æ•°å€¼ä¸ºæ­¤æ¬¡æ“ä½œçš„å…ƒç´ ä¸ªæ•°å¢é‡ï¼Œè€Œä¸æ˜¯å…ƒç´ ä¸ªæ•°çš„ç›®æ ‡å¤§å°ã€‚</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F; https:&#x2F;&#x2F;github.com&#x2F;mono&#x2F;mono&#x2F;blob&#x2F;a1f3cf39287ceaca189ae1b4c06ad1677c8988cf&#x2F;mcs&#x2F;class&#x2F;corlib&#x2F;System.Collections.Generic&#x2F;List.cs#L83

        public void Add (T item)
        &#123;
            &#x2F;&#x2F; If we check to see if we need to grow before trying to grow
            &#x2F;&#x2F; we can speed things up by 25%
            if (_size &#x3D;&#x3D; _items.Length)
                GrowIfNeeded (1);
            _items [_size ++] &#x3D; item;
            _version++;
        &#125;
        
        void GrowIfNeeded (int newCount)
        &#123;
            int minimumSize &#x3D; _size + newCount;
            if (minimumSize &gt; _items.Length)
                Capacity &#x3D; Math.Max (Math.Max (Capacity * 2, DefaultCapacity), minimumSize);
        &#125;</code></pre>
<p>å†ä¸€æ¬¡è¯´æ˜äº†åœ¨åšUnityæ€§èƒ½è°ƒä¼˜ï¼Œæˆ–è€…åœ¨é¢„æµ‹Unityä¸Šçš„ä¸šåŠ¡ä»£ç æ€§èƒ½è¡¨ç°æƒ…å†µæ—¶ï¼Œæœ‰ä¸€ä»½ç‰ˆæœ¬æ­£ç¡®çš„æºç å¾ˆé‡è¦ã€‚å¦‚æœè§‰å¾—åœ¨è¯¸å¤šç‰ˆæœ¬ä¹‹é—´å®šä½C#æºç è¿‡äºéº»çƒ¦ï¼Œç›´æ¥é˜…è¯»il2cppè¾“å‡ºçš„cppæºç ï¼Œæˆ–è®¸ä¹Ÿæ˜¯ä¸€ç§åŠæ³•ã€‚</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ç¼–ç¨‹è¯­è¨€</category>
        <category>C#</category>
      </categories>
      <tags>
        <tag>C#</tag>
        <tag>.NET</tag>
        <tag>IL2CPP</tag>
        <tag>æºç é˜…è¯»</tag>
      </tags>
  </entry>
  <entry>
    <title>.NET source ç³»åˆ—ï¼šSystem.Collections.Generic.Dictionary</title>
    <url>/p/b1b59cb05264/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1
id="system.collections.generic.dictionary">System.Collections.Generic.Dictionary</h1>
<p>å‚è€ƒç‰ˆæœ¬ä¸º .net framework 4.8</p>
<p><a
href="https://referencesource.microsoft.com/#mscorlib/system/collections/generic/dictionary.cs">https://referencesource.microsoft.com/#mscorlib/system/collections/generic/dictionary.cs</a></p>
<h2 id="å‰è¨€">å‰è¨€</h2>
<p>é¿å…çŠ¯å…ˆå…¥ä¸ºä¸»çš„é”™ï¼Œå…ˆç®€å• diff ä¸€ä¸‹å’Œ mono 2.0 æœ‰ä»€ä¹ˆä¸åŒ</p>
<p>é™„ä»¶1ï¼š<a href="/p/b1b59cb05264/Dictionary_mono2.cs" title="Dictionary from mono-2-0">Dictionary from mono-2-0</a></p>
<p>é™„ä»¶2ï¼š<a href="/p/b1b59cb05264/Dictionary_dotnet48.cs" title="Dictionary from .net framework 4.8">Dictionary from .net framework 4.8</a></p>
<p>diff ç»“æœï¼š</p>
<a href="/p/b1b59cb05264/diff-mono2-with-dotnet48.png" class="gallery-item"><img src="/p/b1b59cb05264/diff-mono2-with-dotnet48.png" class="" title="mono2ä¸dotnet48çš„å®ç°å·®å¼‚"></a>
<p>åªèƒ½è¯´æ˜¯å®Œå…¨ä¸ä¸€æ ·äº†ã€‚å“ˆå“ˆã€‚</p>
<h2 id="net-framework-4.8">.net framework 4.8</h2>
<p>reference:</p>
<ul>
<li><a
href="https://blog.markvincze.com/back-to-basics-dictionary-part-1/">https://blog.markvincze.com/back-to-basics-dictionary-part-1/</a>
ï¼ˆlonger: 4 partsï¼‰</li>
<li><a
href="https://www.yycoding.xyz/post/2023/7/2/details-of-dictionary-source-code-in-dotnet-core">https://www.yycoding.xyz/post/2023/7/2/details-of-dictionary-source-code-in-dotnet-core</a></li>
<li><a
href="https://dotnetos.org/blog/2022-03-28-dictionary-implementation/">https://dotnetos.org/blog/2022-03-28-dictionary-implementation/</a>ï¼ˆjust
picsï¼‰</li>
</ul>
<h2 id="æ‘˜è¦">æ‘˜è¦</h2>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public class Dictionary&lt;TKey,TValue&gt;: IDictionary&lt;TKey,TValue&gt;, IDictionary, IReadOnlyDictionary&lt;TKey, TValue&gt;, ISerializable, IDeserializationCallback  &#123;

    private struct Entry &#123;
        public int hashCode;    &#x2F;&#x2F; Lower 31 bits of hash code, -1 if unused
        public int next;        &#x2F;&#x2F; Index of next entry, -1 if last
        public TKey key;           &#x2F;&#x2F; Key of entry
        public TValue value;         &#x2F;&#x2F; Value of entry
    &#125;

    private int[] buckets;
    private Entry[] entries;
    private int count;
    private int version;
    private int freeList;
    private int freeCount;
    private IEqualityComparer&lt;TKey&gt; comparer;
    private KeyCollection keys;
    private ValueCollection values;
    private Object _syncRoot;
    &#x2F;&#x2F; ...       
&#125;</code></pre>
<p>.NETä¸­çš„Dictionaryå®ç°ï¼Œæ˜¯å“ˆå¸Œè¡¨<strong>HashTable</strong>å’Œ<strong>LinkedList</strong>çš„ç»„åˆï¼Œ<strong>LinkedList</strong>è¢«ç”¨äºå¤„ç†å“ˆå¸Œå†²çªï¼ˆæ‹‰é“¾æ³•
separate chainingï¼‰</p>
<ul>
<li>HashTableæ˜¯ä¸€ä¸ªç”¨äºå­˜å‚¨Pairçš„æ•°æ®ç»“æ„ï¼Œæ¯ä¸ªPairéƒ½åŒ…å«Keyå’ŒValueã€‚</li>
<li>HashTableçš„é‡è¦åŠŸèƒ½å°±æ˜¯æä¾›Keyä¹‹åï¼Œè¦èƒ½å¾ˆå¿«åœ°æ‰¾åˆ°ä¸Keyå€¼å¯¹åº”çš„Valueã€‚</li>
<li>HashTableä¼šä½¿ç”¨hash functionæ¥åŸºäºKeyè®¡ç®—å‡ºä¸‹æ ‡ã€‚</li>
</ul>
<span id="more"></span>
<p>Dictionaryä¸­æœ€é‡è¦çš„å‡ ä¸ªç»„æˆéƒ¨åˆ†ï¼ˆå­—æ®µï¼‰ï¼š</p>
<ul>
<li><strong>buckets(int[])</strong>ï¼šæœ‰ç›¸åŒhashcodeçš„æ¡ç›®å½’å±äºåŒä¸€ä¸ªbucketã€‚å“ˆå¸Œç»“æœå–ä½™ä¹‹åå¾—åˆ°è¿™ä¸ª
<code>buckets</code> çš„ä¸‹æ ‡ï¼Œä¸‹æ ‡å¯¹åº”ä½ç½®å­˜å‚¨çš„æ˜¯å…ƒç´ é›†åˆåœ¨
<code>entries</code> ä¸­çš„ç¬¬ä¸€ä¸ªå…ƒç´ ä½ç½®</li>
<li><strong>entries(Entry[])</strong>ï¼šDicionary&lt;TKey, TValue&gt;
çš„å…ƒç´ é›†åˆ</li>
<li><strong>freeList(int)</strong>ï¼šç¬¬ä¸€ä¸ªç©ºé—²ä½ç½®çš„ä¸‹æ ‡</li>
<li><strong>freeCount(int)</strong>ï¼šEntry[] ä¸­å…±æœ‰å¤šå°‘ä¸ªç©ºé—²ä½ç½®</li>
<li><strong>count(int)</strong>ï¼šDictionaryä¸­çš„å†…éƒ¨æ•°ç»„å¤§å°ï¼Œæ³¨æ„å¹¶éæœ‰æ•ˆå…ƒç´ ä¸ªæ•°ã€‚æœ‰æ•ˆå…ƒç´ ä¸ªæ•°é€šè¿‡å±æ€§<strong>Count</strong>è¿”å›ã€‚</li>
<li><strong>version(int)</strong>ï¼šDictionaryçš„ä¿®æ”¹æ¬¡æ•°ï¼Œå®¹å™¨çš„æ ‡è®°</li>
</ul>
<p>åŒæ—¶Entryä¹Ÿæ˜¯Dictionaryçš„ä¸€ä¸ªé‡è¦ç»“æ„ï¼ŒåŒ…å«ï¼š</p>
<ul>
<li>Keyä¸Valueå¯¹è±¡</li>
<li>å“ˆå¸Œç»“æœ <strong>hashCode</strong></li>
<li><strong>next</strong>ï¼šentries
ä¸­ç›¸åŒhashcodeçš„ä¸‹ä¸€ä¸ªå…ƒç´ ä¸‹æ ‡ã€‚å¦‚æœnextå€¼ä¸º-1ï¼Œå³è¡¨ç¤ºæ­¤å…ƒç´ ä¸ºç›¸åŒbucketé›†åˆä¸­çš„æœ€åä¸€ä¸ªå…ƒç´ </li>
</ul>
<a href="/p/b1b59cb05264/dictionary-layout.png" class="gallery-item"><img src="/p/b1b59cb05264/dictionary-layout.png" class="" title="Dictionaryå®ç°å›¾ç¤º"></a>
<h2 id="ä¸»è¦è¡Œä¸º">ä¸»è¦è¡Œä¸º</h2>
<h3 id="æ„é€ å‡½æ•°-ctor">æ„é€ å‡½æ•° ctor</h3>
<p>è‹¥ä¸ä¼ å…¥ä»»ä½•å‚æ•°ä¼šä»¥0ä¸ºé»˜è®¤capacityè°ƒç”¨ <code>Initialize()</code>
å¼€è¾Ÿç©ºé—´ï¼ŒåŒæ—¶ä¼šä½¿ç”¨ <code>EqualityComparer&lt;TKey&gt;.Default</code>
ä½œä¸ºé»˜è®¤æ¯”è¾ƒå™¨ï¼Œç”¨äºè·å–HashCodeï¼Œä»¥åŠåˆ¤æ–­Keyä¹‹é—´æ˜¯å¦ç›¸ç­‰ã€‚</p>
<p><strong>IEqualityComparer<TKey></strong> åªéœ€è¦å®ç°ä¸¤ä¸ªæ–¹æ³•ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F; The generic IEqualityComparer interface implements methods to if check two objects are equal
&#x2F;&#x2F; and generate Hashcode for an object.
&#x2F;&#x2F; It is use in Dictionary class.  
public interface IEqualityComparer&lt;in T&gt;
&#123;
    bool Equals(T x, T y);
    int GetHashCode(T obj);                
&#125;</code></pre>
<h3 id="initializeint-capacity">Initialize(int capacity)</h3>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">private void Initialize(int capacity) &#123;
    int size &#x3D; HashHelpers.GetPrime(capacity);
    buckets &#x3D; new int[size];
    for (int i &#x3D; 0; i &lt; buckets.Length; i++) buckets[i] &#x3D; -1;
    entries &#x3D; new Entry[size];
    freeList &#x3D; -1;
&#125;</code></pre>
<p>æ­¤æ–¹æ³•ä¾èµ– <code>HashHelpers.GetPrime(int min)</code>
æ¥è·å–ç¬¬ä¸€ä¸ªå¤§äº<strong>capacity</strong>çš„è´¨æ•°ã€‚</p>
<p>ç±»å‹ <strong>HashHelpers</strong> ä¸­å­˜åœ¨é™æ€æ•´å‹æ•°ç»„
<strong>primesï¼Œ</strong>è¿™æ˜¯ä¸€ä¸ªç‰¹åˆ«æŒ‘å‡ºçš„è´¨æ•°ç»„æˆçš„è´¨æ•°è¡¨ï¼ˆä¸ºä»€ä¹ˆé€‰äº†è¿™äº›è´¨æ•°ï¼Ÿå€¼å¾—ç ”ç©¶ä¸‹ï¼‰ï¼Œä»¥<strong>3</strong>å¼€å§‹ï¼Œä»¥<strong>7199369</strong>ç»“æŸã€‚è‹¥æä¾›çš„minæ•°å­—å°äº
primes æ•°ç»„ä¸­æœ€å¤§å€¼ï¼Œé‚£ä¹ˆç®€å•åœ°æŸ¥è¡¨å°±èƒ½å¾—åˆ°å¤§äºå®ƒçš„ç›®æ ‡è´¨æ•°ã€‚</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F; system\Collections\hashtable.cs:1711
        public static readonly int[] primes &#x3D; &#123;
            3, 7, 11, 17, 23, 29, 37, 47, 59, 71, 89, 107, 131, 163, 197, 239, 293, 353, 431, 521, 631, 761, 919,
            1103, 1327, 1597, 1931, 2333, 2801, 3371, 4049, 4861, 5839, 7013, 8419, 10103, 12143, 14591,
            17519, 21023, 25229, 30293, 36353, 43627, 52361, 62851, 75431, 90523, 108631, 130363, 156437,
            187751, 225307, 270371, 324449, 389357, 467237, 560689, 672827, 807403, 968897, 1162687, 1395263,
            1674319, 2009191, 2411033, 2893249, 3471899, 4166287, 4999559, 5999471, 7199369&#125;;

&#x2F;&#x2F; System.Collections.HashHelpers.GetPrime
&#x2F;&#x2F; system\Collections\hashtable.cs:1754
        public static int GetPrime(int min) 
        &#123;
            if (min &lt; 0)
                throw new ArgumentException(Environment.GetResourceString(&quot;Arg_HTCapacityOverflow&quot;));
            Contract.EndContractBlock();

            for (int i &#x3D; 0; i &lt; primes.Length; i++) 
            &#123;
                int prime &#x3D; primes[i];
                if (prime &gt;&#x3D; min) return prime;
            &#125;

            &#x2F;&#x2F;outside of our predefined table. 
            &#x2F;&#x2F;compute the hard way. 
            for (int i &#x3D; (min | 1); i &lt; Int32.MaxValue;i+&#x3D;2) 
            &#123;
                if (IsPrime(i) &amp;&amp; ((i - 1) % Hashtable.HashPrime !&#x3D; 0))
                    return i;
            &#125;
            return min;
        &#125;</code></pre>
<p>å¦åˆ™ï¼Œ<code>GetPrime()</code> æ–¹æ³•å°†å›é€€åˆ°æœ´ç´ çš„è´¨æ•°æŸ¥æ‰¾ï¼šä»
<code>min | 1</code> å¼€å§‹ç›´åˆ°
<code>Int32.MaxValue</code>ï¼Œè¿›è¡Œæ­¥é•¿ä¸º2çš„éå†ï¼Œåˆ¤æ–­æ¯ä¸ªæ•°å­—æ˜¯å¦æ˜¯è´¨æ•°
<code>HashHelpers.IsPrime(int
candidate)</code>ã€‚æ³¨æ„ï¼Œè¿™ä¸ªåˆ¤æ–­æ–¹æ³•æ¶‰åŠå¹³æ–¹æ ¹æ“ä½œï¼Œä¸ä¸€ä¸ªæ—¶é—´å¤æ‚åº¦ä¸º<span
class="math inline">\(\bf{O}(\sqrt{\bf{n}})\)</span>çš„å¾ªç¯ã€‚</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F; System.Collections.HashHelpers.IsPrime
&#x2F;&#x2F; system\Collections\hashtable.cs:1738
        public static bool IsPrime(int candidate) 
        &#123;
            if ((candidate &amp; 1) !&#x3D; 0) 
            &#123;
                int limit &#x3D; (int)Math.Sqrt (candidate);
                for (int divisor &#x3D; 3; divisor &lt;&#x3D; limit; divisor+&#x3D;2)
                &#123;
                    if ((candidate % divisor) &#x3D;&#x3D; 0)
                        return false;
                &#125;
                return true;
            &#125;
            return (candidate &#x3D;&#x3D; 2);
        &#125;</code></pre>
<h3 id="æ’å…¥å…ƒç´ -addtkey-key-tvalue-value-ç´¢å¼•å™¨">æ’å…¥å…ƒç´  Add(TKey key,
TValue value) / ç´¢å¼•å™¨</h3>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public TValue this[TKey key] &#123;
    get &#123;
        int i &#x3D; FindEntry(key);
        if (i &gt;&#x3D; 0) return entries[i].value;
        ThrowHelper.ThrowKeyNotFoundException();
        return default(TValue);
    &#125;
    set &#123;
        Insert(key, value, false);
    &#125;
&#125;

public void Add(TKey key, TValue value) &#123;
    Insert(key, value, true);
&#125;</code></pre>
<p>å› ä¸ºDictionaryå®ç°äº†éæ³›å‹ç‰ˆæœ¬çš„IDictionaryï¼Œæ‰€ä»¥ä¹Ÿæœ‰<code>Add(object
key, object value)</code>è¿™æ ·çš„æ–¹æ³•ï¼Œä½†ä¹Ÿåªæ˜¯åœ¨<code>Add(TKey key,
TValue value)</code>çš„åŸºç¡€ä¸Šæ–°å¢äº†ç±»å‹è½¬æ¢å’Œä¸€äº›é”™è¯¯æ£€æŸ¥è€Œå·²ã€‚</p>
<p>æ–¹æ³•<code>Add(TKey key, TValue value)</code>ä¾èµ–æ–¹æ³•<code>Insert(TKey
key, TValue value, bool
add)</code>çš„å®ç°ï¼Œå‚æ•°<strong>add</strong>å°±æ˜¯ç”¨æ¥åŒºåˆ†è°ƒç”¨æ˜¯å¦æ¥è‡ªäº<code>Add()</code>æ–¹æ³•ã€‚åœ¨.netæºç ä¸­çœ‹åˆ°è¿™æ ·çš„æ ‡è¯†æ–¹æ³•è¿˜æŒºæ„å¤–çš„â€¦</p>
<p>å¦å¤–ä¸€ä¸ªä¾èµ–æ–¹æ³•<code>Insert()</code>çš„æ’å…¥å…ƒç´ æ–¹æ³•å°±æ˜¯ä½¿ç”¨ç´¢å¼•å™¨
<code>this[TKey
key]</code>ï¼Œè¿™æ—¶ä¼ å…¥çš„å‚æ•°addå°±ä¼šæ˜¯falseã€‚ä¸€ç›´ä»¥æ¥çš„ä½¿ç”¨ç»éªŒä¹Ÿå‘Šè¯‰æˆ‘ä»¬ä¼ ä¸åŒå‚æ•°ä¼šå¸¦æ¥ä»€ä¹ˆä¸åŒäº†ï¼šå½“è°ƒç”¨Add()æ–¹æ³•æ—¶ï¼Œè‹¥keyå·²å­˜åœ¨ä¼š<strong>æŠ›å‡ºå¼‚å¸¸</strong>ï¼Œè€Œä½¿ç”¨ç´¢å¼•å™¨èƒ½å¤Ÿç›´æ¥è¦†ç›–æ­¤keyå¯¹åº”çš„å†…å®¹ã€‚</p>
<h3 id="æ’å…¥å…ƒç´ -inserttkey-key-tvalue-value-bool-add">æ’å…¥å…ƒç´ 
Insert(TKey key, TValue value, bool add)</h3>
<p><code>Insert()</code>
æ–¹æ³•å°†æ–°å…ƒç´ æ’å…¥åˆ°<strong>entries</strong>ä¸­ï¼Œé€‰æ‹©æ€§åœ°ä½¿ç”¨freeListï¼Œç›¸åº”åœ°æ›´æ–°<strong>buckets</strong>ï¼Œå¹¶ä¸”å¯èƒ½é€ æˆæ‰©å®¹è¡Œä¸ºã€‚</p>
<p>è‹¥å½“å‰çš„<strong>buckets</strong>åœ¨Dictionaryæ„é€ åè¿˜æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œé‚£ä¹ˆä¼šä½¿ç”¨0ä½œä¸ºåˆå§‹å®¹é‡è¿›è¡Œåˆå§‹åŒ–ï¼ŒæŒ‰ç…§ä¸Šé¢çš„ä¿¡æ¯ï¼Œæˆ‘ä»¬åº”è¯¥èƒ½å¾—åˆ°ä¸€ä¸ªå¤§å°ä¸º3çš„bucketsã€‚</p>
<p><strong>è·å–bucketsä¸­ä¸‹æ ‡</strong></p>
<p>æ’å…¥çš„å…ƒç´ é€šè¿‡<strong>comparer</strong>ä»¥åŠè‡ªå·±çš„keyå¾—åˆ°hashcodeåï¼Œé€šè¿‡å¯¹<code>buckets.Length</code>å–ä½™å¾—åˆ°ç›®æ ‡bucketåœ¨æ•°ç»„ä¸­çš„ä¸‹æ ‡<strong>targetBucket</strong>ã€‚</p>
<p><strong>æŸ¥æ‰¾entriesä¸­ä¸‹æ ‡</strong></p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">for (int i &#x3D; buckets[targetBucket]; i &gt;&#x3D; 0; i &#x3D; entries[i].next) &#123;
    if (entries[i].hashCode &#x3D;&#x3D; hashCode &amp;&amp; comparer.Equals(entries[i].key, key)) &#123;
        if (add) &#123; 
            ThrowHelper.ThrowArgumentException(ExceptionResource.Argument_AddingDuplicate);
        &#125;
        entries[i].value &#x3D; value;
        version++;
        return;
    &#125; 
    
    &#x2F;&#x2F; è®°å½•å‘ç”Ÿå†²çªçš„æ¬¡æ•°ï¼Œè¿™å®é™…ä¸Šæ˜¯ç”¨äº FEATURE_RANDOMIZED_STRING_HASHING
    collistionCount++;
&#125;</code></pre>
<p>æ¥ä¸‹æ¥ä¼šé€šè¿‡ä¸€ä¸ªåœ¨Dictionaryå®ç°ä¸­å¾ˆå¸¸è§çš„å¾ªç¯ï¼Œæ¥æŸ¥æ‰¾æ˜¯å¦å­˜åœ¨ä¸€ä¸ªhashcodeä¸keyå‡ç›¸ç­‰çš„å…ƒç´ ï¼Œå¦‚æœå­˜åœ¨åˆ™è¯´æ˜æ·»åŠ äº†keyé‡å¤çš„valueï¼Œä¾¿æ ¹æ®æ­¤æ¬¡<code>Insert</code>æ˜¯å¦æ¥æºäº<code>Add</code>æ¥å†³å®šæ˜¯è¦æŠ›å‡ºå¼‚å¸¸ï¼Œè¿˜æ˜¯è¦†ç›–åŸå€¼å¹¶æ›´æ–°versionã€‚</p>
<p>è‹¥ä¸å­˜åœ¨è¿™æ ·çš„å…ƒç´ ï¼Œé‚£ä¹ˆä¾¿å¯ä»¥è€ƒè™‘å°†æ–°å…ƒç´ åŠ å…¥åˆ°Dictionaryä¸­ï¼š</p>
<ul>
<li>å¦‚æœfreeCountå°šæœ‰å‰©ä½™ï¼Œé‚£ä¹ˆä½¿ç”¨freeListçš„é˜Ÿé¦–å…ƒç´ ä¸‹æ ‡ï¼ŒfreeListé˜Ÿé¦–åç§»ï¼Œæ›´æ–°freeCountï¼Œè€Œä¸æ›´æ–°<strong>count</strong></li>
<li>å¦åˆ™ç›´æ¥ä½¿ç”¨å½“å‰å…ƒç´ countä¸ºä¸‹æ ‡ç´¢å¼•entriesï¼Œæ›´æ–°<strong>count</strong>
<ul>
<li>æ³¨æ„ï¼Œå½“<strong>entries</strong>å·²æ»¡æ—¶ï¼ˆ<code>count ==
entries.Length</code>ï¼‰ï¼Œå‘ç”Ÿæ‰©å®¹<code>Resize()</code>ä»¥åŠtargetBucketçš„é‡æ–°è®¡ç®—ï¼Œæ¯•ç«Ÿç°åœ¨çš„<code>buckets.Length</code>å·²ç»ä¸åŒäº†</li>
</ul></li>
</ul>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">entries[index].hashCode &#x3D; hashCode;
entries[index].next &#x3D; buckets[targetBucket];
entries[index].key &#x3D; key;
entries[index].value &#x3D; value;
buckets[targetBucket] &#x3D; index;
version++;</code></pre>
<p>æœ€åï¼Œé€šè¿‡ä¸Šè¿°æ­¥éª¤å¾—åˆ°çš„indexï¼Œè®¾ç½®entries[index]çš„å„ç§key / hashcode
/
valueä¿¡æ¯ï¼Œå°†æ­¤entries[index]è®¾ç½®ä¸ºtargetBucketçš„é˜Ÿé¦–ï¼ˆbuckets[targetBucket]
â†’ new_entry.next â†’ previous_entryï¼‰ã€‚</p>
<p><strong>FEATURE_RANDOMIZED_STRING_HASHING</strong></p>
<p>å¦‚æœä¸Šè¿°æåˆ°çš„å†²çªæ¬¡æ•°å¤§äº<strong>HashHelpers.HashCollisionThreshold</strong>ï¼ˆ100ï¼‰æ¬¡ï¼Œä¸”å½“å‰comparerè¢«åˆ¤å®šä¸ºâ€œWellKnownEqualityComparerâ€ï¼Œåˆ™ä¼šä¸ºå½“å‰Dictionaryé€‰æ‹©ä¸€ä¸ª<strong>RandomziedEqualityComparer</strong>ï¼Œä¹‹åå¯¹Dictionaryè¿›è¡Œ<code>Resize</code>ï¼Œå¹¶ä¸”<strong>forceNewHashCodes</strong>ï¼Œä½¿ç”¨æ–°çš„compareræ¥è®¡ç®—hashcode</p>
<p>ä¸¾ä¾‹åœ¨mscorlibä¸­å°±èƒ½æ‰¾åˆ°System/StringComparer.csï¼Œå…¶ä¸­åŒ…å«äº†
<strong>CultureAwareRandomizedComparer</strong>ï¼Œ<strong>OrdinalRandomizedComparer</strong>
ç­‰comparerï¼Œè¿™é‡Œå°±å…ˆä¸å±•å¼€äº†ã€‚</p>
<h3 id="æ‰©å®¹-resize">æ‰©å®¹ Resize()</h3>
<p><code>Resize()</code>
æ–¹æ³•ä¼šç”¨ä¸€ä¸ªå¤§äºå½“å‰å…ƒç´ ä¸ªæ•°ä¸¤å€çš„è´¨æ•°ï¼Œæ¥å¯¹å½“å‰å­—å…¸è¿›è¡Œæ‰©å®¹ã€‚</p>
<p>é»˜è®¤æ— å‚çš„Resize()æ–¹æ³•ä¼šæ ¹æ®å½“å‰çš„æœ‰æ•ˆå…ƒç´ ä¸ªæ•°countï¼Œè°ƒç”¨æ–¹æ³•
<code>HashHelpers.ExpandPrime</code>ã€‚</p>
<p><code>HashHelpers.ExpandPrime(int oldSize)</code>
çš„è¡Œä¸ºé€»è¾‘ä¸ºç®€å•åœ°å°† <strong>oldSize</strong> x 2 å¾—åˆ°
<strong>newSize</strong>ï¼Œåšä¸€ä¸ªè¶Šç•Œæ£€æŸ¥ï¼ˆæ­¤å¤„å¯¹æ¯”çš„å¸¸é‡ä¸º
<strong>HashHelpers.MaxPrimeArrayLength / 0x7FEFFFFD /
2146435069</strong>ï¼‰ï¼Œæ¥ç€å¹¶å°† <strong>newSize</strong> ä¼ å…¥æ–¹æ³•
<code>HashHelpers.GetPrime</code>
å¾—åˆ°æ¯”å®ƒæ›´å¤§çš„è´¨æ•°ï¼Œæœ€åå°†æ­¤ç»“æœç”¨äºè°ƒç”¨æ–¹æ³• <code>Resize(int newSize,
bool forceNewHashCodes)</code>ã€‚</p>
<h3 id="æ‰©å®¹-resizeint-newsize-bool-forcenewhashcodes">æ‰©å®¹ Resize(int
newSize, bool forceNewHashCodes)</h3>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">private void Resize(int newSize, bool forceNewHashCodes) &#123;
    Contract.Assert(newSize &gt;&#x3D; entries.Length);
    int[] newBuckets &#x3D; new int[newSize];
    for (int i &#x3D; 0; i &lt; newBuckets.Length; i++) newBuckets[i] &#x3D; -1;
    Entry[] newEntries &#x3D; new Entry[newSize];
    Array.Copy(entries, 0, newEntries, 0, count);
    if(forceNewHashCodes) &#123;
        for (int i &#x3D; 0; i &lt; count; i++) &#123;
            if(newEntries[i].hashCode !&#x3D; -1) &#123;
                newEntries[i].hashCode &#x3D; (comparer.GetHashCode(newEntries[i].key) &amp; 0x7FFFFFFF);
            &#125;
        &#125;
    &#125;
    &#x2F;&#x2F; pay attention to this loop
    for (int i &#x3D; 0; i &lt; count; i++) &#123;
        int bucket &#x3D; newEntries[i].hashCode % newSize;
        newEntries[i].next &#x3D; newBuckets[bucket];
        newBuckets[bucket] &#x3D; i;
    &#125;
    buckets &#x3D; newBuckets;
    entries &#x3D; newEntries;
&#125;</code></pre>
<p>æ–¹æ³•å†…éƒ¨æŒ‰ç…§æ–°çš„sizeå¤§å°å¼€è¾Ÿäº†ä¸¤ä¸ªæ–°æ•°ç»„ï¼Œåˆ†åˆ«æ˜¯
<strong>buckets</strong> å’Œ
<strong>entries</strong>ã€‚<strong>buckets</strong>çš„æ¯ä¸ªæˆå‘˜éƒ½ä¼šè¢«åˆå§‹åŒ–ä¸º-1ã€‚è€Œå¯¹
<strong>entries</strong>ï¼Œåˆ™æ˜¯å…ˆè¿›è¡Œäº†å·²æœ‰ count ä¸ªæ¡ç›®çš„
<code>Array.Copy</code>ã€‚</p>
<p>å¦‚æœæ–¹æ³•ä¼ å…¥äº†<strong>forceNewHashCodes</strong>ï¼Œé‚£ä¹ˆæ¯ä¸ªentryçš„hashcodeéƒ½ä¼šåŸºäºå­—å…¸å†…éƒ¨çš„comparerä»¥åŠentryçš„keyé‡æ–°è®¡ç®—ä¸€éã€‚</p>
<p>å¾ˆæœ‰æ„æ€çš„æ˜¯æ–¹æ³•å†…éƒ¨é€šè¿‡ä¸€ä¸ªå¾ªç¯æ¥é‡ç½®äº†<code>Resize</code>æ“ä½œåçš„<strong>buckets</strong>ä»¥åŠ<strong>entries</strong>é“¾è¡¨ï¼Œè€Œå¾ªç¯ä½“çš„å®ç°å¯ä»¥åŒæ—¶åº”å¯¹ä¸¤ç§æƒ…å†µï¼š</p>
<ul>
<li>å¯¹é‚£äº›å¯¹åº”bucketä¸ºç©ºçš„entryï¼Œentryçš„nextä¼šè¢«è®¾ç½®ä¸º-1ï¼Œä¹‹åè¿™ä¸ªbucketä¼šæŒ‡å‘è¿™ä¸ªentryï¼›</li>
<li>å¯¹é‚£äº›å¯¹åº”bucketä¸ä¸ºç©ºçš„entryï¼ˆå³å­˜åœ¨å…¶ä»–ç›¸åŒhashcodeçš„entryï¼‰ï¼Œentryçš„nextä¼šè¢«è®¾ç½®ä¸ºbucketæŒ‡å‘çš„åŒhashcode
entryï¼ŒéšåbucketåŒæ ·ä¼šæŒ‡å‘è¿™ä¸ªentryã€‚</li>
</ul>
<p>è¿™æ ·ä¸€æ¥ï¼Œæ–°çš„entryæ€»æ˜¯è¢«æ’å…¥åˆ°bucketæŒ‡å‘çš„é˜Ÿé¦–ã€‚</p>
<h3 id="ç§»é™¤å…ƒç´ -removetkey-key">ç§»é™¤å…ƒç´  Remove(TKey key)</h3>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public bool Remove(TKey key) &#123;
    if(key &#x3D;&#x3D; null) &#123;
        ThrowHelper.ThrowArgumentNullException(ExceptionArgument.key);
    &#125;

    if (buckets !&#x3D; null) &#123;
        int hashCode &#x3D; comparer.GetHashCode(key) &amp; 0x7FFFFFFF;
        int bucket &#x3D; hashCode % buckets.Length;
        int last &#x3D; -1;
        for (int i &#x3D; buckets[bucket]; i &gt;&#x3D; 0; last &#x3D; i, i &#x3D; entries[i].next) &#123;
            if (entries[i].hashCode &#x3D;&#x3D; hashCode &amp;&amp; comparer.Equals(entries[i].key, key)) &#123;
                if (last &lt; 0) &#123;
                    buckets[bucket] &#x3D; entries[i].next;
                &#125;
                else &#123;
                    entries[last].next &#x3D; entries[i].next;
                &#125;
                entries[i].hashCode &#x3D; -1;
                entries[i].next &#x3D; freeList;
                entries[i].key &#x3D; default(TKey);
                entries[i].value &#x3D; default(TValue);
                freeList &#x3D; i;
                freeCount++;
                version++;
                return true;
            &#125;
        &#125;
    &#125;
    return false;
&#125;</code></pre>
<p>å½“Removeæ“ä½œå‘ç”Ÿæ—¶ï¼š</p>
<p>ç»´æŠ¤ <strong>buckets</strong> / <strong>entries</strong> é“¾è¡¨ï¼š</p>
<ul>
<li>å¦‚æœç§»é™¤çš„entryæ˜¯æ­¤hashcodeå¯¹åº”çš„bucketæŒ‡å‘çš„é¦–ä¸ªentryï¼Œé‚£ä¹ˆéœ€è¦æ›´æ–°bucketçš„å€¼</li>
<li>å¦‚æœä¸æ˜¯bucketæŒ‡å‘çš„entryï¼Œé‚£ä¹ˆéœ€è¦æ›´æ–°åŒhashcodeçš„æŒ‡å‘è¿™ä¸ªentryçš„ä¸Šä¸€entryå­˜å‚¨çš„next</li>
</ul>
<p>ç»´æŠ¤ç©ºé—²é˜Ÿåˆ—ï¼ŒfreeList / freeCount æ›´æ–°æ“ä½œå‘ç”Ÿï¼š</p>
<ul>
<li>è¢«ç§»é™¤çš„entryï¼Œå…¶nextä¼šæŒ‡å‘å½“å‰freeListï¼Œå³æ—§çš„freeListé˜Ÿé¦–</li>
<li>freeListæŒ‡å‘è¢«ç§»é™¤çš„entryï¼Œæ­¤ç©ºé—²entryç°åœ¨å˜æˆfreeListçš„é˜Ÿé¦–å…ƒç´ </li>
<li>freeCount / version é€’å¢</li>
</ul>
<p>æ³¨æ„ä¹Ÿæ˜¯è¿™ä¸ªæ–¹æ³•å†…è¡¨æ˜äº†ï¼Œ
å½“Entryè¢«ç§»é™¤æ—¶ï¼ŒhashCodeä¼šè¢«æ ‡è®°ä¸º-1ï¼Œè¿™ä¹Ÿæ˜¯æ ¹æ®<strong>comparer</strong>è·å–HashCodeåæ€»æ˜¯è¦å–ä½31ä½çš„åŸå› ã€‚</p>
<h3 id="æŸ¥æ‰¾å…ƒç´ -containskeytkey-key-containsvaluetvalue-value">æŸ¥æ‰¾å…ƒç´ 
ContainsKey(TKey key) / ContainsValue(TValue value)</h3>
<p><code>ContainsKey</code> çš„å®ç°æ˜¯åŸºäºæ–¹æ³• <code>FindEntry(TKey
key)</code> çš„ï¼Œè€Œ <code>ContainsValue</code>
çš„å®ç°æ˜¯ä¸€ä¸ªç®€å•çš„å¯¹<strong>entries</strong>çš„éå†ï¼Œå¯¹äºénullçš„ç›®æ ‡valueï¼Œä¼šä½¿ç”¨å½“å‰TValueç±»å‹çš„DefaultEqualityComparerè¿›è¡Œæ¯”è¾ƒã€‚</p>
<p><code>FindEntry(TKey key)</code>
çš„å®ç°æ˜¯å…ˆåŸºäºkeyè·å–hashcodeï¼Œå†ä»<strong>buckets</strong>ç´¢å¼•åˆ°entriesçš„èµ·å§‹ä½ç½®ï¼Œæ¥ä¸‹æ¥æ ¹æ®æ¯ä¸ªentryçš„nextéå†æ•´ä¸ªæ•°ç»„ä¸­çš„é“¾è¡¨ï¼Œè¿›è¡Œkeyçš„ç›¸ç­‰åˆ¤å®šã€‚</p>
<p>å¯¹å­—å…¸çš„ç›´æ¥ç´¢å¼•æ–¹æ³• dict[key] ä¹Ÿæ˜¯åŸºäºæ–¹æ³• <code>FindEntry(TKey
key)</code>
çš„ï¼Œè¿™é‡Œå°±ä¸èµ˜è¿°äº†ï¼Œå”¯ä¸€éœ€è¦æ³¨æ„çš„æ˜¯ç´¢å¼•æ–¹æ³•åœ¨æ‰¾ä¸åˆ°å¯¹åº”keyæ—¶ä¼šç›´æ¥<strong>æŠ›å‡ºå¼‚å¸¸</strong>ï¼Œæƒ³è¦å®‰å…¨çš„è·å–å€¼ï¼Œæ¨èçš„æ˜¯ä¸‹è¿°<code>TryGetValue</code>æ–¹æ³•ã€‚</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public TValue this[TKey key] &#123;
    get &#123;
        int i &#x3D; FindEntry(key);
        if (i &gt;&#x3D; 0) return entries[i].value;
        ThrowHelper.ThrowKeyNotFoundException();
        return default(TValue);
    &#125;
    set &#123;
        Insert(key, value, false);
    &#125;
&#125;</code></pre>
<h3 id="è·å–å…ƒç´ -trygetvaluetkey-key-out-tvalue-value">è·å–å…ƒç´ 
TryGetValue(TKey key, out Tvalue value)</h3>
<p>TryGetValue æ–¹æ³•åŒæ ·åŸºäº <code>FindEntry(TKey
key)</code>ï¼Œåªæ˜¯å…¶ç»“æœé€šè¿‡ out
å…³é”®å­—è¿”å›ï¼Œè€Œkeyæ˜¯å¦åœ¨å­—æ®µä¸­çš„ç»“æœä¼šä½¿ç”¨boolç»“æœè¿”å›ã€‚</p>
<h2 id="è¿­ä»£å™¨-enumerator">è¿­ä»£å™¨ Enumerator</h2>
<p>å­—å…¸ä¸­å­˜åœ¨ä¸‰ä¸ªå¯éå†çš„å¯¹è±¡ï¼Œåˆ†åˆ«æ˜¯
<strong>Dictionary&lt;TKey,TValue&gt;.Enumerator</strong>ï¼Œ<strong>Dictionary&lt;TKey,TValue&gt;.KeyCollection</strong>ï¼Œä»¥åŠ
<strong>Dictionary&lt;TKey,TValue&gt;.ValueCollection</strong>
åˆ†åˆ«å¯é€šè¿‡å­—å…¸çš„ GetEnumeratorï¼Œä»¥åŠ Keysï¼ŒValues å±æ€§è¿”å›ã€‚</p>
<p>å…¶ä¸­ <strong>Dictionary&lt;TKey,TValue&gt;.Enumerator</strong>
ä¸ºstructï¼Œè€Œ<strong>KeyCollection</strong>ä¸<strong>ValueCollection</strong>å‡ä¸ºclassï¼Œä¸”å­˜åœ¨ç›¸åº”çš„å†…éƒ¨æˆå‘˜ï¼Œä¼šåœ¨ç¬¬ä¸€æ¬¡è·å–çš„æ—¶å€™å‘ç”Ÿå®ä¾‹åŒ–åŠå †å†…å­˜åˆ†é…ã€‚<strong>KeyCollection</strong>
ä¸ <strong>ValueCollection</strong> å‡å­˜åœ¨è‡ªå·±çš„å†…éƒ¨ Enumerator
å£°æ˜ã€‚</p>
<p>å€¼å¾—ä¸€æçš„æ˜¯ä¸‰è€…çš„ Dispose()
æ–¹æ³•ä¸­å‡ä¸ºç©ºï¼Œæ²¡æœ‰é‡è¦å¼ƒç½®çš„å¤–éƒ¨èµ„æºã€‚</p>
<h3
id="dictionarytkeytvalue.enumerator">Dictionary&lt;TKey,TValue&gt;.Enumerator</h3>
<p>æŒæœ‰å½“å‰dictionaryå¼•ç”¨ã€‚</p>
<p>è°ƒç”¨æ–¹æ³• MoveNext() æ—¶ä¼šåŸºäº entries è¿›è¡Œéå†ï¼Œéå†è¿‡ç¨‹ä¸­åªæœ‰
<code>hashcode â‰¥ 0</code> çš„æ¡ç›®ä¼šè¢«è¿”å›ï¼Œå³åªä¼šéå†æœ‰æ•ˆæ¡ç›®ã€‚æ–¹æ³•å†…ä¼šå°†
versionï¼Œéå†ä¸‹æ ‡ indexï¼Œä»¥åŠå½“å‰KeyValuePair&lt;TKey, TValue&gt;
(struct) ä½œä¸ºè‡ªèº«æˆå‘˜ä¿å­˜ã€‚</p>
<p>å½“å‰éå†çš„é”®å€¼å¯¹ä¸ºstructï¼Œå¯ä¸ç”¨æ‹…å¿ƒå †å†…å­˜åˆ†é…ï¼Œæ­¤ç»“æœè¢«ä¿å­˜åœ¨
<strong>current</strong> æˆå‘˜ä¸­ï¼Œä¹Ÿæ˜¯ <strong>Current</strong>
å±æ€§çš„è¿”å›ç»“æœã€‚</p>
<h3 id="keycollection-valuecollection">KeyCollection /
ValueCollection</h3>
<p>ä¸¤è€…è¿”å›çš„Enumeratorï¼ŒåŠå…¶éå†è¿‡ç¨‹å‡ä¸å­—å…¸è‡ªèº«è¿”å›KeyValuePairçš„Enumeratoræ— å¤ªå¤§å·®å¼‚ï¼Œä¸‹é¢ç›´æ¥è´´ä¸Šä»£ç è¿›è¡Œæ¯”è¾ƒã€‚</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">&#x2F;&#x2F; Dictionary&lt;TKey,TValue&gt;.Enumerator.MoveNext
public bool MoveNext() &#123;
    &#x2F;&#x2F; ...

    &#x2F;&#x2F; ä½¿ç”¨uintè½¬æ¢æ¯”è¾ƒï¼Œå¯ä»¥ä¿è¯å³ä½¿dicionary.countä¸ºInt32.MaxValueï¼Œ
    &#x2F;&#x2F; éå†ç»“æŸåå°†indexè®¾ç½®ä¸ºcount+1ï¼ˆintä¸‹ä¸ºè´Ÿå€¼ï¼‰ï¼Œåç»­ä¹Ÿä¸ä¼šé€šè¿‡è¿™ä¸ªåˆ¤æ–­å¼è¿›å…¥whileå—
    while ((uint)index &lt; (uint)dictionary.count) &#123;
        if (dictionary.entries[index].hashCode &gt;&#x3D; 0) &#123;
            current &#x3D; new KeyValuePair&lt;TKey, TValue&gt;(dictionary.entries[index].key, dictionary.entries[index].value);
            index++;
            return true;
        &#125;
        index++;
    &#125;

    index &#x3D; dictionary.count + 1;
    current &#x3D; new KeyValuePair&lt;TKey, TValue&gt;();
    return false;
&#125;

    &#x2F;&#x2F; Dictionary&lt;TKey,TValue&gt;.KeyCollection.Enumerator.MoveNext
    public bool MoveNext() &#123;
        &#x2F;&#x2F; ...

        while ((uint)index &lt; (uint)dictionary.count) &#123;
            if (dictionary.entries[index].hashCode &gt;&#x3D; 0) &#123;
                currentKey &#x3D; dictionary.entries[index].key;
                index++;
                return true;
            &#125;
            index++;
        &#125;

        index &#x3D; dictionary.count + 1;
        currentKey &#x3D; default(TKey);
        return false;
    &#125;
    
    &#x2F;&#x2F; Dictionary&lt;TKey,TValue&gt;.ValueCollection.Enumerator.MoveNext
    public bool MoveNext() &#123;                    
        if (version !&#x3D; dictionary.version) &#123;
            ThrowHelper.ThrowInvalidOperationException(ExceptionResource.InvalidOperation_EnumFailedVersion);
        &#125;
        
        while ((uint)index &lt; (uint)dictionary.count) &#123;
            if (dictionary.entries[index].hashCode &gt;&#x3D; 0) &#123;
                currentValue &#x3D; dictionary.entries[index].value;
                index++;
                return true;
            &#125;
            index++;
        &#125;
        index &#x3D; dictionary.count + 1;
        currentValue &#x3D; default(TValue);
        return false;
    &#125;</code></pre>
<h2 id="å¯å€Ÿé‰´ä¹‹å¤„">å¯å€Ÿé‰´ä¹‹å¤„</h2>
<p>è®°å½•ä¸€äº›åœ¨é˜…è¯» .net framework 4.8 çš„ Dictionary
æºç è¿‡ç¨‹ä¸­ï¼Œè§‰å¾—æœªæ¥åœ¨è®¾è®¡æ•°æ®ç»“æ„å¯ä»¥å‚ç…§å­¦ä¹ çš„è¦ç‚¹:</p>
<ul>
<li>å­˜å‚¨Dictionaryçš„Valueçš„å®ä½“<strong>Entry</strong>è¢«è®¾è®¡ä¸ºäº†å€¼ç±»å‹ï¼Œè€Œä¸æ˜¯å¼•ç”¨ç±»å‹ã€‚ä¸€èˆ¬è€Œè¨€ï¼Œå¯¹äºåŸºæœ¬çš„æ•°æ®ç±»å‹æˆ–è€…çº¯å­—æ®µæˆ–è€…å°äº16ä¸ªå­—èŠ‚çš„ï¼Œè®¾è®¡ä¸ºstructï¼Œè€Œä¸æ˜¯classèƒ½å¤Ÿæ˜æ˜¾æé«˜å†…å­˜å±€éƒ¨æ€§ï¼Œå¹¶ä¸”èƒ½æå¤§å‡å°‘GCå‹åŠ›ã€‚</li>
<li>ç‰¹åˆ«åœ°ï¼Œç›¸æ¯”classæ•°ç»„ï¼Œstructæ•°ç»„çš„å†…å­˜å±€éƒ¨æ€§æœ‰æå¤§çš„ä¼˜åŠ¿ã€‚</li>
<li>åˆ é™¤DictionaryæŸä¸ªkeyå¯¹åº”çš„å…ƒç´ ï¼Œåªæ˜¯å°†<strong>entries</strong>ä¸­å¯¹åº”çš„å…ƒç´ ç§»åˆ°äº†ç©ºé—²åˆ—è¡¨ä¸­ï¼Œåœ¨ä¸‹æ¬¡æ’å…¥æ—¶ï¼Œä¼˜å…ˆæŠŠæ•°æ®åˆ†é…åˆ°ç©ºé—²åˆ—è¡¨ä¸Šã€‚è¿™æ ·ä¸€å®šç¨‹åº¦ä¸Šèƒ½å‡å°‘pageäº¤æ¢ï¼Œå’Œæ–°çš„å†…å­˜æ³¨é”€å’Œåˆ†é…ã€‚</li>
<li>è¿™ç§æŠ€å·§åœ¨C++ç¼–ç¨‹è¯­è¨€ä¸­å¹¿æ³›å­˜åœ¨ï¼Œç”±äºåœ¨éæ‰˜ç®¡è¯­è¨€ä¸­ï¼Œå†…å­˜çš„æ³¨é”€å’Œåˆ†é…æ˜¯ä¸€ä¸ªç›¸å¯¹æ¥è¯´æ¯”è¾ƒè€—èµ„æºçš„æ“ä½œï¼Œæ‰€ä»¥è¿™ç§å†…å­˜ç•™ç”¨æ“ä½œéå¸¸æ™®éã€‚</li>
<li>åœ¨åˆ¤æ–­é“¾è¡¨æ˜¯å¦åˆ°è¾¾å°½å¤´æ—¶ï¼Œå³nextæ˜¯å¦ä¸º-1æ—¶ï¼Œå¯¹äºæ™®é€šå‚¨å€¼çš„é“¾è¡¨ï¼Œç›´æ¥å°†-1è½¬æ¢ä¸ºuintï¼Œç„¶åè·Ÿ<strong>entries</strong>çš„lengthåšæ¯”è¾ƒï¼Œè¿™é‡Œåˆ©ç”¨äº†è´Ÿæ•°è½¬ä¸ºæ— ç¬¦å·æ•´å‹ä¼šæº¢å‡ºæˆä¸ºéå¸¸å¤§çš„æ•´æ•°çš„ç‰¹æ€§ã€‚</li>
</ul>
<h2 id="mono-2.0-dictionary-allocation">mono 2.0 Dictionary
Allocation</h2>
<p>åœ¨è¿™é‡Œé¢å¤–è®°å½•ä¸€ä¸ªä¸ªäººè§‰å¾—åœ¨æ¯”è¾ƒè¿‡æ—¶çš„.NETç¯å¢ƒå¼€å‘ä¸­éœ€è¦æ³¨æ„çš„ç‚¹ï¼Œå°±æ˜¯å­—å…¸åœ¨åˆå§‹åŒ–ä»¥åŠæ‰©å®¹æ—¶å¸¦æ¥çš„è¾ƒå¤§å†…å­˜å¼€é”€ï¼Œä»åˆå§‹åŒ–çš„ä¸¤ä¸ªé‡è¦æ–¹æ³•ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">const int INITIAL_SIZE &#x3D; 10;
const float DEFAULT_LOAD_FACTOR &#x3D; (90f &#x2F; 100);

private void Init (int capacity, IEqualityComparer&lt;TKey&gt; hcp)
&#123;
    if (capacity &lt; 0)
        throw new ArgumentOutOfRangeException (&quot;capacity&quot;);
    this.hcp &#x3D; (hcp !&#x3D; null) ? hcp : EqualityComparer&lt;TKey&gt;.Default;
    if (capacity &#x3D;&#x3D; 0)
        capacity &#x3D; INITIAL_SIZE;

    &#x2F;* Modify capacity so &#39;capacity&#39; elements can be added without resizing *&#x2F;
    capacity &#x3D; (int)(capacity &#x2F; DEFAULT_LOAD_FACTOR) + 1;
    
    InitArrays (capacity);
    generation &#x3D; 0;
&#125;

private void InitArrays (int size) &#123;
    table &#x3D; new int [size];

    linkSlots &#x3D; new Link [size];
    emptySlot &#x3D; NO_SLOT;

    keySlots &#x3D; new TKey [size];
    valueSlots &#x3D; new TValue [size];
    touchedSlots &#x3D; 0;

    threshold &#x3D; (int)(table.Length * DEFAULT_LOAD_FACTOR);
    if (threshold &#x3D;&#x3D; 0 &amp;&amp; table.Length &gt; 0)
        threshold &#x3D; 1;
&#125;</code></pre>
<p>å¯ä»¥çœ‹åˆ°ä¸€èˆ¬æ¥è¯´è‹¥æ²¡æœ‰ä¼ å…¥åˆå§‹å®¹é‡ï¼Œæˆ–è€…ä¼ å…¥0ï¼Œç›´æ¥çš„ç»“æœå°±æ˜¯å¯¼è‡´è®¡ç®—åˆå§‹å®¹é‡æ—¶å°†å¾—åˆ°12ï¼Œä¸”åœ¨InitArraysä¸­å°†åˆ†é…å››ä¸ªæ•°ç»„ï¼Œåˆ†åˆ«è´Ÿè´£ï¼š</p>
<ol type="1">
<li>tableï¼šå­˜å‚¨å–ä½™åçš„hashcodeï¼Œåˆ°linkSlotsä¸‹æ ‡çš„æ˜ å°„ï¼Œè¿™ä¸ªä¸‹æ ‡åŒæ ·ç”¨äºç´¢å¼•keySlotsä¸valueSlotsã€‚</li>
<li>linkSlotsï¼šå­˜å‚¨è®¡ç®—hashcodeç»“æœä»¥åŠnextä¿¡æ¯</li>
<li>keySlotsï¼šé”®å†…å®¹çš„å­˜å‚¨æ•°ç»„</li>
<li>valueSlotsï¼šå€¼å†…å®¹çš„å­˜å‚¨æ•°ç»„</li>
</ol>
<p>å› æ­¤å¦‚æœæœ‰æŠŠæ¡æ­¤å­—å…¸è¢«æ’å…¥çš„å…ƒç´ å¹¶ä¸å¤šï¼ˆç”šè‡³ä»…æœ‰ä¸€ä¸ªå…ƒç´ ï¼‰ï¼Œæˆ–è®¸å¯ä»¥è€ƒè™‘ä¸€å¼€å§‹å°±ä¼ å…¥åˆå§‹å®¹é‡1ï¼Œè¿™æ ·è‡³å°‘åˆ†é…çš„æ•°ç»„çš„å¤§å°æ˜¯æœ€å°çš„ã€‚</p>
<p>æµ‹è¯•ä»£ç ç¤ºä¾‹ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public class DictionaryAllocationTest : MonoBehaviour
&#123;
    private Dictionary&lt;uint, GameObject&gt; m_Objects;
    &#x2F;&#x2F; Start is called before the first frame update
    void Start()
    &#123;
        m_Objects &#x3D; new Dictionary&lt;uint, GameObject&gt;();
        for (int i &#x3D; 0; i &lt; 14; i++)
        &#123;
            m_Objects.Add((uint)i, null);
        &#125;
    &#125;
&#125;</code></pre>
<p><code>Start()</code>
ä¸­æ„é€ å‡½æ•°æ‰§è¡Œå®Œæ¯•ï¼Œå°šæœªè¿›è¡Œå…ƒç´ æ’å…¥çš„debugç»“æœï¼š</p>
<a href="/p/b1b59cb05264/mono2-dict-after-ctor.png" class="gallery-item"><img src="/p/b1b59cb05264/mono2-dict-after-ctor.png" class="" title="æ„é€ å‡½æ•°ä¹‹åçš„å†…éƒ¨æ•°ç»„æƒ…å†µ"></a>
<p>è€Œå½“æ’å…¥12ä¸ªå…ƒç´ åï¼Œå†…éƒ¨æ•°ç»„å°†åŒæ­¥æ‰©å®¹åˆ°37ï¼š</p>
<a href="/p/b1b59cb05264/mono2-dict-after-12inserts.png" class="gallery-item"><img src="/p/b1b59cb05264/mono2-dict-after-12inserts.png" class="" title="æŠµè¾¾å®¹é‡é™åˆ¶æ‰©å®¹åçš„å†…éƒ¨æ•°ç»„æƒ…å†µ"></a>
<p>è€Œåœ¨ä¸Šè¿°æ›´æ–°ç‰ˆæœ¬çš„å­—å…¸å®ç°ä¸­ï¼Œæ— è®ºæ˜¯åˆå§‹åŒ–å¤§å°ï¼Œè¿˜æ˜¯æ‰©å®¹é€Ÿåº¦ï¼Œéƒ½è¦æ›´ä¸ºä¿å®ˆã€‚</p>
<p>å› æ­¤éœ€è¦æ³¨æ„å½“è‡ªå·±åœ¨ç‰ˆæœ¬è€æ—§çš„.NETç¯å¢ƒå¼€å‘ï¼Œä¸”ä»£ç è¿è¡Œåœ¨å†…å­˜èµ„æºåƒç´§çš„åœºæ™¯ä¸‹æ—¶ï¼Œè¦æ…ç”¨Dictionaryã€‚</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ç¼–ç¨‹è¯­è¨€</category>
        <category>C#</category>
      </categories>
      <tags>
        <tag>C#</tag>
        <tag>.NET</tag>
        <tag>æºç é˜…è¯»</tag>
      </tags>
  </entry>
  <entry>
    <title>.NET source ç³»åˆ—ï¼šSystem.Collections.Generic.LinkedList</title>
    <url>/p/4c13c2dd8346/</url>
    <content><![CDATA[<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/css/lightgallery.min.css" /><div class=".article-gallery"><h1 id="net-source-linkedlist">[.NET source] LinkedList</h1>
<p>namespace: System.Collections.Generic.LinkedList</p>
<p>project: ndp.csproj</p>
<p>file: <a
href="https://referencesource.microsoft.com/#System/compmod/system/collections/generic/linkedlist.cs,df5a6c7b6b60da4f">linkedlist.cs</a></p>
<p>version: å‚è€ƒç‰ˆæœ¬ä¸ºå±äº .net standard 2.0 çš„ .NET Framework 4.8</p>
<h2 id="æ‘˜è¦">æ‘˜è¦</h2>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public class LinkedList&lt;T&gt;: ICollection&lt;T&gt;, System.Collections.ICollection
       ,ISerializable, IDeserializationCallback 
&#123;
    internal LinkedListNode&lt;T&gt; head;
    internal int count;
    internal int version;
    private Object _syncRoot;

    &#x2F;&#x2F; serialization ...
&#125;

public sealed class LinkedListNode&lt;T&gt; &#123;
    internal LinkedList&lt;T&gt; list;
    internal LinkedListNode&lt;T&gt; next;
    internal LinkedListNode&lt;T&gt; prev;
    internal T item;
    
    public LinkedListNode( T value) &#123;
        this.item &#x3D; value;
    &#125;

    internal LinkedListNode(LinkedList&lt;T&gt; list, T value) &#123;
        this.list &#x3D; list;
        this.item &#x3D; value;
    &#125;

    public LinkedListNode&lt;T&gt; Next &#123;
        get &#123; return next &#x3D;&#x3D; null || next &#x3D;&#x3D; list.head? null: next;&#125;
    &#125;

    public LinkedListNode&lt;T&gt; Previous &#123;
        get &#123; return prev &#x3D;&#x3D; null || this &#x3D;&#x3D; list.head? null: prev;&#125;
    &#125;
    &#x2F;&#x2F; ...    
&#125;  </code></pre>
<blockquote>
<p>This LinkedList is a doubly-Linked circular list.</p>
</blockquote>
<p>LinkedList çš„å®ç°ç¬¦åˆå¸¸è§çš„é“¾è¡¨æ•°æ®ç»“æ„è®¾è®¡ï¼Œä¸” LinkedList
å®ç°çš„æ˜¯é€šç”¨æ€§æ›´å¼ºçš„åŒå‘ã€ç¯çŠ¶ï¼ˆ<code>headâ†’prev == tail</code>,
<code>tailâ†’next ==
head</code>ï¼‰åˆ—è¡¨ï¼Œé˜…è¯»æºç çš„è¿‡ç¨‹æ›´åƒæ˜¯æŒ‡é’ˆæ“ä½œçš„ä¸€æ¬¡å¤ä¹ ã€‚</p>
<p>LinkedList èƒ½å¤Ÿè¿”å›èŠ‚ç‚¹ä¸ªæ•° <strong>count</strong>ï¼Œä»¥åŠé“¾è¡¨çš„å¤´èŠ‚ç‚¹
<strong>First</strong>ï¼Œå°¾èŠ‚ç‚¹ <strong>Last</strong>
(<code>head.prev</code>)</p>
<span id="more"></span>
<h2 id="å¯¹å¤–æ–¹æ³•">å¯¹å¤–æ–¹æ³•</h2>
<h3 id="æ„é€ å‡½æ•°-ctor">æ„é€ å‡½æ•° ctor</h3>
<ol type="1">
<li>å­˜åœ¨æ— å‚ï¼Œä»¥åŠæ¥å— IEnumerable&lt;T&gt; ä¸¤ä¸ªç‰ˆæœ¬çš„æ„é€ å‡½æ•°</li>
<li>æ¥å— IEnumerable&lt;T&gt; çš„æ„é€ å‡½æ•°ä¾èµ–çš„æ˜¯æ–¹æ³•
<code>LinkedList&lt;T&gt;.AddLast</code></li>
</ol>
<h3 id="ç©ºé“¾è¡¨åˆ¤æ–­">ç©ºé“¾è¡¨åˆ¤æ–­</h3>
<p>å¯ä»¥é€šè¿‡ç®€å•çš„ <code>head == null</code> åˆ¤æ–­å½“å‰é“¾è¡¨æ˜¯å¦ä¸ºç©º</p>
<h3 id="å¤´å°¾æ’å…¥èŠ‚ç‚¹-addfirst-addlast">å¤´å°¾æ’å…¥èŠ‚ç‚¹ AddFirst /
AddLast</h3>
<p>å¤´å°¾æ’å…¥å…ƒç´ çš„æ–¹æ³•éƒ½æ”¯æŒæ’å…¥å€¼ <code>(T value)</code> ä»¥åŠæ’å…¥èŠ‚ç‚¹
<code>(LinkedListNode&lt;T&gt; node)</code> çš„ç‰ˆæœ¬ã€‚</p>
<p><strong>AddFirst</strong> æ“ä½œå¯¹äºç©ºé“¾è¡¨æƒ…å†µï¼Œå†…éƒ¨å®ç°ä¸º
<code>InternalInsertNodeToEmptyList(node)</code>ï¼Œå¯¹äºéç©ºé“¾è¡¨ï¼Œå†…éƒ¨å®ç°ä¸º
<code>InternalInsertNodeBefore(head,
node)</code>ï¼Œå³å°†èŠ‚ç‚¹nodeæ’å…¥åˆ°å¤´æŒ‡é’ˆheadä¹‹å‰ï¼Œä¹‹åå†æŠŠæŒ‡é’ˆçš„å¤´èŠ‚ç‚¹è®¾ç½®ä¸ºä¼ å…¥çš„nodeã€‚</p>
<p><strong>AddLast</strong> æ“ä½œçš„å·§å¦™ä¹‹å¤„åœ¨äºæ–¹æ³•å®ç°ä¸
<strong>AddFirst</strong>
åŸºæœ¬æ˜¯ä¸€è‡´çš„ï¼Œå”¯ä¸€å·®å¼‚åœ¨äºé“¾è¡¨éç©ºçš„æƒ…å†µä¸‹ï¼Œåœ¨<code>InternalInsertNodeBefore(head,
node)</code>
ä¹‹åï¼Œå°‘äº†ä¸€æ­¥æŠŠå¤´èŠ‚ç‚¹è®¾ç½®ä¸ºä¼ å…¥çš„nodeï¼Œè¿™æ ·æ–°æ’å…¥çš„èŠ‚ç‚¹å°±è‡ªç„¶åœ¨é“¾è¡¨çš„æœ€æœ«å°¾äº†ï¼Œå› ä¸ºåœ¨åŒå‘æŒ‡é’ˆä¸­æˆ‘ä»¬æœ‰
<code>head â†’ prev == tail</code></p>
<h3 id="å‰åæ’å…¥èŠ‚ç‚¹-addafter-addbefore">å‰åæ’å…¥èŠ‚ç‚¹ AddAfter /
AddBefore</h3>
<p>AddAfter çš„æ“ä½œä¾èµ– <code>InternalInsertNodeBefore(nodeâ†’next,
newNode)</code> ã€‚</p>
<p>AddBefore çš„æ“ä½œåˆ™ç›´æ¥ä½¿ç”¨ <code>InternalInsertNodeBefore(node,
newNode)</code>ï¼Œä½†éœ€è¦é¢å¤–æ³¨æ„çš„æ˜¯è‹¥æ­¤å¤„çš„ç›®æ ‡èŠ‚ç‚¹ node
æ˜¯å¤´èŠ‚ç‚¹ï¼Œå‰æ’ä¹‹åè®°å¾—æ›´æ–°å¤´èŠ‚ç‚¹</p>
<h3 id="èŠ‚ç‚¹æŸ¥æ‰¾-find-findlast">èŠ‚ç‚¹æŸ¥æ‰¾ Find / FindLast</h3>
<p>Find å†…éƒ¨ä»…åŒºåˆ†æŸ¥æ‰¾çš„å…ƒç´  <code>(T value)</code> æ˜¯å¦ä¸º
nullï¼Œä»¥æ­¤å†³å®šç”¨
<code>EqualityComparer&lt;T&gt;.Default</code>ï¼Œè¿˜æ˜¯ç®€å•åœ°è¿›è¡Œ
<code>node.item == null</code> çš„åˆ¤æ–­ã€‚</p>
<p>è€Œ FindLast å’Œ Find çš„å·®å¼‚ä»…åœ¨äºä»åå¾€å‰æ‰¾ï¼Œè¿˜æ˜¯ä»å‰å¾€åæ‰¾ã€‚</p>
<h3 id="é“¾è¡¨çš„æ¸…ç©º-clear">é“¾è¡¨çš„æ¸…ç©º Clear</h3>
<p>é“¾è¡¨çš„æ¸…ç©ºæ“ä½œæ¶‰åŠåˆ°èŠ‚ç‚¹çš„æ— æ•ˆåŒ–ï¼ˆInvalidateï¼‰æ“ä½œï¼Œä½¿ç”¨èŠ‚ç‚¹ Next
éå†æ•´ä¸ªé“¾è¡¨ï¼Œå°†æ¯ä¸ªèŠ‚ç‚¹éƒ½æ— æ•ˆåŒ–ã€‚Clear æ“ä½œæœ€åå°†é“¾è¡¨çš„å¤´æŒ‡é’ˆ head
ç½®ç©ºï¼ŒèŠ‚ç‚¹ä¸ªæ•°å€¼ç½®0ã€‚</p>
<h3 id="æ‹·è´åˆ°æ•°ç»„-copytot-array-int-index">æ‹·è´åˆ°æ•°ç»„ CopyTo(T[] array,
int index)</h3>
<p>ï¼ˆéœ€è¦è‡ªå·±å¼€è¾Ÿæ•°ç»„ä¼ å…¥ï¼‰</p>
<p>è™½ç„¶é™¤å»ä¸€äº›æ•°ç»„å¤§å°çš„åˆæ³•æ€§æ£€æµ‹ï¼Œé€»è¾‘è¿˜æ˜¯æ¯”è¾ƒç®€å•çš„ï¼šéå†é“¾è¡¨å¹¶ä¾æ¬¡å­˜å…¥åˆ°æ•°ç»„ä¸­è€Œå·²ï¼Œ
ä½†æ˜¯æƒŠè®¶äºæœ‰è¿™æ ·ä¸€ä¸ªæ–¹æ³•ï¼Œæˆ–è®¸åœ¨ä¸€äº›åœºåˆä¼šæ´¾ä¸Šç”¨åœºã€‚</p>
<h3 id="èŠ‚ç‚¹ç§»é™¤-remove">èŠ‚ç‚¹ç§»é™¤ Remove</h3>
<p>ç±»ä¼¼èŠ‚ç‚¹çš„æ’å…¥ï¼ŒèŠ‚ç‚¹çš„ç§»é™¤æ“ä½œé™¤äº†æŒ‡å®šå€¼çš„ <code>Remove(T
value)</code>ï¼Œè¿˜æœ‰ç§»é™¤å¤´èŠ‚ç‚¹çš„
<code>RemoveFirst()</code>ï¼Œä»¥åŠç§»é™¤å°¾èŠ‚ç‚¹çš„
<code>RemoveLast()</code>ï¼Œå®ƒä»¬éƒ½ä¾èµ–åŒä¸€ä¸ªå†…éƒ¨æ–¹æ³•
<code>InternalRemoveNode(LinkedListNode&lt;T&gt; node)</code></p>
<h2 id="å†…éƒ¨å®ç°">å†…éƒ¨å®ç°</h2>
<h3 id="èŠ‚ç‚¹ç§»é™¤-internalremovenode">èŠ‚ç‚¹ç§»é™¤ InternalRemoveNode</h3>
<p>æ­¤æ–¹æ³•çš„å®ç°é™¤å»åˆæ³•æ€§æ ¡éªŒéƒ¨åˆ†ï¼Œåªå‰©ä¸‹äº†ä¸€ä¸ªæ ‡å‡†çš„åŒå‘é“¾è¡¨ç§»é™¤èŠ‚ç‚¹æ“ä½œ</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">internal void InternalRemoveNode(LinkedListNode&lt;T&gt; node) &#123;
    &#x2F;&#x2F; ...
    if ( node.next &#x3D;&#x3D; node) &#123;
        &#x2F;&#x2F; Debug.Assert(count &#x3D;&#x3D; 1 &amp;&amp; head &#x3D;&#x3D; node, ...
        head  &#x3D; null;
    &#125; 
    else &#123;
        node.next.prev &#x3D; node.prev;
        node.prev.next &#x3D; node.next;
        if ( head &#x3D;&#x3D; node) &#123;
            head &#x3D; node.next;
        &#125;
    &#125;
    node.Invalidate();  
    count--;
    version++;          
&#125;</code></pre>
<p>ç§»é™¤èŠ‚ç‚¹å°†ä¼šæ›´æ–°é“¾è¡¨çš„èŠ‚ç‚¹ä¸ªæ•° countï¼Œä»¥åŠç‰ˆæœ¬ version</p>
<h3 id="åˆå§‹åŒ–ç©ºé“¾è¡¨-internalinsertnodetoemptylist">åˆå§‹åŒ–ç©ºé“¾è¡¨
InternalInsertNodeToEmptyList</h3>
<p>ä½¿ç”¨æ–°èŠ‚ç‚¹åˆå§‹åŒ–ç©ºé“¾è¡¨æ—¶ï¼Œhead æŒ‡å‘å”¯ä¸€èŠ‚ç‚¹ï¼Œä¸”æ­¤èŠ‚ç‚¹çš„ prevï¼Œnext
å‡ä¸ºè‡ªå·±</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">private void InternalInsertNodeToEmptyList(LinkedListNode&lt;T&gt; newNode) &#123;
    &#x2F;&#x2F; Debug.Assert( head &#x3D;&#x3D; null &amp;&amp; count &#x3D;&#x3D; 0, ...
    newNode.next &#x3D; newNode;
    newNode.prev &#x3D; newNode;
    head &#x3D; newNode;
    version++;
    count++; 
&#125;
 </code></pre>
<h3 id="èŠ‚ç‚¹å‰æ’-internalinsertnodebefore">èŠ‚ç‚¹å‰æ’
InternalInsertNodeBefore</h3>
<p>ä¸€ä¸ªè§„èŒƒçš„åŒå‘é“¾è¡¨èŠ‚ç‚¹å‰æ’å®ç°ï¼Œå¯ä»¥ä½œä¸ºå‚è€ƒ</p>
<p>LinkedList ä¸­çš„æ‰€æœ‰é“¾è¡¨æ’å…¥æ“ä½œä»…ä¾èµ–è¿™ä¸€ä¸ªæ–¹æ³•ï¼Œåæ’çš„æ“ä½œä¼šé€šè¿‡
<code>InsertNodeBefore(nodeâ†’next, newNode)</code> æ¥å®ç°</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">private void InternalInsertNodeBefore(LinkedListNode&lt;T&gt; node, LinkedListNode&lt;T&gt; newNode) &#123;
    newNode.next &#x3D; node;
    newNode.prev &#x3D; node.prev;
    node.prev.next &#x3D; newNode;
    node.prev &#x3D; newNode;            
    version++;
    count++;
&#125;</code></pre>
<h3 id="èŠ‚ç‚¹æ— æ•ˆåŒ–-invalidatenode">èŠ‚ç‚¹æ— æ•ˆåŒ– InvalidateNode</h3>
<p>æ— æ•ˆåŒ–æ“ä½œä¼šå°†èŠ‚ç‚¹å­˜æœ‰çš„é“¾è¡¨å¼•ç”¨ï¼Œå‰å‘ã€åå‘æŒ‡é’ˆéƒ½ç½®ä¸º
nullï¼Œè¿™æ ·å½“æ“ä½œå®Œæˆåï¼Œè¿™äº›èŠ‚ç‚¹å°±éƒ½ä¼šè¢«GCå›æ”¶äº†ã€‚</p>
<h3 id="èŠ‚ç‚¹æ ¡éªŒ-validatenode-validatenewnode">èŠ‚ç‚¹æ ¡éªŒ ValidateNode /
ValidateNewNode</h3>
<p>å¯¹äºæ–°èŠ‚ç‚¹ï¼Œå°†æ ¡éªŒèŠ‚ç‚¹æ˜¯å¦ä¸ºnullï¼ŒèŠ‚ç‚¹æ˜¯å¦è¿˜Attachåœ¨ä¹‹å‰çš„listä¸Šï¼ˆè¦æ±‚
<code>node.list</code>
ä¸ºnullï¼‰ï¼›è€Œå¯¹äºå·²åœ¨é“¾è¡¨ä¸­çš„èŠ‚ç‚¹ï¼ŒåŒæ ·æ ¡éªŒèŠ‚ç‚¹æ˜¯å¦ä¸ºnullï¼Œä¸”æ ¡éªŒèŠ‚ç‚¹å­˜æœ‰çš„é“¾è¡¨å¼•ç”¨æ˜¯å¦ä¸ºå½“å‰é“¾è¡¨ï¼ˆè¦æ±‚
<code>node.list == this</code> ï¼‰</p>
<h3 id="èŠ‚ç‚¹çš„nextä¸previous">èŠ‚ç‚¹çš„Nextä¸Previous</h3>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public LinkedListNode&lt;T&gt; Next &#123;
    get &#123; return next &#x3D;&#x3D; null || next &#x3D;&#x3D; list.head? null: next;&#125;
&#125;

public LinkedListNode&lt;T&gt; Previous &#123;
    get &#123; return prev &#x3D;&#x3D; null || this &#x3D;&#x3D; list.head? null: prev;&#125;
&#125;</code></pre>
<p>åœ¨åŒå‘é“¾è¡¨ä¸­çš„èŠ‚ç‚¹æœ‰æ­¤è®¾è®¡ï¼šè‹¥å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹å·²æ˜¯å¤´èŠ‚ç‚¹ï¼Œé‚£ä¹ˆåœ¨è®¿é—®
Next æ—¶ä¼šè¿”å› null
æ¥è¡¨ç¤ºè‡ªå·±æ˜¯å°¾èŠ‚ç‚¹ï¼›è‹¥å½“å‰èŠ‚ç‚¹ä¸å¼•ç”¨é“¾è¡¨çš„å¤´èŠ‚ç‚¹ç›¸ç­‰ï¼Œé‚£ä¹ˆåœ¨è®¿é—®
Previous æ—¶ä¼šè¿”å› null æ¥è¡¨ç¤ºè‡ªå·±æ˜¯å¤´èŠ‚ç‚¹ã€‚</p>
<h2 id="è¿­ä»£å™¨-enumerator">è¿­ä»£å™¨ Enumerator</h2>
<p>LinkedList çš„è¿­ä»£å™¨å®ç°ä¹Ÿæ˜¯æ¯”è¾ƒç¬¦åˆç›´è§‰çš„ï¼Œé‡ç‚¹è§‚å¯Ÿä¸‹
<code>MoveNext()</code> æ–¹æ³•ä¸­çš„ç»ˆæ­¢æ¡ä»¶å³å¯ï¼š</p>
<pre class="line-numbers language-csharp" data-language="csharp"><code class="language-csharp">public bool MoveNext() &#123;
    if (version !&#x3D; list.version) &#123;
        throw new InvalidOperationException(SR.GetString(SR.InvalidOperation_EnumFailedVersion));
    &#125;
 
    if (node &#x3D;&#x3D; null) &#123;
        index &#x3D; list.Count + 1;
        return false;
    &#125;
 
    ++index;
    current &#x3D; node.item;   
    node &#x3D; node.next;  
    if (node &#x3D;&#x3D; list.head) &#123;
        node &#x3D; null;
    &#125;
    return true;
&#125;</code></pre>
<p>é™¤äº†ç†Ÿæ‚‰çš„ version checkï¼Œåªéœ€è¦æ³¨æ„è¿­ä»£åœ¨ä¸‹æ–¹çš„ <code>node ==
list.head</code> åŸºæœ¬ç»“æŸï¼Œä¸‹æ¬¡ä¾¿ä¼šç”±äº node å·²è®¾ç½® nullï¼Œè€Œå°† index
è®¾ç½®ä¸ºæ— æ•ˆå€¼<code>count + 1</code>ï¼Œä»¥æ­¤æ¥ç»“æŸè¿­ä»£ã€‚</p>
</div><script src="https://cdn.jsdelivr.net/lightgallery.js/1.0.1/js/lightgallery.min.js"></script><script src="/js/lg-thumbnail.min.js"></script><script src="/js/lg-zoom.min.js"></script><script src="/js/lg-fullscreen.min.js"></script><script>if (typeof lightGallery !== 'undefined') {
        var options = {
            selector: '.gallery-item'
        };
        lightGallery(document.getElementsByClassName('.article-gallery')[0], options);
        }</script>]]></content>
      <categories>
        <category>è®¡ç®—æœºç§‘å­¦</category>
        <category>ç¼–ç¨‹è¯­è¨€</category>
        <category>C#</category>
      </categories>
      <tags>
        <tag>C#</tag>
        <tag>.NET</tag>
        <tag>æºç é˜…è¯»</tag>
      </tags>
  </entry>
</search>
